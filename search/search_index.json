{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Bienvenue en Base de donn\u00e9es 2","title":"Accueil"},{"location":"#bienvenue-en-base-de-donnees-2","text":"","title":"Bienvenue en Base de donn\u00e9es 2"},{"location":"examen/epreuve_finale/formatif_part01/","text":"\u00c9preuve finale - partie 1 - Formatif Consignes Vous avez droit \u00e0 toutes vos notes et Internet. Aucune communication n'est permise (messagerie, courriel, etc.). Un \u00e9l\u00e8ve pris en flagrant d\u00e9lit se verra attribuer la note de 0 pour plagiat. La dur\u00e9e de l'examen est de 1h50. Une fois l\u2019examen termin\u00e9, vous devez me remettre les fichiers suivants dans un dossier compress\u00e9 nomm\u00e9 au format suivant : NomPrenom_ExamenFinalPartie1. Un diagramme de classe en format image. Un script SQL de cr\u00e9ation de la base de donn\u00e9es et des tables. Un script SQL de cr\u00e9ation des d\u00e9clencheurs. Un script SQL de cr\u00e9ation d'un usager. Le dossier compress\u00e9 doit \u00eatre remis sur Teams dans le devoir de l'examen. Il est de votre devoir de vous assurer que tous les fichiers sont inclus dans la remise. Aucun fichier ne sera accept\u00e9 une fois que vous aurez quitt\u00e9 le lieu de l'examen . Mise en situation L'entreprise qui vous emploie d\u00e9veloppe une application qui permet de cr\u00e9er des questionnaires et vous \u00eates en charge de cr\u00e9er la base de donn\u00e9es qui contiendra ces questionnaires. Vous avez re\u00e7u de votre charg\u00e9 de projet les \u00e9crans suivants pour vous aider dans votre travail. Ce premier \u00e9cran repr\u00e9sente une vue du questionnaire dans son ensemble. Pour chaque questionnaire on doit obligatoirement d\u00e9finir un titre et on a l'option d'ajouter un court texte descriptif. On peut ensuite ajouter une ou plusieurs questions qui peuvent \u00eatre de deux types : \u00e0 choix de r\u00e9ponse ou bien au format texte. Chaque type \u00e0 ses propres particularit\u00e9s. Le questionnaire \u00e0 une colonne qu'on ne voit pas \u00e0 l'\u00e9cran et qui contient le pointage cumul\u00e9 de toutes les questions. Questions \u00e0 choix de r\u00e9ponse. Voici une capture d'\u00e9cran des options d'une question \u00e0 choix de r\u00e9ponse. La question peut avoir plusieurs choix, mais seulement un de ces choix est la bonne r\u00e9ponse. On peut ajouter un pointage ou pas \u00e0 la question. La question peut \u00eatre obligatoire ou non. Questions au format texte Voici une capture d'\u00e9cran d'une question au format texte. - Pour ce type de question, l'usager doit saisir sa r\u00e9ponse en texte. On peut avoir une ou plusieurs bonnes r\u00e9ponses. - On peut ajouter un pointage ou pas \u00e0 la question. - La question peut \u00eatre obligatoire ou non. Directives Question #1 Vous devez cr\u00e9er un mod\u00e8le de la base de donn\u00e9es qui permettra de reproduire des questionnaires selon les sp\u00e9cifications de la mise en situation plus haut. Le mod\u00e8le doit seulement permettre de sauvegarder les informations de cr\u00e9ation du questionnaire, vous ne devez pas \u00e0 g\u00e9rer les r\u00e9ponses des participants. Votre mod\u00e8le doit \u00eatre sous la forme d'un diagramme de classes et r\u00e9pondre aux points suivants : Votre diagramme doit r\u00e9pondre \u00e0 la convention de nomenclature telle que d\u00e9crite dans les notes de cours \"Analyse et mod\u00e9lisation de syst\u00e8mes\". Pour chaque colonne de chaque table du diagramme, vous devez sp\u00e9cifier un type de donn\u00e9es ad\u00e9quat, si elle est une cl\u00e9 primaire (PK) ou \u00e9trang\u00e8re (FK). Si la colonne est ni une cl\u00e9 primaire ou \u00e9trang\u00e8re, mais qu'elle ne peut \u00eatre nulle, vous devez aussi l'indiquer (NOT NULL). ex. #1 -> id INT PK ex. #2 -> code_usager VARCHAR(50) NOT NULL Pour les relations entre les tables, vous devez m'indiquer le type de relation en utilisant la notation 1<--->1 pour une relation d'un \u00e0 un et 1<--->n ou n<--->1 pour une relation d'un \u00e0 plusieurs Votre mod\u00e9lisation doit r\u00e9pondre aux r\u00e8gles de la troisi\u00e8me forme normale. Vous devez me fournir votre diagramme de classes dans un format image (jpg, png) et le nommer NomPrenom_diagramme Question #2 Cr\u00e9ez un script SQL qui va cr\u00e9er la base de donn\u00e9es ainsi que toutes les tables repr\u00e9sent\u00e9es dans votre diagramme de classes. La base de donn\u00e9es doit se nommer ExamenFinal_NomPrenom Dans la cr\u00e9ation des tables, vous devez inclure la cr\u00e9ation des cl\u00e9s primaires et \u00e9trang\u00e8res s'il y a lieu. Le script doit pouvoir \u00eatre lanc\u00e9 plus d'une fois sans provoquer d'erreurs. Chaque lancement du script doit r\u00e9g\u00e9n\u00e9rer la base de donn\u00e9es ainsi que les tables. Le script SQL \u00e0 remettre doit se nommer NomPrenom_ceationBD.sql. Question #3 Cr\u00e9ez un script SQL qui va ajouter des d\u00e9clencheurs (Triggers) qui permettront de recalculer la colonne du pointage cumul\u00e9 du questionnaire \u00e0 chaque fois que vous allez ajouter, modifier ou supprimer une question. Pour chacune des op\u00e9rations (ajout, modification et suppression), choisissez le bon moment pour placer le d\u00e9clencheur. Si la question n'a pas de pointage, vous ne devez pas faire la mise \u00e0 jour de la colonne. Le script doit pouvoir \u00eatre lanc\u00e9 plus d'une fois sans provoquer d'erreurs. Chaque lancement du script doit recr\u00e9er les triggers. Le script SQL \u00e0 remettre doit se nommer NomPrenom_creationTrigger.sql. Question #4 Cr\u00e9ez un script SQL qui fera la cr\u00e9ation d'un usager et lui donnera des permissions selon les informations suivantes: a) Informations de l'usager : nom : correcteur mot de passe : !3ct3Ur h\u00f4te accept\u00e9 : localhost b) Permission de l'usager : Il peut faire des requ\u00eates SELECT et UPDATE sur toutes les colonnes de la table qui contient les informations g\u00e9n\u00e9rales du questionnaire de votre base de donn\u00e9es sauf la colonne du pointage calcul\u00e9 . Pour toutes les autres tables de la base de donn\u00e9es, il peut faire des requ\u00eates SELECT et UPDATE. Le script doit pouvoir \u00eatre lanc\u00e9 plus d'une fois sans provoquer d'erreurs et chaque lancement du script doit recr\u00e9er les triggers. Le script SQL \u00e0 remettre doit se nommer NomPrenom_creationUsager.sql. Grille de correction \u00c9l\u00e9ments Points Tous les scripts SQL peuvent \u00eatre ex\u00e9cut\u00e9s plus d'une fois sans provoquer d'erreurs /6 Question #1 /40 La convention de nomenclature est respect\u00e9e. 2 Les types de donn\u00e9es utilis\u00e9s sont exacts et pertinents. 6 Les relations entre les tables sont justes. 10 La mod\u00e9lisation r\u00e9pond aux r\u00e8gles de la troisi\u00e8me forme normale. 2 Le diagramme de classes r\u00e9pond aux besoins de la mise en situation. 20 Question #2 /20 La base de donn\u00e9es est cr\u00e9\u00e9e et porte le nom requis 5 Toutes les tables sont cr\u00e9\u00e9es ainsi que les cl\u00e9s primaires et \u00e9trang\u00e8res 15 Question #3 /24 Un d\u00e9clencheur est lanc\u00e9 au bon moment lors de l'ajout d'une question et met \u00e0 jour le pointage calcul\u00e9 au besoin. 8 Un d\u00e9clencheur est lanc\u00e9 au bon moment lors de la modification d'une question et met \u00e0 jour le pointage calcul\u00e9 au besoin. 8 Un d\u00e9clencheur est lanc\u00e9 au bon moment lors de la suppression d'une question et met \u00e0 jour le pointage calcul\u00e9 au besoin. 8 Question #4 /10 L'usager est cr\u00e9\u00e9 selon les informations donn\u00e9es. 5 Les permissions requises sont accord\u00e9es \u00e0 l'usager. 5 Total /100","title":"Formatif partie 01"},{"location":"examen/epreuve_finale/formatif_part01/#epreuve-finale-partie-1-formatif","text":"","title":"\u00c9preuve finale - partie 1 - Formatif"},{"location":"examen/epreuve_finale/formatif_part01/#consignes","text":"Vous avez droit \u00e0 toutes vos notes et Internet. Aucune communication n'est permise (messagerie, courriel, etc.). Un \u00e9l\u00e8ve pris en flagrant d\u00e9lit se verra attribuer la note de 0 pour plagiat. La dur\u00e9e de l'examen est de 1h50. Une fois l\u2019examen termin\u00e9, vous devez me remettre les fichiers suivants dans un dossier compress\u00e9 nomm\u00e9 au format suivant : NomPrenom_ExamenFinalPartie1. Un diagramme de classe en format image. Un script SQL de cr\u00e9ation de la base de donn\u00e9es et des tables. Un script SQL de cr\u00e9ation des d\u00e9clencheurs. Un script SQL de cr\u00e9ation d'un usager. Le dossier compress\u00e9 doit \u00eatre remis sur Teams dans le devoir de l'examen. Il est de votre devoir de vous assurer que tous les fichiers sont inclus dans la remise. Aucun fichier ne sera accept\u00e9 une fois que vous aurez quitt\u00e9 le lieu de l'examen .","title":"Consignes"},{"location":"examen/epreuve_finale/formatif_part01/#mise-en-situation","text":"L'entreprise qui vous emploie d\u00e9veloppe une application qui permet de cr\u00e9er des questionnaires et vous \u00eates en charge de cr\u00e9er la base de donn\u00e9es qui contiendra ces questionnaires. Vous avez re\u00e7u de votre charg\u00e9 de projet les \u00e9crans suivants pour vous aider dans votre travail. Ce premier \u00e9cran repr\u00e9sente une vue du questionnaire dans son ensemble. Pour chaque questionnaire on doit obligatoirement d\u00e9finir un titre et on a l'option d'ajouter un court texte descriptif. On peut ensuite ajouter une ou plusieurs questions qui peuvent \u00eatre de deux types : \u00e0 choix de r\u00e9ponse ou bien au format texte. Chaque type \u00e0 ses propres particularit\u00e9s. Le questionnaire \u00e0 une colonne qu'on ne voit pas \u00e0 l'\u00e9cran et qui contient le pointage cumul\u00e9 de toutes les questions.","title":"Mise en situation"},{"location":"examen/epreuve_finale/formatif_part01/#questions-a-choix-de-reponse","text":"Voici une capture d'\u00e9cran des options d'une question \u00e0 choix de r\u00e9ponse. La question peut avoir plusieurs choix, mais seulement un de ces choix est la bonne r\u00e9ponse. On peut ajouter un pointage ou pas \u00e0 la question. La question peut \u00eatre obligatoire ou non.","title":"Questions \u00e0 choix de r\u00e9ponse."},{"location":"examen/epreuve_finale/formatif_part01/#questions-au-format-texte","text":"Voici une capture d'\u00e9cran d'une question au format texte. - Pour ce type de question, l'usager doit saisir sa r\u00e9ponse en texte. On peut avoir une ou plusieurs bonnes r\u00e9ponses. - On peut ajouter un pointage ou pas \u00e0 la question. - La question peut \u00eatre obligatoire ou non.","title":"Questions au format texte"},{"location":"examen/epreuve_finale/formatif_part01/#directives","text":"","title":"Directives"},{"location":"examen/epreuve_finale/formatif_part01/#question-1","text":"Vous devez cr\u00e9er un mod\u00e8le de la base de donn\u00e9es qui permettra de reproduire des questionnaires selon les sp\u00e9cifications de la mise en situation plus haut. Le mod\u00e8le doit seulement permettre de sauvegarder les informations de cr\u00e9ation du questionnaire, vous ne devez pas \u00e0 g\u00e9rer les r\u00e9ponses des participants. Votre mod\u00e8le doit \u00eatre sous la forme d'un diagramme de classes et r\u00e9pondre aux points suivants : Votre diagramme doit r\u00e9pondre \u00e0 la convention de nomenclature telle que d\u00e9crite dans les notes de cours \"Analyse et mod\u00e9lisation de syst\u00e8mes\". Pour chaque colonne de chaque table du diagramme, vous devez sp\u00e9cifier un type de donn\u00e9es ad\u00e9quat, si elle est une cl\u00e9 primaire (PK) ou \u00e9trang\u00e8re (FK). Si la colonne est ni une cl\u00e9 primaire ou \u00e9trang\u00e8re, mais qu'elle ne peut \u00eatre nulle, vous devez aussi l'indiquer (NOT NULL). ex. #1 -> id INT PK ex. #2 -> code_usager VARCHAR(50) NOT NULL Pour les relations entre les tables, vous devez m'indiquer le type de relation en utilisant la notation 1<--->1 pour une relation d'un \u00e0 un et 1<--->n ou n<--->1 pour une relation d'un \u00e0 plusieurs Votre mod\u00e9lisation doit r\u00e9pondre aux r\u00e8gles de la troisi\u00e8me forme normale. Vous devez me fournir votre diagramme de classes dans un format image (jpg, png) et le nommer NomPrenom_diagramme","title":"Question #1"},{"location":"examen/epreuve_finale/formatif_part01/#question-2","text":"Cr\u00e9ez un script SQL qui va cr\u00e9er la base de donn\u00e9es ainsi que toutes les tables repr\u00e9sent\u00e9es dans votre diagramme de classes. La base de donn\u00e9es doit se nommer ExamenFinal_NomPrenom Dans la cr\u00e9ation des tables, vous devez inclure la cr\u00e9ation des cl\u00e9s primaires et \u00e9trang\u00e8res s'il y a lieu. Le script doit pouvoir \u00eatre lanc\u00e9 plus d'une fois sans provoquer d'erreurs. Chaque lancement du script doit r\u00e9g\u00e9n\u00e9rer la base de donn\u00e9es ainsi que les tables. Le script SQL \u00e0 remettre doit se nommer NomPrenom_ceationBD.sql.","title":"Question #2"},{"location":"examen/epreuve_finale/formatif_part01/#question-3","text":"Cr\u00e9ez un script SQL qui va ajouter des d\u00e9clencheurs (Triggers) qui permettront de recalculer la colonne du pointage cumul\u00e9 du questionnaire \u00e0 chaque fois que vous allez ajouter, modifier ou supprimer une question. Pour chacune des op\u00e9rations (ajout, modification et suppression), choisissez le bon moment pour placer le d\u00e9clencheur. Si la question n'a pas de pointage, vous ne devez pas faire la mise \u00e0 jour de la colonne. Le script doit pouvoir \u00eatre lanc\u00e9 plus d'une fois sans provoquer d'erreurs. Chaque lancement du script doit recr\u00e9er les triggers. Le script SQL \u00e0 remettre doit se nommer NomPrenom_creationTrigger.sql.","title":"Question #3"},{"location":"examen/epreuve_finale/formatif_part01/#question-4","text":"Cr\u00e9ez un script SQL qui fera la cr\u00e9ation d'un usager et lui donnera des permissions selon les informations suivantes: a) Informations de l'usager : nom : correcteur mot de passe : !3ct3Ur h\u00f4te accept\u00e9 : localhost b) Permission de l'usager : Il peut faire des requ\u00eates SELECT et UPDATE sur toutes les colonnes de la table qui contient les informations g\u00e9n\u00e9rales du questionnaire de votre base de donn\u00e9es sauf la colonne du pointage calcul\u00e9 . Pour toutes les autres tables de la base de donn\u00e9es, il peut faire des requ\u00eates SELECT et UPDATE. Le script doit pouvoir \u00eatre lanc\u00e9 plus d'une fois sans provoquer d'erreurs et chaque lancement du script doit recr\u00e9er les triggers. Le script SQL \u00e0 remettre doit se nommer NomPrenom_creationUsager.sql.","title":"Question #4"},{"location":"examen/epreuve_finale/formatif_part01/#grille-de-correction","text":"\u00c9l\u00e9ments Points Tous les scripts SQL peuvent \u00eatre ex\u00e9cut\u00e9s plus d'une fois sans provoquer d'erreurs /6 Question #1 /40 La convention de nomenclature est respect\u00e9e. 2 Les types de donn\u00e9es utilis\u00e9s sont exacts et pertinents. 6 Les relations entre les tables sont justes. 10 La mod\u00e9lisation r\u00e9pond aux r\u00e8gles de la troisi\u00e8me forme normale. 2 Le diagramme de classes r\u00e9pond aux besoins de la mise en situation. 20 Question #2 /20 La base de donn\u00e9es est cr\u00e9\u00e9e et porte le nom requis 5 Toutes les tables sont cr\u00e9\u00e9es ainsi que les cl\u00e9s primaires et \u00e9trang\u00e8res 15 Question #3 /24 Un d\u00e9clencheur est lanc\u00e9 au bon moment lors de l'ajout d'une question et met \u00e0 jour le pointage calcul\u00e9 au besoin. 8 Un d\u00e9clencheur est lanc\u00e9 au bon moment lors de la modification d'une question et met \u00e0 jour le pointage calcul\u00e9 au besoin. 8 Un d\u00e9clencheur est lanc\u00e9 au bon moment lors de la suppression d'une question et met \u00e0 jour le pointage calcul\u00e9 au besoin. 8 Question #4 /10 L'usager est cr\u00e9\u00e9 selon les informations donn\u00e9es. 5 Les permissions requises sont accord\u00e9es \u00e0 l'usager. 5 Total /100","title":"Grille de correction"},{"location":"examen/epreuve_finale/formatif_part02/","text":"\u00c9preuve finale - partie 2 - Formatif Consignes Vous avez droit \u00e0 toutes vos notes et Internet. Aucune communication n'est permise (messagerie, courriel, etc.). Un \u00e9l\u00e8ve pris en flagrant d\u00e9lit se verra attribuer la note de 0 pour plagiat. La dur\u00e9e de l'examen est de 1h50. Une fois l\u2019examen termin\u00e9, vous devez faire un commit avec le message \"Remise finale\" et faire un push de votre d\u00e9p\u00f4t pour le synchroniser avec GitHub. Il est de votre devoir de vous assurer que votre fichier est inclus dans la remise. Aucun fichier ne sera accept\u00e9 une fois que vous aurez quitt\u00e9 le lieu de l'examen. Directives Clonez le d\u00e9p\u00f4t GitHub suivant : https://github.com/Base-de-donnee-2/epreuvefinal-formatif2.git Importez le script SQL create_bd.sql pr\u00e9sent dans le r\u00e9pertoire ressources du d\u00e9p\u00f4t Git clon\u00e9. N'oubliez pas dans le script Python d'ajuster les informations de connexion \u00e0 la base de donn\u00e9es. Diagramme de classe de la base de donn\u00e9es import\u00e9e Menu principale du script questionnaire.py Question #1 Compl\u00e9tez la section afficher une question du script questionnaire.py. Vous devez demander \u00e0 l'usager le id de la question. Si le id est valide et que la question existe, afficher les informations suivantes : Sur la premi\u00e8re ligne, le texte de la question, un ast\u00e9risque si la question est obligatoire et le pointage de la question entre parenth\u00e8ses. Ex: \"Quelle est la capitale du Botswana * (5 points)\" Sur la deuxi\u00e8me ligne, le type de la question. \"Question \u00e0 choix\" Sur les lignes suivantes, si c'est une question \u00e0 choix de r\u00e9ponse, afficher un choix par ligne et entre parenth\u00e8ses \"(bonne r\u00e9ponse)\" \u00e0 la suite de la ligne avec le choix de la bonne r\u00e9ponse. Si c'est une question texte, afficher sur une troisi\u00e8me ligne \"Bonne r\u00e9ponse : \" et la liste des r\u00e9ponses de la table question_texte_reponse s\u00e9par\u00e9es par des virgules. Ex : \"Bonne r\u00e9ponse : Anglais, Tswana\" Exemple de r\u00e9sultat pour une question \u00e0 choix Exemple de r\u00e9sultat pour une question texte Question #2 Compl\u00e9tez la section ajouter une r\u00e9ponse du script questionnaire.py. Vous devez demander \u00e0 l'usager le id de la question. Demandez le texte de la r\u00e9ponse \u00e0 ajouter. Si la question est \u00e0 choix de r\u00e9ponse Vous devez demander si c'est la bonne r\u00e9ponse. Ex \"Est-ce la bonne r\u00e9ponse (o/n)\" Vous devez demander l'ordre du choix. (Vous n'\u00eates pas oblig\u00e9 de valider si le nombre est d\u00e9j\u00e0 utilis\u00e9 pour cette question) Faites ensuite la requ\u00eate d'ajout de ces informations dans la bonne table selon le type de question (question_choix ou question_texte_reponse). Question #3 Compl\u00e9tez la section supprimer une question du script questionnaire.py. Cr\u00e9ez une proc\u00e9dure stock\u00e9e nomm\u00e9e suppressionQuestion et qui prendra en param\u00e8tre le id de la question. Dans votre proc\u00e9dure stock\u00e9e, faites la suppression de la question ainsi que les choix de r\u00e9ponse de la table question_choix ou les bonnes r\u00e9ponses de la table question_texte_reponse . Les requ\u00eates de suppression doivent \u00eatre comprise dans une transaction et elle sera approuv\u00e9 que si toutes les requ\u00eates ont r\u00e9ussi. (Voir les notes de cours ou notre bon ami Google). Lancez la proc\u00e9dure stock\u00e9e quand vous s\u00e9lectionnez l'option supprimer une question du menu principale. Ajoutez un script sql nomm\u00e9 create_suppressionQuestion.sql dans le r\u00e9pertoire ressources du projet qui permettra de recr\u00e9er votre proc\u00e9dure stock\u00e9e. Grille de correction \u00c9l\u00e9ments Points Question #1 /25 Les informations requises de la question sont affich\u00e9es \u00e0 l'\u00e9cran selon les directives. 10 Les choix de r\u00e9ponses ou la liste de bonne r\u00e9ponse sont affich\u00e9es \u00e0 l'\u00e9cran. 15 Question #2 /25 La r\u00e9ponse est ajout\u00e9 avec toutes les informations requises dans la bonne table. 25 Question #3 /50 Une proc\u00e9dure stock\u00e9e est cr\u00e9\u00e9 et permet de supprimer une question et ses choix de r\u00e9ponses ou bonnes r\u00e9ponses. 20 La proc\u00e9dure stock\u00e9e est lanc\u00e9 depuis l'option Supprimer une question du menu principal. 10 Les requ\u00eates de suppression de la proc\u00e9dure stock\u00e9e sont comprise dans une transaction. 5 La transaction \u00e9choue si une des requ\u00eates provoque une erreur. 10 Un script SQL est pr\u00e9sent dans le r\u00e9pertoire ressources et permet de recr\u00e9er la proc\u00e9dure stock\u00e9e 5 Total /100","title":"Formatif partie 02"},{"location":"examen/epreuve_finale/formatif_part02/#epreuve-finale-partie-2-formatif","text":"","title":"\u00c9preuve finale - partie 2 - Formatif"},{"location":"examen/epreuve_finale/formatif_part02/#consignes","text":"Vous avez droit \u00e0 toutes vos notes et Internet. Aucune communication n'est permise (messagerie, courriel, etc.). Un \u00e9l\u00e8ve pris en flagrant d\u00e9lit se verra attribuer la note de 0 pour plagiat. La dur\u00e9e de l'examen est de 1h50. Une fois l\u2019examen termin\u00e9, vous devez faire un commit avec le message \"Remise finale\" et faire un push de votre d\u00e9p\u00f4t pour le synchroniser avec GitHub. Il est de votre devoir de vous assurer que votre fichier est inclus dans la remise. Aucun fichier ne sera accept\u00e9 une fois que vous aurez quitt\u00e9 le lieu de l'examen.","title":"Consignes"},{"location":"examen/epreuve_finale/formatif_part02/#directives","text":"Clonez le d\u00e9p\u00f4t GitHub suivant : https://github.com/Base-de-donnee-2/epreuvefinal-formatif2.git Importez le script SQL create_bd.sql pr\u00e9sent dans le r\u00e9pertoire ressources du d\u00e9p\u00f4t Git clon\u00e9. N'oubliez pas dans le script Python d'ajuster les informations de connexion \u00e0 la base de donn\u00e9es. Diagramme de classe de la base de donn\u00e9es import\u00e9e Menu principale du script questionnaire.py","title":"Directives"},{"location":"examen/epreuve_finale/formatif_part02/#question-1","text":"Compl\u00e9tez la section afficher une question du script questionnaire.py. Vous devez demander \u00e0 l'usager le id de la question. Si le id est valide et que la question existe, afficher les informations suivantes : Sur la premi\u00e8re ligne, le texte de la question, un ast\u00e9risque si la question est obligatoire et le pointage de la question entre parenth\u00e8ses. Ex: \"Quelle est la capitale du Botswana * (5 points)\" Sur la deuxi\u00e8me ligne, le type de la question. \"Question \u00e0 choix\" Sur les lignes suivantes, si c'est une question \u00e0 choix de r\u00e9ponse, afficher un choix par ligne et entre parenth\u00e8ses \"(bonne r\u00e9ponse)\" \u00e0 la suite de la ligne avec le choix de la bonne r\u00e9ponse. Si c'est une question texte, afficher sur une troisi\u00e8me ligne \"Bonne r\u00e9ponse : \" et la liste des r\u00e9ponses de la table question_texte_reponse s\u00e9par\u00e9es par des virgules. Ex : \"Bonne r\u00e9ponse : Anglais, Tswana\" Exemple de r\u00e9sultat pour une question \u00e0 choix Exemple de r\u00e9sultat pour une question texte","title":"Question #1"},{"location":"examen/epreuve_finale/formatif_part02/#question-2","text":"Compl\u00e9tez la section ajouter une r\u00e9ponse du script questionnaire.py. Vous devez demander \u00e0 l'usager le id de la question. Demandez le texte de la r\u00e9ponse \u00e0 ajouter. Si la question est \u00e0 choix de r\u00e9ponse Vous devez demander si c'est la bonne r\u00e9ponse. Ex \"Est-ce la bonne r\u00e9ponse (o/n)\" Vous devez demander l'ordre du choix. (Vous n'\u00eates pas oblig\u00e9 de valider si le nombre est d\u00e9j\u00e0 utilis\u00e9 pour cette question) Faites ensuite la requ\u00eate d'ajout de ces informations dans la bonne table selon le type de question (question_choix ou question_texte_reponse).","title":"Question #2"},{"location":"examen/epreuve_finale/formatif_part02/#question-3","text":"Compl\u00e9tez la section supprimer une question du script questionnaire.py. Cr\u00e9ez une proc\u00e9dure stock\u00e9e nomm\u00e9e suppressionQuestion et qui prendra en param\u00e8tre le id de la question. Dans votre proc\u00e9dure stock\u00e9e, faites la suppression de la question ainsi que les choix de r\u00e9ponse de la table question_choix ou les bonnes r\u00e9ponses de la table question_texte_reponse . Les requ\u00eates de suppression doivent \u00eatre comprise dans une transaction et elle sera approuv\u00e9 que si toutes les requ\u00eates ont r\u00e9ussi. (Voir les notes de cours ou notre bon ami Google). Lancez la proc\u00e9dure stock\u00e9e quand vous s\u00e9lectionnez l'option supprimer une question du menu principale. Ajoutez un script sql nomm\u00e9 create_suppressionQuestion.sql dans le r\u00e9pertoire ressources du projet qui permettra de recr\u00e9er votre proc\u00e9dure stock\u00e9e.","title":"Question #3"},{"location":"examen/epreuve_finale/formatif_part02/#grille-de-correction","text":"\u00c9l\u00e9ments Points Question #1 /25 Les informations requises de la question sont affich\u00e9es \u00e0 l'\u00e9cran selon les directives. 10 Les choix de r\u00e9ponses ou la liste de bonne r\u00e9ponse sont affich\u00e9es \u00e0 l'\u00e9cran. 15 Question #2 /25 La r\u00e9ponse est ajout\u00e9 avec toutes les informations requises dans la bonne table. 25 Question #3 /50 Une proc\u00e9dure stock\u00e9e est cr\u00e9\u00e9 et permet de supprimer une question et ses choix de r\u00e9ponses ou bonnes r\u00e9ponses. 20 La proc\u00e9dure stock\u00e9e est lanc\u00e9 depuis l'option Supprimer une question du menu principal. 10 Les requ\u00eates de suppression de la proc\u00e9dure stock\u00e9e sont comprise dans une transaction. 5 La transaction \u00e9choue si une des requ\u00eates provoque une erreur. 10 Un script SQL est pr\u00e9sent dans le r\u00e9pertoire ressources et permet de recr\u00e9er la proc\u00e9dure stock\u00e9e 5 Total /100","title":"Grille de correction"},{"location":"examen/intra/examen_intra/","text":"Examen intra - Dune Consignes Vous avez droit \u00e0 toutes vos notes et Internet. Aucune communication n'est permise (messagerie, courriel, etc.). Un \u00e9l\u00e8ve pris en flagrant d\u00e9lit se verra attribuer la note de 0 pour plagiat. La dur\u00e9e de l'examen est de 1h50. Une fois l\u2019examen termin\u00e9, vous devez me remettre un fichier image de votre diagramme de classes via le devoir de l\u2019examen sur Teams. Le fichier doit \u00eatre nomm\u00e9 au format suivant : NomPrenom_Examen1. Il est de votre devoir de vous assurer que votre fichier est inclus dans la remise. Aucun fichier ne sera accept\u00e9 une fois que vous aurez quitt\u00e9 le lieu de l'examen. Mise en situation La maison des Atreides fait appel \u00e0 vos services pour informatiser leur op\u00e9ration d'extraction de l'\u00c9pice sur la plan\u00e8te Arrakis. L'\u00c9pice se retrouve naturellement dans les d\u00e9serts de sable qui recouvrent la plan\u00e8te, concentr\u00e9e dans des endroits bien d\u00e9finis qu'on nomme champ. Pour chaque champ, on attribue un code alphanum\u00e9rique de 5 caract\u00e8res et un nom. Ex. un champ nomm\u00e9 \"petit erg austral\" portant le code ea012. Les champs peuvent parfois \u00eatre immenses et l'on d\u00e9finit des zones d'extractions dans chaque champ o\u00f9 la r\u00e9colte d'\u00c9pice se fera. Une zone d'extraction a aussi un code alphanum\u00e9rique de 5 caract\u00e8res. On doit aussi conna\u00eetre sa localisation par sa latitude, longitude et son altitude. La latitude est un nombre variant entre 90 et -90 degr\u00e9s avec une pr\u00e9cision de 6 d\u00e9cimales. La longitude varie entre 180 et -180 degr\u00e9s avec elle aussi une pr\u00e9cision de 6 d\u00e9cimales. Finalement, l'altitude est une valeur enti\u00e8re en m\u00e8tres qui peut \u00eatre n\u00e9gative. Ex : Latitude : 46.059537 | Longitude : -71.94353 | Altitude : 140. On effectue r\u00e9guli\u00e8rement des estimations pour chaque zone du nombre de lingots d'\u00c9pice (lge) qu'on pourrait extraire. Pour chaque estimation, on veut savoir la date de l'estimation ainsi que le nombre de lge estim\u00e9 qui est une valeur num\u00e9rique enti\u00e8re. Parlons maintenant des op\u00e9rations d'extractions. Les extractions se font \u00e0 l'aide de \"moissonneuse\", un v\u00e9hicule adapt\u00e9 pour ce travail. Pour l'instant, la seule information \u00e0 conna\u00eetre sur nos moissonneuses est son num\u00e9ro de s\u00e9rie, un code alphanum\u00e9rique de 20 caract\u00e8res. Ensuite, pour chaque op\u00e9ration, il y a qu'une moissonneuse d'impliqu\u00e9e, mais chaque moissonneuse va participer \u00e0 plusieurs op\u00e9rations. L'op\u00e9ration est aussi reli\u00e9e \u00e0 une zone d'extraction. Bien s\u00fbr une zone d'extraction va \"subir\" plusieurs op\u00e9rations d'extraction. Les autres informations \u00e0 retenir pour l'op\u00e9ration sont la date de l'op\u00e9ration, le poids au d\u00e9part et \u00e0 l'arriv\u00e9e de la moissonneuse (une valeur num\u00e9rique enti\u00e8re), la quantit\u00e9 de lingots d'\u00c9pice r\u00e9colt\u00e9s ainsi que le niveau de risque de l'op\u00e9ration. Le niveau de risque est choisi parmi une liste de terme (\"Bas\", \"Mod\u00e9r\u00e9\", \"\u00c9lev\u00e9\", \"Est-ce que \u00e7a en vaut vraiment la peine\"). Pour assurer la protection des op\u00e9rations, on engage un ou plusieurs groupes de mercenaires. Pour le groupe de mercenaire, on ne veut conna\u00eetre que le nom du groupe, la personne contact (on peut inscrire son nom et pr\u00e9nom dans la m\u00eame colonne \ud83d\ude1c ) et une cote de confiance. La cote de confiance est un pourcentage de 0 \u00e0 100% avec une pr\u00e9cision de 2 d\u00e9cimales (75.50%). On va aussi joindre \u00e0 chaque op\u00e9ration une ou plusieurs \u00e9quipes de travail. Les \u00e9quipes sont identifi\u00e9es par un code alphanum\u00e9rique de 5 caract\u00e8res. Ces \u00e9quipes sont form\u00e9es de plusieurs employ\u00e9s, mais un employ\u00e9 ne peut pas faire partie de plus d'une \u00e9quipe \u00e0 la fois. Pour chaque employ\u00e9 on doit conna\u00eetre son nom et pr\u00e9nom, sa date de naissance, sa plan\u00e8te d'origine, la maison \u00e0 laquelle il appartient (la maison est un peu comme son clan) et sa profession. L'employ\u00e9 ne peut avoir qu'une profession et appartenir qu'\u00e0 une maison. Notes aux puristes : Ok je sais que dans l'univers de Dune les ordinateurs comme nous les connaissons ont \u00e9t\u00e9 banni depuis longtemps mais bon on va dire qu'ils existent encore. Directives Vous devez cr\u00e9er un diagramme de classes qui r\u00e9pond aux besoins de la mise en situation en respectant les points suivants : Votre mod\u00e8le doit r\u00e9pondre \u00e0 la convention de nomenclature telle que d\u00e9crite dans les notes de cours \"Analyse et mod\u00e9lisation de syst\u00e8mes\". Vous devez sp\u00e9cifier un type de donn\u00e9es pertinent pour chaque colonne de chaque table du diagramme. Pour les relations entre les tables, vous devez m'indiquer le type de relation en utilisant la notation (1 -- 1..n). Votre mod\u00e9lisation doit r\u00e9pondre aux r\u00e8gles de la troisi\u00e8me forme normale. Grille de correction \u00c9l\u00e9ments points Total /100 La convention de nomenclature est respect\u00e9e 5 Les types de donn\u00e9es utilis\u00e9s sont exacte et pertinent 5 Les relations entrent les tables sont juste 30 La mod\u00e9lisation r\u00e9ponds aux r\u00e8gles de la troisi\u00e8me forme normale 10 Le diagramme de classes r\u00e9ponds aux besoins de la mise en situation 50","title":"Examen intra - Dune"},{"location":"examen/intra/examen_intra/#examen-intra-dune","text":"","title":"Examen intra - Dune"},{"location":"examen/intra/examen_intra/#consignes","text":"Vous avez droit \u00e0 toutes vos notes et Internet. Aucune communication n'est permise (messagerie, courriel, etc.). Un \u00e9l\u00e8ve pris en flagrant d\u00e9lit se verra attribuer la note de 0 pour plagiat. La dur\u00e9e de l'examen est de 1h50. Une fois l\u2019examen termin\u00e9, vous devez me remettre un fichier image de votre diagramme de classes via le devoir de l\u2019examen sur Teams. Le fichier doit \u00eatre nomm\u00e9 au format suivant : NomPrenom_Examen1. Il est de votre devoir de vous assurer que votre fichier est inclus dans la remise. Aucun fichier ne sera accept\u00e9 une fois que vous aurez quitt\u00e9 le lieu de l'examen.","title":"Consignes"},{"location":"examen/intra/examen_intra/#mise-en-situation","text":"La maison des Atreides fait appel \u00e0 vos services pour informatiser leur op\u00e9ration d'extraction de l'\u00c9pice sur la plan\u00e8te Arrakis. L'\u00c9pice se retrouve naturellement dans les d\u00e9serts de sable qui recouvrent la plan\u00e8te, concentr\u00e9e dans des endroits bien d\u00e9finis qu'on nomme champ. Pour chaque champ, on attribue un code alphanum\u00e9rique de 5 caract\u00e8res et un nom. Ex. un champ nomm\u00e9 \"petit erg austral\" portant le code ea012. Les champs peuvent parfois \u00eatre immenses et l'on d\u00e9finit des zones d'extractions dans chaque champ o\u00f9 la r\u00e9colte d'\u00c9pice se fera. Une zone d'extraction a aussi un code alphanum\u00e9rique de 5 caract\u00e8res. On doit aussi conna\u00eetre sa localisation par sa latitude, longitude et son altitude. La latitude est un nombre variant entre 90 et -90 degr\u00e9s avec une pr\u00e9cision de 6 d\u00e9cimales. La longitude varie entre 180 et -180 degr\u00e9s avec elle aussi une pr\u00e9cision de 6 d\u00e9cimales. Finalement, l'altitude est une valeur enti\u00e8re en m\u00e8tres qui peut \u00eatre n\u00e9gative. Ex : Latitude : 46.059537 | Longitude : -71.94353 | Altitude : 140. On effectue r\u00e9guli\u00e8rement des estimations pour chaque zone du nombre de lingots d'\u00c9pice (lge) qu'on pourrait extraire. Pour chaque estimation, on veut savoir la date de l'estimation ainsi que le nombre de lge estim\u00e9 qui est une valeur num\u00e9rique enti\u00e8re. Parlons maintenant des op\u00e9rations d'extractions. Les extractions se font \u00e0 l'aide de \"moissonneuse\", un v\u00e9hicule adapt\u00e9 pour ce travail. Pour l'instant, la seule information \u00e0 conna\u00eetre sur nos moissonneuses est son num\u00e9ro de s\u00e9rie, un code alphanum\u00e9rique de 20 caract\u00e8res. Ensuite, pour chaque op\u00e9ration, il y a qu'une moissonneuse d'impliqu\u00e9e, mais chaque moissonneuse va participer \u00e0 plusieurs op\u00e9rations. L'op\u00e9ration est aussi reli\u00e9e \u00e0 une zone d'extraction. Bien s\u00fbr une zone d'extraction va \"subir\" plusieurs op\u00e9rations d'extraction. Les autres informations \u00e0 retenir pour l'op\u00e9ration sont la date de l'op\u00e9ration, le poids au d\u00e9part et \u00e0 l'arriv\u00e9e de la moissonneuse (une valeur num\u00e9rique enti\u00e8re), la quantit\u00e9 de lingots d'\u00c9pice r\u00e9colt\u00e9s ainsi que le niveau de risque de l'op\u00e9ration. Le niveau de risque est choisi parmi une liste de terme (\"Bas\", \"Mod\u00e9r\u00e9\", \"\u00c9lev\u00e9\", \"Est-ce que \u00e7a en vaut vraiment la peine\"). Pour assurer la protection des op\u00e9rations, on engage un ou plusieurs groupes de mercenaires. Pour le groupe de mercenaire, on ne veut conna\u00eetre que le nom du groupe, la personne contact (on peut inscrire son nom et pr\u00e9nom dans la m\u00eame colonne \ud83d\ude1c ) et une cote de confiance. La cote de confiance est un pourcentage de 0 \u00e0 100% avec une pr\u00e9cision de 2 d\u00e9cimales (75.50%). On va aussi joindre \u00e0 chaque op\u00e9ration une ou plusieurs \u00e9quipes de travail. Les \u00e9quipes sont identifi\u00e9es par un code alphanum\u00e9rique de 5 caract\u00e8res. Ces \u00e9quipes sont form\u00e9es de plusieurs employ\u00e9s, mais un employ\u00e9 ne peut pas faire partie de plus d'une \u00e9quipe \u00e0 la fois. Pour chaque employ\u00e9 on doit conna\u00eetre son nom et pr\u00e9nom, sa date de naissance, sa plan\u00e8te d'origine, la maison \u00e0 laquelle il appartient (la maison est un peu comme son clan) et sa profession. L'employ\u00e9 ne peut avoir qu'une profession et appartenir qu'\u00e0 une maison. Notes aux puristes : Ok je sais que dans l'univers de Dune les ordinateurs comme nous les connaissons ont \u00e9t\u00e9 banni depuis longtemps mais bon on va dire qu'ils existent encore.","title":"Mise en situation"},{"location":"examen/intra/examen_intra/#directives","text":"Vous devez cr\u00e9er un diagramme de classes qui r\u00e9pond aux besoins de la mise en situation en respectant les points suivants : Votre mod\u00e8le doit r\u00e9pondre \u00e0 la convention de nomenclature telle que d\u00e9crite dans les notes de cours \"Analyse et mod\u00e9lisation de syst\u00e8mes\". Vous devez sp\u00e9cifier un type de donn\u00e9es pertinent pour chaque colonne de chaque table du diagramme. Pour les relations entre les tables, vous devez m'indiquer le type de relation en utilisant la notation (1 -- 1..n). Votre mod\u00e9lisation doit r\u00e9pondre aux r\u00e8gles de la troisi\u00e8me forme normale.","title":"Directives"},{"location":"examen/intra/examen_intra/#grille-de-correction","text":"\u00c9l\u00e9ments points Total /100 La convention de nomenclature est respect\u00e9e 5 Les types de donn\u00e9es utilis\u00e9s sont exacte et pertinent 5 Les relations entrent les tables sont juste 30 La mod\u00e9lisation r\u00e9ponds aux r\u00e8gles de la troisi\u00e8me forme normale 10 Le diagramme de classes r\u00e9ponds aux besoins de la mise en situation 50","title":"Grille de correction"},{"location":"examen/intra/intra_formatif_01/","text":"Examen intra formatif 01 - Voyage vers Mars Mise en situation Le projet de colonisation de la plan\u00e8te Mars est entr\u00e9 dans une nouvelle phase et le lancement du premier vol habit\u00e9 est pour bient\u00f4t. Vous avez \u00e9t\u00e9 choisi pour \u00eatre responsable de la gestion des informations sur l'\u00e9quipage. C'est une responsabilit\u00e9 tr\u00e8s importante, car une partie du succ\u00e8s de la mission r\u00e9side dans l'\u00e9quilibre psychologique du personnel embarqu\u00e9 dans le vaisseau. Voici une description de ce qu\u2019il est imp\u00e9ratif d'avoir comme informations. Pour chaque membre de l'\u00e9quipage, on veut avoir leur nom, leur genre, leur pays d'origine et leur \u00e9tat civil. Vous devez aussi dresser la liste des enfants de cette personne. Attention, on nous rapporte qu'il y a des parents qui se sont port\u00e9s volontaires ensemble pour cette mission, alors deux membres d'\u00e9quipage peuvent avoir le m\u00eame enfant. Pr\u00e9cision suppl\u00e9mentaire, les enfants ne font pas partie du voyage . Chaque passager se voit aussi attribuer un matricule alphanum\u00e9rique de 10 \u00e0 20 caract\u00e8res. Finalement, on veut savoir si cette personne a effectu\u00e9 son service militaire ou non. Pour les enfants de l'\u00e9quipage, on n'a besoin que de leur nom et de pouvoir conna\u00eetre leur \u00e2ge. L'\u00e9quipage a \u00e9t\u00e9 s\u00e9lectionn\u00e9 selon les expertises de chacun qui ont \u00e9t\u00e9 jug\u00e9es utiles au bon d\u00e9roulement de la mission. Donc chaque membre de l'\u00e9quipage a une ou plusieurs professions. Pour palier en d'\u00e9ventuelles pertes humaines, nous avons s\u00e9lectionn\u00e9 plusieurs personnes ayant une m\u00eame profession. Pour \u00e9tablir une sorte de hi\u00e9rarchie, chaque personne a un grade d'attribuer pour chacune de ses professions. Le grade est un titre : Maitre, second ou rempla\u00e7ant. Ex.: Arthur Dallas est un pilote de grade \"second\". Derni\u00e8re chose \u00e0 retenir, chaque membre de l'\u00e9quipage devra subir des \u00e9valuations psychologiques r\u00e9guli\u00e8rement. Il est primordial que vous conserviez une trace de ces \u00e9valuations. Les \u00e9valuations se font de mani\u00e8re individuelle. Pour chaque \u00e9valuation, vous devez conserver le membre d'\u00e9quipage concern\u00e9 ainsi que le psychologue qui a men\u00e9 l'\u00e9valuation ( des passagers dont la profession est psychologue seront charg\u00e9s de faire les \u00e9valuations). Vous devez aussi conserver la date de l'\u00e9valuation ainsi que les notes et les recommandations du psychologue traitant. Directives Vous devez cr\u00e9er un diagramme de classes qui r\u00e9pond aux besoins de la mise en situation en respectant les points suivants : Votre mod\u00e8le doit r\u00e9pondre \u00e0 la convention de nomenclature telle que d\u00e9crite dans les notes de cours \"Analyse et mod\u00e9lisation de syst\u00e8mes\". Vous devez sp\u00e9cifier un type de donn\u00e9es pertinent pour chaque colonne de chaque table du diagramme. Pour les relations entre les tables, vous devez m'indiquer le type de relation en utilisant la notation (1 -- 1..n). Votre mod\u00e9lisation doit r\u00e9pondre aux r\u00e8gles de la troisi\u00e8me forme normale. Sur le diagramme, ajoutez le titre \"Examen Intra - Formatif\" ainsi que votre nom. La remise du diagramme se fera sous forme d'un fichier image nomm\u00e9 \"NomPr\u00e9nom - Examen Intra Formatif\" dans le devoir associ\u00e9 sur Teams. Corrig\u00e9 Si \u00e7a vous int\u00e9resse j'ai cr\u00e9\u00e9 un script SQL pour g\u00e9n\u00e9rer les tables du diagramme et y ins\u00e9rer des donn\u00e9es. Il est disponible ici . Ma version du diagramme","title":"Formatif 01 - Voyage vers Mars"},{"location":"examen/intra/intra_formatif_01/#examen-intra-formatif-01-voyage-vers-mars","text":"","title":"Examen intra formatif 01 - Voyage vers Mars"},{"location":"examen/intra/intra_formatif_01/#mise-en-situation","text":"Le projet de colonisation de la plan\u00e8te Mars est entr\u00e9 dans une nouvelle phase et le lancement du premier vol habit\u00e9 est pour bient\u00f4t. Vous avez \u00e9t\u00e9 choisi pour \u00eatre responsable de la gestion des informations sur l'\u00e9quipage. C'est une responsabilit\u00e9 tr\u00e8s importante, car une partie du succ\u00e8s de la mission r\u00e9side dans l'\u00e9quilibre psychologique du personnel embarqu\u00e9 dans le vaisseau. Voici une description de ce qu\u2019il est imp\u00e9ratif d'avoir comme informations. Pour chaque membre de l'\u00e9quipage, on veut avoir leur nom, leur genre, leur pays d'origine et leur \u00e9tat civil. Vous devez aussi dresser la liste des enfants de cette personne. Attention, on nous rapporte qu'il y a des parents qui se sont port\u00e9s volontaires ensemble pour cette mission, alors deux membres d'\u00e9quipage peuvent avoir le m\u00eame enfant. Pr\u00e9cision suppl\u00e9mentaire, les enfants ne font pas partie du voyage . Chaque passager se voit aussi attribuer un matricule alphanum\u00e9rique de 10 \u00e0 20 caract\u00e8res. Finalement, on veut savoir si cette personne a effectu\u00e9 son service militaire ou non. Pour les enfants de l'\u00e9quipage, on n'a besoin que de leur nom et de pouvoir conna\u00eetre leur \u00e2ge. L'\u00e9quipage a \u00e9t\u00e9 s\u00e9lectionn\u00e9 selon les expertises de chacun qui ont \u00e9t\u00e9 jug\u00e9es utiles au bon d\u00e9roulement de la mission. Donc chaque membre de l'\u00e9quipage a une ou plusieurs professions. Pour palier en d'\u00e9ventuelles pertes humaines, nous avons s\u00e9lectionn\u00e9 plusieurs personnes ayant une m\u00eame profession. Pour \u00e9tablir une sorte de hi\u00e9rarchie, chaque personne a un grade d'attribuer pour chacune de ses professions. Le grade est un titre : Maitre, second ou rempla\u00e7ant. Ex.: Arthur Dallas est un pilote de grade \"second\". Derni\u00e8re chose \u00e0 retenir, chaque membre de l'\u00e9quipage devra subir des \u00e9valuations psychologiques r\u00e9guli\u00e8rement. Il est primordial que vous conserviez une trace de ces \u00e9valuations. Les \u00e9valuations se font de mani\u00e8re individuelle. Pour chaque \u00e9valuation, vous devez conserver le membre d'\u00e9quipage concern\u00e9 ainsi que le psychologue qui a men\u00e9 l'\u00e9valuation ( des passagers dont la profession est psychologue seront charg\u00e9s de faire les \u00e9valuations). Vous devez aussi conserver la date de l'\u00e9valuation ainsi que les notes et les recommandations du psychologue traitant.","title":"Mise en situation"},{"location":"examen/intra/intra_formatif_01/#directives","text":"Vous devez cr\u00e9er un diagramme de classes qui r\u00e9pond aux besoins de la mise en situation en respectant les points suivants : Votre mod\u00e8le doit r\u00e9pondre \u00e0 la convention de nomenclature telle que d\u00e9crite dans les notes de cours \"Analyse et mod\u00e9lisation de syst\u00e8mes\". Vous devez sp\u00e9cifier un type de donn\u00e9es pertinent pour chaque colonne de chaque table du diagramme. Pour les relations entre les tables, vous devez m'indiquer le type de relation en utilisant la notation (1 -- 1..n). Votre mod\u00e9lisation doit r\u00e9pondre aux r\u00e8gles de la troisi\u00e8me forme normale. Sur le diagramme, ajoutez le titre \"Examen Intra - Formatif\" ainsi que votre nom. La remise du diagramme se fera sous forme d'un fichier image nomm\u00e9 \"NomPr\u00e9nom - Examen Intra Formatif\" dans le devoir associ\u00e9 sur Teams.","title":"Directives"},{"location":"examen/intra/intra_formatif_01/#corrige","text":"Si \u00e7a vous int\u00e9resse j'ai cr\u00e9\u00e9 un script SQL pour g\u00e9n\u00e9rer les tables du diagramme et y ins\u00e9rer des donn\u00e9es. Il est disponible ici . Ma version du diagramme","title":"Corrig\u00e9"},{"location":"examen/intra/intra_formatif_02/","text":"Examen intra formatif 02 - xLabs Consignes Vous avez droit \u00e0 toutes vos notes et Internet. Aucune communication n'est permise (messagerie, courriel, etc.). Un \u00e9l\u00e8ve pris en flagrant d\u00e9lit se verra attribuer la note de 0 pour plagiat. La dur\u00e9e de l'examen est de 1h50. Une fois l\u2019examen termin\u00e9, vous devez me remettre un fichier image de votre diagramme de classes via le devoir de l\u2019examen sur Teams. Le fichier doit \u00eatre nomm\u00e9 au format suivant : NomPrenom_Examen1. Il est de votre devoir de vous assurer que votre fichier est inclus dans la remise. Aucun fichier ne sera accept\u00e9 une fois que vous aurez quitt\u00e9 le lieu de l'examen. Mise en situation Le centre de recherche xLabs se sp\u00e9cialise dans des recherches dites marginales. Elle emploie une pl\u00e9thore de cobayes pour ses diff\u00e9rents projets et pr\u00e9sentement il est difficile de garder une trace de l'\u00e9tat de tous ces \"volontaires\". La direction vous a donn\u00e9 le mandat de mod\u00e9liser leur op\u00e9ration. Pour chaque cobaye, on veut connaitre sa date de naissance, la date \u00e0 laquelle il a commenc\u00e9 sa premi\u00e8re exp\u00e9rience et aussi sa date de d\u00e9c\u00e8s s'il y a lieu, car chez xlabs on est cobaye \u00e0 vie. Un num\u00e9ro d'identification unique est attribu\u00e9 aux cobayes. Par contre ce num\u00e9ro peut \u00eatre r\u00e9utilis\u00e9 \u00e0 la mort du cobaye. Le centre utilise une grande vari\u00e9t\u00e9 d'animaux pour ses recherches et l'on vous demande aussi de sauvegarder les informations de classification suivante : le nom de l'esp\u00e8ce, sa classe, son ordre et sa famille. Les cobayes peuvent participer \u00e0 plus d'une exp\u00e9rience \u00e0 la fois. On veut connaitre la date de d\u00e9but et de fin de la participation de chaque cobaye \u00e0 chaque exp\u00e9rience. Chaque exp\u00e9rience \u00e0 un titre, un niveau de s\u00e9curit\u00e9 qui se situe entre 0 et 10 et une courte description qui d\u00e9fini le sujet de l'exp\u00e9rience. Un ou plusieurs chercheurs peuvent \u00eatre associ\u00e9s \u00e0 une exp\u00e9rience et un chercheur peut participer \u00e0 plus d'une exp\u00e9rience \u00e0 la fois. Parmi les chercheurs impliqu\u00e9s, un r\u00f4le est attribu\u00e9 \u00e0 chacun. Il y a pr\u00e9sentement trois r\u00f4les disponible (directeur de recherche, assistant, appariteur) mais il n'est pas impossible que \u00e7a change dans l'avenir. Le r\u00f4le d'un chercheur peut aussi varier d'une exp\u00e9rience \u00e0 l'autre. Au niveau des chercheurs, on veut connaitre uniquement leur nom et leur num\u00e9ro d'identification personnelle. Durant le temps que dure une exp\u00e9rience, les chercheurs vont faire des observations. Pour chaque observation, il y a un chercheur impliqu\u00e9, un cobaye, une exp\u00e9rience, une date d'observation et les notes de l'observation. Afin de s'assurer de la bonne rentabilit\u00e9 des cobayes, un chercheur effectue chaque jour une \u00e9valuation g\u00e9n\u00e9rale de ceux-ci. L'\u00e9valuation consiste uniquement en une prise de notes. On veut donc conserver pour chaque \u00e9valuation le cobaye \u00e9valu\u00e9, le chercheur impliqu\u00e9, la date de l'\u00e9valuation ainsi que les notes prises. Directives Vous devez cr\u00e9er un diagramme de classes qui r\u00e9pond aux besoins de la mise en situation en respectant les points suivants : Votre mod\u00e8le doit r\u00e9pondre \u00e0 la convention de nomenclature telle que d\u00e9crite dans les notes de cours \"Analyse et mod\u00e9lisation de syst\u00e8mes\". Vous devez sp\u00e9cifier un type de donn\u00e9es pertinent pour chaque colonne de chaque table du diagramme. Pour les relations entre les tables, vous devez m'indiquer le type de relation en utilisant la notation (1 -- 1..n). Votre mod\u00e9lisation doit r\u00e9pondre aux r\u00e8gles de la troisi\u00e8me forme normale. Sur le diagramme, ajoutez le titre \"Confidentiel - xLabs industries\" ainsi que votre nom. Grille de correction \u00c9l\u00e9ments points Total /100 La convention de nomenclature est respect\u00e9e 5 Les types de donn\u00e9es utilis\u00e9s sont exacte et pertinent 5 Les relations entrent les tables sont juste 30 La mod\u00e9lisation r\u00e9ponds aux r\u00e8gles de la troisi\u00e8me forme normale 10 Le diagramme de classes r\u00e9ponds aux besoins de la mise en situation 50 Corrig\u00e9 Ma version du diagramme","title":"Formatif 02 - xLabs"},{"location":"examen/intra/intra_formatif_02/#examen-intra-formatif-02-xlabs","text":"","title":"Examen intra formatif 02 - xLabs"},{"location":"examen/intra/intra_formatif_02/#consignes","text":"Vous avez droit \u00e0 toutes vos notes et Internet. Aucune communication n'est permise (messagerie, courriel, etc.). Un \u00e9l\u00e8ve pris en flagrant d\u00e9lit se verra attribuer la note de 0 pour plagiat. La dur\u00e9e de l'examen est de 1h50. Une fois l\u2019examen termin\u00e9, vous devez me remettre un fichier image de votre diagramme de classes via le devoir de l\u2019examen sur Teams. Le fichier doit \u00eatre nomm\u00e9 au format suivant : NomPrenom_Examen1. Il est de votre devoir de vous assurer que votre fichier est inclus dans la remise. Aucun fichier ne sera accept\u00e9 une fois que vous aurez quitt\u00e9 le lieu de l'examen.","title":"Consignes"},{"location":"examen/intra/intra_formatif_02/#mise-en-situation","text":"Le centre de recherche xLabs se sp\u00e9cialise dans des recherches dites marginales. Elle emploie une pl\u00e9thore de cobayes pour ses diff\u00e9rents projets et pr\u00e9sentement il est difficile de garder une trace de l'\u00e9tat de tous ces \"volontaires\". La direction vous a donn\u00e9 le mandat de mod\u00e9liser leur op\u00e9ration. Pour chaque cobaye, on veut connaitre sa date de naissance, la date \u00e0 laquelle il a commenc\u00e9 sa premi\u00e8re exp\u00e9rience et aussi sa date de d\u00e9c\u00e8s s'il y a lieu, car chez xlabs on est cobaye \u00e0 vie. Un num\u00e9ro d'identification unique est attribu\u00e9 aux cobayes. Par contre ce num\u00e9ro peut \u00eatre r\u00e9utilis\u00e9 \u00e0 la mort du cobaye. Le centre utilise une grande vari\u00e9t\u00e9 d'animaux pour ses recherches et l'on vous demande aussi de sauvegarder les informations de classification suivante : le nom de l'esp\u00e8ce, sa classe, son ordre et sa famille. Les cobayes peuvent participer \u00e0 plus d'une exp\u00e9rience \u00e0 la fois. On veut connaitre la date de d\u00e9but et de fin de la participation de chaque cobaye \u00e0 chaque exp\u00e9rience. Chaque exp\u00e9rience \u00e0 un titre, un niveau de s\u00e9curit\u00e9 qui se situe entre 0 et 10 et une courte description qui d\u00e9fini le sujet de l'exp\u00e9rience. Un ou plusieurs chercheurs peuvent \u00eatre associ\u00e9s \u00e0 une exp\u00e9rience et un chercheur peut participer \u00e0 plus d'une exp\u00e9rience \u00e0 la fois. Parmi les chercheurs impliqu\u00e9s, un r\u00f4le est attribu\u00e9 \u00e0 chacun. Il y a pr\u00e9sentement trois r\u00f4les disponible (directeur de recherche, assistant, appariteur) mais il n'est pas impossible que \u00e7a change dans l'avenir. Le r\u00f4le d'un chercheur peut aussi varier d'une exp\u00e9rience \u00e0 l'autre. Au niveau des chercheurs, on veut connaitre uniquement leur nom et leur num\u00e9ro d'identification personnelle. Durant le temps que dure une exp\u00e9rience, les chercheurs vont faire des observations. Pour chaque observation, il y a un chercheur impliqu\u00e9, un cobaye, une exp\u00e9rience, une date d'observation et les notes de l'observation. Afin de s'assurer de la bonne rentabilit\u00e9 des cobayes, un chercheur effectue chaque jour une \u00e9valuation g\u00e9n\u00e9rale de ceux-ci. L'\u00e9valuation consiste uniquement en une prise de notes. On veut donc conserver pour chaque \u00e9valuation le cobaye \u00e9valu\u00e9, le chercheur impliqu\u00e9, la date de l'\u00e9valuation ainsi que les notes prises.","title":"Mise en situation"},{"location":"examen/intra/intra_formatif_02/#directives","text":"Vous devez cr\u00e9er un diagramme de classes qui r\u00e9pond aux besoins de la mise en situation en respectant les points suivants : Votre mod\u00e8le doit r\u00e9pondre \u00e0 la convention de nomenclature telle que d\u00e9crite dans les notes de cours \"Analyse et mod\u00e9lisation de syst\u00e8mes\". Vous devez sp\u00e9cifier un type de donn\u00e9es pertinent pour chaque colonne de chaque table du diagramme. Pour les relations entre les tables, vous devez m'indiquer le type de relation en utilisant la notation (1 -- 1..n). Votre mod\u00e9lisation doit r\u00e9pondre aux r\u00e8gles de la troisi\u00e8me forme normale. Sur le diagramme, ajoutez le titre \"Confidentiel - xLabs industries\" ainsi que votre nom.","title":"Directives"},{"location":"examen/intra/intra_formatif_02/#grille-de-correction","text":"\u00c9l\u00e9ments points Total /100 La convention de nomenclature est respect\u00e9e 5 Les types de donn\u00e9es utilis\u00e9s sont exacte et pertinent 5 Les relations entrent les tables sont juste 30 La mod\u00e9lisation r\u00e9ponds aux r\u00e8gles de la troisi\u00e8me forme normale 10 Le diagramme de classes r\u00e9ponds aux besoins de la mise en situation 50","title":"Grille de correction"},{"location":"examen/intra/intra_formatif_02/#corrige","text":"Ma version du diagramme","title":"Corrig\u00e9"},{"location":"exercices/ex01/ex01_enonce/","text":"Exercice 1 - R\u00e9vision Question de se remettre en mode \"BD\", voici un petit exercice de r\u00e9vision des concepts vus durant le cours de Base de donn\u00e9es 1. En \u00e9quipe de 2 inscrivez moi dans un fichier sql les commandes et requ\u00eates que vous avez utilis\u00e9 pour compl\u00e9ter l'exercice. 1. Cr\u00e9ation d'une base de donn\u00e9es et importation d'une sauvegarde Cr\u00e9ez une nouvelle base de donn\u00e9es et nommez la exercice01_revision T\u00e9l\u00e9charger le fichier bd_athlete.sql . Lancer le script pour cr\u00e9er les tables et ajouter les donn\u00e9es. Allez-y en ligne de commande ou bien avec DBeaver 2. Ajout de cl\u00e9s \u00e9trang\u00e8res Ajoutez les cl\u00e9s \u00e9trang\u00e8res suivantes \u00e0 la table r\u00e9sultat . Pour chaque cl\u00e9, appliquez la strat\u00e9gie cascade \u00e0 la suppression et \u00e0 la mise \u00e0 jour. Le champs epreuve_id vers la cl\u00e9 primaire id de la table epreuve . Le champs athlete_id vers la cl\u00e9 primaire id de la table athlete . 3. Manipulation des donn\u00e9es S\u00e9lectionnez le titre de toutes les \u00e9preuves. Comptez combien d'athl\u00e8tes proviennent du Qu\u00e9bec. Comptez le nombre de r\u00e9sultat de l'athl\u00e8te N\u00e9h\u00e9mie Harbage . Le r\u00e9sultat devra respecter le format suivant : Affichez la liste des athl\u00e8tes qui ont particip\u00e9 au 10 kilom\u00e8tres de l'\u00e9dition du 20 juillet 2020 (Afficher le nom et le pr\u00e9nom) en ordre alphab\u00e9tique de nom et de pr\u00e9nom. Affichez les trois meilleurs temps du marathon du 20 juillet 2020. Les champs \u00e0 afficher sont le pr\u00e9nom et le nom de athl\u00e8te concat\u00e9n\u00e9 et le r\u00e9sultat. Dans le but de faire une liste de diffusion, affichez le nom, pr\u00e9nom et courriel des tous les athl\u00e8tes de plus de 65 ans. Pour chaque athl\u00e8tes, afficher leur meilleur temps pour chaque cat\u00e9gorie d'\u00e9preuves. Si l'athl\u00e8te n'a jamais particip\u00e9 \u00e0 une \u00e9preuve, inscrire '-' au lieu de son r\u00e9sultat. Les r\u00e9sultats doivent \u00eatre affich\u00e9 en hh:mm:ss.ms et les athl\u00e8tes doivent \u00eatre class\u00e9 en ordre alphab\u00e9tique de nom et pr\u00e9nom. Le r\u00e9sultat final devra respecter le format suivant : Comptez combien d'athl\u00e8tes ont particip\u00e9 au moins une fois \u00e0 chacune des 4 \u00e9preuves. Vous pouvez simplement afficher le nombre total d'athl\u00e8tes.","title":"Exercice 01 - Revision"},{"location":"exercices/ex01/ex01_enonce/#exercice-1-revision","text":"Question de se remettre en mode \"BD\", voici un petit exercice de r\u00e9vision des concepts vus durant le cours de Base de donn\u00e9es 1. En \u00e9quipe de 2 inscrivez moi dans un fichier sql les commandes et requ\u00eates que vous avez utilis\u00e9 pour compl\u00e9ter l'exercice.","title":"Exercice 1 - R\u00e9vision"},{"location":"exercices/ex01/ex01_enonce/#1-creation-dune-base-de-donnees-et-importation-dune-sauvegarde","text":"Cr\u00e9ez une nouvelle base de donn\u00e9es et nommez la exercice01_revision T\u00e9l\u00e9charger le fichier bd_athlete.sql . Lancer le script pour cr\u00e9er les tables et ajouter les donn\u00e9es. Allez-y en ligne de commande ou bien avec DBeaver","title":"1. Cr\u00e9ation d'une base de donn\u00e9es et importation d'une sauvegarde"},{"location":"exercices/ex01/ex01_enonce/#2-ajout-de-cles-etrangeres","text":"Ajoutez les cl\u00e9s \u00e9trang\u00e8res suivantes \u00e0 la table r\u00e9sultat . Pour chaque cl\u00e9, appliquez la strat\u00e9gie cascade \u00e0 la suppression et \u00e0 la mise \u00e0 jour. Le champs epreuve_id vers la cl\u00e9 primaire id de la table epreuve . Le champs athlete_id vers la cl\u00e9 primaire id de la table athlete .","title":"2. Ajout de cl\u00e9s \u00e9trang\u00e8res"},{"location":"exercices/ex01/ex01_enonce/#3-manipulation-des-donnees","text":"S\u00e9lectionnez le titre de toutes les \u00e9preuves. Comptez combien d'athl\u00e8tes proviennent du Qu\u00e9bec. Comptez le nombre de r\u00e9sultat de l'athl\u00e8te N\u00e9h\u00e9mie Harbage . Le r\u00e9sultat devra respecter le format suivant : Affichez la liste des athl\u00e8tes qui ont particip\u00e9 au 10 kilom\u00e8tres de l'\u00e9dition du 20 juillet 2020 (Afficher le nom et le pr\u00e9nom) en ordre alphab\u00e9tique de nom et de pr\u00e9nom. Affichez les trois meilleurs temps du marathon du 20 juillet 2020. Les champs \u00e0 afficher sont le pr\u00e9nom et le nom de athl\u00e8te concat\u00e9n\u00e9 et le r\u00e9sultat. Dans le but de faire une liste de diffusion, affichez le nom, pr\u00e9nom et courriel des tous les athl\u00e8tes de plus de 65 ans. Pour chaque athl\u00e8tes, afficher leur meilleur temps pour chaque cat\u00e9gorie d'\u00e9preuves. Si l'athl\u00e8te n'a jamais particip\u00e9 \u00e0 une \u00e9preuve, inscrire '-' au lieu de son r\u00e9sultat. Les r\u00e9sultats doivent \u00eatre affich\u00e9 en hh:mm:ss.ms et les athl\u00e8tes doivent \u00eatre class\u00e9 en ordre alphab\u00e9tique de nom et pr\u00e9nom. Le r\u00e9sultat final devra respecter le format suivant : Comptez combien d'athl\u00e8tes ont particip\u00e9 au moins une fois \u00e0 chacune des 4 \u00e9preuves. Vous pouvez simplement afficher le nombre total d'athl\u00e8tes.","title":"3. Manipulation des donn\u00e9es"},{"location":"exercices/ex02/ex02_enonce/","text":"Analyse du syst\u00e8me de stationnement du c\u00e9gep Pour notre premier cas, on va analyser le syst\u00e8me de droit de stationnement du c\u00e9gep. Vous devez analyser le syst\u00e8me et ensuite cr\u00e9er un mod\u00e8le entit\u00e9-association, soit sur papier ou avec un logiciel appropri\u00e9. Une fois termin\u00e9, me le remettre sur Teams dans la section devoir. On doit tout d'abord se cr\u00e9er un usager avec un courriel et un mot de passe. Ensuite l'usager cr\u00e9\u00e9 peut effectuer une commande qui d\u00e9terminera la dur\u00e9e du droit de stationnement et les v\u00e9hicules autoris\u00e9s selon leur plaque d'immatriculation. L'usager \u00e0 le choix entre trois type de droit : 30 jours 1 session annuelle Il peut entrer un maximum de 4 plaques d'immatriculation par commande. Un compte peut contenir plus de 4 plaque d'immatriculation, mais chaque plaque est associ\u00e9 \u00e0 une commande, un droit de stationnement. Pour les autres informations, r\u00e9f\u00e9rez-vous aux images suivantes : Dans la section Informations personnelles on retrouve le num\u00e9ro de DA ou d'employ\u00e9, le nom complet, le courriel et le num\u00e9ro de t\u00e9l\u00e9phone.","title":"Exercice 02 - Analyse du syst\u00e8me de stationnement"},{"location":"exercices/ex02/ex02_enonce/#analyse-du-systeme-de-stationnement-du-cegep","text":"Pour notre premier cas, on va analyser le syst\u00e8me de droit de stationnement du c\u00e9gep. Vous devez analyser le syst\u00e8me et ensuite cr\u00e9er un mod\u00e8le entit\u00e9-association, soit sur papier ou avec un logiciel appropri\u00e9. Une fois termin\u00e9, me le remettre sur Teams dans la section devoir. On doit tout d'abord se cr\u00e9er un usager avec un courriel et un mot de passe. Ensuite l'usager cr\u00e9\u00e9 peut effectuer une commande qui d\u00e9terminera la dur\u00e9e du droit de stationnement et les v\u00e9hicules autoris\u00e9s selon leur plaque d'immatriculation. L'usager \u00e0 le choix entre trois type de droit : 30 jours 1 session annuelle Il peut entrer un maximum de 4 plaques d'immatriculation par commande. Un compte peut contenir plus de 4 plaque d'immatriculation, mais chaque plaque est associ\u00e9 \u00e0 une commande, un droit de stationnement. Pour les autres informations, r\u00e9f\u00e9rez-vous aux images suivantes : Dans la section Informations personnelles on retrouve le num\u00e9ro de DA ou d'employ\u00e9, le nom complet, le courriel et le num\u00e9ro de t\u00e9l\u00e9phone.","title":"Analyse du syst\u00e8me de stationnement du c\u00e9gep"},{"location":"exercices/ex03/ex03_enonce/","text":"Exercice 03 - Mod\u00e9lisation d'un livre de recettes Consignes En \u00e9quipe de 4 vous devez analyser et mod\u00e9liser un livre de recettes. Les deux images qui suivent vous indique ce qui doit \u00eatre inclus dans la base de donn\u00e9es. Toutes les informations pr\u00e9sentent doivent \u00eatre sauvegard\u00e9es. Pr\u00e9cision sur les pictogrammes dans les recettes : Le bol repr\u00e9sente le temps de pr\u00e9paration de la recette La flamme est le temps de cuisson La main est un temps de pr\u00e9paration autre Vous devez me produire et remettre : Le mod\u00e8le entit\u00e9-association fait sur papier en classe. ( ou une photo de votre oeuvre d'art sur le tableau) Un diagramme des classes complet, avec les types de donn\u00e9es, les relations et qui respecte les trois premi\u00e8res formes normale. Vous pouvez me remettre le diagramme sous la forme que vous voulez. Un script sql de g\u00e9n\u00e9ration de la base de donn\u00e9es Vous devez respecter les trois premi\u00e8re forme normale et la convention de nommage qui est d\u00e9crite dans les notes de cours. Images Recette 1 Recette 2","title":"Exercice 03 - Mod\u00e9lisation d'un livre de recettes"},{"location":"exercices/ex03/ex03_enonce/#exercice-03-modelisation-dun-livre-de-recettes","text":"","title":"Exercice 03 - Mod\u00e9lisation d'un livre de recettes"},{"location":"exercices/ex03/ex03_enonce/#consignes","text":"En \u00e9quipe de 4 vous devez analyser et mod\u00e9liser un livre de recettes. Les deux images qui suivent vous indique ce qui doit \u00eatre inclus dans la base de donn\u00e9es. Toutes les informations pr\u00e9sentent doivent \u00eatre sauvegard\u00e9es. Pr\u00e9cision sur les pictogrammes dans les recettes : Le bol repr\u00e9sente le temps de pr\u00e9paration de la recette La flamme est le temps de cuisson La main est un temps de pr\u00e9paration autre Vous devez me produire et remettre : Le mod\u00e8le entit\u00e9-association fait sur papier en classe. ( ou une photo de votre oeuvre d'art sur le tableau) Un diagramme des classes complet, avec les types de donn\u00e9es, les relations et qui respecte les trois premi\u00e8res formes normale. Vous pouvez me remettre le diagramme sous la forme que vous voulez. Un script sql de g\u00e9n\u00e9ration de la base de donn\u00e9es Vous devez respecter les trois premi\u00e8re forme normale et la convention de nommage qui est d\u00e9crite dans les notes de cours.","title":"Consignes"},{"location":"exercices/ex03/ex03_enonce/#images","text":"","title":"Images"},{"location":"exercices/ex03/ex03_enonce/#recette-1","text":"","title":"Recette 1"},{"location":"exercices/ex03/ex03_enonce/#recette-2","text":"","title":"Recette 2"},{"location":"exercices/ex04/ex04_enonce/","text":"Exercice 4 - INSERT \u00c0 partir de la base de donn\u00e9es athl\u00e8te de l'exercice 01, (le script sql de g\u00e9n\u00e9ration est disponible ici ), r\u00e9alisez les requ\u00eates d'insertion suivante. Ins\u00e9rez-vous dans la table athl\u00e8te sans sp\u00e9cifier les noms de colonnes dans la requ\u00eate. Ins\u00e9rez un autre athl\u00e8te fictif mais en sp\u00e9cifiant seulement son nom, pr\u00e9nom et la date de naissance. R\u00e9cup\u00e9rez le id qui a \u00e9t\u00e9 g\u00e9n\u00e9r\u00e9 automatiquement lors de la requ\u00eate pr\u00e9c\u00e9dente et faites afficher avec une requ\u00eate SELECT le message suivant : \"L'athl\u00e8te [prenom] [nom] a \u00e9t\u00e9 ajout\u00e9 avec succ\u00e8s!\". Utilisez le id r\u00e9cup\u00e9r\u00e9 dans la clause WHERE de votre requ\u00eate. Cr\u00e9ez une nouvelle table appel\u00e9 athlete_quebec avec les colonnes suivante ( id cl\u00e9 primaire auto-incr\u00e9ment\u00e9, nom, pr\u00e9nom, ville ) Ins\u00e9rez dans cette table tous les athl\u00e8tes qui proviennent de la province du Qu\u00e9bec \u00e0 l'aide d'une requ\u00eate select. Je veux que vous me remettiez les requ\u00eates dans un script SQL avec pour chaque requ\u00eate d'insertion une requ\u00eate select qui va valider que les donn\u00e9es ont bien \u00e9t\u00e9 ajout\u00e9. Corrig\u00e9 -- 1. Ins\u00e9rez-vous dans la table athl\u00e8te sans sp\u00e9cifier les noms de colonnes -- dans la requ\u00eate. INSERT INTO athlete VALUES (501, 'Fr\u00e9chette', 'Mathieu', '1980-01-01', '1 rue Street', 'Princeville', 'Qu\u00e9bec', 'Canada', 'math.frechette@gmail.com'); SELECT * FROM athlete WHERE id = 501; -- 2. Ins\u00e9rez un autre athl\u00e8te fictif mais en sp\u00e9cifiant seulement son nom, -- pr\u00e9nom et la date de naissance. INSERT INTO athlete (nom, prenom, date_naissance) VALUES ('Fr\u00e9chette','Mathieu 2','1980-01-01'); SELECT * FROM athlete WHERE id = LAST_INSERT_ID() ; -- 3. R\u00e9cup\u00e9rez le id qui a \u00e9t\u00e9 g\u00e9n\u00e9r\u00e9 automatiquement lors de la requ\u00eate -- pr\u00e9c\u00e9dente et faites afficher avec une requ\u00eate SELECT le message -- suivant : \"L'athl\u00e8te [prenom] [nom] a \u00e9t\u00e9 ajout\u00e9 avec succ\u00e8s!\". Utilisez -- le id r\u00e9cup\u00e9r\u00e9 dans la clause WHERE de votre requ\u00eate. SELECT CONCAT(\"L'athl\u00e8te \", a.prenom, \" \", a.nom, \" a \u00e9t\u00e9 ajout\u00e9 avec succ\u00e8s!\") FROM athlete a WHERE a.id = LAST_INSERT_ID(); -- 4. Cr\u00e9ez une nouvelle table appel\u00e9 athlete_quebec avec les colonnes -- suivante ( id cl\u00e9 primaire auto-incr\u00e9ment\u00e9, nom, pr\u00e9nom, ville ) CREATE TABLE IF NOT EXISTS athlete_quebec ( id INT AUTO_INCREMENT NOT NULL, nom VARCHAR(50), prenom VARCHAR(50), ville VARCHAR(50), CONSTRAINT PRIMARY KEY (id) ); -- 5. Ins\u00e9rez dans cette table tous les athl\u00e8tes qui proviennent de la -- province du Qu\u00e9bec \u00e0 l'aide d'une requ\u00eate select. INSERT INTO athlete_quebec (nom, prenom, ville) SELECT a.nom, a.prenom, a.ville FROM athlete a WHERE a.province = \"Qu\u00e9bec\"; SELECT * FROM athlete_quebec;","title":"Exercice 04 - Insert"},{"location":"exercices/ex04/ex04_enonce/#exercice-4-insert","text":"\u00c0 partir de la base de donn\u00e9es athl\u00e8te de l'exercice 01, (le script sql de g\u00e9n\u00e9ration est disponible ici ), r\u00e9alisez les requ\u00eates d'insertion suivante. Ins\u00e9rez-vous dans la table athl\u00e8te sans sp\u00e9cifier les noms de colonnes dans la requ\u00eate. Ins\u00e9rez un autre athl\u00e8te fictif mais en sp\u00e9cifiant seulement son nom, pr\u00e9nom et la date de naissance. R\u00e9cup\u00e9rez le id qui a \u00e9t\u00e9 g\u00e9n\u00e9r\u00e9 automatiquement lors de la requ\u00eate pr\u00e9c\u00e9dente et faites afficher avec une requ\u00eate SELECT le message suivant : \"L'athl\u00e8te [prenom] [nom] a \u00e9t\u00e9 ajout\u00e9 avec succ\u00e8s!\". Utilisez le id r\u00e9cup\u00e9r\u00e9 dans la clause WHERE de votre requ\u00eate. Cr\u00e9ez une nouvelle table appel\u00e9 athlete_quebec avec les colonnes suivante ( id cl\u00e9 primaire auto-incr\u00e9ment\u00e9, nom, pr\u00e9nom, ville ) Ins\u00e9rez dans cette table tous les athl\u00e8tes qui proviennent de la province du Qu\u00e9bec \u00e0 l'aide d'une requ\u00eate select. Je veux que vous me remettiez les requ\u00eates dans un script SQL avec pour chaque requ\u00eate d'insertion une requ\u00eate select qui va valider que les donn\u00e9es ont bien \u00e9t\u00e9 ajout\u00e9.","title":"Exercice 4 - INSERT"},{"location":"exercices/ex04/ex04_enonce/#corrige","text":"-- 1. Ins\u00e9rez-vous dans la table athl\u00e8te sans sp\u00e9cifier les noms de colonnes -- dans la requ\u00eate. INSERT INTO athlete VALUES (501, 'Fr\u00e9chette', 'Mathieu', '1980-01-01', '1 rue Street', 'Princeville', 'Qu\u00e9bec', 'Canada', 'math.frechette@gmail.com'); SELECT * FROM athlete WHERE id = 501; -- 2. Ins\u00e9rez un autre athl\u00e8te fictif mais en sp\u00e9cifiant seulement son nom, -- pr\u00e9nom et la date de naissance. INSERT INTO athlete (nom, prenom, date_naissance) VALUES ('Fr\u00e9chette','Mathieu 2','1980-01-01'); SELECT * FROM athlete WHERE id = LAST_INSERT_ID() ; -- 3. R\u00e9cup\u00e9rez le id qui a \u00e9t\u00e9 g\u00e9n\u00e9r\u00e9 automatiquement lors de la requ\u00eate -- pr\u00e9c\u00e9dente et faites afficher avec une requ\u00eate SELECT le message -- suivant : \"L'athl\u00e8te [prenom] [nom] a \u00e9t\u00e9 ajout\u00e9 avec succ\u00e8s!\". Utilisez -- le id r\u00e9cup\u00e9r\u00e9 dans la clause WHERE de votre requ\u00eate. SELECT CONCAT(\"L'athl\u00e8te \", a.prenom, \" \", a.nom, \" a \u00e9t\u00e9 ajout\u00e9 avec succ\u00e8s!\") FROM athlete a WHERE a.id = LAST_INSERT_ID(); -- 4. Cr\u00e9ez une nouvelle table appel\u00e9 athlete_quebec avec les colonnes -- suivante ( id cl\u00e9 primaire auto-incr\u00e9ment\u00e9, nom, pr\u00e9nom, ville ) CREATE TABLE IF NOT EXISTS athlete_quebec ( id INT AUTO_INCREMENT NOT NULL, nom VARCHAR(50), prenom VARCHAR(50), ville VARCHAR(50), CONSTRAINT PRIMARY KEY (id) ); -- 5. Ins\u00e9rez dans cette table tous les athl\u00e8tes qui proviennent de la -- province du Qu\u00e9bec \u00e0 l'aide d'une requ\u00eate select. INSERT INTO athlete_quebec (nom, prenom, ville) SELECT a.nom, a.prenom, a.ville FROM athlete a WHERE a.province = \"Qu\u00e9bec\"; SELECT * FROM athlete_quebec;","title":"Corrig\u00e9"},{"location":"exercices/ex05/ex05_enonce/","text":"Exercice 5 - VIEW \u00c0 partir de la base de donn\u00e9es athl\u00e8te de l'exercice 01, (le script sql de g\u00e9n\u00e9ration est disponible ici ), creez les views suivantes : Cr\u00e9ez une view nomm\u00e9e resultat_hhmmss qui affiche le r\u00e9sultat format\u00e9 en heures, minutes, secondes (hh:mm:ss). Les colonnes de la view doivent \u00eatre les m\u00eames que la table resultat mais en ajoutant une colonne nomm\u00e9e resultat_hhmmss dans laquelle le calcul sera fait (id, athlete_id, epreuve_id, date_resultat, resultat_ms, resultat_hhmmss). Cr\u00e9ez une view nomm\u00e9e athlete_complet qui, en combinant les tables n\u00e9cessaires, affiche les athl\u00e8tes avec les colonnes suivantes, (id, nom pr\u00e9nom concat, date_epreuve, nom_epreuve, r\u00e9sultat). Attention, je veux que les noms de colonnes de la view soit identique \u00e0 ce que je demande entre parenth\u00e8se) \u00c0 partir de la view pr\u00e9c\u00e9dente, athlete_complet, s\u00e9lectionn\u00e9 les informations des athl\u00e8tes qui ont particip\u00e9 \u00e0 un marathon. Cr\u00e9ez une view nomm\u00e9e resultat_21juillet2020 qui va contenir toutes les informations de la table r\u00e9sultat mais uniquement pour la date du 21 juillet 2020. Modifier la view resultat_21juillet2020 pour qu'elle affiche les r\u00e9sultats du 14 juillet 2019. Modifier aussi son nom pour resultat_14juillet2019 Supprimer la view resultat_14juillet2019 Je veux que vous me remettiez les requ\u00eates dans un script SQL. Corrig\u00e9 -- #1 CREATE OR REPLACE VIEW resultat_hhmmss AS SELECT r.id, r.athlete_id, r.epreuve_id, r.date_resultat, r.resultat_ms, TIME_FORMAT(SEC_TO_TIME(r.resultat_ms / 1000), '%H:%i:%s') AS resultat_hhmmss FROM resultat r; -- #2 CREATE OR REPLACE VIEW athlete_complet (id, nom, date_epreuve, nom_epreuve, resultat) AS SELECT a.id, CONCAT(a.prenom, ' ', a.nom), rh.date_resultat, e.description, rh.resultat_hhmmss FROM athlete a INNER JOIN resultat_hhmmss rh ON rh.athlete_id = a.id INNER JOIN epreuve e ON e.id = rh.epreuve_id; -- J'ai r\u00e9utiliser ici la view cr\u00e9\u00e9 au num\u00e9ro 1 pour vous montrer -- qu'on peut tr\u00e8s bien utiliser une view dans une view -- #3 SELECT * FROM athlete_complet ac WHERE ac.nom_epreuve = 'Marathon'; -- #4 CREATE OR REPLACE VIEW resultat_21juillet2020 AS SELECT * FROM resultat r WHERE r.date_resultat = '2020-07-21'; -- #5 ALTER VIEW resultat_21juillet2020 AS SELECT * FROM resultat r WHERE r.date_resultat = '2019-07-14'; RENAME TABLE resultat_21juillet2020 TO resultat_14juillet2019; -- #6 DROP VIEW IF EXISTS resultat_14juillet2019;","title":"Exercice 05 - Les Views"},{"location":"exercices/ex05/ex05_enonce/#exercice-5-view","text":"\u00c0 partir de la base de donn\u00e9es athl\u00e8te de l'exercice 01, (le script sql de g\u00e9n\u00e9ration est disponible ici ), creez les views suivantes : Cr\u00e9ez une view nomm\u00e9e resultat_hhmmss qui affiche le r\u00e9sultat format\u00e9 en heures, minutes, secondes (hh:mm:ss). Les colonnes de la view doivent \u00eatre les m\u00eames que la table resultat mais en ajoutant une colonne nomm\u00e9e resultat_hhmmss dans laquelle le calcul sera fait (id, athlete_id, epreuve_id, date_resultat, resultat_ms, resultat_hhmmss). Cr\u00e9ez une view nomm\u00e9e athlete_complet qui, en combinant les tables n\u00e9cessaires, affiche les athl\u00e8tes avec les colonnes suivantes, (id, nom pr\u00e9nom concat, date_epreuve, nom_epreuve, r\u00e9sultat). Attention, je veux que les noms de colonnes de la view soit identique \u00e0 ce que je demande entre parenth\u00e8se) \u00c0 partir de la view pr\u00e9c\u00e9dente, athlete_complet, s\u00e9lectionn\u00e9 les informations des athl\u00e8tes qui ont particip\u00e9 \u00e0 un marathon. Cr\u00e9ez une view nomm\u00e9e resultat_21juillet2020 qui va contenir toutes les informations de la table r\u00e9sultat mais uniquement pour la date du 21 juillet 2020. Modifier la view resultat_21juillet2020 pour qu'elle affiche les r\u00e9sultats du 14 juillet 2019. Modifier aussi son nom pour resultat_14juillet2019 Supprimer la view resultat_14juillet2019 Je veux que vous me remettiez les requ\u00eates dans un script SQL.","title":"Exercice 5 - VIEW"},{"location":"exercices/ex05/ex05_enonce/#corrige","text":"-- #1 CREATE OR REPLACE VIEW resultat_hhmmss AS SELECT r.id, r.athlete_id, r.epreuve_id, r.date_resultat, r.resultat_ms, TIME_FORMAT(SEC_TO_TIME(r.resultat_ms / 1000), '%H:%i:%s') AS resultat_hhmmss FROM resultat r; -- #2 CREATE OR REPLACE VIEW athlete_complet (id, nom, date_epreuve, nom_epreuve, resultat) AS SELECT a.id, CONCAT(a.prenom, ' ', a.nom), rh.date_resultat, e.description, rh.resultat_hhmmss FROM athlete a INNER JOIN resultat_hhmmss rh ON rh.athlete_id = a.id INNER JOIN epreuve e ON e.id = rh.epreuve_id; -- J'ai r\u00e9utiliser ici la view cr\u00e9\u00e9 au num\u00e9ro 1 pour vous montrer -- qu'on peut tr\u00e8s bien utiliser une view dans une view -- #3 SELECT * FROM athlete_complet ac WHERE ac.nom_epreuve = 'Marathon'; -- #4 CREATE OR REPLACE VIEW resultat_21juillet2020 AS SELECT * FROM resultat r WHERE r.date_resultat = '2020-07-21'; -- #5 ALTER VIEW resultat_21juillet2020 AS SELECT * FROM resultat r WHERE r.date_resultat = '2019-07-14'; RENAME TABLE resultat_21juillet2020 TO resultat_14juillet2019; -- #6 DROP VIEW IF EXISTS resultat_14juillet2019;","title":"Corrig\u00e9"},{"location":"exercices/ex06/ex06_corrige/","text":"Exercice 06 - Corrig\u00e9 1. Fonction calcul_credit() DROP FUNCTION IF EXISTS calcul_credit; DELIMITER $$ CREATE FUNCTION calcul_credit (citoyen_id INT) RETURNS INT NOT DETERMINISTIC BEGIN DECLARE score_actuel INT DEFAULT 0; DECLARE score_min INT DEFAULT 0; DECLARE score_max INT DEFAULT 1000; DECLARE score_initial INT DEFAULT 0; DECLARE score_variation INT DEFAULT 0; -- R\u00e9cup\u00e9ration du score initial SELECT c.credit_initial INTO score_initial FROM citoyen c WHERE c.id = citoyen_id; -- Calcul de la variation de son score SELECT SUM(COALESCE(ce.score_ajustement, et.score_defaut, 0)) INTO score_variation FROM citoyen c LEFT JOIN citoyen_evenement ce ON ce.citoyen_id = c.id LEFT JOIN evenement e ON e.id = ce.evenement_id LEFT JOIN evenement_type et ON et.id = e.type_evenement_id WHERE c.id = citoyen_id; -- Calcul du score actuel SET score_actuel = score_initial + score_variation; -- Ajustement du score IF score_actuel < score_min THEN SET score_actuel = score_min; END IF; IF score_actuel > score_max THEN SET score_actuel = score_max; END IF; RETURN (score_actuel); END$$ DELIMITER ; 2. Fonction privilege_valide() DROP FUNCTION IF EXISTS privilege_valide; DELIMITER $$ CREATE FUNCTION privilege_valide (_pin VARCHAR(100), _classe_id INT) RETURNS BIT NOT DETERMINISTIC BEGIN DECLARE is_valid BIT DEFAULT 0; SELECT ( SELECT cl.credit_min FROM citoyen c INNER JOIN classe cl ON cl.id = c.classe_id WHERE c.pin = _pin ) >= ( SELECT c.credit_min FROM classe c WHERE c.id = _classe_id ) INTO is_valid; RETURN (is_valid); END$$ DELIMITER ; 3. Vue citoyen_avec_credit CREATE OR REPLACE VIEW citoyen_avec_credit AS SELECT c.id AS citoyen_id, CONCAT(c.nom,', ',c.prenom), c.pin, cl.titre, calcul_credit(c.id) AS credit FROM citoyen c INNER JOIN classe cl ON cl.id = c.classe_id; 4. Proc\u00e9dure stock\u00e9e liste_manifestant DROP PROCEDURE IF EXISTS liste_manifestant; DELIMITER $$ CREATE PROCEDURE liste_manifestant( IN _date_manifestation DATE ) BEGIN SELECT c.id AS citoyen_id, e.id AS evenement_id, CONCAT(c.nom,', ',c.prenom) AS nom, c.pin, cl.titre AS classe, e.date_evenement, e.notes FROM citoyen c INNER JOIN classe cl ON cl.id = c.classe_id INNER JOIN citoyen_evenement ce ON ce.citoyen_id = c.id INNER JOIN evenement e ON e.id = ce.evenement_id WHERE e.type_evenement_id = 4 -- Le id 4 correspont au type manifestation AND DATE_FORMAT(e.date_evenement, '%Y-%m-%d') = _date_manifestation ORDER BY c.nom, c.prenom; END $$ DELIMITER ; 5. Proc\u00e9dure stock\u00e9e update_classe DROP PROCEDURE IF EXISTS update_classe; DELIMITER $$ CREATE PROCEDURE update_classe () BEGIN DECLARE fin_enregistrement INT DEFAULT 0; DECLARE citoyen_id INT DEFAULT 0; DECLARE id_classe_calcule INT DEFAULT 0; DECLARE id_classe_actuel INT DEFAULT 0; DECLARE curseur_citoyen CURSOR FOR SELECT id FROM citoyen; DECLARE CONTINUE HANDLER FOR NOT FOUND SET fin_enregistrement = 1; OPEN curseur_citoyen; liste_citoyen:LOOP FETCH curseur_citoyen INTO citoyen_id; IF fin_enregistrement = 1 THEN LEAVE liste_citoyen; END IF; SELECT classe_id INTO id_classe_actuel FROM citoyen WHERE id = citoyen_id; SELECT id INTO id_classe_calcule FROM classe c WHERE c.credit_min <= calcul_credit(citoyen_id) ORDER BY c.credit_min DESC LIMIT 1; IF id_classe_calcule <> id_classe_actuel THEN -- Mettre \u00e0 jour la classe du citoyen UPDATE citoyen SET classe_id = id_classe_calcule WHERE id = citoyen_id; -- Laisser une trace de l'op\u00e9ration INSERT INTO log_update_classe (date_update, citoyen_id, ancienne_classe_id, nouvelle_classe_id) VALUES (NOW(), citoyen_id, id_classe_actuel, id_classe_calcule); END IF; END LOOP liste_citoyen; CLOSE curseur_citoyen; END $$ DELIMITER ;","title":"Exercice 06 - Corrig\u00e9"},{"location":"exercices/ex06/ex06_corrige/#exercice-06-corrige","text":"","title":"Exercice 06 - Corrig\u00e9"},{"location":"exercices/ex06/ex06_corrige/#1-fonction-calcul_credit","text":"DROP FUNCTION IF EXISTS calcul_credit; DELIMITER $$ CREATE FUNCTION calcul_credit (citoyen_id INT) RETURNS INT NOT DETERMINISTIC BEGIN DECLARE score_actuel INT DEFAULT 0; DECLARE score_min INT DEFAULT 0; DECLARE score_max INT DEFAULT 1000; DECLARE score_initial INT DEFAULT 0; DECLARE score_variation INT DEFAULT 0; -- R\u00e9cup\u00e9ration du score initial SELECT c.credit_initial INTO score_initial FROM citoyen c WHERE c.id = citoyen_id; -- Calcul de la variation de son score SELECT SUM(COALESCE(ce.score_ajustement, et.score_defaut, 0)) INTO score_variation FROM citoyen c LEFT JOIN citoyen_evenement ce ON ce.citoyen_id = c.id LEFT JOIN evenement e ON e.id = ce.evenement_id LEFT JOIN evenement_type et ON et.id = e.type_evenement_id WHERE c.id = citoyen_id; -- Calcul du score actuel SET score_actuel = score_initial + score_variation; -- Ajustement du score IF score_actuel < score_min THEN SET score_actuel = score_min; END IF; IF score_actuel > score_max THEN SET score_actuel = score_max; END IF; RETURN (score_actuel); END$$ DELIMITER ;","title":"1. Fonction calcul_credit()"},{"location":"exercices/ex06/ex06_corrige/#2-fonction-privilege_valide","text":"DROP FUNCTION IF EXISTS privilege_valide; DELIMITER $$ CREATE FUNCTION privilege_valide (_pin VARCHAR(100), _classe_id INT) RETURNS BIT NOT DETERMINISTIC BEGIN DECLARE is_valid BIT DEFAULT 0; SELECT ( SELECT cl.credit_min FROM citoyen c INNER JOIN classe cl ON cl.id = c.classe_id WHERE c.pin = _pin ) >= ( SELECT c.credit_min FROM classe c WHERE c.id = _classe_id ) INTO is_valid; RETURN (is_valid); END$$ DELIMITER ;","title":"2. Fonction privilege_valide()"},{"location":"exercices/ex06/ex06_corrige/#3-vue-citoyen_avec_credit","text":"CREATE OR REPLACE VIEW citoyen_avec_credit AS SELECT c.id AS citoyen_id, CONCAT(c.nom,', ',c.prenom), c.pin, cl.titre, calcul_credit(c.id) AS credit FROM citoyen c INNER JOIN classe cl ON cl.id = c.classe_id;","title":"3. Vue citoyen_avec_credit"},{"location":"exercices/ex06/ex06_corrige/#4-procedure-stockee-liste_manifestant","text":"DROP PROCEDURE IF EXISTS liste_manifestant; DELIMITER $$ CREATE PROCEDURE liste_manifestant( IN _date_manifestation DATE ) BEGIN SELECT c.id AS citoyen_id, e.id AS evenement_id, CONCAT(c.nom,', ',c.prenom) AS nom, c.pin, cl.titre AS classe, e.date_evenement, e.notes FROM citoyen c INNER JOIN classe cl ON cl.id = c.classe_id INNER JOIN citoyen_evenement ce ON ce.citoyen_id = c.id INNER JOIN evenement e ON e.id = ce.evenement_id WHERE e.type_evenement_id = 4 -- Le id 4 correspont au type manifestation AND DATE_FORMAT(e.date_evenement, '%Y-%m-%d') = _date_manifestation ORDER BY c.nom, c.prenom; END $$ DELIMITER ;","title":"4. Proc\u00e9dure stock\u00e9e liste_manifestant"},{"location":"exercices/ex06/ex06_corrige/#5-procedure-stockee-update_classe","text":"DROP PROCEDURE IF EXISTS update_classe; DELIMITER $$ CREATE PROCEDURE update_classe () BEGIN DECLARE fin_enregistrement INT DEFAULT 0; DECLARE citoyen_id INT DEFAULT 0; DECLARE id_classe_calcule INT DEFAULT 0; DECLARE id_classe_actuel INT DEFAULT 0; DECLARE curseur_citoyen CURSOR FOR SELECT id FROM citoyen; DECLARE CONTINUE HANDLER FOR NOT FOUND SET fin_enregistrement = 1; OPEN curseur_citoyen; liste_citoyen:LOOP FETCH curseur_citoyen INTO citoyen_id; IF fin_enregistrement = 1 THEN LEAVE liste_citoyen; END IF; SELECT classe_id INTO id_classe_actuel FROM citoyen WHERE id = citoyen_id; SELECT id INTO id_classe_calcule FROM classe c WHERE c.credit_min <= calcul_credit(citoyen_id) ORDER BY c.credit_min DESC LIMIT 1; IF id_classe_calcule <> id_classe_actuel THEN -- Mettre \u00e0 jour la classe du citoyen UPDATE citoyen SET classe_id = id_classe_calcule WHERE id = citoyen_id; -- Laisser une trace de l'op\u00e9ration INSERT INTO log_update_classe (date_update, citoyen_id, ancienne_classe_id, nouvelle_classe_id) VALUES (NOW(), citoyen_id, id_classe_actuel, id_classe_calcule); END IF; END LOOP liste_citoyen; CLOSE curseur_citoyen; END $$ DELIMITER ;","title":"5. Proc\u00e9dure stock\u00e9e update_classe"},{"location":"exercices/ex06/ex06_enonce/","text":"Exercice 06 - Cr\u00e9dit social Installation Les scripts sql de g\u00e9n\u00e9ration de la base de donn\u00e9es sont disponible sur Teams dans la section Fichiers > Supports de cours > Exercices > Exercice06 - Cr\u00e9dit social . Cr\u00e9ez une nouvelle base de donn\u00e9es nomm\u00e9e credit_social Cr\u00e9ez les tables en ex\u00e9cutant le script sql 01_create_table.sql Ins\u00e9rez les donn\u00e9es en ex\u00e9cutant les scripts suivants ( l'ordre est important ). Certains scripts comportent beaucoup de ligne, 50 000 pour 04_insert_citoyen, c'est normale que le temps ex\u00e9cution soit long. Cr\u00e9ez un script SQL par num\u00e9ro. Une fois termin\u00e9 remettez moi les 5 scripts dans le devoir sur Teams. Liste des scripts \u00e0 ex\u00e9cuter 02_insert_classe 03_insert_evenement_type 04_insert_citoyen 05_insert_evenement 06_insert_citoyen_evenement Diagramme des classes Descriptions La base de donn\u00e9es sert \u00e0 stocker des informations sur les citoyens pour \u00e9tablir leur score de cr\u00e9dit social, une note de bon comportement qui d\u00e9termine dans quel classe le citoyen est situ\u00e9. Calcul du cr\u00e9dit social En naissant, un citoyen se voit octroyer un cr\u00e9dit initial de 500 (par contre ce nombre pourrait \u00eatre modifi\u00e9 par le parti). Tout au long de sa vie, le total de ce cr\u00e9dit va fluctuer selon des \u00e9v\u00e9nements auquel le citoyen va participer. Donc le cr\u00e9dit social de chaque citoyen est la somme de son cr\u00e9dit initial et du score de tous les \u00e9v\u00e9nements auxquels il a particip\u00e9. Les \u00e9v\u00e9nements sont d\u00e9fini par un type et un score par d\u00e9faut (dans la table evenement_type , mais ce score peut \u00eatre ajust\u00e9 selon la nature de l'\u00e9v\u00e9nement (le champ score_ajustement de la table citoyen_evenement , s'il est \u00e0 null ne pas en tenir compte, sinon il outrepasse le score par d\u00e9faut de l'\u00e9v\u00e9nement). Le score de cr\u00e9dit social peut varier entre 0 et 1000. Calcul de la classe du citoyen Chaque citoyen appartient \u00e0 une classe selon son score de cr\u00e9dit social. \u00c7a lui donne droit \u00e0 certain avantage de sa classe mais aussi aux avantages de toutes les classes inf\u00e9rieurs. Pour appartenir \u00e0 une classe, le score de cr\u00e9dit social du citoyen doit \u00eatre sup\u00e9rieur au cr\u00e9dit minimum de cette classe ( colonne credit_min de la table classe ). La classe est recalcul\u00e9 chaque nuit selon son score actuel. Donc pour connaitre la classe d'un citoyen vous n'avez qu'\u00e0 utiliser le champ classe_id de la table citoyen. Exercices 1. Fonction calcul_credit() Cr\u00e9ez une fonction nomm\u00e9e calcul_credit qui prends en param\u00e8tre le id d'un citoyen et retourne le total du calcul de son cr\u00e9dit social. Param\u00eatres IN/OUT tYPE Valeur test id IN INT 20958 RETURNS OUT INT 365 Ex. Le citoyen Harry Walsh, id 20958, pin 51d8fbc8-d473-45f5-991e-15aea899e8f9, a un score de cr\u00e9dit social de 365. select calcul_credit(20958) as score_credit 2. Fonction privilege_valide() Cr\u00e9ez une fonction nomm\u00e9e privilege_valide qui prend en param\u00e8tre le code pin du citoyen ainsi que le id d'une classe. Si la classe du citoyen est \u00e9gale ou sup\u00e9rieur \u00e0 la classe pass\u00e9e en param\u00e8tre, retournez TRUE, sinon retournez FALSE. Pour d\u00e9termin\u00e9 si une classe est sup\u00e9rieur \u00e0 une autre, vous devez vous fiez \u00e0 la colonne credit_min de la table classe . Param\u00eatres IN/OUT tYPE Valeur test pin IN VARCHAR(100) 51d8fbc8-d473-45f5-991e-15aea899e8f9 classe_id IN INT 4 RETURNS OUT BOOLEAN FALSE Ex. Le citoyen Harry Walsh, id 20958, pin 51d8fbc8-d473-45f5-991e-15aea899e8f9 appartient \u00e0 la classe Delta. -- Cette requ\u00eate retournera 1 select privilege_valide('51d8fbc8-d473-45f5-991e-15aea899e8f9',4) as valide -- Cette requ\u00eate retournera 0 select privilege_valide('51d8fbc8-d473-45f5-991e-15aea899e8f9',3) as valide 3. Vue citoyen_avec_credit Cr\u00e9ez une vue nomm\u00e9e citoyen_avec_credit qui contiendra les champs suivants Nom colonne table colonne citoyen_id citoyen id nom citoyen nom, prenom (\"Walsh, Harry\") pin citoyen pin classe classe titre credit calcul\u00e9 Faites ensuite une requ\u00eate sur cette view pour afficher les informations du citoyen id 20958 4. Proc\u00e9dure stock\u00e9e liste_manifestant Cr\u00e9ez une proc\u00e9dure stock\u00e9e nomm\u00e9e liste_manifestant qui prend une date en param\u00e8tre et retourne une liste de manifestants qui \u00e9tait pr\u00e9sent. Assurez-vous que pour la date s\u00e9lectionn\u00e9e s'il y a un \u00e9v\u00e9nement il soit de type manifestation. Le r\u00e9sultat doit \u00eatre class\u00e9 en ordre alphab\u00e9tique de nom et pr\u00e9nom. Nom colonne table colonne citoyen_id citoyen id evenement_id evenement id nom citoyen nom, prenom (\"Walsh, Harry\") pin citoyen pin classe classe titre date_evenement evenement date_evenement notes evenement notes Faite ensuite une validation avec la date 2021-04-01, vous devriez avoir 17 enregistrements. Si vous essayer avec la date 2022-09-15 vous devriez en avoir aucun. 5. Proc\u00e9dure stock\u00e9e update_classe Cr\u00e9ez une proc\u00e9dure stock\u00e9e nomm\u00e9e update_classe qui va updater la classe de chaque citoyen. Il vous faudra calculer le cr\u00e9dit social de chacun, ensuite d\u00e9terminer dans quelle classe il appartient selon le cr\u00e9dit minimum de chaque classe. Vous devez parcourir tous les enregistrements de la table citoyen en utilisant un curseur. Si vous d\u00e9tectez une diff\u00e9rence entre la classe du citoyen et votre calcul, vous devez \"logger\" le probl\u00e8me dans la table log_update_classe . Pour tester votre procedure, limitez la requ\u00eate SELECT qui alimente le curseur \u00e0 un seul citoyen et modifier la valeur du champs credit_initial de ce citoyen pour que la valeur du champs classe_id ne soit plus valide. Dans l'exemple plus bas j'ai modifi\u00e9 la valeur du cr\u00e9dit initial du citoyen 2 pour 850, ce qui lui donne une classe de 2 (Beta) au lieu de 4 (Delta). Apr\u00e8s avoir lancer ma proc\u00e9dure, on peut voir que la valeur de classe_id a bien \u00e9t\u00e9 modifi\u00e9 et que l'op\u00e9ration a \u00e9t\u00e9 enregistr\u00e9 dans la table log_update_classe. Corrig\u00e9 Le corrig\u00e9 est disponible ici","title":"Exercice 06 - Cr\u00e9dit social"},{"location":"exercices/ex06/ex06_enonce/#exercice-06-credit-social","text":"","title":"Exercice 06 - Cr\u00e9dit social"},{"location":"exercices/ex06/ex06_enonce/#installation","text":"Les scripts sql de g\u00e9n\u00e9ration de la base de donn\u00e9es sont disponible sur Teams dans la section Fichiers > Supports de cours > Exercices > Exercice06 - Cr\u00e9dit social . Cr\u00e9ez une nouvelle base de donn\u00e9es nomm\u00e9e credit_social Cr\u00e9ez les tables en ex\u00e9cutant le script sql 01_create_table.sql Ins\u00e9rez les donn\u00e9es en ex\u00e9cutant les scripts suivants ( l'ordre est important ). Certains scripts comportent beaucoup de ligne, 50 000 pour 04_insert_citoyen, c'est normale que le temps ex\u00e9cution soit long. Cr\u00e9ez un script SQL par num\u00e9ro. Une fois termin\u00e9 remettez moi les 5 scripts dans le devoir sur Teams. Liste des scripts \u00e0 ex\u00e9cuter 02_insert_classe 03_insert_evenement_type 04_insert_citoyen 05_insert_evenement 06_insert_citoyen_evenement","title":"Installation"},{"location":"exercices/ex06/ex06_enonce/#diagramme-des-classes","text":"","title":"Diagramme des classes"},{"location":"exercices/ex06/ex06_enonce/#descriptions","text":"La base de donn\u00e9es sert \u00e0 stocker des informations sur les citoyens pour \u00e9tablir leur score de cr\u00e9dit social, une note de bon comportement qui d\u00e9termine dans quel classe le citoyen est situ\u00e9.","title":"Descriptions"},{"location":"exercices/ex06/ex06_enonce/#calcul-du-credit-social","text":"En naissant, un citoyen se voit octroyer un cr\u00e9dit initial de 500 (par contre ce nombre pourrait \u00eatre modifi\u00e9 par le parti). Tout au long de sa vie, le total de ce cr\u00e9dit va fluctuer selon des \u00e9v\u00e9nements auquel le citoyen va participer. Donc le cr\u00e9dit social de chaque citoyen est la somme de son cr\u00e9dit initial et du score de tous les \u00e9v\u00e9nements auxquels il a particip\u00e9. Les \u00e9v\u00e9nements sont d\u00e9fini par un type et un score par d\u00e9faut (dans la table evenement_type , mais ce score peut \u00eatre ajust\u00e9 selon la nature de l'\u00e9v\u00e9nement (le champ score_ajustement de la table citoyen_evenement , s'il est \u00e0 null ne pas en tenir compte, sinon il outrepasse le score par d\u00e9faut de l'\u00e9v\u00e9nement). Le score de cr\u00e9dit social peut varier entre 0 et 1000.","title":"Calcul du cr\u00e9dit social"},{"location":"exercices/ex06/ex06_enonce/#calcul-de-la-classe-du-citoyen","text":"Chaque citoyen appartient \u00e0 une classe selon son score de cr\u00e9dit social. \u00c7a lui donne droit \u00e0 certain avantage de sa classe mais aussi aux avantages de toutes les classes inf\u00e9rieurs. Pour appartenir \u00e0 une classe, le score de cr\u00e9dit social du citoyen doit \u00eatre sup\u00e9rieur au cr\u00e9dit minimum de cette classe ( colonne credit_min de la table classe ). La classe est recalcul\u00e9 chaque nuit selon son score actuel. Donc pour connaitre la classe d'un citoyen vous n'avez qu'\u00e0 utiliser le champ classe_id de la table citoyen.","title":"Calcul de la classe du citoyen"},{"location":"exercices/ex06/ex06_enonce/#exercices","text":"","title":"Exercices"},{"location":"exercices/ex06/ex06_enonce/#1-fonction-calcul_credit","text":"Cr\u00e9ez une fonction nomm\u00e9e calcul_credit qui prends en param\u00e8tre le id d'un citoyen et retourne le total du calcul de son cr\u00e9dit social. Param\u00eatres IN/OUT tYPE Valeur test id IN INT 20958 RETURNS OUT INT 365 Ex. Le citoyen Harry Walsh, id 20958, pin 51d8fbc8-d473-45f5-991e-15aea899e8f9, a un score de cr\u00e9dit social de 365. select calcul_credit(20958) as score_credit","title":"1. Fonction calcul_credit()"},{"location":"exercices/ex06/ex06_enonce/#2-fonction-privilege_valide","text":"Cr\u00e9ez une fonction nomm\u00e9e privilege_valide qui prend en param\u00e8tre le code pin du citoyen ainsi que le id d'une classe. Si la classe du citoyen est \u00e9gale ou sup\u00e9rieur \u00e0 la classe pass\u00e9e en param\u00e8tre, retournez TRUE, sinon retournez FALSE. Pour d\u00e9termin\u00e9 si une classe est sup\u00e9rieur \u00e0 une autre, vous devez vous fiez \u00e0 la colonne credit_min de la table classe . Param\u00eatres IN/OUT tYPE Valeur test pin IN VARCHAR(100) 51d8fbc8-d473-45f5-991e-15aea899e8f9 classe_id IN INT 4 RETURNS OUT BOOLEAN FALSE Ex. Le citoyen Harry Walsh, id 20958, pin 51d8fbc8-d473-45f5-991e-15aea899e8f9 appartient \u00e0 la classe Delta. -- Cette requ\u00eate retournera 1 select privilege_valide('51d8fbc8-d473-45f5-991e-15aea899e8f9',4) as valide -- Cette requ\u00eate retournera 0 select privilege_valide('51d8fbc8-d473-45f5-991e-15aea899e8f9',3) as valide","title":"2. Fonction privilege_valide()"},{"location":"exercices/ex06/ex06_enonce/#3-vue-citoyen_avec_credit","text":"Cr\u00e9ez une vue nomm\u00e9e citoyen_avec_credit qui contiendra les champs suivants Nom colonne table colonne citoyen_id citoyen id nom citoyen nom, prenom (\"Walsh, Harry\") pin citoyen pin classe classe titre credit calcul\u00e9 Faites ensuite une requ\u00eate sur cette view pour afficher les informations du citoyen id 20958","title":"3. Vue citoyen_avec_credit"},{"location":"exercices/ex06/ex06_enonce/#4-procedure-stockee-liste_manifestant","text":"Cr\u00e9ez une proc\u00e9dure stock\u00e9e nomm\u00e9e liste_manifestant qui prend une date en param\u00e8tre et retourne une liste de manifestants qui \u00e9tait pr\u00e9sent. Assurez-vous que pour la date s\u00e9lectionn\u00e9e s'il y a un \u00e9v\u00e9nement il soit de type manifestation. Le r\u00e9sultat doit \u00eatre class\u00e9 en ordre alphab\u00e9tique de nom et pr\u00e9nom. Nom colonne table colonne citoyen_id citoyen id evenement_id evenement id nom citoyen nom, prenom (\"Walsh, Harry\") pin citoyen pin classe classe titre date_evenement evenement date_evenement notes evenement notes Faite ensuite une validation avec la date 2021-04-01, vous devriez avoir 17 enregistrements. Si vous essayer avec la date 2022-09-15 vous devriez en avoir aucun.","title":"4. Proc\u00e9dure stock\u00e9e liste_manifestant"},{"location":"exercices/ex06/ex06_enonce/#5-procedure-stockee-update_classe","text":"Cr\u00e9ez une proc\u00e9dure stock\u00e9e nomm\u00e9e update_classe qui va updater la classe de chaque citoyen. Il vous faudra calculer le cr\u00e9dit social de chacun, ensuite d\u00e9terminer dans quelle classe il appartient selon le cr\u00e9dit minimum de chaque classe. Vous devez parcourir tous les enregistrements de la table citoyen en utilisant un curseur. Si vous d\u00e9tectez une diff\u00e9rence entre la classe du citoyen et votre calcul, vous devez \"logger\" le probl\u00e8me dans la table log_update_classe . Pour tester votre procedure, limitez la requ\u00eate SELECT qui alimente le curseur \u00e0 un seul citoyen et modifier la valeur du champs credit_initial de ce citoyen pour que la valeur du champs classe_id ne soit plus valide. Dans l'exemple plus bas j'ai modifi\u00e9 la valeur du cr\u00e9dit initial du citoyen 2 pour 850, ce qui lui donne une classe de 2 (Beta) au lieu de 4 (Delta). Apr\u00e8s avoir lancer ma proc\u00e9dure, on peut voir que la valeur de classe_id a bien \u00e9t\u00e9 modifi\u00e9 et que l'op\u00e9ration a \u00e9t\u00e9 enregistr\u00e9 dans la table log_update_classe.","title":"5. Proc\u00e9dure stock\u00e9e update_classe"},{"location":"exercices/ex06/ex06_enonce/#corrige","text":"Le corrig\u00e9 est disponible ici","title":"Corrig\u00e9"},{"location":"exercices/ex07/ex07_corrige/","text":"Exercice 05 - Corrig\u00e9 IN Question 1 select * from citoyen where ville in ('Minneapolis', 'Philadelphia', 'Phoenix'); Question 2 select * from evenement e where e.type_evenement_id in (4, 5); Question 3 select * from evenement e where e.type_evenement_id = 4 and month(e.date_evenement) in (3,4,5) Question 4 select * from citoyen c where c.id not in ( select ce.citoyen_id from evenement e inner join citoyen_evenement ce on ce.evenement_id = e.id where e.type_evenement_id = 1 ); Question 5 select * from citoyen c inner join classe cl on cl.id = c.classe_id where cl.titre = 'Alpha' and c.id in ( select ce.citoyen_id from evenement e inner join citoyen_evenement ce on ce.evenement_id = e.id where e.type_evenement_id = 4 ); LIKE Question 1 select * from citoyen where prenom like 'M%' and nom like 'F%' Question 2 select * from citoyen where prenom like '___'; Question 3 select * from citoyen where pin like '%-6935-%'; Question 4 select c.* from citoyen c inner join citoyen_evenement ce on ce.citoyen_id = c.id inner join evenement e on e.id = ce.evenement_id where e.notes like '%math%'; Question 5 select * from citoyen where pin like '__6c4b66%'; GROUP BY Question 1 select cl.titre, count(c.id) as nb_citoyen from citoyen c right join classe cl on cl.id = c.classe_id group by cl.titre; Question 2 select e.id as evenement_id, e.date_evenement, e.notes, count(*) as nombre_arrestations from evenement e inner join evenement_type et on et.id = e.type_evenement_id inner join citoyen_evenement ce on ce.evenement_id = e.id where et.titre = \"Manifestation\" group by e.id having count(*) > 5 order by e.id; Question 3 select ce.evenement_id, ceiling(avg(calcul_credit(ce.citoyen_id))) as moyenne_score from evenement e inner join evenement_type et on et.id = e.type_evenement_id inner join citoyen_evenement ce on ce.evenement_id = e.id where et.titre = \"Denonciation\" group by ce.evenement_id order by ce.evenement_id; Question 4 Pour cette question ce n'\u00e9tait pas vraiment pertinent de le faire avec un group by. select c.nom, c.prenom, calcul_credit(c.id) as score from citoyen c where calcul_credit(c.id) = ( select max(calcul_credit(c.id)) from citoyen c where c.id < 100 ) and c.id < 100; Question 5 select date(e.date_evenement) as date_evenement, sum(calcul_credit(ce.citoyen_id)) as total_score from evenement e inner join citoyen_evenement ce on ce.evenement_id = e.id inner join evenement_type et on et.id = e.type_evenement_id where et.titre = \"Reunion du parti\" and date(e.date_evenement) = '2021-07-17' group by date(e.date_evenement); EXISTS Question 1 select * from citoyen c1 where exists ( select 1 from citoyen c2 where ville = 'Quebec' and c2.id = c1.id ); Question 2 select * from citoyen c where exists ( select 1 from evenement e inner join citoyen_evenement ce on ce.evenement_id = e.id where e.type_evenement_id = 3 and ce.citoyen_id = c.id ) order by c.id; Question 3 select * from citoyen c where not exists ( select 1 from citoyen_evenement ce where ce.citoyen_id = c.id ); Question 4 La difficult\u00e9 ici \u00e9tait qu'on ne peut pas faire de update avec dans le where une sous-requ\u00eate sur la m\u00eame table. Une fa\u00e7on de contourner le probl\u00e8me est de cr\u00e9er une table temporaire dans la sous-requ\u00eate. update citoyen set pin = concat('x', right(citoyen.pin, length(citoyen.pin) - 1)) where exists ( select 1 from (select * from citoyen) c -- Cr\u00e9e une table temporaire where c.ville = \"Madrid\" and c.id = citoyen.id ); Question 5 update citoyen_evenement ce set ce.score_ajustement = FLOOR(RAND()*(100-25+1))+25 where exists ( select 1 from evenement_type et inner join evenement e on e.type_evenement_id = et.id where et.titre = \"Denonciation\" and e.id = ce.evenement_id ); Proc\u00e9dures stock\u00e9es et fonctions Question 1 DROP PROCEDURE IF EXISTS credit_social.participation_evenement; DELIMITER $$ $$ create procedure credit_social.participation_evenement(_citoyen_id INT) begin declare nb_reunion INT default 0; declare nb_denonciation INT default 0; declare nb_realignement INT default 0; declare nb_manifestation INT default 0; declare nb_idees INT default 0; declare nb_comportement INT default 0; -- Nombre de participation \u00e0 une r\u00e9union du parti select count(*) into nb_reunion from evenement e inner join citoyen_evenement ce on ce.evenement_id = e.id where e.type_evenement_id = 1 and ce.citoyen_id = _citoyen_id; -- Nombre de participation \u00e0 une d\u00e9nonciation select count(*) into nb_denonciation from evenement e inner join citoyen_evenement ce on ce.evenement_id = e.id where e.type_evenement_id = 2 and ce.citoyen_id = _citoyen_id; -- Nombre de participation \u00e0 un r\u00e9alignement sanitaire select count(*) into nb_realignement from evenement e inner join citoyen_evenement ce on ce.evenement_id = e.id where e.type_evenement_id = 3 and ce.citoyen_id = _citoyen_id; -- Nombre de participation \u00e0 une manifestation select count(*) into nb_manifestation from evenement e inner join citoyen_evenement ce on ce.evenement_id = e.id where e.type_evenement_id = 4 and ce.citoyen_id = _citoyen_id; -- Nombre d'arrestation pour idees dissidentes select count(*) into nb_idees from evenement e inner join citoyen_evenement ce on ce.evenement_id = e.id where e.type_evenement_id = 5 and ce.citoyen_id = _citoyen_id; -- Nombre d'arrestation pour comportement reprehensible select count(*) into nb_comportement from evenement e inner join citoyen_evenement ce on ce.evenement_id = e.id where e.type_evenement_id = 6 and ce.citoyen_id = _citoyen_id; -- Retour select c.id as id_citoyen, c.nom, c.prenom, nb_reunion, nb_denonciation, nb_realignement, nb_manifestation, nb_idees, nb_comportement from citoyen c where c.id = _citoyen_id; end $$ DELIMITER ; Question 2 DROP FUNCTION IF EXISTS credit_social.valide_pin; DELIMITER $$ $$ CREATE FUNCTION credit_social.valide_pin(_citoyen_id int) RETURNS INT deterministic begin return (select pin regexp('([a-zA-Z0-9]{8})([-]{1})([a-zA-Z0-9]{4})([-]{1})([a-zA-Z0-9]{4})([-]{1})([a-zA-Z0-9]{4})([-]{1})([a-zA-Z0-9]{12})') from citoyen where id = _citoyen_id); END$$ DELIMITER ;","title":"Exercice 05 - Corrig\u00e9"},{"location":"exercices/ex07/ex07_corrige/#exercice-05-corrige","text":"","title":"Exercice 05 - Corrig\u00e9"},{"location":"exercices/ex07/ex07_corrige/#in","text":"","title":"IN"},{"location":"exercices/ex07/ex07_corrige/#question-1","text":"select * from citoyen where ville in ('Minneapolis', 'Philadelphia', 'Phoenix');","title":"Question 1"},{"location":"exercices/ex07/ex07_corrige/#question-2","text":"select * from evenement e where e.type_evenement_id in (4, 5);","title":"Question 2"},{"location":"exercices/ex07/ex07_corrige/#question-3","text":"select * from evenement e where e.type_evenement_id = 4 and month(e.date_evenement) in (3,4,5)","title":"Question 3"},{"location":"exercices/ex07/ex07_corrige/#question-4","text":"select * from citoyen c where c.id not in ( select ce.citoyen_id from evenement e inner join citoyen_evenement ce on ce.evenement_id = e.id where e.type_evenement_id = 1 );","title":"Question 4"},{"location":"exercices/ex07/ex07_corrige/#question-5","text":"select * from citoyen c inner join classe cl on cl.id = c.classe_id where cl.titre = 'Alpha' and c.id in ( select ce.citoyen_id from evenement e inner join citoyen_evenement ce on ce.evenement_id = e.id where e.type_evenement_id = 4 );","title":"Question 5"},{"location":"exercices/ex07/ex07_corrige/#like","text":"","title":"LIKE"},{"location":"exercices/ex07/ex07_corrige/#question-1_1","text":"select * from citoyen where prenom like 'M%' and nom like 'F%'","title":"Question 1"},{"location":"exercices/ex07/ex07_corrige/#question-2_1","text":"select * from citoyen where prenom like '___';","title":"Question 2"},{"location":"exercices/ex07/ex07_corrige/#question-3_1","text":"select * from citoyen where pin like '%-6935-%';","title":"Question 3"},{"location":"exercices/ex07/ex07_corrige/#question-4_1","text":"select c.* from citoyen c inner join citoyen_evenement ce on ce.citoyen_id = c.id inner join evenement e on e.id = ce.evenement_id where e.notes like '%math%';","title":"Question 4"},{"location":"exercices/ex07/ex07_corrige/#question-5_1","text":"select * from citoyen where pin like '__6c4b66%';","title":"Question 5"},{"location":"exercices/ex07/ex07_corrige/#group-by","text":"","title":"GROUP BY"},{"location":"exercices/ex07/ex07_corrige/#question-1_2","text":"select cl.titre, count(c.id) as nb_citoyen from citoyen c right join classe cl on cl.id = c.classe_id group by cl.titre;","title":"Question 1"},{"location":"exercices/ex07/ex07_corrige/#question-2_2","text":"select e.id as evenement_id, e.date_evenement, e.notes, count(*) as nombre_arrestations from evenement e inner join evenement_type et on et.id = e.type_evenement_id inner join citoyen_evenement ce on ce.evenement_id = e.id where et.titre = \"Manifestation\" group by e.id having count(*) > 5 order by e.id;","title":"Question 2"},{"location":"exercices/ex07/ex07_corrige/#question-3_2","text":"select ce.evenement_id, ceiling(avg(calcul_credit(ce.citoyen_id))) as moyenne_score from evenement e inner join evenement_type et on et.id = e.type_evenement_id inner join citoyen_evenement ce on ce.evenement_id = e.id where et.titre = \"Denonciation\" group by ce.evenement_id order by ce.evenement_id;","title":"Question 3"},{"location":"exercices/ex07/ex07_corrige/#question-4_2","text":"Pour cette question ce n'\u00e9tait pas vraiment pertinent de le faire avec un group by. select c.nom, c.prenom, calcul_credit(c.id) as score from citoyen c where calcul_credit(c.id) = ( select max(calcul_credit(c.id)) from citoyen c where c.id < 100 ) and c.id < 100;","title":"Question 4"},{"location":"exercices/ex07/ex07_corrige/#question-5_2","text":"select date(e.date_evenement) as date_evenement, sum(calcul_credit(ce.citoyen_id)) as total_score from evenement e inner join citoyen_evenement ce on ce.evenement_id = e.id inner join evenement_type et on et.id = e.type_evenement_id where et.titre = \"Reunion du parti\" and date(e.date_evenement) = '2021-07-17' group by date(e.date_evenement);","title":"Question 5"},{"location":"exercices/ex07/ex07_corrige/#exists","text":"","title":"EXISTS"},{"location":"exercices/ex07/ex07_corrige/#question-1_3","text":"select * from citoyen c1 where exists ( select 1 from citoyen c2 where ville = 'Quebec' and c2.id = c1.id );","title":"Question 1"},{"location":"exercices/ex07/ex07_corrige/#question-2_3","text":"select * from citoyen c where exists ( select 1 from evenement e inner join citoyen_evenement ce on ce.evenement_id = e.id where e.type_evenement_id = 3 and ce.citoyen_id = c.id ) order by c.id;","title":"Question 2"},{"location":"exercices/ex07/ex07_corrige/#question-3_3","text":"select * from citoyen c where not exists ( select 1 from citoyen_evenement ce where ce.citoyen_id = c.id );","title":"Question 3"},{"location":"exercices/ex07/ex07_corrige/#question-4_3","text":"La difficult\u00e9 ici \u00e9tait qu'on ne peut pas faire de update avec dans le where une sous-requ\u00eate sur la m\u00eame table. Une fa\u00e7on de contourner le probl\u00e8me est de cr\u00e9er une table temporaire dans la sous-requ\u00eate. update citoyen set pin = concat('x', right(citoyen.pin, length(citoyen.pin) - 1)) where exists ( select 1 from (select * from citoyen) c -- Cr\u00e9e une table temporaire where c.ville = \"Madrid\" and c.id = citoyen.id );","title":"Question 4"},{"location":"exercices/ex07/ex07_corrige/#question-5_3","text":"update citoyen_evenement ce set ce.score_ajustement = FLOOR(RAND()*(100-25+1))+25 where exists ( select 1 from evenement_type et inner join evenement e on e.type_evenement_id = et.id where et.titre = \"Denonciation\" and e.id = ce.evenement_id );","title":"Question 5"},{"location":"exercices/ex07/ex07_corrige/#procedures-stockees-et-fonctions","text":"","title":"Proc\u00e9dures stock\u00e9es et fonctions"},{"location":"exercices/ex07/ex07_corrige/#question-1_4","text":"DROP PROCEDURE IF EXISTS credit_social.participation_evenement; DELIMITER $$ $$ create procedure credit_social.participation_evenement(_citoyen_id INT) begin declare nb_reunion INT default 0; declare nb_denonciation INT default 0; declare nb_realignement INT default 0; declare nb_manifestation INT default 0; declare nb_idees INT default 0; declare nb_comportement INT default 0; -- Nombre de participation \u00e0 une r\u00e9union du parti select count(*) into nb_reunion from evenement e inner join citoyen_evenement ce on ce.evenement_id = e.id where e.type_evenement_id = 1 and ce.citoyen_id = _citoyen_id; -- Nombre de participation \u00e0 une d\u00e9nonciation select count(*) into nb_denonciation from evenement e inner join citoyen_evenement ce on ce.evenement_id = e.id where e.type_evenement_id = 2 and ce.citoyen_id = _citoyen_id; -- Nombre de participation \u00e0 un r\u00e9alignement sanitaire select count(*) into nb_realignement from evenement e inner join citoyen_evenement ce on ce.evenement_id = e.id where e.type_evenement_id = 3 and ce.citoyen_id = _citoyen_id; -- Nombre de participation \u00e0 une manifestation select count(*) into nb_manifestation from evenement e inner join citoyen_evenement ce on ce.evenement_id = e.id where e.type_evenement_id = 4 and ce.citoyen_id = _citoyen_id; -- Nombre d'arrestation pour idees dissidentes select count(*) into nb_idees from evenement e inner join citoyen_evenement ce on ce.evenement_id = e.id where e.type_evenement_id = 5 and ce.citoyen_id = _citoyen_id; -- Nombre d'arrestation pour comportement reprehensible select count(*) into nb_comportement from evenement e inner join citoyen_evenement ce on ce.evenement_id = e.id where e.type_evenement_id = 6 and ce.citoyen_id = _citoyen_id; -- Retour select c.id as id_citoyen, c.nom, c.prenom, nb_reunion, nb_denonciation, nb_realignement, nb_manifestation, nb_idees, nb_comportement from citoyen c where c.id = _citoyen_id; end $$ DELIMITER ;","title":"Question 1"},{"location":"exercices/ex07/ex07_corrige/#question-2_4","text":"DROP FUNCTION IF EXISTS credit_social.valide_pin; DELIMITER $$ $$ CREATE FUNCTION credit_social.valide_pin(_citoyen_id int) RETURNS INT deterministic begin return (select pin regexp('([a-zA-Z0-9]{8})([-]{1})([a-zA-Z0-9]{4})([-]{1})([a-zA-Z0-9]{4})([-]{1})([a-zA-Z0-9]{4})([-]{1})([a-zA-Z0-9]{12})') from citoyen where id = _citoyen_id); END$$ DELIMITER ;","title":"Question 2"},{"location":"exercices/ex07/ex07_enonce/","text":"Exercices 07 - Op\u00e9rateurs logiques \u00c0 partir de la base de donn\u00e9es credit_social , r\u00e9alisez les requ\u00eates suivantes. Vous devez utiliser l'op\u00e9rateur de la \"section\" dans votre solution. IN S\u00e9lectionnez tous les citoyens qui habitent \u00e0 Minneapolis, Philadelphia ou Phoenix S\u00e9lectionnez tous les \u00e9v\u00e9nements qui sont de type Manifestation ou Idees dissidentes . S\u00e9lectionnez tous les \u00e9v\u00e9nements qui sont de type Manifestation et qui ont eu lieu durant les mois de mars , avril et mai , peu importe l'ann\u00e9e. \u00c0 l'aide d'une sous-requ\u00eate, s\u00e9lectionnez tous les citoyens qui n'ont jamais particip\u00e9 \u00e0 une r\u00e9union du parti. \u00c0 l'aide d'une sous-requ\u00eate, s\u00e9lectionnez tous les citoyens de classe Epsilon qui ont d\u00e9j\u00e0 particip\u00e9 \u00e0 une manifestation. LIKE S\u00e9lectionnez tous les citoyens dont les initiales sont MF. S\u00e9lectionnez tous les citoyens dont le pr\u00e9nom est compos\u00e9 d'exactement 3 caract\u00e8res. S\u00e9lectionnez tous les citoyens qui ont la s\u00e9rie -6935- dans leur code PIN. S\u00e9lectionnez tous les citoyens qui ont particip\u00e9 \u00e0 un \u00e9v\u00e9nement et que dans la note de l'\u00e9v\u00e9nement on retrouve le mot math . S\u00e9lectionnez tous les citoyens dont le code PIN commence par deux caract\u00e8res, peut-importe lesquels, et ensuite contient les caract\u00e8res 6c4b66 . Le reste du code peut \u00eatre n'importe quoi. GROUP BY Calculez le nombre de citoyen par classe. Affichez comme r\u00e9sultat le titre de la classe et le nombre de citoyen. Si la classe \u00e0 aucun citoyen, afficher 0; S\u00e9lectionnez les manifestations qui avait plus de 5 participants qui furent arr\u00eat\u00e9. (Une entr\u00e9e a \u00e9t\u00e9 cr\u00e9\u00e9 dans la table \u00e9v\u00e9nement). Calculer la moyenne des scores de cr\u00e9dit social pour chaque d\u00e9nonciation. S\u00e9lectionnez citoyen qui a le plus haut score de cr\u00e9dit social. Le r\u00e9sultat doit contenir son nom, pr\u00e9nom et score. N'utilisez pas de GROUP BY pour cette requ\u00eate , allez-y avec ce que vous voulez. Calculer la somme des scores de cr\u00e9dit social pour tous les participants de la r\u00e9union du parti du 2021-07-17. Il y a eu plusieurs r\u00e9unions cette journ\u00e9e, soit vous en cibler qu'un avec aussi l'heure ou bien vous faite la somme de toutes les r\u00e9unions de cette journ\u00e9e. EXISTS S\u00e9lectionnez tous les citoyens qui r\u00e9sident au Qu\u00e9bec. (Ce n'est pas tr\u00e8s optimal comme requ\u00eate mais c'est pour pratiquer le exists). S\u00e9lectionnez tous les citoyens qui n'ont jamais eu de r\u00e9alignement sanitaire. S\u00e9lectionnez tous les citoyens qui n'ont jamais particip\u00e9 \u00e0 aucun \u00e9v\u00e9nement. Faites une mise \u00e0 jour du code pin de tous les citoyens de la ville de Madrid. Remplacer le premier caract\u00e8re par un x. Vous pouvez vous servir de la fonction concat() et right() . La difficult\u00e9 ici est qu'on ne peut pas faire de update avec dans le where une sous-requ\u00eate sur la m\u00eame table. Faites une mise \u00e0 jour de la colonne score_ajustement de la table citoyen_evenement pour tous les \u00e9v\u00e9nement de type d\u00e9nonciation. La valeur de score_ajustement devra \u00eatre un nombre g\u00e9n\u00e9r\u00e9 al\u00e9atoirement entre 25 et 100. Proc\u00e9dures stock\u00e9es et fonctions Cr\u00e9ez une proc\u00e9dure stock\u00e9e qui va s\u00e9lectionner, pour un citoyen (le id du citoyen sera re\u00e7u en param\u00e8tre) donn\u00e9, le nombre de fois qu'il a particip\u00e9 \u00e0 chacun des types d'\u00e9v\u00e9nements. Le r\u00e9sultat devra comporter le id du citoyen, son nom et pr\u00e9nom, et une colonne par \u00e9v\u00e9nement (elles peuvent \u00eatre \"hardcod\u00e9\"). Cr\u00e9ez une fonction qui va valider le code PIN d'un citoyen. Le id du citoyen sera re\u00e7u en param\u00e8tre. La structure valide du code pin est AAAAAAAA-AAAA-AAAA-AAAA-AAAAAAAAAAAA (A = caract\u00e8re alphanum\u00e9rique). Utilisez la fonction REGEX pour valider le PIN. La valeur de retour doit \u00eatre TRUE si le pin est valide, sinon FALSE. Corrig\u00e9 Le corrig\u00e9 est ici","title":"Exercice 07 - Op\u00e9rateurs logiques"},{"location":"exercices/ex07/ex07_enonce/#exercices-07-operateurs-logiques","text":"\u00c0 partir de la base de donn\u00e9es credit_social , r\u00e9alisez les requ\u00eates suivantes. Vous devez utiliser l'op\u00e9rateur de la \"section\" dans votre solution.","title":"Exercices 07 - Op\u00e9rateurs logiques"},{"location":"exercices/ex07/ex07_enonce/#in","text":"S\u00e9lectionnez tous les citoyens qui habitent \u00e0 Minneapolis, Philadelphia ou Phoenix S\u00e9lectionnez tous les \u00e9v\u00e9nements qui sont de type Manifestation ou Idees dissidentes . S\u00e9lectionnez tous les \u00e9v\u00e9nements qui sont de type Manifestation et qui ont eu lieu durant les mois de mars , avril et mai , peu importe l'ann\u00e9e. \u00c0 l'aide d'une sous-requ\u00eate, s\u00e9lectionnez tous les citoyens qui n'ont jamais particip\u00e9 \u00e0 une r\u00e9union du parti. \u00c0 l'aide d'une sous-requ\u00eate, s\u00e9lectionnez tous les citoyens de classe Epsilon qui ont d\u00e9j\u00e0 particip\u00e9 \u00e0 une manifestation.","title":"IN"},{"location":"exercices/ex07/ex07_enonce/#like","text":"S\u00e9lectionnez tous les citoyens dont les initiales sont MF. S\u00e9lectionnez tous les citoyens dont le pr\u00e9nom est compos\u00e9 d'exactement 3 caract\u00e8res. S\u00e9lectionnez tous les citoyens qui ont la s\u00e9rie -6935- dans leur code PIN. S\u00e9lectionnez tous les citoyens qui ont particip\u00e9 \u00e0 un \u00e9v\u00e9nement et que dans la note de l'\u00e9v\u00e9nement on retrouve le mot math . S\u00e9lectionnez tous les citoyens dont le code PIN commence par deux caract\u00e8res, peut-importe lesquels, et ensuite contient les caract\u00e8res 6c4b66 . Le reste du code peut \u00eatre n'importe quoi.","title":"LIKE"},{"location":"exercices/ex07/ex07_enonce/#group-by","text":"Calculez le nombre de citoyen par classe. Affichez comme r\u00e9sultat le titre de la classe et le nombre de citoyen. Si la classe \u00e0 aucun citoyen, afficher 0; S\u00e9lectionnez les manifestations qui avait plus de 5 participants qui furent arr\u00eat\u00e9. (Une entr\u00e9e a \u00e9t\u00e9 cr\u00e9\u00e9 dans la table \u00e9v\u00e9nement). Calculer la moyenne des scores de cr\u00e9dit social pour chaque d\u00e9nonciation. S\u00e9lectionnez citoyen qui a le plus haut score de cr\u00e9dit social. Le r\u00e9sultat doit contenir son nom, pr\u00e9nom et score. N'utilisez pas de GROUP BY pour cette requ\u00eate , allez-y avec ce que vous voulez. Calculer la somme des scores de cr\u00e9dit social pour tous les participants de la r\u00e9union du parti du 2021-07-17. Il y a eu plusieurs r\u00e9unions cette journ\u00e9e, soit vous en cibler qu'un avec aussi l'heure ou bien vous faite la somme de toutes les r\u00e9unions de cette journ\u00e9e.","title":"GROUP BY"},{"location":"exercices/ex07/ex07_enonce/#exists","text":"S\u00e9lectionnez tous les citoyens qui r\u00e9sident au Qu\u00e9bec. (Ce n'est pas tr\u00e8s optimal comme requ\u00eate mais c'est pour pratiquer le exists). S\u00e9lectionnez tous les citoyens qui n'ont jamais eu de r\u00e9alignement sanitaire. S\u00e9lectionnez tous les citoyens qui n'ont jamais particip\u00e9 \u00e0 aucun \u00e9v\u00e9nement. Faites une mise \u00e0 jour du code pin de tous les citoyens de la ville de Madrid. Remplacer le premier caract\u00e8re par un x. Vous pouvez vous servir de la fonction concat() et right() . La difficult\u00e9 ici est qu'on ne peut pas faire de update avec dans le where une sous-requ\u00eate sur la m\u00eame table. Faites une mise \u00e0 jour de la colonne score_ajustement de la table citoyen_evenement pour tous les \u00e9v\u00e9nement de type d\u00e9nonciation. La valeur de score_ajustement devra \u00eatre un nombre g\u00e9n\u00e9r\u00e9 al\u00e9atoirement entre 25 et 100.","title":"EXISTS"},{"location":"exercices/ex07/ex07_enonce/#procedures-stockees-et-fonctions","text":"Cr\u00e9ez une proc\u00e9dure stock\u00e9e qui va s\u00e9lectionner, pour un citoyen (le id du citoyen sera re\u00e7u en param\u00e8tre) donn\u00e9, le nombre de fois qu'il a particip\u00e9 \u00e0 chacun des types d'\u00e9v\u00e9nements. Le r\u00e9sultat devra comporter le id du citoyen, son nom et pr\u00e9nom, et une colonne par \u00e9v\u00e9nement (elles peuvent \u00eatre \"hardcod\u00e9\"). Cr\u00e9ez une fonction qui va valider le code PIN d'un citoyen. Le id du citoyen sera re\u00e7u en param\u00e8tre. La structure valide du code pin est AAAAAAAA-AAAA-AAAA-AAAA-AAAAAAAAAAAA (A = caract\u00e8re alphanum\u00e9rique). Utilisez la fonction REGEX pour valider le PIN. La valeur de retour doit \u00eatre TRUE si le pin est valide, sinon FALSE.","title":"Proc\u00e9dures stock\u00e9es et fonctions"},{"location":"exercices/ex07/ex07_enonce/#corrige","text":"Le corrig\u00e9 est ici","title":"Corrig\u00e9"},{"location":"exercices/ex08/ex08_corrige/","text":"Exercice 08 - Exemple de programme Le programme est divis\u00e9 en deux fichiers, un premier pour l'affichage et les interactions avec l'utilisateur et un second qui s'occupe uniquement des op\u00e9rations avec la base de donn\u00e9es py_crud.py from db_citoyen import deleteCitoyen, getCitoyen, insertCitoyen, updateCitoyen import os # Permet d'effacer la console def cls(): os.system('cls' if os.name=='nt' else 'clear') def afficheTitre(texte): titre = '= {} ='.format(texte) ligne = '=' * len(titre) print(ligne + '\\n' + titre + '\\n' + ligne + '\\n') def retourMenu(): input(\"\\nAppuyez sur une touche pour revenir au menu...\") cls() # Affichage du menu et attente d'une option def menu(): choix = 0 afficheTitre('Cr\u00e9dit social') try: choix = int(input((\"\"\" Menu principal 1- Ajouter un nouveau citoyen 2- Obtenir les informations d'un citoyen 3- Modifier un citoyen 4- Supprimer un citoyen 5- Quitter Veuillez choisir une option : \"\"\"))) cls() except ValueError: print(\"\\nLe choix est invalide\") return choix # 1- Ajouter un nouveau citoyen def ajouteCitoyen(): afficheTitre('Ajouter un nouveau citoyen') print('\\nVeuillez nous donner les informations suivantes au sujet du nouveau citoyen') prenom = input('{0:14} : '.format('Pr\u00e9nom')) nom = input('{0:14} : '.format('Nom')) noCivique = input('{0:14} : '.format('Num\u00e9ro civique')) adresse = input('{0:14} : '.format('Adresse')) ville = input('{0:14} : '.format('Ville')) pin = input('{0:14} : '.format('PIN')) citoyenId = insertCitoyen(nom, prenom, noCivique, adresse, ville, pin) print('Le citoyen {} {} - id [{}] a \u00e9t\u00e9 ajout\u00e9 avec succ\u00e8s'.format(prenom, nom, citoyenId)) retourMenu() # 2- Obtenir les informations d'un citoyen def selectCitoyen(): afficheTitre('Obtenir les informations d\\'un citoyen') citoyen_id = input(\"Entrez le id du citoyen : \") resultat = getCitoyen(citoyen_id) if resultat is None: print(\"Le citoyen n'existe pas/plus\") else: nom, classe, score = resultat print('\\n> {} - Classe: {} - Score: {}\\n'.format(nom, classe, score)) retourMenu() # 3- Modifier un citoyen def modifieCitoyen(): afficheTitre('Modifier un citoyen') print('\\nVeuillez nous donner les informations suivantes au sujet du citoyen \u00e0 modifier') citoyen_id = input('{0:14} : '.format('Id du citoyen')) no_civique = input('{0:14} : '.format('Num\u00e9ro civique')) adresse = input('{0:14} : '.format('Adresse')) ville = input('{0:14} : '.format('Ville')) citoyen_update = updateCitoyen(citoyen_id, no_civique, adresse, ville) if(citoyen_update): print(\"Le citoyen [{0}] a \u00e9t\u00e9 modifi\u00e9.\".format(citoyen_id)) retourMenu() # 4- Supprimer un citoyen def supprimeCitoyen(): afficheTitre('Supprimer un citoyen') print('\\nVeuillez nous donner les informations suivantes au sujet du citoyen \u00e0 modifier') citoyen_id = input('{0:14} : '.format('Id du citoyen')) citoyen_delete = deleteCitoyen(citoyen_id) if(citoyen_delete): print(\"Le citoyen [{0}] a \u00e9t\u00e9 'pacifi\u00e9'.\".format(citoyen_id)) retourMenu() # Boucle principale cls() while True: choixMenu = menu() match choixMenu: case 1: ajouteCitoyen() case 2: selectCitoyen() case 3: modifieCitoyen() case 4: supprimeCitoyen() case 5: print(\"Goodbye!!\") break case _: cls() print(\"Choix invalide\") db_citoyen.py import mysql.connector as mysql db_config = { 'host' : 'localhost', 'user' : 'root', 'password' : '*******', 'database' : 'credit_social' } def insertCitoyen(nom: str, prenom: str, noCivique: int, adresse: str, ville: str, pin: str) -> int: \"\"\" Ajoute un citoyen Arguments: nom: un string prenom: un string noCivique: un integer adresse: un string ville: un string pin: un string Returns: Le id du citoyen cr\u00e9\u00e9 (integer) \"\"\" query = \"\"\" INSERT INTO citoyen (classe_id, nom, prenom, no_civique, adresse, ville, pin, credit_initial) VALUES (%(classe_id)s, %(nom)s, %(prenom)s, %(no_civique)s, %(adresse)s, %(ville)s, %(pin)s, %(credit_initial)s); \"\"\" parametre = { 'classe_id' : 4, 'nom' : nom, 'prenom' : prenom, 'no_civique' : noCivique, 'adresse' : adresse, 'ville' : ville, 'pin' : pin, 'credit_initial' : 500, } try: connection = mysql.connect(**db_config) cursor = connection.cursor() cursor.execute(query, parametre) citoyenId = cursor.lastrowid connection.commit() except mysql.Error as erreur: print(erreur) finally: cursor.close() connection.close() return citoyenId # S\u00e9lectionne le nom, la classe et le score d'un citoyen selon son id def getCitoyen(id): \"\"\" S\u00e9lectionne un citoyen Arguments: id: le id du citoyen (integer) Returns: Un tuple avec le nom, la classe et le score d'un citoyen \"\"\" query = \"\"\" select concat(c.prenom, ' ', c.nom) as nom, cl.titre as classe, calcul_credit(c.id) as score from citoyen c inner join classe cl on cl.id = c.classe_id where c.id = %(citoyen_id)s; \"\"\" parametres = { 'citoyen_id' : id } try: connection = mysql.connect(**db_config) cursor = connection.cursor() cursor.execute(query, parametres) result = cursor.fetchone() except mysql.Error as erreur: print(erreur) finally: cursor.close() connection.close() return result def updateCitoyen(id_citoyen: int, no_civique: int, adresse: str, ville: str)-> bool: \"\"\" Modifie un citoyen Arguments: id: le id du citoyen (integer) no_civique: un integer adresse: un string ville: un string Returns: True si la modification a fonctionn\u00e9 \"\"\" query = \"\"\" UPDATE citoyen SET no_civique = %(no_civique)s, adresse = %(adresse)s, ville = %(ville)s WHERE id = %(citoyen_id)s; \"\"\" parametre = { 'citoyen_id' : id_citoyen, 'no_civique' : no_civique, 'adresse' : adresse, 'ville' : ville, } citoyenUpdate = False try: connection = mysql.connect( host=\"localhost\", user=\"root\", password=\"r00t_bd2\", database=\"credit_social\" ) cursor = connection.cursor() cursor.execute(query, parametre) connection.commit() citoyenUpdate = True except mysql.Error as erreur: print(erreur) finally: cursor.close() connection.close() return citoyenUpdate def deleteCitoyen(citoyen_id: int)->bool: \"\"\" Supprime un citoyen Arguments: id: le id du citoyen (integer) Returns: True si la modification a fonctionn\u00e9 \"\"\" citoyenDelete = False query_citoyen_evenement = \"DELETE FROM citoyen_evenement WHERE citoyen_id = %(citoyen_id)s\" query_citoyen = \"DELETE FROM citoyen WHERE id = %(citoyen_id)s\" parametres = {'citoyen_id' : citoyen_id} try: connection = mysql.connect(**db_config) cursor = connection.cursor() cursor.execute(query_citoyen_evenement, parametres) cursor.execute(query_citoyen, parametres) connection.commit() citoyenDelete = True except mysql.Error as erreur: print(erreur) finally: cursor.close() connection.close() return citoyenDelete","title":"Exercice 08 - Exemple de programme"},{"location":"exercices/ex08/ex08_corrige/#exercice-08-exemple-de-programme","text":"Le programme est divis\u00e9 en deux fichiers, un premier pour l'affichage et les interactions avec l'utilisateur et un second qui s'occupe uniquement des op\u00e9rations avec la base de donn\u00e9es py_crud.py from db_citoyen import deleteCitoyen, getCitoyen, insertCitoyen, updateCitoyen import os # Permet d'effacer la console def cls(): os.system('cls' if os.name=='nt' else 'clear') def afficheTitre(texte): titre = '= {} ='.format(texte) ligne = '=' * len(titre) print(ligne + '\\n' + titre + '\\n' + ligne + '\\n') def retourMenu(): input(\"\\nAppuyez sur une touche pour revenir au menu...\") cls() # Affichage du menu et attente d'une option def menu(): choix = 0 afficheTitre('Cr\u00e9dit social') try: choix = int(input((\"\"\" Menu principal 1- Ajouter un nouveau citoyen 2- Obtenir les informations d'un citoyen 3- Modifier un citoyen 4- Supprimer un citoyen 5- Quitter Veuillez choisir une option : \"\"\"))) cls() except ValueError: print(\"\\nLe choix est invalide\") return choix # 1- Ajouter un nouveau citoyen def ajouteCitoyen(): afficheTitre('Ajouter un nouveau citoyen') print('\\nVeuillez nous donner les informations suivantes au sujet du nouveau citoyen') prenom = input('{0:14} : '.format('Pr\u00e9nom')) nom = input('{0:14} : '.format('Nom')) noCivique = input('{0:14} : '.format('Num\u00e9ro civique')) adresse = input('{0:14} : '.format('Adresse')) ville = input('{0:14} : '.format('Ville')) pin = input('{0:14} : '.format('PIN')) citoyenId = insertCitoyen(nom, prenom, noCivique, adresse, ville, pin) print('Le citoyen {} {} - id [{}] a \u00e9t\u00e9 ajout\u00e9 avec succ\u00e8s'.format(prenom, nom, citoyenId)) retourMenu() # 2- Obtenir les informations d'un citoyen def selectCitoyen(): afficheTitre('Obtenir les informations d\\'un citoyen') citoyen_id = input(\"Entrez le id du citoyen : \") resultat = getCitoyen(citoyen_id) if resultat is None: print(\"Le citoyen n'existe pas/plus\") else: nom, classe, score = resultat print('\\n> {} - Classe: {} - Score: {}\\n'.format(nom, classe, score)) retourMenu() # 3- Modifier un citoyen def modifieCitoyen(): afficheTitre('Modifier un citoyen') print('\\nVeuillez nous donner les informations suivantes au sujet du citoyen \u00e0 modifier') citoyen_id = input('{0:14} : '.format('Id du citoyen')) no_civique = input('{0:14} : '.format('Num\u00e9ro civique')) adresse = input('{0:14} : '.format('Adresse')) ville = input('{0:14} : '.format('Ville')) citoyen_update = updateCitoyen(citoyen_id, no_civique, adresse, ville) if(citoyen_update): print(\"Le citoyen [{0}] a \u00e9t\u00e9 modifi\u00e9.\".format(citoyen_id)) retourMenu() # 4- Supprimer un citoyen def supprimeCitoyen(): afficheTitre('Supprimer un citoyen') print('\\nVeuillez nous donner les informations suivantes au sujet du citoyen \u00e0 modifier') citoyen_id = input('{0:14} : '.format('Id du citoyen')) citoyen_delete = deleteCitoyen(citoyen_id) if(citoyen_delete): print(\"Le citoyen [{0}] a \u00e9t\u00e9 'pacifi\u00e9'.\".format(citoyen_id)) retourMenu() # Boucle principale cls() while True: choixMenu = menu() match choixMenu: case 1: ajouteCitoyen() case 2: selectCitoyen() case 3: modifieCitoyen() case 4: supprimeCitoyen() case 5: print(\"Goodbye!!\") break case _: cls() print(\"Choix invalide\") db_citoyen.py import mysql.connector as mysql db_config = { 'host' : 'localhost', 'user' : 'root', 'password' : '*******', 'database' : 'credit_social' } def insertCitoyen(nom: str, prenom: str, noCivique: int, adresse: str, ville: str, pin: str) -> int: \"\"\" Ajoute un citoyen Arguments: nom: un string prenom: un string noCivique: un integer adresse: un string ville: un string pin: un string Returns: Le id du citoyen cr\u00e9\u00e9 (integer) \"\"\" query = \"\"\" INSERT INTO citoyen (classe_id, nom, prenom, no_civique, adresse, ville, pin, credit_initial) VALUES (%(classe_id)s, %(nom)s, %(prenom)s, %(no_civique)s, %(adresse)s, %(ville)s, %(pin)s, %(credit_initial)s); \"\"\" parametre = { 'classe_id' : 4, 'nom' : nom, 'prenom' : prenom, 'no_civique' : noCivique, 'adresse' : adresse, 'ville' : ville, 'pin' : pin, 'credit_initial' : 500, } try: connection = mysql.connect(**db_config) cursor = connection.cursor() cursor.execute(query, parametre) citoyenId = cursor.lastrowid connection.commit() except mysql.Error as erreur: print(erreur) finally: cursor.close() connection.close() return citoyenId # S\u00e9lectionne le nom, la classe et le score d'un citoyen selon son id def getCitoyen(id): \"\"\" S\u00e9lectionne un citoyen Arguments: id: le id du citoyen (integer) Returns: Un tuple avec le nom, la classe et le score d'un citoyen \"\"\" query = \"\"\" select concat(c.prenom, ' ', c.nom) as nom, cl.titre as classe, calcul_credit(c.id) as score from citoyen c inner join classe cl on cl.id = c.classe_id where c.id = %(citoyen_id)s; \"\"\" parametres = { 'citoyen_id' : id } try: connection = mysql.connect(**db_config) cursor = connection.cursor() cursor.execute(query, parametres) result = cursor.fetchone() except mysql.Error as erreur: print(erreur) finally: cursor.close() connection.close() return result def updateCitoyen(id_citoyen: int, no_civique: int, adresse: str, ville: str)-> bool: \"\"\" Modifie un citoyen Arguments: id: le id du citoyen (integer) no_civique: un integer adresse: un string ville: un string Returns: True si la modification a fonctionn\u00e9 \"\"\" query = \"\"\" UPDATE citoyen SET no_civique = %(no_civique)s, adresse = %(adresse)s, ville = %(ville)s WHERE id = %(citoyen_id)s; \"\"\" parametre = { 'citoyen_id' : id_citoyen, 'no_civique' : no_civique, 'adresse' : adresse, 'ville' : ville, } citoyenUpdate = False try: connection = mysql.connect( host=\"localhost\", user=\"root\", password=\"r00t_bd2\", database=\"credit_social\" ) cursor = connection.cursor() cursor.execute(query, parametre) connection.commit() citoyenUpdate = True except mysql.Error as erreur: print(erreur) finally: cursor.close() connection.close() return citoyenUpdate def deleteCitoyen(citoyen_id: int)->bool: \"\"\" Supprime un citoyen Arguments: id: le id du citoyen (integer) Returns: True si la modification a fonctionn\u00e9 \"\"\" citoyenDelete = False query_citoyen_evenement = \"DELETE FROM citoyen_evenement WHERE citoyen_id = %(citoyen_id)s\" query_citoyen = \"DELETE FROM citoyen WHERE id = %(citoyen_id)s\" parametres = {'citoyen_id' : citoyen_id} try: connection = mysql.connect(**db_config) cursor = connection.cursor() cursor.execute(query_citoyen_evenement, parametres) cursor.execute(query_citoyen, parametres) connection.commit() citoyenDelete = True except mysql.Error as erreur: print(erreur) finally: cursor.close() connection.close() return citoyenDelete","title":"Exercice 08 - Exemple de programme"},{"location":"exercices/ex08/ex08_corrige_delete/","text":"Supprimer un citoyen Fonction pour saisir le id du citoyen \u00e0 supprimer # 4- Supprimer un citoyen def supprimeCitoyen(): print('Supprimer un citoyen') print('\\nVeuillez nous donner les informations suivantes au sujet du citoyen \u00e0 modifier') citoyen_id = input('{0:14} : '.format('Id du citoyen')) citoyen_delete = deleteCitoyen(citoyen_id) if(citoyen_delete): print(\"Le citoyen [{0}] a \u00e9t\u00e9 'pacifi\u00e9'.\".format(citoyen_id)) Fonction qui supprimer un citoyen dans la base de donn\u00e9es et retourne True si la suppression a \u00e9t\u00e9 faite def deleteCitoyen(citoyen_id: int)->bool: \"\"\" Supprime un citoyen Arguments: id: le id du citoyen (integer) Returns: True si la modification a fonctionn\u00e9 \"\"\" citoyenDelete = False query_citoyen_evenement = \"DELETE FROM citoyen_evenement WHERE citoyen_id = %(citoyen_id)s\" query_citoyen = \"DELETE FROM citoyen WHERE id = %(citoyen_id)s\" parametres = {'citoyen_id' : citoyen_id} try: connection = mysql.connect(**db_config) cursor = connection.cursor() cursor.execute(query_citoyen_evenement, parametres) cursor.execute(query_citoyen, parametres) connection.commit() citoyenDelete = True except mysql.Error as erreur: print(erreur) finally: cursor.close() connection.close() return citoyenDelete","title":"Supprimer un citoyen"},{"location":"exercices/ex08/ex08_corrige_delete/#supprimer-un-citoyen","text":"Fonction pour saisir le id du citoyen \u00e0 supprimer # 4- Supprimer un citoyen def supprimeCitoyen(): print('Supprimer un citoyen') print('\\nVeuillez nous donner les informations suivantes au sujet du citoyen \u00e0 modifier') citoyen_id = input('{0:14} : '.format('Id du citoyen')) citoyen_delete = deleteCitoyen(citoyen_id) if(citoyen_delete): print(\"Le citoyen [{0}] a \u00e9t\u00e9 'pacifi\u00e9'.\".format(citoyen_id)) Fonction qui supprimer un citoyen dans la base de donn\u00e9es et retourne True si la suppression a \u00e9t\u00e9 faite def deleteCitoyen(citoyen_id: int)->bool: \"\"\" Supprime un citoyen Arguments: id: le id du citoyen (integer) Returns: True si la modification a fonctionn\u00e9 \"\"\" citoyenDelete = False query_citoyen_evenement = \"DELETE FROM citoyen_evenement WHERE citoyen_id = %(citoyen_id)s\" query_citoyen = \"DELETE FROM citoyen WHERE id = %(citoyen_id)s\" parametres = {'citoyen_id' : citoyen_id} try: connection = mysql.connect(**db_config) cursor = connection.cursor() cursor.execute(query_citoyen_evenement, parametres) cursor.execute(query_citoyen, parametres) connection.commit() citoyenDelete = True except mysql.Error as erreur: print(erreur) finally: cursor.close() connection.close() return citoyenDelete","title":"Supprimer un citoyen"},{"location":"exercices/ex08/ex08_corrige_insert/","text":"Ajouter un citoyen Fonction pour saisir les informations et afficher le r\u00e9sultat # 1- Ajouter un nouveau citoyen def ajouteCitoyen(): print('Ajouter un nouveau citoyen') print('\\nVeuillez nous donner les informations suivantes au sujet du nouveau citoyen') prenom = input('{0:14} : '.format('Pr\u00e9nom')) nom = input('{0:14} : '.format('Nom')) noCivique = input('{0:14} : '.format('Num\u00e9ro civique')) adresse = input('{0:14} : '.format('Adresse')) ville = input('{0:14} : '.format('Ville')) pin = input('{0:14} : '.format('PIN')) citoyenId = insertCitoyen(nom, prenom, noCivique, adresse, ville, pin) print('Le citoyen {} {} - id [{}] a \u00e9t\u00e9 ajout\u00e9 avec succ\u00e8s'.format(prenom, nom, citoyenId)) Fonction qui ins\u00e8re le citoyen dans la bd et retourne son id def insertCitoyen(nom: str, prenom: str, noCivique: int, adresse: str, ville: str, pin: str) -> int: \"\"\" Ajoute un citoyen Arguments: nom: un string prenom: un string noCivique: un integer adresse: un string ville: un string pin: un string Returns: Le id du citoyen cr\u00e9\u00e9 (integer) \"\"\" db_config = { 'host' : 'localhost', 'user' : 'root', 'password' : 'r00t_bd2', 'database' : 'credit_social' } query = \"\"\" INSERT INTO citoyen (classe_id, nom, prenom, no_civique, adresse, ville, pin, credit_initial) VALUES (%(classe_id)s, %(nom)s, %(prenom)s, %(no_civique)s, %(adresse)s, %(ville)s, %(pin)s, %(credit_initial)s); \"\"\" parametre = { 'classe_id' : 4, 'nom' : nom, 'prenom' : prenom, 'no_civique' : noCivique, 'adresse' : adresse, 'ville' : ville, 'pin' : pin, 'credit_initial' : 500, } try: connection = mysql.connect(**db_config) cursor = connection.cursor() cursor.execute(query, parametre) citoyenId = cursor.lastrowid connection.commit() except mysql.Error as erreur: print(erreur) finally: cursor.close() connection.close() return citoyenId","title":"Ajouter un citoyen"},{"location":"exercices/ex08/ex08_corrige_insert/#ajouter-un-citoyen","text":"Fonction pour saisir les informations et afficher le r\u00e9sultat # 1- Ajouter un nouveau citoyen def ajouteCitoyen(): print('Ajouter un nouveau citoyen') print('\\nVeuillez nous donner les informations suivantes au sujet du nouveau citoyen') prenom = input('{0:14} : '.format('Pr\u00e9nom')) nom = input('{0:14} : '.format('Nom')) noCivique = input('{0:14} : '.format('Num\u00e9ro civique')) adresse = input('{0:14} : '.format('Adresse')) ville = input('{0:14} : '.format('Ville')) pin = input('{0:14} : '.format('PIN')) citoyenId = insertCitoyen(nom, prenom, noCivique, adresse, ville, pin) print('Le citoyen {} {} - id [{}] a \u00e9t\u00e9 ajout\u00e9 avec succ\u00e8s'.format(prenom, nom, citoyenId)) Fonction qui ins\u00e8re le citoyen dans la bd et retourne son id def insertCitoyen(nom: str, prenom: str, noCivique: int, adresse: str, ville: str, pin: str) -> int: \"\"\" Ajoute un citoyen Arguments: nom: un string prenom: un string noCivique: un integer adresse: un string ville: un string pin: un string Returns: Le id du citoyen cr\u00e9\u00e9 (integer) \"\"\" db_config = { 'host' : 'localhost', 'user' : 'root', 'password' : 'r00t_bd2', 'database' : 'credit_social' } query = \"\"\" INSERT INTO citoyen (classe_id, nom, prenom, no_civique, adresse, ville, pin, credit_initial) VALUES (%(classe_id)s, %(nom)s, %(prenom)s, %(no_civique)s, %(adresse)s, %(ville)s, %(pin)s, %(credit_initial)s); \"\"\" parametre = { 'classe_id' : 4, 'nom' : nom, 'prenom' : prenom, 'no_civique' : noCivique, 'adresse' : adresse, 'ville' : ville, 'pin' : pin, 'credit_initial' : 500, } try: connection = mysql.connect(**db_config) cursor = connection.cursor() cursor.execute(query, parametre) citoyenId = cursor.lastrowid connection.commit() except mysql.Error as erreur: print(erreur) finally: cursor.close() connection.close() return citoyenId","title":"Ajouter un citoyen"},{"location":"exercices/ex08/ex08_corrige_select/","text":"S\u00e9lectionner un citoyen Fonction pour saisir le id du citoyen et afficher le r\u00e9sultat # 2- Obtenir les informations d'un citoyen def selectCitoyen(): print('Obtenir les informations d\\'un citoyen') citoyen_id = input(\"Entrez le id du citoyen : \") resultat = getCitoyen(citoyen_id) if resultat is None: print(\"Le citoyen n'existe pas/plus\") else: nom, classe, score = resultat print('\\n> {} - Classe: {} - Score: {}\\n'.format(nom, classe, score)) Fonction qui s\u00e9lectionne le citoyen dans la base de donn\u00e9es selon son id et retourne son nom, sa classe et son score de cr\u00e9dit social. def getCitoyen(id): \"\"\" S\u00e9lectionne un citoyen Arguments: id: le id du citoyen (integer) Returns: Un tuple avec le nom, la classe et le score d'un citoyen \"\"\" db_config = { 'host' : 'localhost', 'user' : 'root', 'password' : 'r00t_bd2', 'database' : 'credit_social' } query = \"\"\" select concat(c.prenom, ' ', c.nom) as nom, cl.titre as classe, calcul_credit(c.id) as score from citoyen c inner join classe cl on cl.id = c.classe_id where c.id = %(citoyen_id)s; \"\"\" parametres = { 'citoyen_id' : id } try: connection = mysql.connect(**db_config) cursor = connection.cursor() cursor.execute(query, parametres) result = cursor.fetchone() except mysql.Error as erreur: print(erreur) finally: cursor.close() connection.close() return result","title":"S\u00e9lectionner un citoyen"},{"location":"exercices/ex08/ex08_corrige_select/#selectionner-un-citoyen","text":"Fonction pour saisir le id du citoyen et afficher le r\u00e9sultat # 2- Obtenir les informations d'un citoyen def selectCitoyen(): print('Obtenir les informations d\\'un citoyen') citoyen_id = input(\"Entrez le id du citoyen : \") resultat = getCitoyen(citoyen_id) if resultat is None: print(\"Le citoyen n'existe pas/plus\") else: nom, classe, score = resultat print('\\n> {} - Classe: {} - Score: {}\\n'.format(nom, classe, score)) Fonction qui s\u00e9lectionne le citoyen dans la base de donn\u00e9es selon son id et retourne son nom, sa classe et son score de cr\u00e9dit social. def getCitoyen(id): \"\"\" S\u00e9lectionne un citoyen Arguments: id: le id du citoyen (integer) Returns: Un tuple avec le nom, la classe et le score d'un citoyen \"\"\" db_config = { 'host' : 'localhost', 'user' : 'root', 'password' : 'r00t_bd2', 'database' : 'credit_social' } query = \"\"\" select concat(c.prenom, ' ', c.nom) as nom, cl.titre as classe, calcul_credit(c.id) as score from citoyen c inner join classe cl on cl.id = c.classe_id where c.id = %(citoyen_id)s; \"\"\" parametres = { 'citoyen_id' : id } try: connection = mysql.connect(**db_config) cursor = connection.cursor() cursor.execute(query, parametres) result = cursor.fetchone() except mysql.Error as erreur: print(erreur) finally: cursor.close() connection.close() return result","title":"S\u00e9lectionner un citoyen"},{"location":"exercices/ex08/ex08_corrige_update/","text":"Modifier les informations d'un citoyen Fonctions pour saisir les informations \u00e0 modifier # 3- Modifier un citoyen def modifieCitoyen(): print('Modifier un citoyen') print('\\nVeuillez nous donner les informations suivantes au sujet du citoyen \u00e0 modifier') citoyen_id = input('{0:14} : '.format('Id du citoyen')) no_civique = input('{0:14} : '.format('Num\u00e9ro civique')) adresse = input('{0:14} : '.format('Adresse')) ville = input('{0:14} : '.format('Ville')) citoyen_update = updateCitoyen(citoyen_id, no_civique, adresse, ville) if(citoyen_update): print(\"Le citoyen [{0}] a \u00e9t\u00e9 modifi\u00e9.\".format(citoyen_id)) Fonction qui modifie les informations du citoyen dans la base de donn\u00e9es et retourne True si la modification a \u00e9t\u00e9 effectu\u00e9. def updateCitoyen(id_citoyen: int, no_civique: int, adresse: str, ville: str)-> bool: \"\"\" Modifie un citoyen Arguments: id: le id du citoyen (integer) no_civique: un integer adresse: un string ville: un string Returns: True si la modification a fonctionn\u00e9 \"\"\" db_config = { 'host' : 'localhost', 'user' : 'root', 'password' : 'r00t_bd2', 'database' : 'credit_social' } query = \"\"\" UPDATE citoyen SET no_civique = %(no_civique)s, adresse = %(adresse)s, ville = %(ville)s WHERE id = %(citoyen_id)s; \"\"\" parametre = { 'citoyen_id' : id_citoyen, 'no_civique' : no_civique, 'adresse' : adresse, 'ville' : ville, } citoyenUpdate = False try: connection = mysql.connect( host=\"localhost\", user=\"root\", password=\"r00t_bd2\", database=\"credit_social\" ) cursor = connection.cursor() cursor.execute(query, parametre) connection.commit() citoyenUpdate = True except mysql.Error as erreur: print(erreur) finally: cursor.close() connection.close() return citoyenUpdate","title":"Modifier les informations d'un citoyen"},{"location":"exercices/ex08/ex08_corrige_update/#modifier-les-informations-dun-citoyen","text":"Fonctions pour saisir les informations \u00e0 modifier # 3- Modifier un citoyen def modifieCitoyen(): print('Modifier un citoyen') print('\\nVeuillez nous donner les informations suivantes au sujet du citoyen \u00e0 modifier') citoyen_id = input('{0:14} : '.format('Id du citoyen')) no_civique = input('{0:14} : '.format('Num\u00e9ro civique')) adresse = input('{0:14} : '.format('Adresse')) ville = input('{0:14} : '.format('Ville')) citoyen_update = updateCitoyen(citoyen_id, no_civique, adresse, ville) if(citoyen_update): print(\"Le citoyen [{0}] a \u00e9t\u00e9 modifi\u00e9.\".format(citoyen_id)) Fonction qui modifie les informations du citoyen dans la base de donn\u00e9es et retourne True si la modification a \u00e9t\u00e9 effectu\u00e9. def updateCitoyen(id_citoyen: int, no_civique: int, adresse: str, ville: str)-> bool: \"\"\" Modifie un citoyen Arguments: id: le id du citoyen (integer) no_civique: un integer adresse: un string ville: un string Returns: True si la modification a fonctionn\u00e9 \"\"\" db_config = { 'host' : 'localhost', 'user' : 'root', 'password' : 'r00t_bd2', 'database' : 'credit_social' } query = \"\"\" UPDATE citoyen SET no_civique = %(no_civique)s, adresse = %(adresse)s, ville = %(ville)s WHERE id = %(citoyen_id)s; \"\"\" parametre = { 'citoyen_id' : id_citoyen, 'no_civique' : no_civique, 'adresse' : adresse, 'ville' : ville, } citoyenUpdate = False try: connection = mysql.connect( host=\"localhost\", user=\"root\", password=\"r00t_bd2\", database=\"credit_social\" ) cursor = connection.cursor() cursor.execute(query, parametre) connection.commit() citoyenUpdate = True except mysql.Error as erreur: print(erreur) finally: cursor.close() connection.close() return citoyenUpdate","title":"Modifier les informations d'un citoyen"},{"location":"exercices/ex08/ex08_enonce/","text":"Exercice 08 - pyCRUD Comme premier exercice avec Python, on va cr\u00e9er une application console simple qui va couvrir sommairement les op\u00e9ration CRUD. Nous allons utiliser la base de donn\u00e9es credit_social. Je vous laisse aller pour l'apprentissage de Python et des notions dont vous allez avoir besoin (afficher \u00e0 l'\u00e9cran, lire une saisie clavier, boucle, fonction, module?). Installation de python est des librairies T\u00e9l\u00e9chargez la derni\u00e8re version de Python \u00e0 l'adresse suivante : https://www.python.org/downloads/ Installez le connecteur mySQL pour Python : https://dev.mysql.com/downloads/connector/python/ en le t\u00e9l\u00e9chargeant En ligne de commande avec pip (probablement install\u00e9 avec Python) bash python -m pip install mysql-connector-python Cr\u00e9ation du menu Au lancement du programme, un menu s'affichera avec les options suivantes : Ajouter un nouveau citoyen Obtenir les informations d'un citoyen Modifier un citoyen Supprimer un citoyen Quitter Exemple de menu Options du menu 1. Ajouter un citoyen Demander de la fa\u00e7on que vous voulez les informations suivantes sur le citoyen \u00e0 ajouter : nom pr\u00e9nom no_civique adresse ville pin Les champs classe_id et credit_initial seront \"forc\u00e9\" \u00e0 respectivement 4 et 500. Une fois l'ajout fait, afficher un message de confirmation et revenez au menu principal. 2. Obtenir les informations d'un citoyen Demander \u00e0 l'usager de saisir le id du citoyen. Afficher ensuite les informations suivantes : Pr\u00e9nom et nom Classe Score de cr\u00e9dit social Ensuite revenez au menu principal. 3. Modifier un citoyen Permettre en saisissant le id d'un citoyen de modifier son adresse ( no_civique, adresse, ville). Afficher un message de confirmation et revenez au menu principal. 4. Supprimer un citoyen Supprimer un citoyen de la base de donn\u00e9es avec son id. Attention pr\u00e9sentement dans la base de donn\u00e9es il n'y a aucune cl\u00e9s \u00e9trang\u00e8res entre les tables citoyen, citoyen_evenement et evenement. On peut donc supprimer un citoyen sans supprimer les \u00e9v\u00e8nements auxquelles il a particip\u00e9. Il faudrait s'assurer qu'en supprimant un citoyen, ses \u00e9v\u00e8nements soient aussi supprim\u00e9. \u00c0 vous de choisir l'approche que vous voulez (Le faire dans la requ\u00eate suppression, supprimer en cascade depuis une cl\u00e9 \u00e9trang\u00e8re, etc.) 5. Quitter On quitte la boucle et le programme. Exemple de connexion \u00e0 mySQL import mysql.connector # Cr\u00e9ation de la connexion \u00e0 la bd mydb = mysql.connector.connect( host=\"localhost\", user=\"root\", password=\"r00t_bd2\", database=\"formatif_intra_01\" ) # Cr\u00e9ation d'un curseur mycursor = mydb.cursor() # Dans notre requ\u00eate on remplace tous les param\u00eatres par des %s requete = \"SELECT id, titre FROM profession WHERE id = %s\" # Ensuite on cr\u00e9e un tuple avec les valeurs des param\u00eatres parametres = (8,) # Dans le execute on passe en param\u00eatres la requ\u00eate et ensuite les param\u00eatres mycursor.execute(requete, parametres) # Le curseur r\u00e9cup\u00e8re toutes les donn\u00e9es du r\u00e9sultat de la requ\u00eate myresult = mycursor.fetchall() print('\\nListe des professions') # Boucle sur les r\u00e9sultats de la requ\u00eate, en attribuant la valeur des champs # id et titre \u00e0 des variables du m\u00eame nom for (id, titre) in myresult: print('{} - {}'.format(id, titre)) Ressources https://dev.mysql.com/doc/connector-python/en/ https://www.w3schools.com/python/python_mysql_getstarted.asp Corrig\u00e9 Ajouter un nouveau citoyen Obtenir les informations d'un citoyen Modifier un citoyen Supprimer un citoyen Le programme en entier","title":"Exercice 08 - pyCRUD"},{"location":"exercices/ex08/ex08_enonce/#exercice-08-pycrud","text":"Comme premier exercice avec Python, on va cr\u00e9er une application console simple qui va couvrir sommairement les op\u00e9ration CRUD. Nous allons utiliser la base de donn\u00e9es credit_social. Je vous laisse aller pour l'apprentissage de Python et des notions dont vous allez avoir besoin (afficher \u00e0 l'\u00e9cran, lire une saisie clavier, boucle, fonction, module?).","title":"Exercice 08 - pyCRUD"},{"location":"exercices/ex08/ex08_enonce/#installation-de-python-est-des-librairies","text":"T\u00e9l\u00e9chargez la derni\u00e8re version de Python \u00e0 l'adresse suivante : https://www.python.org/downloads/ Installez le connecteur mySQL pour Python : https://dev.mysql.com/downloads/connector/python/ en le t\u00e9l\u00e9chargeant En ligne de commande avec pip (probablement install\u00e9 avec Python) bash python -m pip install mysql-connector-python","title":"Installation de python est des librairies"},{"location":"exercices/ex08/ex08_enonce/#creation-du-menu","text":"Au lancement du programme, un menu s'affichera avec les options suivantes : Ajouter un nouveau citoyen Obtenir les informations d'un citoyen Modifier un citoyen Supprimer un citoyen Quitter Exemple de menu","title":"Cr\u00e9ation du menu"},{"location":"exercices/ex08/ex08_enonce/#options-du-menu","text":"","title":"Options du menu"},{"location":"exercices/ex08/ex08_enonce/#1-ajouter-un-citoyen","text":"Demander de la fa\u00e7on que vous voulez les informations suivantes sur le citoyen \u00e0 ajouter : nom pr\u00e9nom no_civique adresse ville pin Les champs classe_id et credit_initial seront \"forc\u00e9\" \u00e0 respectivement 4 et 500. Une fois l'ajout fait, afficher un message de confirmation et revenez au menu principal.","title":"1. Ajouter un citoyen"},{"location":"exercices/ex08/ex08_enonce/#2-obtenir-les-informations-dun-citoyen","text":"Demander \u00e0 l'usager de saisir le id du citoyen. Afficher ensuite les informations suivantes : Pr\u00e9nom et nom Classe Score de cr\u00e9dit social Ensuite revenez au menu principal.","title":"2. Obtenir les informations d'un citoyen"},{"location":"exercices/ex08/ex08_enonce/#3-modifier-un-citoyen","text":"Permettre en saisissant le id d'un citoyen de modifier son adresse ( no_civique, adresse, ville). Afficher un message de confirmation et revenez au menu principal.","title":"3. Modifier un citoyen"},{"location":"exercices/ex08/ex08_enonce/#4-supprimer-un-citoyen","text":"Supprimer un citoyen de la base de donn\u00e9es avec son id. Attention pr\u00e9sentement dans la base de donn\u00e9es il n'y a aucune cl\u00e9s \u00e9trang\u00e8res entre les tables citoyen, citoyen_evenement et evenement. On peut donc supprimer un citoyen sans supprimer les \u00e9v\u00e8nements auxquelles il a particip\u00e9. Il faudrait s'assurer qu'en supprimant un citoyen, ses \u00e9v\u00e8nements soient aussi supprim\u00e9. \u00c0 vous de choisir l'approche que vous voulez (Le faire dans la requ\u00eate suppression, supprimer en cascade depuis une cl\u00e9 \u00e9trang\u00e8re, etc.)","title":"4. Supprimer un citoyen"},{"location":"exercices/ex08/ex08_enonce/#5-quitter","text":"On quitte la boucle et le programme.","title":"5. Quitter"},{"location":"exercices/ex08/ex08_enonce/#exemple-de-connexion-a-mysql","text":"import mysql.connector # Cr\u00e9ation de la connexion \u00e0 la bd mydb = mysql.connector.connect( host=\"localhost\", user=\"root\", password=\"r00t_bd2\", database=\"formatif_intra_01\" ) # Cr\u00e9ation d'un curseur mycursor = mydb.cursor() # Dans notre requ\u00eate on remplace tous les param\u00eatres par des %s requete = \"SELECT id, titre FROM profession WHERE id = %s\" # Ensuite on cr\u00e9e un tuple avec les valeurs des param\u00eatres parametres = (8,) # Dans le execute on passe en param\u00eatres la requ\u00eate et ensuite les param\u00eatres mycursor.execute(requete, parametres) # Le curseur r\u00e9cup\u00e8re toutes les donn\u00e9es du r\u00e9sultat de la requ\u00eate myresult = mycursor.fetchall() print('\\nListe des professions') # Boucle sur les r\u00e9sultats de la requ\u00eate, en attribuant la valeur des champs # id et titre \u00e0 des variables du m\u00eame nom for (id, titre) in myresult: print('{} - {}'.format(id, titre))","title":"Exemple de connexion \u00e0 mySQL"},{"location":"exercices/ex08/ex08_enonce/#ressources","text":"https://dev.mysql.com/doc/connector-python/en/ https://www.w3schools.com/python/python_mysql_getstarted.asp","title":"Ressources"},{"location":"exercices/ex08/ex08_enonce/#corrige","text":"Ajouter un nouveau citoyen Obtenir les informations d'un citoyen Modifier un citoyen Supprimer un citoyen Le programme en entier","title":"Corrig\u00e9"},{"location":"exercices/ex09/ex09_enonce/","text":"Exercice 09 - pyQt5 \u00c0 l'aide de la librairie pyQT5 et de la base de donn\u00e9es credit_social, cr\u00e9ez une interface graphique qui permettra de saisir un id de citoyen et de retourner son nom. Installation de pyQT5 pip install PyQt5 Documentation : https://pypi.org/project/PyQt5/ R\u00e9sultat On entre un id dans le textBox. En cliquant sur rechercher, on effectue une requ\u00eate \u00e0 la base de donn\u00e9es. On affiche le nom du citoyen sous le bouton. Exemple de code L'exemple de code suivant va afficher une fen\u00eatre vide. # Pour pouvoir passer des arguments \u00e0 notre application import sys # Les librairies PyQT5 from PyQt5.QtCore import * from PyQt5.QtWidgets import * from PyQt5.QtGui import * class MainWindow(QMainWindow): def __init__(self): super(MainWindow, self).__init__() self.setWindowTitle(\"Oh la belle fen\u00eatre vide\") # Une instance de QApplication, on doit en avoir absolument # une et seulement une par application app = QApplication(sys.argv) # Cr\u00e9ation de notre fen\u00eatre principale en appelant la fonction # MainWindow appel\u00e9 plus haut window = MainWindow() # Tr\u00e8s important de l'afficher car par d\u00e9faut elle est masqu\u00e9. window.show() # D\u00e9marre la boucle d'\u00e9v\u00e8nement. L'application va s'afficher. app.exec() Exemple d'un classe MainWindows avec un bouton et un champ texte. Il y a un \u00e9v\u00e9nement sur le bouton pour appeler une fonction quand on le clique. class MainWindows(QMainWindow): def __init__(self): super().__init__() self.setWindowTitle(\"Mon App\") self.setFixedSize(QSize(300, 300)) # On cr\u00e9e un widget qui va contenir les autres et on # d\u00e9fini le type de layout \u00e0 utiliser layout = QGridLayout() # On cr\u00e9e un bouton avec le texte rechercher bouton = QPushButton('Rechercher') # On ajoute le bouton au widget layout # \u00e0 la position 2,0 (troisi\u00e8me ligne, premi\u00e8re colonne) layout.addWidget(bouton, 2, 0) # On cr\u00e9e un widget label self.resultat = QLabel('-') # Formatage du texte self.resultat.setAlignment(Qt.AlignCenter) font = self.resultat.font() font.setPointSize(12) self.resultat.setFont(font) self.resultat.setFixedHeight(100) # On ajoute le label dans le layout layout.addWidget(self.resultat, 3, 0) # On associe l'\u00e9v\u00e9nement clic du bouton \u00e0 la fonction # afficher_nom bouton.clicked.connect(self.afficher_nom) # On cr\u00e9e un container qui repr\u00e9sente le widget principal, # tout le contenu de notre fen\u00eatre container = QWidget() # On y ajoute le widget layout container.setLayout(layout) # On d\u00e9fini le container comme le widget principal self.setCentralWidget(container) def afficher_nom(self): self.resultat.setText('Mathieu Fr\u00e9chette') Corrig\u00e9 Voici ma version de l'exercice app.py import sys from PyQt5.QtCore import QSize, Qt from PyQt5.QtWidgets import QApplication, QGridLayout, QHBoxLayout, QLabel, QLineEdit, QMainWindow, QPushButton, QVBoxLayout, QWidget from db_citoyen import getCitoyen class MainWindows(QMainWindow): def __init__(self): super().__init__() self.setWindowTitle(\"Mon App\") # self.setFixedSize(QSize(300, 300)) layout = QGridLayout() layout.setContentsMargins(40,10,40,10) titre = QLabel('Entrez le id du citoyen') titre.setAlignment(Qt.AlignCenter) font = titre.font() font.setPointSize(12) titre.setFont(font) titre.setFixedHeight(50) layout.addWidget(titre, 0, 0) # Edit box self.input_id_citoyen = QLineEdit() self.input_id_citoyen.returnPressed.connect(self.RechercherCitoyen) layout.addWidget(self.input_id_citoyen, 1, 0) bouton = QPushButton('Rechercher') bouton.clicked.connect(self.RechercherCitoyen) layout.addWidget(bouton, 2, 0) self.label_nom_citoyen = QLabel('-') self.label_nom_citoyen.setAlignment(Qt.AlignCenter) font = self.label_nom_citoyen.font() font.setPointSize(12) self.label_nom_citoyen.setFont(font) self.label_nom_citoyen.setFixedHeight(100) layout.addWidget(self.label_nom_citoyen, 3, 0) container = QWidget() container.setLayout(layout) self.setCentralWidget(container) def RechercherCitoyen(self): citoyen_id = self.input_id_citoyen.text() resultat = getCitoyen(citoyen_id) nom_citoyen = \"Le citoyen n'existe pas\" if resultat is not None: nom_citoyen, classe, score = resultat self.label_nom_citoyen.setText(nom_citoyen) app = QApplication(sys.argv) window = MainWindows() window.show() app.exec() db_citoyen.py import mysql.connector as mysql db_config = { 'host' : 'localhost', 'user' : 'root', 'password' : '********', 'database' : 'credit_social' } # S\u00e9lectionne le nom, la classe et le score d'un citoyen selon son id def getCitoyen(id): \"\"\" S\u00e9lectionne un citoyen Arguments: id: le id du citoyen (integer) Returns: Un tuple avec le nom, la classe et le score d'un citoyen \"\"\" query = \"\"\" select concat(c.prenom, ' ', c.nom) as nom, cl.titre as classe, calcul_credit(c.id) as score from citoyen c inner join classe cl on cl.id = c.classe_id where c.id = %(citoyen_id)s; \"\"\" parametres = { 'citoyen_id' : id } result = () try: connection = mysql.connect(**db_config) cursor = connection.cursor() cursor.execute(query, parametres) result = cursor.fetchone() except mysql.Error as erreur: print(erreur) finally: cursor.close() connection.close() return result","title":"Exercice 09 - pyQT5"},{"location":"exercices/ex09/ex09_enonce/#exercice-09-pyqt5","text":"\u00c0 l'aide de la librairie pyQT5 et de la base de donn\u00e9es credit_social, cr\u00e9ez une interface graphique qui permettra de saisir un id de citoyen et de retourner son nom.","title":"Exercice 09 - pyQt5"},{"location":"exercices/ex09/ex09_enonce/#installation-de-pyqt5","text":"pip install PyQt5 Documentation : https://pypi.org/project/PyQt5/","title":"Installation de pyQT5"},{"location":"exercices/ex09/ex09_enonce/#resultat","text":"On entre un id dans le textBox. En cliquant sur rechercher, on effectue une requ\u00eate \u00e0 la base de donn\u00e9es. On affiche le nom du citoyen sous le bouton.","title":"R\u00e9sultat"},{"location":"exercices/ex09/ex09_enonce/#exemple-de-code","text":"L'exemple de code suivant va afficher une fen\u00eatre vide. # Pour pouvoir passer des arguments \u00e0 notre application import sys # Les librairies PyQT5 from PyQt5.QtCore import * from PyQt5.QtWidgets import * from PyQt5.QtGui import * class MainWindow(QMainWindow): def __init__(self): super(MainWindow, self).__init__() self.setWindowTitle(\"Oh la belle fen\u00eatre vide\") # Une instance de QApplication, on doit en avoir absolument # une et seulement une par application app = QApplication(sys.argv) # Cr\u00e9ation de notre fen\u00eatre principale en appelant la fonction # MainWindow appel\u00e9 plus haut window = MainWindow() # Tr\u00e8s important de l'afficher car par d\u00e9faut elle est masqu\u00e9. window.show() # D\u00e9marre la boucle d'\u00e9v\u00e8nement. L'application va s'afficher. app.exec() Exemple d'un classe MainWindows avec un bouton et un champ texte. Il y a un \u00e9v\u00e9nement sur le bouton pour appeler une fonction quand on le clique. class MainWindows(QMainWindow): def __init__(self): super().__init__() self.setWindowTitle(\"Mon App\") self.setFixedSize(QSize(300, 300)) # On cr\u00e9e un widget qui va contenir les autres et on # d\u00e9fini le type de layout \u00e0 utiliser layout = QGridLayout() # On cr\u00e9e un bouton avec le texte rechercher bouton = QPushButton('Rechercher') # On ajoute le bouton au widget layout # \u00e0 la position 2,0 (troisi\u00e8me ligne, premi\u00e8re colonne) layout.addWidget(bouton, 2, 0) # On cr\u00e9e un widget label self.resultat = QLabel('-') # Formatage du texte self.resultat.setAlignment(Qt.AlignCenter) font = self.resultat.font() font.setPointSize(12) self.resultat.setFont(font) self.resultat.setFixedHeight(100) # On ajoute le label dans le layout layout.addWidget(self.resultat, 3, 0) # On associe l'\u00e9v\u00e9nement clic du bouton \u00e0 la fonction # afficher_nom bouton.clicked.connect(self.afficher_nom) # On cr\u00e9e un container qui repr\u00e9sente le widget principal, # tout le contenu de notre fen\u00eatre container = QWidget() # On y ajoute le widget layout container.setLayout(layout) # On d\u00e9fini le container comme le widget principal self.setCentralWidget(container) def afficher_nom(self): self.resultat.setText('Mathieu Fr\u00e9chette')","title":"Exemple de code"},{"location":"exercices/ex09/ex09_enonce/#corrige","text":"Voici ma version de l'exercice app.py import sys from PyQt5.QtCore import QSize, Qt from PyQt5.QtWidgets import QApplication, QGridLayout, QHBoxLayout, QLabel, QLineEdit, QMainWindow, QPushButton, QVBoxLayout, QWidget from db_citoyen import getCitoyen class MainWindows(QMainWindow): def __init__(self): super().__init__() self.setWindowTitle(\"Mon App\") # self.setFixedSize(QSize(300, 300)) layout = QGridLayout() layout.setContentsMargins(40,10,40,10) titre = QLabel('Entrez le id du citoyen') titre.setAlignment(Qt.AlignCenter) font = titre.font() font.setPointSize(12) titre.setFont(font) titre.setFixedHeight(50) layout.addWidget(titre, 0, 0) # Edit box self.input_id_citoyen = QLineEdit() self.input_id_citoyen.returnPressed.connect(self.RechercherCitoyen) layout.addWidget(self.input_id_citoyen, 1, 0) bouton = QPushButton('Rechercher') bouton.clicked.connect(self.RechercherCitoyen) layout.addWidget(bouton, 2, 0) self.label_nom_citoyen = QLabel('-') self.label_nom_citoyen.setAlignment(Qt.AlignCenter) font = self.label_nom_citoyen.font() font.setPointSize(12) self.label_nom_citoyen.setFont(font) self.label_nom_citoyen.setFixedHeight(100) layout.addWidget(self.label_nom_citoyen, 3, 0) container = QWidget() container.setLayout(layout) self.setCentralWidget(container) def RechercherCitoyen(self): citoyen_id = self.input_id_citoyen.text() resultat = getCitoyen(citoyen_id) nom_citoyen = \"Le citoyen n'existe pas\" if resultat is not None: nom_citoyen, classe, score = resultat self.label_nom_citoyen.setText(nom_citoyen) app = QApplication(sys.argv) window = MainWindows() window.show() app.exec() db_citoyen.py import mysql.connector as mysql db_config = { 'host' : 'localhost', 'user' : 'root', 'password' : '********', 'database' : 'credit_social' } # S\u00e9lectionne le nom, la classe et le score d'un citoyen selon son id def getCitoyen(id): \"\"\" S\u00e9lectionne un citoyen Arguments: id: le id du citoyen (integer) Returns: Un tuple avec le nom, la classe et le score d'un citoyen \"\"\" query = \"\"\" select concat(c.prenom, ' ', c.nom) as nom, cl.titre as classe, calcul_credit(c.id) as score from citoyen c inner join classe cl on cl.id = c.classe_id where c.id = %(citoyen_id)s; \"\"\" parametres = { 'citoyen_id' : id } result = () try: connection = mysql.connect(**db_config) cursor = connection.cursor() cursor.execute(query, parametres) result = cursor.fetchone() except mysql.Error as erreur: print(erreur) finally: cursor.close() connection.close() return result","title":"Corrig\u00e9"},{"location":"exercices/ex10/ex10_corrige/","text":"Exercice 10 - Corrig\u00e9 Question #1 /* * Pour chaque modification \u00e0 la table resultat, ins\u00e9rez les informations n\u00e9cessaires dans la table * resultat_log APR\u00c8S l'ex\u00e9cution de la requ\u00eate INSERT, UPDATE et DELETE. Attention, lors d'un UPDATE, * ajoutez les informations seulement si la colonne resultat_ms a \u00e9t\u00e9 modifi\u00e9. */ DELIMITER $$ -- Ajout lors d'un INSERT DROP TRIGGER IF EXISTS resultat_after_insert$$ CREATE TRIGGER resultat_after_insert AFTER INSERT ON resultat FOR EACH ROW BEGIN INSERT INTO resultat_log (operation, ancien_resultat, nouveau_resultat, resultat_id, date_operation) VALUES ('insert', null, NEW.resultat_ms, NEW.id, NOW()); END$$ -- Ajout lors d'un UPDATE DROP TRIGGER IF EXISTS resultat_after_update$$ CREATE TRIGGER resultat_after_update AFTER UPDATE ON resultat FOR EACH ROW BEGIN IF (OLD.resultat_ms <> NEW.resultat_ms) THEN INSERT INTO resultat_log (operation, ancien_resultat, nouveau_resultat, resultat_id, date_operation) VALUES ('update', OLD.resultat_ms, NEW.resultat_ms, OLD.id, NOW()); END IF; END$$ -- Ajout lors d'un DELETE DROP TRIGGER IF EXISTS resultat_after_delete$$ CREATE TRIGGER resultat_after_delete AFTER DELETE ON resultat FOR EACH ROW BEGIN INSERT INTO resultat_log (operation, ancien_resultat, nouveau_resultat, resultat_id, date_operation) VALUES ('delete', OLD.resultat_ms, null, OLD.id, NOW()); END$$ DELIMITER ; Question #2 /* * Quand on ajoute un r\u00e9sultat, validez AVANT l'ajout que la valeur de la colonne cree_par existe * dans la table usager. Si la valeur est invalide, emp\u00eachez la requ\u00eate INSERT et retournez un message * d'erreurs ( Regardez du c\u00f4t\u00e9 de SIGNAL en MySQL) */ DELIMITER $$ DROP TRIGGER IF EXISTS resultat_before_insert$$ CREATE TRIGGER resultat_before_insert BEFORE INSERT ON resultat FOR EACH ROW BEGIN IF NOT EXISTS (SELECT id FROM usager WHERE id = NEW.cree_par) THEN SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Le id usager est inconnu'; END IF; END$$ DELIMITER ; Question #3 /* * Effectuez les m\u00eames op\u00e9rations que la question #2 quand on modifie un r\u00e9sultat mais sur la colonne modifie_par. */ DELIMITER $$ DROP TRIGGER IF EXISTS resultat_before_update$$ CREATE TRIGGER resultat_before_update BEFORE UPDATE ON resultat FOR EACH ROW BEGIN IF NOT EXISTS (SELECT id FROM usager WHERE id = NEW.modifie_par) THEN SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Le id usager est inconnu'; END IF; END$$ DELIMITER ; Question #4 /* * AVANT l'insertion ou la modification de la description d'une \u00e9preuve dans la table epreuve_type, * valider que la description n'est pas d\u00e9j\u00e0 utilis\u00e9. Si oui, modifiez la valeur \u00e0 ajouter ou modifier * en ajoutant (x) \u00e0 la description. ( x vaudra le nombre de fois que le nom se * retrouve dans la table -1 ) Ex. On veut ins\u00e9rer Marathon comme valeur mais elle est d\u00e9j\u00e0 pr\u00e9sente * comme description dans la table. On va utiliser Marathon (1) comme nouvelle valeur \u00e0 ins\u00e9rer. */ DELIMITER $$ DROP TRIGGER IF EXISTS epreuve_type_before_insert$$ CREATE TRIGGER epreuve_type_before_insert BEFORE INSERT ON epreuve_type FOR EACH ROW BEGIN DECLARE nb_occurence INT DEFAULT 0; SELECT count(*) INTO nb_occurence FROM epreuve_type WHERE description = NEW.description OR description LIKE CONCAT(NEW.description, ' (%)'); IF nb_occurence > 0 THEN SET NEW.description = CONCAT(NEW.description, \" (\", nb_occurence, \")\"); END IF; END$$ DELIMITER ;","title":"Exercice 10 - Corrig\u00e9"},{"location":"exercices/ex10/ex10_corrige/#exercice-10-corrige","text":"","title":"Exercice 10 - Corrig\u00e9"},{"location":"exercices/ex10/ex10_corrige/#question-1","text":"/* * Pour chaque modification \u00e0 la table resultat, ins\u00e9rez les informations n\u00e9cessaires dans la table * resultat_log APR\u00c8S l'ex\u00e9cution de la requ\u00eate INSERT, UPDATE et DELETE. Attention, lors d'un UPDATE, * ajoutez les informations seulement si la colonne resultat_ms a \u00e9t\u00e9 modifi\u00e9. */ DELIMITER $$ -- Ajout lors d'un INSERT DROP TRIGGER IF EXISTS resultat_after_insert$$ CREATE TRIGGER resultat_after_insert AFTER INSERT ON resultat FOR EACH ROW BEGIN INSERT INTO resultat_log (operation, ancien_resultat, nouveau_resultat, resultat_id, date_operation) VALUES ('insert', null, NEW.resultat_ms, NEW.id, NOW()); END$$ -- Ajout lors d'un UPDATE DROP TRIGGER IF EXISTS resultat_after_update$$ CREATE TRIGGER resultat_after_update AFTER UPDATE ON resultat FOR EACH ROW BEGIN IF (OLD.resultat_ms <> NEW.resultat_ms) THEN INSERT INTO resultat_log (operation, ancien_resultat, nouveau_resultat, resultat_id, date_operation) VALUES ('update', OLD.resultat_ms, NEW.resultat_ms, OLD.id, NOW()); END IF; END$$ -- Ajout lors d'un DELETE DROP TRIGGER IF EXISTS resultat_after_delete$$ CREATE TRIGGER resultat_after_delete AFTER DELETE ON resultat FOR EACH ROW BEGIN INSERT INTO resultat_log (operation, ancien_resultat, nouveau_resultat, resultat_id, date_operation) VALUES ('delete', OLD.resultat_ms, null, OLD.id, NOW()); END$$ DELIMITER ;","title":"Question #1"},{"location":"exercices/ex10/ex10_corrige/#question-2","text":"/* * Quand on ajoute un r\u00e9sultat, validez AVANT l'ajout que la valeur de la colonne cree_par existe * dans la table usager. Si la valeur est invalide, emp\u00eachez la requ\u00eate INSERT et retournez un message * d'erreurs ( Regardez du c\u00f4t\u00e9 de SIGNAL en MySQL) */ DELIMITER $$ DROP TRIGGER IF EXISTS resultat_before_insert$$ CREATE TRIGGER resultat_before_insert BEFORE INSERT ON resultat FOR EACH ROW BEGIN IF NOT EXISTS (SELECT id FROM usager WHERE id = NEW.cree_par) THEN SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Le id usager est inconnu'; END IF; END$$ DELIMITER ;","title":"Question #2"},{"location":"exercices/ex10/ex10_corrige/#question-3","text":"/* * Effectuez les m\u00eames op\u00e9rations que la question #2 quand on modifie un r\u00e9sultat mais sur la colonne modifie_par. */ DELIMITER $$ DROP TRIGGER IF EXISTS resultat_before_update$$ CREATE TRIGGER resultat_before_update BEFORE UPDATE ON resultat FOR EACH ROW BEGIN IF NOT EXISTS (SELECT id FROM usager WHERE id = NEW.modifie_par) THEN SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Le id usager est inconnu'; END IF; END$$ DELIMITER ;","title":"Question #3"},{"location":"exercices/ex10/ex10_corrige/#question-4","text":"/* * AVANT l'insertion ou la modification de la description d'une \u00e9preuve dans la table epreuve_type, * valider que la description n'est pas d\u00e9j\u00e0 utilis\u00e9. Si oui, modifiez la valeur \u00e0 ajouter ou modifier * en ajoutant (x) \u00e0 la description. ( x vaudra le nombre de fois que le nom se * retrouve dans la table -1 ) Ex. On veut ins\u00e9rer Marathon comme valeur mais elle est d\u00e9j\u00e0 pr\u00e9sente * comme description dans la table. On va utiliser Marathon (1) comme nouvelle valeur \u00e0 ins\u00e9rer. */ DELIMITER $$ DROP TRIGGER IF EXISTS epreuve_type_before_insert$$ CREATE TRIGGER epreuve_type_before_insert BEFORE INSERT ON epreuve_type FOR EACH ROW BEGIN DECLARE nb_occurence INT DEFAULT 0; SELECT count(*) INTO nb_occurence FROM epreuve_type WHERE description = NEW.description OR description LIKE CONCAT(NEW.description, ' (%)'); IF nb_occurence > 0 THEN SET NEW.description = CONCAT(NEW.description, \" (\", nb_occurence, \")\"); END IF; END$$ DELIMITER ;","title":"Question #4"},{"location":"exercices/ex10/ex10_enonce/","text":"Exercice 10 - Triggers Pr\u00e9paration des donn\u00e9es Importer le script sql exercice10_trigger.sql disponible ici Triggers \u00e0 cr\u00e9er Question #1 Pour chaque modification \u00e0 la table resultat , ins\u00e9rez les informations n\u00e9cessaires dans la table resultat_log APR\u00c8S l'ex\u00e9cution de la requ\u00eate INSERT, UPDATE et DELETE. Attention, lors d'un UPDATE, ajoutez les informations seulement si la colonne resultat_ms a \u00e9t\u00e9 modifi\u00e9. colonne insert update delete operation \"insert\" \"update\" \"delete\" ancien_resultat null old.resultat_ms old.resultat_ms nouveau_resultat new.resultat_ms new.resultat_ms null resultat_id new.id new.id new.id date_operation La date du jour La date du jour La date du jour Question #2 Quand on ajoute un r\u00e9sultat, validez AVANT l'ajout que la valeur de la colonne cree_par existe dans la table usager . Si la valeur est invalide, emp\u00eachez la requ\u00eate INSERT et retournez un message d'erreurs ( Regardez du c\u00f4t\u00e9 de SIGNAL en MySQL). La valeur \u00e0 ins\u00e9rer est le id d'un usager de la table usager . Question #3 Effectuez les m\u00eames op\u00e9rations que la question #2 quand on modifie un r\u00e9sultat mais sur la colonne modifie_par. Question #4 AVANT l'insertion ou la modification de la description d'une \u00e9preuve dans la table epreuve_type, valider que la description n'est pas d\u00e9j\u00e0 utilis\u00e9. Si oui, modifiez la valeur \u00e0 ajouter ou modifier en ajoutant (x) \u00e0 la description. ( x vaudra le nombre de fois que le nom se retrouve dans la table -1 ) Ex. On veut ins\u00e9rer Marathon comme valeur mais elle est d\u00e9j\u00e0 pr\u00e9sente comme description dans la table. On va utiliser Marathon (1) comme nouvelle valeur \u00e0 ins\u00e9rer. Corrig\u00e9 Le corrig\u00e9 est ici","title":"Exercice 10 - Triggers"},{"location":"exercices/ex10/ex10_enonce/#exercice-10-triggers","text":"","title":"Exercice 10 - Triggers"},{"location":"exercices/ex10/ex10_enonce/#preparation-des-donnees","text":"Importer le script sql exercice10_trigger.sql disponible ici","title":"Pr\u00e9paration des donn\u00e9es"},{"location":"exercices/ex10/ex10_enonce/#triggers-a-creer","text":"","title":"Triggers \u00e0 cr\u00e9er"},{"location":"exercices/ex10/ex10_enonce/#question-1","text":"Pour chaque modification \u00e0 la table resultat , ins\u00e9rez les informations n\u00e9cessaires dans la table resultat_log APR\u00c8S l'ex\u00e9cution de la requ\u00eate INSERT, UPDATE et DELETE. Attention, lors d'un UPDATE, ajoutez les informations seulement si la colonne resultat_ms a \u00e9t\u00e9 modifi\u00e9. colonne insert update delete operation \"insert\" \"update\" \"delete\" ancien_resultat null old.resultat_ms old.resultat_ms nouveau_resultat new.resultat_ms new.resultat_ms null resultat_id new.id new.id new.id date_operation La date du jour La date du jour La date du jour","title":"Question #1"},{"location":"exercices/ex10/ex10_enonce/#question-2","text":"Quand on ajoute un r\u00e9sultat, validez AVANT l'ajout que la valeur de la colonne cree_par existe dans la table usager . Si la valeur est invalide, emp\u00eachez la requ\u00eate INSERT et retournez un message d'erreurs ( Regardez du c\u00f4t\u00e9 de SIGNAL en MySQL). La valeur \u00e0 ins\u00e9rer est le id d'un usager de la table usager .","title":"Question #2"},{"location":"exercices/ex10/ex10_enonce/#question-3","text":"Effectuez les m\u00eames op\u00e9rations que la question #2 quand on modifie un r\u00e9sultat mais sur la colonne modifie_par.","title":"Question #3"},{"location":"exercices/ex10/ex10_enonce/#question-4","text":"AVANT l'insertion ou la modification de la description d'une \u00e9preuve dans la table epreuve_type, valider que la description n'est pas d\u00e9j\u00e0 utilis\u00e9. Si oui, modifiez la valeur \u00e0 ajouter ou modifier en ajoutant (x) \u00e0 la description. ( x vaudra le nombre de fois que le nom se retrouve dans la table -1 ) Ex. On veut ins\u00e9rer Marathon comme valeur mais elle est d\u00e9j\u00e0 pr\u00e9sente comme description dans la table. On va utiliser Marathon (1) comme nouvelle valeur \u00e0 ins\u00e9rer.","title":"Question #4"},{"location":"exercices/ex10/ex10_enonce/#corrige","text":"Le corrig\u00e9 est ici","title":"Corrig\u00e9"},{"location":"exercices/ex11/ex11_enonce/","text":"Exercice 11 - Livres dont vous \u00eates le h\u00e9ro Description de l'exercice L'objectif du projet est de cr\u00e9er une application qui permettra de lire et de naviguer dans un livre dont vous \u00eates le h\u00e9ros. Vous devrez faire l'analyse du cas et me produire un diagramme de classes de cette analyse. Ensuite cr\u00e9er la base de donn\u00e9es en lien avec votre analyse. Je vais vous fournir le texte d'un livre divis\u00e9 en chapitres pour l'inclure dans la base de donn\u00e9es. Finalement vous allez d\u00e9velopper une application fonctionnelle en python avec une interface graphique. L'exercice sera \u00e9valu\u00e9 et comptera pour 15% de la note finale. Vous pouvez le faire en \u00e9quipe de 2 ou individuellement. Remise de l'exercice Cr\u00e9ez un d\u00e9p\u00f4t Github de l'exercice \u00e0 l'int\u00e9rieur duquel vous allez avoir les \u00e9l\u00e9ments suivants : Dans un r\u00e9pertoire nomm\u00e9 ressources, votre diagramme de classes ainsi que les scripts SQL n\u00e9cessaires \u00e0 la cr\u00e9ation de votre base de donn\u00e9es et \u00e0 l'insertion des donn\u00e9es une fois l'application fonctionnel . Le code de votre application. Si vous travaillez en \u00e9quipe, je veux que chacun travaille sur une version locale du projet et fasse des commits et merge sur le projet ma\u00eetre sur Github pour que je puisse \u00e9valuer l'implication de chaque co\u00e9quipiers. La remise du projet se fera durant le cours du 18 novembre 2022 Analyse du cas Les points suivants du livre doivent \u00eatre couverts par votre analyse : Le texte du livre divis\u00e9 entre chapitres ainsi que le principe de navigation entre les chapitres. (Pour chaque chapitre il n'y a qu'un choix restreint de chapitres auxquels on peut acc\u00e9der) Pour l'instant on n'aura qu'un livre dans l'application, mais on pourrait en avoir plusieurs. On va prendre pour acquis que tout les livres auraient la m\u00eame fiche de personnage. La fiche du personnage (feuille d'aventure). Pour les sections disciplines Kai et Armes , les valeurs qu'on peut y entrer doivent provenir d'une liste de choix, celle-ci est d\u00e9crite plus loin dans le livre. (\u00c0 partir de la page 9 pour les disciplines et 11 pour les armes) On ne couvrira pas le syst\u00e8me de r\u00e8gles, \u00e7a sera \u00e0 l'usager de le faire manuellement. (Combat, perte d'endurance, etc...) On doit pouvoir enregistrer notre progression dans le livre et faire plusieurs parties en m\u00eame temps. Votre analyse doit respecter les r\u00e8gles de la troisi\u00e8me forme normale, \u00e0 moins de cas d'exception qui devront \u00eatre justifi\u00e9s. Diagramme de classes Le diagramme de classes doit respecter le plus fid\u00e8lement votre analyse. Les normes de nomenclature d\u00e9fini dans les notes de cours doivent \u00eatre suivi. Base de donn\u00e9es Il n'y a pas de minimum ou maximum quand aux nombre de tables \u00e0 avoir, mais vous devez inclure les \u00e9l\u00e9ments suivants : Un usager avec des droits restreint qui sera utilis\u00e9 par l'application. Pour les droits, allez-y au minimum, seulement les tables et commandes n\u00e9cessaires au fonctionnement de l'application. Vous devez au minimum inclure 2 proc\u00e9dures stock\u00e9es, fonctions ou triggers (Une fonction et un trigger, une proc\u00e9dure stock\u00e9e et une fonction, deux triggers, etc...). Application L'application doit comporter les fonctionnalit\u00e9s suivantes : Lire un livre, naviguer entre les chapitres selon leur num\u00e9ro. Permettre \u00e0 l'usager de modifier sa fiche de personnage. Sauvegarde notre progression de lecture, (num\u00e9ro de chapitre, feuille d'aventure) Supprimer une sauvegarde. Ressources Loup solitaire T.1 : Le livre de r\u00e9f\u00e9rence insert_chapitre.sql : Les textes de chaque chapitre insert_lien_chapitre.sql : Les liens du chapitre vers les autres Grille de correction Crit\u00e8res R\u00e9ussi Satisfaisant insatisfaisant Points Les scripts SQL de cr\u00e9ation de tables et d'insertion de donn\u00e9es sont fonctionnels et couvrent l'ensemble de l'application. 2 1 0 /2 Le diagramme de classes respecte les points \u00e0 couvrir de l'analyse de cas et les normes de nomenclature d\u00e9finies dans les notes de cours. 2 1 0 /2 Un usager avec des droits restreints est utilis\u00e9 pour la connexion entre l'application et la base de donn\u00e9es. Sa cr\u00e9ation est incluse dans les scripts SQL remis. 2 1 0 /2 La base de donn\u00e9es comportent 2 proc\u00e9dures stock\u00e9es, fonctions ou triggers. 2 1 0 /2 L'application permet de lire un livre et de naviguer entre les chapitres par leur num\u00e9ro. 2 1 0 /2 L'application permet \u00e0 l'usager de modifier manuellement la feuille de personnage du livre. 2 1 0 /2 L'application permet de sauvegarder la progression de lecture (le chapitre en cours) et la feuille de personnage. 4 2 0 /4 L'application permet de supprimer une sauvegarde 2 1 0 /2 Le projet est li\u00e9 \u00e0 un d\u00e9p\u00f4t sur GitHub et un suivi a \u00e9t\u00e9 effectu\u00e9 durant le d\u00e9veloppement. (Commit, push, pull request) 2 1 0 /2 Total /20","title":"Exercice 11 - LDVELH"},{"location":"exercices/ex11/ex11_enonce/#exercice-11-livres-dont-vous-etes-le-hero","text":"","title":"Exercice 11 - Livres dont vous \u00eates le h\u00e9ro"},{"location":"exercices/ex11/ex11_enonce/#description-de-lexercice","text":"L'objectif du projet est de cr\u00e9er une application qui permettra de lire et de naviguer dans un livre dont vous \u00eates le h\u00e9ros. Vous devrez faire l'analyse du cas et me produire un diagramme de classes de cette analyse. Ensuite cr\u00e9er la base de donn\u00e9es en lien avec votre analyse. Je vais vous fournir le texte d'un livre divis\u00e9 en chapitres pour l'inclure dans la base de donn\u00e9es. Finalement vous allez d\u00e9velopper une application fonctionnelle en python avec une interface graphique. L'exercice sera \u00e9valu\u00e9 et comptera pour 15% de la note finale. Vous pouvez le faire en \u00e9quipe de 2 ou individuellement.","title":"Description de l'exercice"},{"location":"exercices/ex11/ex11_enonce/#remise-de-lexercice","text":"Cr\u00e9ez un d\u00e9p\u00f4t Github de l'exercice \u00e0 l'int\u00e9rieur duquel vous allez avoir les \u00e9l\u00e9ments suivants : Dans un r\u00e9pertoire nomm\u00e9 ressources, votre diagramme de classes ainsi que les scripts SQL n\u00e9cessaires \u00e0 la cr\u00e9ation de votre base de donn\u00e9es et \u00e0 l'insertion des donn\u00e9es une fois l'application fonctionnel . Le code de votre application. Si vous travaillez en \u00e9quipe, je veux que chacun travaille sur une version locale du projet et fasse des commits et merge sur le projet ma\u00eetre sur Github pour que je puisse \u00e9valuer l'implication de chaque co\u00e9quipiers. La remise du projet se fera durant le cours du 18 novembre 2022","title":"Remise de l'exercice"},{"location":"exercices/ex11/ex11_enonce/#analyse-du-cas","text":"Les points suivants du livre doivent \u00eatre couverts par votre analyse : Le texte du livre divis\u00e9 entre chapitres ainsi que le principe de navigation entre les chapitres. (Pour chaque chapitre il n'y a qu'un choix restreint de chapitres auxquels on peut acc\u00e9der) Pour l'instant on n'aura qu'un livre dans l'application, mais on pourrait en avoir plusieurs. On va prendre pour acquis que tout les livres auraient la m\u00eame fiche de personnage. La fiche du personnage (feuille d'aventure). Pour les sections disciplines Kai et Armes , les valeurs qu'on peut y entrer doivent provenir d'une liste de choix, celle-ci est d\u00e9crite plus loin dans le livre. (\u00c0 partir de la page 9 pour les disciplines et 11 pour les armes) On ne couvrira pas le syst\u00e8me de r\u00e8gles, \u00e7a sera \u00e0 l'usager de le faire manuellement. (Combat, perte d'endurance, etc...) On doit pouvoir enregistrer notre progression dans le livre et faire plusieurs parties en m\u00eame temps. Votre analyse doit respecter les r\u00e8gles de la troisi\u00e8me forme normale, \u00e0 moins de cas d'exception qui devront \u00eatre justifi\u00e9s.","title":"Analyse du cas"},{"location":"exercices/ex11/ex11_enonce/#diagramme-de-classes","text":"Le diagramme de classes doit respecter le plus fid\u00e8lement votre analyse. Les normes de nomenclature d\u00e9fini dans les notes de cours doivent \u00eatre suivi.","title":"Diagramme de classes"},{"location":"exercices/ex11/ex11_enonce/#base-de-donnees","text":"Il n'y a pas de minimum ou maximum quand aux nombre de tables \u00e0 avoir, mais vous devez inclure les \u00e9l\u00e9ments suivants : Un usager avec des droits restreint qui sera utilis\u00e9 par l'application. Pour les droits, allez-y au minimum, seulement les tables et commandes n\u00e9cessaires au fonctionnement de l'application. Vous devez au minimum inclure 2 proc\u00e9dures stock\u00e9es, fonctions ou triggers (Une fonction et un trigger, une proc\u00e9dure stock\u00e9e et une fonction, deux triggers, etc...).","title":"Base de donn\u00e9es"},{"location":"exercices/ex11/ex11_enonce/#application","text":"L'application doit comporter les fonctionnalit\u00e9s suivantes : Lire un livre, naviguer entre les chapitres selon leur num\u00e9ro. Permettre \u00e0 l'usager de modifier sa fiche de personnage. Sauvegarde notre progression de lecture, (num\u00e9ro de chapitre, feuille d'aventure) Supprimer une sauvegarde.","title":"Application"},{"location":"exercices/ex11/ex11_enonce/#ressources","text":"Loup solitaire T.1 : Le livre de r\u00e9f\u00e9rence insert_chapitre.sql : Les textes de chaque chapitre insert_lien_chapitre.sql : Les liens du chapitre vers les autres","title":"Ressources"},{"location":"exercices/ex11/ex11_enonce/#grille-de-correction","text":"Crit\u00e8res R\u00e9ussi Satisfaisant insatisfaisant Points Les scripts SQL de cr\u00e9ation de tables et d'insertion de donn\u00e9es sont fonctionnels et couvrent l'ensemble de l'application. 2 1 0 /2 Le diagramme de classes respecte les points \u00e0 couvrir de l'analyse de cas et les normes de nomenclature d\u00e9finies dans les notes de cours. 2 1 0 /2 Un usager avec des droits restreints est utilis\u00e9 pour la connexion entre l'application et la base de donn\u00e9es. Sa cr\u00e9ation est incluse dans les scripts SQL remis. 2 1 0 /2 La base de donn\u00e9es comportent 2 proc\u00e9dures stock\u00e9es, fonctions ou triggers. 2 1 0 /2 L'application permet de lire un livre et de naviguer entre les chapitres par leur num\u00e9ro. 2 1 0 /2 L'application permet \u00e0 l'usager de modifier manuellement la feuille de personnage du livre. 2 1 0 /2 L'application permet de sauvegarder la progression de lecture (le chapitre en cours) et la feuille de personnage. 4 2 0 /4 L'application permet de supprimer une sauvegarde 2 1 0 /2 Le projet est li\u00e9 \u00e0 un d\u00e9p\u00f4t sur GitHub et un suivi a \u00e9t\u00e9 effectu\u00e9 durant le d\u00e9veloppement. (Commit, push, pull request) 2 1 0 /2 Total /20","title":"Grille de correction"},{"location":"exercices/ex12/ex12_enonce/","text":"Exercice 12 - Gestion des usagers Pour cet exercice nous allons utiliser la base de donn\u00e9es credit_social (voir le script de cr\u00e9ation dans l' exercice 6 ).Vous devez me produire un script SQL qui va effectuer les op\u00e9rations suivantes. Assurez-vous de tester que les permissions sont bien appliqu\u00e9es. L'exercice doit \u00eatre fait depuis une console , pas de workbench, phpmyadmin, etc. Vous pouvez ajouter les r\u00e9ponses des sections \"C\" dans le m\u00eame script en commentaire. 1. Usager citoyen_alpha a) Cr\u00e9ez un usager avec les informations suivantes : nom : citoyen_alpha mot de passe : !alph2 h\u00f4te accept\u00e9 : tous b) Donnez les permissions suivantes \u00e0 cette usager : Il a la permission de tout faire dans la base de donn\u00e9es credit_social. Il peut aussi ajouter des permissions \u00e0 d'autre usagers. Il peut cr\u00e9er des usagers pour toutes les bases de donn\u00e9es c) Testez les \u00e9l\u00e9ments suivants Inscrivez le r\u00e9sultat d'une requ\u00eate SELECT sur une table d'une autre base de donn\u00e9es que credit_social. Faites la cr\u00e9ation de l'usager suivant (le point #2) avec cet usager. Est-ce que \u00e7a fonctionne? 2. Usager citoyen_beta a) Cr\u00e9er un usager avec les informations suivantes : nom : citoyen_beta mot de passe : !b3ta h\u00f4te accept\u00e9 : tous b) Donnez les permissions suivantes \u00e0 cet usager : Il peut faire des requ\u00eates SELECT, UPDATE, INSERT sur les tables citoyen et evenement de la base de donn\u00e9es credit_social. Il peut ex\u00e9cuter toutes les proc\u00e9dures stock\u00e9es. c) Testez les \u00e9l\u00e9ments suivants Essayez de supprimer l'\u00e9v\u00e9nement avec le id 6 de la table evenement. Inscrivez la requ\u00eate effectu\u00e9e et le r\u00e9sultat. Ex\u00e9cutez une proc\u00e9dure stock\u00e9e de la base de donn\u00e9es credit_social. Inscrivez la requ\u00eate effectu\u00e9e. Modifiez le cr\u00e9dit initial du citoyen avec le id 2107 pour 800. Inscrivez la requ\u00eate effectu\u00e9e. 3. Usager citoyen_gamma a) Cr\u00e9er un usager avec les informations suivantes : nom : citoyen_gamma mot de passe : !g2mm2 h\u00f4te accept\u00e9 : tous b) Donnez les permissions suivantes \u00e0 cet usager : Il peut faire des requ\u00eates SELECT sur les colonnes nom, prenom et pin de la table citoyen de la base de donn\u00e9es credit_social. Il peut ex\u00e9cuter uniquement la proc\u00e9dure stock\u00e9e update_classe de la base de donn\u00e9es credit_social c) Testez les \u00e9l\u00e9ments suivants \u00cates-vous capable de donner le nom et pr\u00e9nom du citoyen avec le id 1111? Sinon pourquoi? Faites les modifications n\u00e9cessaires pour en \u00eatre capable. Inscrivez l'op\u00e9ration effectu\u00e9e. Trouvez une fa\u00e7on pour permettre \u00e0 cet usager de pouvoir afficher le nom, prenom et la classe d'un citoyen selon son PIN sans ajouter la table classe dans les permissions SELECT de l'usager. Inscrivez l'op\u00e9ration effectu\u00e9e. Testez votre solution avec le PIN 39c0cf42-510c-4811-8c3c-47ab100443ce et inscrivez le nom complet du citoyen correspondant.","title":"Exercice 12 - Gestion des usagers"},{"location":"exercices/ex12/ex12_enonce/#exercice-12-gestion-des-usagers","text":"Pour cet exercice nous allons utiliser la base de donn\u00e9es credit_social (voir le script de cr\u00e9ation dans l' exercice 6 ).Vous devez me produire un script SQL qui va effectuer les op\u00e9rations suivantes. Assurez-vous de tester que les permissions sont bien appliqu\u00e9es. L'exercice doit \u00eatre fait depuis une console , pas de workbench, phpmyadmin, etc. Vous pouvez ajouter les r\u00e9ponses des sections \"C\" dans le m\u00eame script en commentaire.","title":"Exercice 12 - Gestion des usagers"},{"location":"exercices/ex12/ex12_enonce/#1-usager-citoyen_alpha","text":"a) Cr\u00e9ez un usager avec les informations suivantes : nom : citoyen_alpha mot de passe : !alph2 h\u00f4te accept\u00e9 : tous b) Donnez les permissions suivantes \u00e0 cette usager : Il a la permission de tout faire dans la base de donn\u00e9es credit_social. Il peut aussi ajouter des permissions \u00e0 d'autre usagers. Il peut cr\u00e9er des usagers pour toutes les bases de donn\u00e9es c) Testez les \u00e9l\u00e9ments suivants Inscrivez le r\u00e9sultat d'une requ\u00eate SELECT sur une table d'une autre base de donn\u00e9es que credit_social. Faites la cr\u00e9ation de l'usager suivant (le point #2) avec cet usager. Est-ce que \u00e7a fonctionne?","title":"1. Usager citoyen_alpha"},{"location":"exercices/ex12/ex12_enonce/#2-usager-citoyen_beta","text":"a) Cr\u00e9er un usager avec les informations suivantes : nom : citoyen_beta mot de passe : !b3ta h\u00f4te accept\u00e9 : tous b) Donnez les permissions suivantes \u00e0 cet usager : Il peut faire des requ\u00eates SELECT, UPDATE, INSERT sur les tables citoyen et evenement de la base de donn\u00e9es credit_social. Il peut ex\u00e9cuter toutes les proc\u00e9dures stock\u00e9es. c) Testez les \u00e9l\u00e9ments suivants Essayez de supprimer l'\u00e9v\u00e9nement avec le id 6 de la table evenement. Inscrivez la requ\u00eate effectu\u00e9e et le r\u00e9sultat. Ex\u00e9cutez une proc\u00e9dure stock\u00e9e de la base de donn\u00e9es credit_social. Inscrivez la requ\u00eate effectu\u00e9e. Modifiez le cr\u00e9dit initial du citoyen avec le id 2107 pour 800. Inscrivez la requ\u00eate effectu\u00e9e.","title":"2. Usager citoyen_beta"},{"location":"exercices/ex12/ex12_enonce/#3-usager-citoyen_gamma","text":"a) Cr\u00e9er un usager avec les informations suivantes : nom : citoyen_gamma mot de passe : !g2mm2 h\u00f4te accept\u00e9 : tous b) Donnez les permissions suivantes \u00e0 cet usager : Il peut faire des requ\u00eates SELECT sur les colonnes nom, prenom et pin de la table citoyen de la base de donn\u00e9es credit_social. Il peut ex\u00e9cuter uniquement la proc\u00e9dure stock\u00e9e update_classe de la base de donn\u00e9es credit_social c) Testez les \u00e9l\u00e9ments suivants \u00cates-vous capable de donner le nom et pr\u00e9nom du citoyen avec le id 1111? Sinon pourquoi? Faites les modifications n\u00e9cessaires pour en \u00eatre capable. Inscrivez l'op\u00e9ration effectu\u00e9e. Trouvez une fa\u00e7on pour permettre \u00e0 cet usager de pouvoir afficher le nom, prenom et la classe d'un citoyen selon son PIN sans ajouter la table classe dans les permissions SELECT de l'usager. Inscrivez l'op\u00e9ration effectu\u00e9e. Testez votre solution avec le PIN 39c0cf42-510c-4811-8c3c-47ab100443ce et inscrivez le nom complet du citoyen correspondant.","title":"3. Usager citoyen_gamma"},{"location":"exercices/ex13/ex13_enonce/","text":"Exercice 13 - R\u00e9vision analyse Mise en situation \u00c0 partir de l'image suivante, vous devez mod\u00e9liser le syst\u00e8me de facturation d'un garage de voiture. Pr\u00e9cisions Seulement les informations surlign\u00e9es en jaunes doivent \u00eatre sauvegard\u00e9s (ou peuvent \u00eatre reproduit exactement avec les autres informations sauvegard\u00e9es). Le nombre 2134521 situ\u00e9 au-dessus du nom \"Mathieu Fr\u00e9chette\" est le code de ce client. La description du v\u00e9hicule est un champs texte associ\u00e9 au compte du client. Le client peut avoir plus d'un v\u00e9hicule associ\u00e9 \u00e0 son compte. La case PLAQUE est le num\u00e9ro de la plaque d'immatriculation du v\u00e9hicule Les trois champs ODO ... repr\u00e9sente trois prise de odom\u00e8tre du v\u00e9hicule durant le travail factur\u00e9. Dans le d\u00e9tail de la facture : Le texte \"Remettre Pneus dans l'auto\" est un texte global \u00e0 la facture qu'un le commis a entr\u00e9 manuellement. Il y a trois ligne de d\u00e9tail, chacune commen\u00e7ant par une quantit\u00e9 et un code de produit. Le texte \"N'oubliez pas la rotation... \" est aussi un texte globale \u00e0 la facture qu'un le commis a entr\u00e9 manuellement. Un peu payer la facture selon plus d'un mode de paiement. Donc \u00e0 la ligne \"M\u00e9thode de paiement. Visa=730.92$\" on pourrait retrouver plus d'un mode de paiement avec le montant pour chaque mode. Les \"produits\" sont class\u00e9s en trois cat\u00e9gorie : Pi\u00e8ces, Main-d'\u0153uvre (M.O.) et autre. Un produit ne peut avoir qu'une cat\u00e9gorie. Dans la table facturation, ajoutez deux colonnes, date_creation (type date) et user_creation (type varchar) qui seront remplies automatiquement avec un d\u00e9clencheur. Diagramme de classes Produisez le diagramme de classes en relation \u00e0 partir des informations plus haut. Vous devez indiquer les relations entres les tables en pr\u00e9cisant le type de relation. Utilisez la notation 1<--->1 pour une relation d'un \u00e0 un et 1<--->n ou n<--->1 pour une relation d'un \u00e0 plusieurs Vous devez inscrire les types de donn\u00e9es Vous devez inscrire les cl\u00e9s primaires (PK) et \u00e9trang\u00e8res (FK) Cr\u00e9ation de la base de donn\u00e9es Cr\u00e9ez un script SQL qui effectuera les op\u00e9rations suivantes : Cr\u00e9ation d'un nouvelle base de donn\u00e9es Cr\u00e9ation des tables selon le diagramme de classes. Triggers Cr\u00e9ez un script SQL qui fera la cr\u00e9ation des deux d\u00e9clencheurs (Triggers) suivants : AVANT la cr\u00e9ation d'une facture, ajoutez la date du syst\u00e8me au champ date_creation de la table de facturation. AVANT la cr\u00e9ation d'une facture, ajoutez le nom de l'usager courant dans le champs user_creation si aucun code de commis n'a \u00e9t\u00e9 sp\u00e9cifi\u00e9 lors de la requ\u00eate d'insertion. La commande current_user() permet de connaitre le nom de l'usager courant. Cr\u00e9ation d'un usager Cr\u00e9ez un script SQL qui effectuera les op\u00e9rations suivantes : a) Cr\u00e9ez un usager selon ces informations : nom : facturation mot de passe : $acture h\u00f4te accept\u00e9 : localhost b) Donnez les permissions suivantes \u00e0 cette usager : Il peut faire des requ\u00eates SELECT, UPDATE, INSERT sur les tables de facturations de la base de donn\u00e9es cr\u00e9\u00e9. Il peut faire des requ\u00eates SELECT, UPDATE sur la table des clients. Il peut faire des requ\u00eates SELECT sur la table des produits.","title":"Exercice 13 - R\u00e9visions - Facture garage"},{"location":"exercices/ex13/ex13_enonce/#exercice-13-revision-analyse","text":"","title":"Exercice 13 - R\u00e9vision analyse"},{"location":"exercices/ex13/ex13_enonce/#mise-en-situation","text":"\u00c0 partir de l'image suivante, vous devez mod\u00e9liser le syst\u00e8me de facturation d'un garage de voiture.","title":"Mise en situation"},{"location":"exercices/ex13/ex13_enonce/#precisions","text":"Seulement les informations surlign\u00e9es en jaunes doivent \u00eatre sauvegard\u00e9s (ou peuvent \u00eatre reproduit exactement avec les autres informations sauvegard\u00e9es). Le nombre 2134521 situ\u00e9 au-dessus du nom \"Mathieu Fr\u00e9chette\" est le code de ce client. La description du v\u00e9hicule est un champs texte associ\u00e9 au compte du client. Le client peut avoir plus d'un v\u00e9hicule associ\u00e9 \u00e0 son compte. La case PLAQUE est le num\u00e9ro de la plaque d'immatriculation du v\u00e9hicule Les trois champs ODO ... repr\u00e9sente trois prise de odom\u00e8tre du v\u00e9hicule durant le travail factur\u00e9. Dans le d\u00e9tail de la facture : Le texte \"Remettre Pneus dans l'auto\" est un texte global \u00e0 la facture qu'un le commis a entr\u00e9 manuellement. Il y a trois ligne de d\u00e9tail, chacune commen\u00e7ant par une quantit\u00e9 et un code de produit. Le texte \"N'oubliez pas la rotation... \" est aussi un texte globale \u00e0 la facture qu'un le commis a entr\u00e9 manuellement. Un peu payer la facture selon plus d'un mode de paiement. Donc \u00e0 la ligne \"M\u00e9thode de paiement. Visa=730.92$\" on pourrait retrouver plus d'un mode de paiement avec le montant pour chaque mode. Les \"produits\" sont class\u00e9s en trois cat\u00e9gorie : Pi\u00e8ces, Main-d'\u0153uvre (M.O.) et autre. Un produit ne peut avoir qu'une cat\u00e9gorie. Dans la table facturation, ajoutez deux colonnes, date_creation (type date) et user_creation (type varchar) qui seront remplies automatiquement avec un d\u00e9clencheur.","title":"Pr\u00e9cisions"},{"location":"exercices/ex13/ex13_enonce/#diagramme-de-classes","text":"Produisez le diagramme de classes en relation \u00e0 partir des informations plus haut. Vous devez indiquer les relations entres les tables en pr\u00e9cisant le type de relation. Utilisez la notation 1<--->1 pour une relation d'un \u00e0 un et 1<--->n ou n<--->1 pour une relation d'un \u00e0 plusieurs Vous devez inscrire les types de donn\u00e9es Vous devez inscrire les cl\u00e9s primaires (PK) et \u00e9trang\u00e8res (FK)","title":"Diagramme de classes"},{"location":"exercices/ex13/ex13_enonce/#creation-de-la-base-de-donnees","text":"Cr\u00e9ez un script SQL qui effectuera les op\u00e9rations suivantes : Cr\u00e9ation d'un nouvelle base de donn\u00e9es Cr\u00e9ation des tables selon le diagramme de classes.","title":"Cr\u00e9ation de la base de donn\u00e9es"},{"location":"exercices/ex13/ex13_enonce/#triggers","text":"Cr\u00e9ez un script SQL qui fera la cr\u00e9ation des deux d\u00e9clencheurs (Triggers) suivants : AVANT la cr\u00e9ation d'une facture, ajoutez la date du syst\u00e8me au champ date_creation de la table de facturation. AVANT la cr\u00e9ation d'une facture, ajoutez le nom de l'usager courant dans le champs user_creation si aucun code de commis n'a \u00e9t\u00e9 sp\u00e9cifi\u00e9 lors de la requ\u00eate d'insertion. La commande current_user() permet de connaitre le nom de l'usager courant.","title":"Triggers"},{"location":"exercices/ex13/ex13_enonce/#creation-dun-usager","text":"Cr\u00e9ez un script SQL qui effectuera les op\u00e9rations suivantes : a) Cr\u00e9ez un usager selon ces informations : nom : facturation mot de passe : $acture h\u00f4te accept\u00e9 : localhost b) Donnez les permissions suivantes \u00e0 cette usager : Il peut faire des requ\u00eates SELECT, UPDATE, INSERT sur les tables de facturations de la base de donn\u00e9es cr\u00e9\u00e9. Il peut faire des requ\u00eates SELECT, UPDATE sur la table des clients. Il peut faire des requ\u00eates SELECT sur la table des produits.","title":"Cr\u00e9ation d'un usager"},{"location":"notes_de_cours/analyse/","text":"Mod\u00e8le entit\u00e9-association (entit\u00e9-relation) D\u00e9finition Le mod\u00e8le entit\u00e9-relation (ou entit\u00e9-association) permet de repr\u00e9senter de fa\u00e7on conceptuelle les donn\u00e9es d'un probl\u00e8me. Il nous fournit une repr\u00e9sentation graphique des associations entre les donn\u00e9es. \u00c7a nous sera tr\u00e8s utile pour cr\u00e9er des diagrammes et mod\u00e9liser diff\u00e9rents syst\u00e8mes. Le mod\u00e8le contient des entit\u00e9s qui repr\u00e9sentent les \u00e9l\u00e9ments du syst\u00e8me Des athl\u00e8tes, des r\u00e9sultats, des livres, des auteurs, etc. Le mod\u00e8le montre les associations entre les entit\u00e9s Quelle est l\u2019interaction entre les diff\u00e9rentes entit\u00e9s du syst\u00e8me Quelles sont les contraintes sur ces associations Mod\u00e9lisation Une entit\u00e9 est d\u00e9finie comme Une chose capable d\u2019avoir une existence ind\u00e9pendante. Une chose qui peut \u00eatre identifi\u00e9e de fa\u00e7on unique. Les associations repr\u00e9sentent comment les types d\u2019entit\u00e9s sont reli\u00e9s entre eux Les associations peuvent \u00eatre vues comme des verbes entre des entit\u00e9s Un athl\u00e8te r\u00e9alise un r\u00e9sultat Un livre est \u00e9crit par un auteur Les associations peuvent avoir des contraintes Un r\u00e9sultat ne peut \u00eatre r\u00e9alis\u00e9 que par un athl\u00e8te Un athl\u00e8te pour r\u00e9aliser plusieurs r\u00e9sultats Chaque entit\u00e9 et association peut avoir des attributs pour le d\u00e9finir. Le nom et pr\u00e9nom d'un athl\u00e8te, le titre d'un livre Pour r\u00e9sum\u00e9, si on traduit en langage de base de donn\u00e9es, une entit\u00e9 va correspondre \u00e0 une table et un attribut \u00e0 un champ. Les associations repr\u00e9sentent les relations entre les tables.","title":"Mod\u00e8le entit\u00e9-association"},{"location":"notes_de_cours/analyse/#modele-entite-association-entite-relation","text":"","title":"Mod\u00e8le entit\u00e9-association (entit\u00e9-relation)"},{"location":"notes_de_cours/analyse/#definition","text":"Le mod\u00e8le entit\u00e9-relation (ou entit\u00e9-association) permet de repr\u00e9senter de fa\u00e7on conceptuelle les donn\u00e9es d'un probl\u00e8me. Il nous fournit une repr\u00e9sentation graphique des associations entre les donn\u00e9es. \u00c7a nous sera tr\u00e8s utile pour cr\u00e9er des diagrammes et mod\u00e9liser diff\u00e9rents syst\u00e8mes. Le mod\u00e8le contient des entit\u00e9s qui repr\u00e9sentent les \u00e9l\u00e9ments du syst\u00e8me Des athl\u00e8tes, des r\u00e9sultats, des livres, des auteurs, etc. Le mod\u00e8le montre les associations entre les entit\u00e9s Quelle est l\u2019interaction entre les diff\u00e9rentes entit\u00e9s du syst\u00e8me Quelles sont les contraintes sur ces associations","title":"D\u00e9finition"},{"location":"notes_de_cours/analyse/#modelisation","text":"Une entit\u00e9 est d\u00e9finie comme Une chose capable d\u2019avoir une existence ind\u00e9pendante. Une chose qui peut \u00eatre identifi\u00e9e de fa\u00e7on unique. Les associations repr\u00e9sentent comment les types d\u2019entit\u00e9s sont reli\u00e9s entre eux Les associations peuvent \u00eatre vues comme des verbes entre des entit\u00e9s Un athl\u00e8te r\u00e9alise un r\u00e9sultat Un livre est \u00e9crit par un auteur Les associations peuvent avoir des contraintes Un r\u00e9sultat ne peut \u00eatre r\u00e9alis\u00e9 que par un athl\u00e8te Un athl\u00e8te pour r\u00e9aliser plusieurs r\u00e9sultats Chaque entit\u00e9 et association peut avoir des attributs pour le d\u00e9finir. Le nom et pr\u00e9nom d'un athl\u00e8te, le titre d'un livre Pour r\u00e9sum\u00e9, si on traduit en langage de base de donn\u00e9es, une entit\u00e9 va correspondre \u00e0 une table et un attribut \u00e0 un champ. Les associations repr\u00e9sentent les relations entre les tables.","title":"Mod\u00e9lisation"},{"location":"notes_de_cours/convention/","text":"Convention de nommage MySQL Bien que MySQL n'a pas vraiment de convention de nommage officiel, voici certaines des r\u00e8gles les plus utilis\u00e9es : R\u00e8gles g\u00e9n\u00e9rales Toujours \u00e9crire les noms en minuscule. \u00c7a peut aider \u00e0 \u00e9viter les erreurs, car MySQL est sensible \u00e0 la case Ne jamais utiliser d'espace, la remplacer par une barre de soulignement \"_\" Utilisez seulement des lettres dans les noms, pas de nombres ni de caract\u00e8res sp\u00e9ciaux \u00c9vitez d'utiliser un pr\u00e9fix dans le nom, \u00e7a complique inutilement le nom et nuit \u00e0 la visibilit\u00e9. Nom des tables Le nom doit \u00eatre au singulier Le nom doit \u00eatre en minuscule Ne pas utiliser de pr\u00e9fix sauf si c'est in\u00e9vitable. Le nom doit \u00eatre clair et explicite Ne pas utiliser d'abr\u00e9viation Nom des champs Le nom doit \u00eatre en minuscule, sans espace et sans nombres. On doit \u00e9viter les pr\u00e9fixes Utilisez un nom court, sans utiliser abr\u00e9viation par contre. Ne pas utiliser de mot r\u00e9serv\u00e9 comme nom de champs, comme date par exemple Le nom d'une cl\u00e9 \u00e9trang\u00e8re devrait contenir le nom de la table et de sa cl\u00e9 primaire. Une cl\u00e9 \u00e9trang\u00e8re vers la table usager dont la cl\u00e9 primaire est le champ id devrait \u00eatre nomm\u00e9e usager_id","title":"Convention de nommage MySQL"},{"location":"notes_de_cours/convention/#convention-de-nommage-mysql","text":"Bien que MySQL n'a pas vraiment de convention de nommage officiel, voici certaines des r\u00e8gles les plus utilis\u00e9es :","title":"Convention de nommage MySQL"},{"location":"notes_de_cours/convention/#regles-generales","text":"Toujours \u00e9crire les noms en minuscule. \u00c7a peut aider \u00e0 \u00e9viter les erreurs, car MySQL est sensible \u00e0 la case Ne jamais utiliser d'espace, la remplacer par une barre de soulignement \"_\" Utilisez seulement des lettres dans les noms, pas de nombres ni de caract\u00e8res sp\u00e9ciaux \u00c9vitez d'utiliser un pr\u00e9fix dans le nom, \u00e7a complique inutilement le nom et nuit \u00e0 la visibilit\u00e9.","title":"R\u00e8gles g\u00e9n\u00e9rales"},{"location":"notes_de_cours/convention/#nom-des-tables","text":"Le nom doit \u00eatre au singulier Le nom doit \u00eatre en minuscule Ne pas utiliser de pr\u00e9fix sauf si c'est in\u00e9vitable. Le nom doit \u00eatre clair et explicite Ne pas utiliser d'abr\u00e9viation","title":"Nom des tables"},{"location":"notes_de_cours/convention/#nom-des-champs","text":"Le nom doit \u00eatre en minuscule, sans espace et sans nombres. On doit \u00e9viter les pr\u00e9fixes Utilisez un nom court, sans utiliser abr\u00e9viation par contre. Ne pas utiliser de mot r\u00e9serv\u00e9 comme nom de champs, comme date par exemple Le nom d'une cl\u00e9 \u00e9trang\u00e8re devrait contenir le nom de la table et de sa cl\u00e9 primaire. Une cl\u00e9 \u00e9trang\u00e8re vers la table usager dont la cl\u00e9 primaire est le champ id devrait \u00eatre nomm\u00e9e usager_id","title":"Nom des champs"},{"location":"notes_de_cours/curseur/","text":"Les curseurs Parfois on peut vouloir effectuer un traitement sur chaque lignes du r\u00e9sultat d'une requ\u00eate. Les curseurs ( cursor ) nous permettent de parcourir justement de parcourir ligne par ligne un r\u00e9sultat, un peu \u00e0 la mani\u00e8re d'une boucle \"while\" en programmation. Il y a trois caract\u00e9ristiques \u00e0 savoir sur les curseurs : Ils sont en lecture seule, on ne peut pas modifier les valeurs du r\u00e9sultat. On ne peut que parcourir les lignes du r\u00e9sultat de la premi\u00e8re \u00e0 la derni\u00e8re et on ne peut pas sauter de ligne. Pour modifier \"l'ordre de lecture\" on doit utiliser le r\u00e9sultat avec la clause ORDER BY de la requ\u00eate qui g\u00e9n\u00e9rera le r\u00e9sultat. En MySQL, les donn\u00e9es du curseurs pointent vers les vrais donn\u00e9es de la base de donn\u00e9es. Ce qui veut dire que si une modification est faite durant l'utilisation du curseur, les donn\u00e9es de celui-ci seront aussi modifi\u00e9es. On peut utiliser les curseurs dans des proc\u00e9dures stock\u00e9es, des fonctions et des \"triggers\". L'utilisation des curseurs se fait en quatre \u00e9tapes : DECLARE : On d\u00e9clare notre curseur en lui sp\u00e9cifiant la requ\u00eate qui sera utilis\u00e9e OPEN : On \"ouvre\" notre curseur. On le place dans un \u00e9tat o\u00f9 il pourra recevoir les donn\u00e9es FETCH : On ajoute les donn\u00e9es de la ligne courante du r\u00e9sultat de la requ\u00eate. La valeur de chaque colonnes de la ligne de r\u00e9sultat sera ajout\u00e9 dans une variable que l'on aura d\u00e9clar\u00e9e pr\u00e9alablement. CLOSE : On ferme le curseur une fois notre utilisation termin\u00e9e. D\u00e9claration du curseur La d\u00e9claration du curseur doit se faire apr\u00e8s la d\u00e9claration des autres variables sinon MySQL va g\u00e9n\u00e9rer un erreur. La syntaxe pour d\u00e9clarer un curseur est la suivante : DECLARE mon_curseur CURSOR FROM requete_select; On doit toujours utiliser une requ\u00eate SELECT pour g\u00e9n\u00e9rer le r\u00e9sultat qui va \u00eatre utilis\u00e9 par le curseur. Voici un exemple o\u00f9 l'on voudrait utiliser le matricule des employ\u00e9es qui ont \u00e9t\u00e9 embauch\u00e9 il y a 5 ans ou plus DECLARE curseur_employe CURSOR FROM SELECT matricule FROM employe WHERE TIMESTAMPDIFF(year,date_embauche, now()) >= 5; Ouverture du curseur Pour ouvrir le curseur, on doit simplement utiliser la commande OPEN suivie du nom du curseur : OPEN mon_curseur; Si on reprend l'exemple plus haut, on ferais OPEN curseur_employe; Ajout de donn\u00e9es au curseur Une fois le curseur disponible, on peut y ajouter des donn\u00e9es avec la commande FETCH . On le verra plus loin mais le cette op\u00e9ration s'effectue \u00e0 l'int\u00e9rieur d'une boucle. Le r\u00e9sultat du FETCH sera les valeurs des colonnes du r\u00e9sultat pour la ligne courante. La syntaxe est la suivante : FETCH mon_curseur INTO liste de variable; Les variables doivent \u00eatre s\u00e9par\u00e9es par des espaces et correspondre au nombre de colonnes du r\u00e9sultat. Ces variables auront \u00e9t\u00e9 d\u00e9clar\u00e9 au d\u00e9but de la proc\u00e9dure comme on l'expliquait plus haut. En reprenant notre exemple, nom allons assigner la valeur du matricule de la ligne courante du r\u00e9sultat dans une variable nomm\u00e9e no_matricule : FETCH curseur_employe INTO no_matricule; Chaque fois qu'on execute la commande FETCH, MySQL essaie de lire la ligne suivante du r\u00e9sultat. S'il n'y a plus d'enregistrement (qu'on est \u00e0 la derni\u00e8re ligne), une exception sera lev\u00e9. On doit g\u00e9rer cette exception si on veut que tout se d\u00e9roule bien. Pour se faire, on va ajouter un HANDLER . Sa d\u00e9claration se fera apr\u00e8s la d\u00e9claration du curseur (on va voir plus loin l'ordre en d\u00e9tail avec un exemple). DECLARE CONTINUE HANDLER FOR NOT FOUND SET fin_enregistrement = 1; En r\u00e9sum\u00e9, on indique \u00e0 MySQL que si il rencontre l'exception NOT FOUND de continuer le traitement ( CONTINUE ) et d'assigner \u00e0 la variable fin_enregistrement la valeur 1. La variable fin_enregistrement aura \u00e9t\u00e9 d\u00e9clar\u00e9 plus haut. Fermeture du curseur Finalement, une fois notre traitement termin\u00e9, il nous reste qu'\u00e0 fermer le curseur. CLOSE mon_curseur; ou avec notre exemple CLOSE curseur_employe; Exemple d'une proc\u00e9dure utilisant un curseur Une entreprise veut cr\u00e9er deux listes de diffusion pour ses employ\u00e9es, une premi\u00e8re pour les employ\u00e9es qui compte moins de x ann\u00e9es d'anciennet\u00e9s et une pour les autres (le nombre d'ann\u00e9es sera re\u00e7u en param\u00eatre). La liste comportera le nom et pr\u00e9nom de l'employ\u00e9 ainsi que son adresse courriel. Dans la base de donn\u00e9es il y a d\u00e9j\u00e0 deux tables qui ont \u00e9t\u00e9 cr\u00e9\u00e9 pour recevoir ces listes : employe_moins et employe_plus . En r\u00e9alit\u00e9 il y aurait plus d'\u00e9tapes en mettre en place dans notre proc\u00e9dure pour s'assurer de l'int\u00e9grit\u00e9 de nos donn\u00e9es (utiliser une transaction, vider les tables avant l'ajout, \"attraper\" les erreurs, etc...). Pour simplifier les choses prenons pour acquis que les tables sont vides et que tout va se d\u00e9rouler sans erreurs comme par magie. DELIMITER $$ CREATE PROCEDURE generer_liste_employe (IN nombre_annee) BEGIN -- D\u00e9claration de la variable utilis\u00e9e dans le handler \"NOT FOUND\" DECLARE fin_enregistrement INTEGER DEFAULT 0; -- D\u00e9claration des variables utilis\u00e9es dans le fetch du curseur DECLARE nom varchar(30) DEFAULT \"\"; DECLARE prenom varchar(30) DEFAULT \"\"; DECLARE courriel varchar(255) DEFAULT \"\"; DECLARE calcul_anciennete INT DEFAULT 0; -- D\u00e9claration du curseur des employ\u00e9es DEClARE curseur_employe CURSOR FOR SELECT nom, prenom, email, TIMESTAMPDIFF(year,date_embauche, now()) FROM employees; -- D\u00e9claration du handler NOT FOUND DECLARE CONTINUE HANDLER FOR NOT FOUND SET fin_enregistrement = 1; -- Ouverture du curseur OPEN curseur_employe; -- D\u00e9but de la boucle liste_employee: LOOP -- On assigne les valeurs de la ligne du r\u00e9sultat aux variables FETCH curseur_employe INTO nom, prenom, courriel, calcul_anciennete; -- On s'assure qu'on n'a pas atteind la fin des enregistrements avant de continuer IF fin_enregistrement = 1 THEN LEAVE liste_employee; END IF; -- En utilisant la variable calcul_anciennete utilis\u00e9e dans le fetch et le param\u00eatre -- nombre_annee, on valide avec un si dans quelle tables ajout\u00e9es les donn\u00e9es IF calcul_anciennete < nombre_annee THEN INSERT INTO employe_moins(nom, prenom, courriel) VALUES (nom, prenom, courriel) ELSE INSERT INTO employe_plus(nom, prenom, courriel) VALUES (nom, prenom, courriel) END IF; END LOOP liste_employee; -- Fermeture du curseur CLOSE curseur_employe; END$$ DELIMITER ; Sources et documentation suppl\u00e9mentaire https://dev.mysql.com/doc/refman/8.0/en/cursors.html https://www.mysqltutorial.org/mysql-cursor/","title":"Les curseurs"},{"location":"notes_de_cours/curseur/#les-curseurs","text":"Parfois on peut vouloir effectuer un traitement sur chaque lignes du r\u00e9sultat d'une requ\u00eate. Les curseurs ( cursor ) nous permettent de parcourir justement de parcourir ligne par ligne un r\u00e9sultat, un peu \u00e0 la mani\u00e8re d'une boucle \"while\" en programmation. Il y a trois caract\u00e9ristiques \u00e0 savoir sur les curseurs : Ils sont en lecture seule, on ne peut pas modifier les valeurs du r\u00e9sultat. On ne peut que parcourir les lignes du r\u00e9sultat de la premi\u00e8re \u00e0 la derni\u00e8re et on ne peut pas sauter de ligne. Pour modifier \"l'ordre de lecture\" on doit utiliser le r\u00e9sultat avec la clause ORDER BY de la requ\u00eate qui g\u00e9n\u00e9rera le r\u00e9sultat. En MySQL, les donn\u00e9es du curseurs pointent vers les vrais donn\u00e9es de la base de donn\u00e9es. Ce qui veut dire que si une modification est faite durant l'utilisation du curseur, les donn\u00e9es de celui-ci seront aussi modifi\u00e9es. On peut utiliser les curseurs dans des proc\u00e9dures stock\u00e9es, des fonctions et des \"triggers\". L'utilisation des curseurs se fait en quatre \u00e9tapes : DECLARE : On d\u00e9clare notre curseur en lui sp\u00e9cifiant la requ\u00eate qui sera utilis\u00e9e OPEN : On \"ouvre\" notre curseur. On le place dans un \u00e9tat o\u00f9 il pourra recevoir les donn\u00e9es FETCH : On ajoute les donn\u00e9es de la ligne courante du r\u00e9sultat de la requ\u00eate. La valeur de chaque colonnes de la ligne de r\u00e9sultat sera ajout\u00e9 dans une variable que l'on aura d\u00e9clar\u00e9e pr\u00e9alablement. CLOSE : On ferme le curseur une fois notre utilisation termin\u00e9e.","title":"Les curseurs"},{"location":"notes_de_cours/curseur/#declaration-du-curseur","text":"La d\u00e9claration du curseur doit se faire apr\u00e8s la d\u00e9claration des autres variables sinon MySQL va g\u00e9n\u00e9rer un erreur. La syntaxe pour d\u00e9clarer un curseur est la suivante : DECLARE mon_curseur CURSOR FROM requete_select; On doit toujours utiliser une requ\u00eate SELECT pour g\u00e9n\u00e9rer le r\u00e9sultat qui va \u00eatre utilis\u00e9 par le curseur. Voici un exemple o\u00f9 l'on voudrait utiliser le matricule des employ\u00e9es qui ont \u00e9t\u00e9 embauch\u00e9 il y a 5 ans ou plus DECLARE curseur_employe CURSOR FROM SELECT matricule FROM employe WHERE TIMESTAMPDIFF(year,date_embauche, now()) >= 5;","title":"D\u00e9claration du curseur"},{"location":"notes_de_cours/curseur/#ouverture-du-curseur","text":"Pour ouvrir le curseur, on doit simplement utiliser la commande OPEN suivie du nom du curseur : OPEN mon_curseur; Si on reprend l'exemple plus haut, on ferais OPEN curseur_employe;","title":"Ouverture du curseur"},{"location":"notes_de_cours/curseur/#ajout-de-donnees-au-curseur","text":"Une fois le curseur disponible, on peut y ajouter des donn\u00e9es avec la commande FETCH . On le verra plus loin mais le cette op\u00e9ration s'effectue \u00e0 l'int\u00e9rieur d'une boucle. Le r\u00e9sultat du FETCH sera les valeurs des colonnes du r\u00e9sultat pour la ligne courante. La syntaxe est la suivante : FETCH mon_curseur INTO liste de variable; Les variables doivent \u00eatre s\u00e9par\u00e9es par des espaces et correspondre au nombre de colonnes du r\u00e9sultat. Ces variables auront \u00e9t\u00e9 d\u00e9clar\u00e9 au d\u00e9but de la proc\u00e9dure comme on l'expliquait plus haut. En reprenant notre exemple, nom allons assigner la valeur du matricule de la ligne courante du r\u00e9sultat dans une variable nomm\u00e9e no_matricule : FETCH curseur_employe INTO no_matricule; Chaque fois qu'on execute la commande FETCH, MySQL essaie de lire la ligne suivante du r\u00e9sultat. S'il n'y a plus d'enregistrement (qu'on est \u00e0 la derni\u00e8re ligne), une exception sera lev\u00e9. On doit g\u00e9rer cette exception si on veut que tout se d\u00e9roule bien. Pour se faire, on va ajouter un HANDLER . Sa d\u00e9claration se fera apr\u00e8s la d\u00e9claration du curseur (on va voir plus loin l'ordre en d\u00e9tail avec un exemple). DECLARE CONTINUE HANDLER FOR NOT FOUND SET fin_enregistrement = 1; En r\u00e9sum\u00e9, on indique \u00e0 MySQL que si il rencontre l'exception NOT FOUND de continuer le traitement ( CONTINUE ) et d'assigner \u00e0 la variable fin_enregistrement la valeur 1. La variable fin_enregistrement aura \u00e9t\u00e9 d\u00e9clar\u00e9 plus haut.","title":"Ajout de donn\u00e9es au curseur"},{"location":"notes_de_cours/curseur/#fermeture-du-curseur","text":"Finalement, une fois notre traitement termin\u00e9, il nous reste qu'\u00e0 fermer le curseur. CLOSE mon_curseur; ou avec notre exemple CLOSE curseur_employe;","title":"Fermeture du curseur"},{"location":"notes_de_cours/curseur/#exemple-dune-procedure-utilisant-un-curseur","text":"Une entreprise veut cr\u00e9er deux listes de diffusion pour ses employ\u00e9es, une premi\u00e8re pour les employ\u00e9es qui compte moins de x ann\u00e9es d'anciennet\u00e9s et une pour les autres (le nombre d'ann\u00e9es sera re\u00e7u en param\u00eatre). La liste comportera le nom et pr\u00e9nom de l'employ\u00e9 ainsi que son adresse courriel. Dans la base de donn\u00e9es il y a d\u00e9j\u00e0 deux tables qui ont \u00e9t\u00e9 cr\u00e9\u00e9 pour recevoir ces listes : employe_moins et employe_plus . En r\u00e9alit\u00e9 il y aurait plus d'\u00e9tapes en mettre en place dans notre proc\u00e9dure pour s'assurer de l'int\u00e9grit\u00e9 de nos donn\u00e9es (utiliser une transaction, vider les tables avant l'ajout, \"attraper\" les erreurs, etc...). Pour simplifier les choses prenons pour acquis que les tables sont vides et que tout va se d\u00e9rouler sans erreurs comme par magie. DELIMITER $$ CREATE PROCEDURE generer_liste_employe (IN nombre_annee) BEGIN -- D\u00e9claration de la variable utilis\u00e9e dans le handler \"NOT FOUND\" DECLARE fin_enregistrement INTEGER DEFAULT 0; -- D\u00e9claration des variables utilis\u00e9es dans le fetch du curseur DECLARE nom varchar(30) DEFAULT \"\"; DECLARE prenom varchar(30) DEFAULT \"\"; DECLARE courriel varchar(255) DEFAULT \"\"; DECLARE calcul_anciennete INT DEFAULT 0; -- D\u00e9claration du curseur des employ\u00e9es DEClARE curseur_employe CURSOR FOR SELECT nom, prenom, email, TIMESTAMPDIFF(year,date_embauche, now()) FROM employees; -- D\u00e9claration du handler NOT FOUND DECLARE CONTINUE HANDLER FOR NOT FOUND SET fin_enregistrement = 1; -- Ouverture du curseur OPEN curseur_employe; -- D\u00e9but de la boucle liste_employee: LOOP -- On assigne les valeurs de la ligne du r\u00e9sultat aux variables FETCH curseur_employe INTO nom, prenom, courriel, calcul_anciennete; -- On s'assure qu'on n'a pas atteind la fin des enregistrements avant de continuer IF fin_enregistrement = 1 THEN LEAVE liste_employee; END IF; -- En utilisant la variable calcul_anciennete utilis\u00e9e dans le fetch et le param\u00eatre -- nombre_annee, on valide avec un si dans quelle tables ajout\u00e9es les donn\u00e9es IF calcul_anciennete < nombre_annee THEN INSERT INTO employe_moins(nom, prenom, courriel) VALUES (nom, prenom, courriel) ELSE INSERT INTO employe_plus(nom, prenom, courriel) VALUES (nom, prenom, courriel) END IF; END LOOP liste_employee; -- Fermeture du curseur CLOSE curseur_employe; END$$ DELIMITER ;","title":"Exemple d'une proc\u00e9dure utilisant un curseur"},{"location":"notes_de_cours/curseur/#sources-et-documentation-supplementaire","text":"https://dev.mysql.com/doc/refman/8.0/en/cursors.html https://www.mysqltutorial.org/mysql-cursor/","title":"Sources et documentation suppl\u00e9mentaire"},{"location":"notes_de_cours/formes_normales/","text":"Formes normales Les formes normales sont un ensemble de r\u00e8gles qui, si elles sont suivies, nous assure de la robustesse de notre mod\u00e8le de donn\u00e9es. Elles nous offrent aussi les avantages suivants : \u00c9viter la redondance des donn\u00e9es Simplifier les mises \u00e0 jour Interdire les incoh\u00e9rences de donn\u00e9es venant des redondances Il existe 8 niveaux de formes normales, mais le plus souvent seulement les trois premi\u00e8res sont appliqu\u00e9es. C'est aussi ce que nous verrons dans le cadre du cours. Chaque forme normale doit respecter toutes les formes qui la pr\u00e9c\u00e8dent. Pour qu'on puisse dire qu'on est en troisi\u00e8me forme normale, il faut que la premi\u00e8re et deuxi\u00e8me forme soit respect\u00e9e. Premi\u00e8re forme normale (1FN) Dans la premi\u00e8re forme normale, on doit s'assurer que chaque attribut soit atomique, c'est-\u00e0-dire qu'il n'est pas une liste de valeurs ou bien compos\u00e9 (si on le d\u00e9compose, on obtient d'autres informations). Exemple d'une table usager qui n'est pas 1FN id nom email 1 Fr\u00e9chette, Mathieu math.frechette@gmail.com 2 Fr\u00e9chette, J\u00e9r\u00f4me jero@gmail.com, jerome.frechette@caramail.com 3 Mathis, Jennifer jennyM@gmail.com La forme n'est pas respect\u00e9e, car les valeurs de l'attribut nom sont compos\u00e9es et l'attribut email contient parfois une liste de valeur. Pour \u00eatre 1FN, on devrait cr\u00e9er une nouvelle table avec l'attribut email et s\u00e9parer l'attribut nom en deux, nom et pr\u00e9nom : table usager ID NOM PRENOM 1 Fr\u00e9chette Mathieu 2 Fr\u00e9chette J\u00e9r\u00f4me 3 Mathis Jennifer table email ID USAGER_ID EMAIL 1 1 math.frechette@gmail.com 2 2 jero@gmail.com 3 2 jerome.frechette@caramail.com 4 3 jennyM@gmail.com Impact de l'application de la r\u00e8gle Aucun attribut n\u2019est compos\u00e9 ou de valeurs multiples Impose par ce fait qu'un attribut membre de la cl\u00e9 primaire est toujours \u00e0 valeur unique Augmente grandement la performance en \u00e9vitant de parcourir des attributs sous forme de liste et en cr\u00e9ant des indexes plus performants. Deuxi\u00e8me forme normale (2FN) Pour \u00eatre en 2FN, il faut : Respecter la premi\u00e8re forme normale Que tous les attributs qui ne sont pas une cl\u00e9 primaire soient d\u00e9pendant en totalit\u00e9 de la ou des cl\u00e9s primaires. Supposons la table note_cours dans laquelle on veut enregistrer la note obtenue par cours par \u00e9tudiant : ETUDIANT_ID COURS_ID NOTE NOM_COURS 1 1 95 Programmation 1 2 1 88 Programmation 1 1 2 64 Design Web Cette table n'est pas 2FN, car l'attribut NOM_COURS est d\u00e9pendant de la cl\u00e9 COURS_ID, mais pas de la cl\u00e9 ETUDIANT_ID. L'attribut devrait \u00eatre enregistr\u00e9 dans une autre table. table note_cours ETUDIANT_ID COURS_ID NOTE 1 1 95 2 1 88 1 2 64 table cours ID NOM 1 Programmation 1 2 Design Web Impact de l'application de la r\u00e8gle Permets d'\u00e9liminer plusieurs redondances des donn\u00e9es. Facilite la mise \u00e0 jour des donn\u00e9es Troisi\u00e8me forme normale (3FN) Pour respecter la troisi\u00e8me forme normale, on doit : Remplir toutes les exigences de la deuxi\u00e8me r\u00e8gle normale, donc implicitement de la premi\u00e8re r\u00e8gle aussi. Tous les attributs qui ne sont pas une cl\u00e9 primaire doivent d\u00e9pendre directement de la cl\u00e9 primaire et non d'autres attributs de la table. Prenons par exemple la table inventaire suivante ID QUANTITE ITEM_ID DESCRIPTION 1 3 1 Potion de soins mineures 2 11 2 \u00c9p\u00e9e de cuivre Ici l'attribut DESCRIPTION est d\u00e9pendant de l'attribut ITEM_ID , mais pas de la cl\u00e9 primaire ID . La solution ici serait de supprimer l'attribut description de la table, en supposant que l'information se retrouve dans la table item . Impact de l'application de la r\u00e8gle Permets d'\u00e9liminer plusieurs redondances des donn\u00e9es. Facilite la mise \u00e0 jour des donn\u00e9es Dans certaines situations, une fois la troisi\u00e8me forme atteinte, il peut \u00eatre acceptable de briser la r\u00e8gle \u00e0 cause de certaines exigences ou probl\u00e9matiques pr\u00e9cise. Par exemple dans une table o\u00f9 on enregistre le d\u00e9tail d'une ligne de facture, le total de la ligne ne doit pas \u00eatre sauvegard\u00e9, car il peut \u00eatre calcul\u00e9 \u00e0 partir de la quantit\u00e9 et du prix unitaire. Par contre, si on a \u00e0 faire beaucoup d'op\u00e9ration avec le total de la ligne, on pourrait conserver le total dans une colonne pour faciliter le traitement.","title":"Les formes normales"},{"location":"notes_de_cours/formes_normales/#formes-normales","text":"Les formes normales sont un ensemble de r\u00e8gles qui, si elles sont suivies, nous assure de la robustesse de notre mod\u00e8le de donn\u00e9es. Elles nous offrent aussi les avantages suivants : \u00c9viter la redondance des donn\u00e9es Simplifier les mises \u00e0 jour Interdire les incoh\u00e9rences de donn\u00e9es venant des redondances Il existe 8 niveaux de formes normales, mais le plus souvent seulement les trois premi\u00e8res sont appliqu\u00e9es. C'est aussi ce que nous verrons dans le cadre du cours. Chaque forme normale doit respecter toutes les formes qui la pr\u00e9c\u00e8dent. Pour qu'on puisse dire qu'on est en troisi\u00e8me forme normale, il faut que la premi\u00e8re et deuxi\u00e8me forme soit respect\u00e9e.","title":"Formes normales"},{"location":"notes_de_cours/formes_normales/#premiere-forme-normale-1fn","text":"Dans la premi\u00e8re forme normale, on doit s'assurer que chaque attribut soit atomique, c'est-\u00e0-dire qu'il n'est pas une liste de valeurs ou bien compos\u00e9 (si on le d\u00e9compose, on obtient d'autres informations). Exemple d'une table usager qui n'est pas 1FN id nom email 1 Fr\u00e9chette, Mathieu math.frechette@gmail.com 2 Fr\u00e9chette, J\u00e9r\u00f4me jero@gmail.com, jerome.frechette@caramail.com 3 Mathis, Jennifer jennyM@gmail.com La forme n'est pas respect\u00e9e, car les valeurs de l'attribut nom sont compos\u00e9es et l'attribut email contient parfois une liste de valeur. Pour \u00eatre 1FN, on devrait cr\u00e9er une nouvelle table avec l'attribut email et s\u00e9parer l'attribut nom en deux, nom et pr\u00e9nom : table usager ID NOM PRENOM 1 Fr\u00e9chette Mathieu 2 Fr\u00e9chette J\u00e9r\u00f4me 3 Mathis Jennifer table email ID USAGER_ID EMAIL 1 1 math.frechette@gmail.com 2 2 jero@gmail.com 3 2 jerome.frechette@caramail.com 4 3 jennyM@gmail.com Impact de l'application de la r\u00e8gle Aucun attribut n\u2019est compos\u00e9 ou de valeurs multiples Impose par ce fait qu'un attribut membre de la cl\u00e9 primaire est toujours \u00e0 valeur unique Augmente grandement la performance en \u00e9vitant de parcourir des attributs sous forme de liste et en cr\u00e9ant des indexes plus performants.","title":"Premi\u00e8re forme normale (1FN)"},{"location":"notes_de_cours/formes_normales/#deuxieme-forme-normale-2fn","text":"Pour \u00eatre en 2FN, il faut : Respecter la premi\u00e8re forme normale Que tous les attributs qui ne sont pas une cl\u00e9 primaire soient d\u00e9pendant en totalit\u00e9 de la ou des cl\u00e9s primaires. Supposons la table note_cours dans laquelle on veut enregistrer la note obtenue par cours par \u00e9tudiant : ETUDIANT_ID COURS_ID NOTE NOM_COURS 1 1 95 Programmation 1 2 1 88 Programmation 1 1 2 64 Design Web Cette table n'est pas 2FN, car l'attribut NOM_COURS est d\u00e9pendant de la cl\u00e9 COURS_ID, mais pas de la cl\u00e9 ETUDIANT_ID. L'attribut devrait \u00eatre enregistr\u00e9 dans une autre table. table note_cours ETUDIANT_ID COURS_ID NOTE 1 1 95 2 1 88 1 2 64 table cours ID NOM 1 Programmation 1 2 Design Web Impact de l'application de la r\u00e8gle Permets d'\u00e9liminer plusieurs redondances des donn\u00e9es. Facilite la mise \u00e0 jour des donn\u00e9es","title":"Deuxi\u00e8me forme normale (2FN)"},{"location":"notes_de_cours/formes_normales/#troisieme-forme-normale-3fn","text":"Pour respecter la troisi\u00e8me forme normale, on doit : Remplir toutes les exigences de la deuxi\u00e8me r\u00e8gle normale, donc implicitement de la premi\u00e8re r\u00e8gle aussi. Tous les attributs qui ne sont pas une cl\u00e9 primaire doivent d\u00e9pendre directement de la cl\u00e9 primaire et non d'autres attributs de la table. Prenons par exemple la table inventaire suivante ID QUANTITE ITEM_ID DESCRIPTION 1 3 1 Potion de soins mineures 2 11 2 \u00c9p\u00e9e de cuivre Ici l'attribut DESCRIPTION est d\u00e9pendant de l'attribut ITEM_ID , mais pas de la cl\u00e9 primaire ID . La solution ici serait de supprimer l'attribut description de la table, en supposant que l'information se retrouve dans la table item . Impact de l'application de la r\u00e8gle Permets d'\u00e9liminer plusieurs redondances des donn\u00e9es. Facilite la mise \u00e0 jour des donn\u00e9es Dans certaines situations, une fois la troisi\u00e8me forme atteinte, il peut \u00eatre acceptable de briser la r\u00e8gle \u00e0 cause de certaines exigences ou probl\u00e9matiques pr\u00e9cise. Par exemple dans une table o\u00f9 on enregistre le d\u00e9tail d'une ligne de facture, le total de la ligne ne doit pas \u00eatre sauvegard\u00e9, car il peut \u00eatre calcul\u00e9 \u00e0 partir de la quantit\u00e9 et du prix unitaire. Par contre, si on a \u00e0 faire beaucoup d'op\u00e9ration avec le total de la ligne, on pourrait conserver le total dans une colonne pour faciliter le traitement.","title":"Troisi\u00e8me forme normale (3FN)"},{"location":"notes_de_cours/function/","text":"Les fonctions stock\u00e9es (Stored function) C'est quoi et \u00e0 quoi \u00e7a sert? Cr\u00e9ation d'une fonction Utilisation d'une fonction Modification d'une fonction Suppression d'une fonction","title":"Les fonctions stock\u00e9es (Stored function)"},{"location":"notes_de_cours/function/#les-fonctions-stockees-stored-function","text":"C'est quoi et \u00e0 quoi \u00e7a sert?","title":"Les fonctions stock\u00e9es (Stored function)"},{"location":"notes_de_cours/function/#creation-dune-fonction","text":"","title":"Cr\u00e9ation d'une fonction"},{"location":"notes_de_cours/function/#utilisation-dune-fonction","text":"","title":"Utilisation d'une fonction"},{"location":"notes_de_cours/function/#modification-dune-fonction","text":"","title":"Modification d'une fonction"},{"location":"notes_de_cours/function/#suppression-dune-fonction","text":"","title":"Suppression d'une fonction"},{"location":"notes_de_cours/insert/","text":"INSERT La commande INSERT est utilis\u00e9e pour ajouter des enregistrements dans une table. Syntaxe de base La m\u00e9thode la plus simple INSERT INTO ma_table VALUES (valeur1, valeur2, valeur3); Avantages - Requ\u00eate plus courte - Si on modifie les noms de colonnes, pas besoin de modifier la requ\u00eate. Inconv\u00e9nients Possibilit\u00e9 d'erreurs plus grande, il faut que les valeurs concordent avec le nombre de colonnes et leur position. La m\u00e9thode la plus pr\u00e9cise INSERT INTO ma_table (colonne1, colonne2, colonne3) VALUES (valeur1, valeur2, valeur3); Avantages - Plus de pr\u00e9cisions dans la requ\u00eate - On n'est pas forc\u00e9 de suivre l'ordre des colonnes ni d'ajouter une valeur pour chacune d'entre elles. Inconv\u00e9nient - Les requ\u00eates sont plus longue \u00e0 \u00e9crire. Au niveau de la maintenance, si on modifie un nom de colonne, il faut modifier toutes les requ\u00eates ajoutant des valeurs dans cette colonne. Ins\u00e9rer des donn\u00e9es seulement dans certaines colonnes INSERT INTO ma_table (colonne1) VALUES (valeur1); Les autres champs non sp\u00e9cifi\u00e9s prendront la valeur par d\u00e9faut si elle est d\u00e9fini ou NULL sinon. Ins\u00e9rer plusieurs lignes dans la m\u00eame requ\u00eate La syntaxe est la m\u00eame, on doit seulement s\u00e9parer les s\u00e9ries de valeurs par une virgule : INSERT INTO ma_table VALUES (valeur_a1, valeur_a2, valeur_a3), (valeur_b1, valeur_b2, valeur_b3), (valeur_c1, valeur_c2, valeur_c3), (valeur_d1, valeur_d2, valeur_d3); INSERT INTO ma_table (colonne1, colonne2, colonne3) VALUES (valeur_a1, valeur_a2, valeur_a3), (valeur_b1, valeur_b2, valeur_b3), (valeur_c1, valeur_c2, valeur_c3), (valeur_d1, valeur_d2, valeur_d3); Ins\u00e9rer des valeurs provenant d'une autre table On peut ins\u00e9rer les valeurs d'autres tables en utilisant une sous-requ\u00eate de s\u00e9lection au lieu de sp\u00e9cifier les valeurs dans la section VALUES . INSERT INTO ma_table (colonne1, colonne2, colonne3) SELECT valeur1, valeur2, valeur3 FROM table_source; La requ\u00eate SELECT n'a pas de contraintes et peut contenir plusieurs jointures, des conditions WHERE et HAVING , d'autres sous-requ\u00eate, etc. Si on veut ins\u00e9rer tout le contenu d'une table dans une autre, on peut utiliser l'instruction TABLE et le nom de la table d'o\u00f9 proviennent les donn\u00e9es \u00e0 ins\u00e9rer. INSERT INTO ma_table TABLE table_source Les colonnes de type auto-incr\u00e9ment Ce type de colonne est incr\u00e9ment\u00e9e automatiquement lors d'une insertion de donn\u00e9es, on ne doit pas les ajouter dans nos requ\u00eates d'insertion. R\u00e9cup\u00e9rer la valeur d'une colonne auto-incr\u00e9ment On peut r\u00e9cup\u00e9rer la premi\u00e8re valeur provenant d'un champ auto-incr\u00e9ment qui a \u00e9t\u00e9 ins\u00e9rer avec succ\u00e8s en utilisant la fonction last_insert_id() . INSERT INTO ma_table (colonne1) VALUES (valeur1); SELECT last_insert_id();","title":"INSERT"},{"location":"notes_de_cours/insert/#insert","text":"La commande INSERT est utilis\u00e9e pour ajouter des enregistrements dans une table.","title":"INSERT"},{"location":"notes_de_cours/insert/#syntaxe-de-base","text":"","title":"Syntaxe de base"},{"location":"notes_de_cours/insert/#la-methode-la-plus-simple","text":"INSERT INTO ma_table VALUES (valeur1, valeur2, valeur3); Avantages - Requ\u00eate plus courte - Si on modifie les noms de colonnes, pas besoin de modifier la requ\u00eate. Inconv\u00e9nients Possibilit\u00e9 d'erreurs plus grande, il faut que les valeurs concordent avec le nombre de colonnes et leur position.","title":"La m\u00e9thode la plus simple"},{"location":"notes_de_cours/insert/#la-methode-la-plus-precise","text":"INSERT INTO ma_table (colonne1, colonne2, colonne3) VALUES (valeur1, valeur2, valeur3); Avantages - Plus de pr\u00e9cisions dans la requ\u00eate - On n'est pas forc\u00e9 de suivre l'ordre des colonnes ni d'ajouter une valeur pour chacune d'entre elles. Inconv\u00e9nient - Les requ\u00eates sont plus longue \u00e0 \u00e9crire. Au niveau de la maintenance, si on modifie un nom de colonne, il faut modifier toutes les requ\u00eates ajoutant des valeurs dans cette colonne.","title":"La m\u00e9thode la plus pr\u00e9cise"},{"location":"notes_de_cours/insert/#inserer-des-donnees-seulement-dans-certaines-colonnes","text":"INSERT INTO ma_table (colonne1) VALUES (valeur1); Les autres champs non sp\u00e9cifi\u00e9s prendront la valeur par d\u00e9faut si elle est d\u00e9fini ou NULL sinon.","title":"Ins\u00e9rer des donn\u00e9es seulement dans certaines colonnes"},{"location":"notes_de_cours/insert/#inserer-plusieurs-lignes-dans-la-meme-requete","text":"La syntaxe est la m\u00eame, on doit seulement s\u00e9parer les s\u00e9ries de valeurs par une virgule : INSERT INTO ma_table VALUES (valeur_a1, valeur_a2, valeur_a3), (valeur_b1, valeur_b2, valeur_b3), (valeur_c1, valeur_c2, valeur_c3), (valeur_d1, valeur_d2, valeur_d3); INSERT INTO ma_table (colonne1, colonne2, colonne3) VALUES (valeur_a1, valeur_a2, valeur_a3), (valeur_b1, valeur_b2, valeur_b3), (valeur_c1, valeur_c2, valeur_c3), (valeur_d1, valeur_d2, valeur_d3);","title":"Ins\u00e9rer plusieurs lignes dans la m\u00eame requ\u00eate"},{"location":"notes_de_cours/insert/#inserer-des-valeurs-provenant-dune-autre-table","text":"On peut ins\u00e9rer les valeurs d'autres tables en utilisant une sous-requ\u00eate de s\u00e9lection au lieu de sp\u00e9cifier les valeurs dans la section VALUES . INSERT INTO ma_table (colonne1, colonne2, colonne3) SELECT valeur1, valeur2, valeur3 FROM table_source; La requ\u00eate SELECT n'a pas de contraintes et peut contenir plusieurs jointures, des conditions WHERE et HAVING , d'autres sous-requ\u00eate, etc. Si on veut ins\u00e9rer tout le contenu d'une table dans une autre, on peut utiliser l'instruction TABLE et le nom de la table d'o\u00f9 proviennent les donn\u00e9es \u00e0 ins\u00e9rer. INSERT INTO ma_table TABLE table_source","title":"Ins\u00e9rer des valeurs provenant d'une autre table"},{"location":"notes_de_cours/insert/#les-colonnes-de-type-auto-increment","text":"Ce type de colonne est incr\u00e9ment\u00e9e automatiquement lors d'une insertion de donn\u00e9es, on ne doit pas les ajouter dans nos requ\u00eates d'insertion.","title":"Les colonnes de type auto-incr\u00e9ment"},{"location":"notes_de_cours/insert/#recuperer-la-valeur-dune-colonne-auto-increment","text":"On peut r\u00e9cup\u00e9rer la premi\u00e8re valeur provenant d'un champ auto-incr\u00e9ment qui a \u00e9t\u00e9 ins\u00e9rer avec succ\u00e8s en utilisant la fonction last_insert_id() . INSERT INTO ma_table (colonne1) VALUES (valeur1); SELECT last_insert_id();","title":"R\u00e9cup\u00e9rer la valeur d'une colonne auto-incr\u00e9ment"},{"location":"notes_de_cours/join/","text":"Les jointures Base de donn\u00e9es mod\u00e8les J'ai un syst\u00e8me de deux tables, l'une de joueurs et l'autre de guilde. Les joueurs peuvent ou non faire partie d'une guilde et chaque guilde peut avoir de 0 \u00e0 plusieurs joueurs. table joueur id guilde_id nom prenom 1 1 Fr\u00e9chette Mathieu 2 1 Ouellet Alexandre 3 2 Tousignant Simon 4 null Taleb Fr\u00e9d\u00e9ric table guilde id Nom 1 SqlIsGod 2 Error404 3 IsNobodyHere \u200b INNER JOIN Une jointure INNER JOIN retournera tous les enregistrements correspondants entre deux tables. Exemple SELECT j.nom, j.prenom, g.nom AS guilde FROM joueur j INNER JOIN guilde g ON g.id = j.guilde_id; R\u00e9sultat nom prenom guilde Fr\u00e9chette Mathieu SqlIsGod Ouellet Alexandre SqlIsGod Tousignant Simon Error404 LEFT JOIN Une jointure LEFT JOIN retournera tous les enregistrements de la table de gauche et seulement les enregistrements correspondant de la table de droite. Exemple SELECT j.nom, j.prenom, g.nom AS guilde FROM joueur j LEFT JOIN guilde g ON g.id = j.guilde_id; R\u00e9sultat nom prenom guilde Fr\u00e9chette Mathieu SqlIsGod Ouellet Alexandre SqlIsGod Tousignant Simon Error404 Taleb Fr\u00e9d\u00e9ric NULL RIGHT JOIN Une jointure RIGHT JOIN retournera tous les enregistrements de la table de droite et seulement les enregistrements correspondant de la table de gauche. Exemple SELECT j.nom, j.prenom, g.nom AS guilde FROM joueur j RIGHT JOIN guilde g ON g.id = j.guilde_id; R\u00e9sultat Nom prenom guilde Fr\u00e9chette Mathieu SqlIsGod Ouellet Alexandre SqlIsGod Tousignant Simon Error404 NULL NULL IsNobodyHere OUTER JOIN Une jointure OUTER JOIN retournera tous les enregistrements des deux tables. On ne peux pas utiliser la commande OUTER JOIN en MySQL mais on peut arriver au m\u00eame r\u00e9sultat en faisant une premi\u00e8re requ\u00eate avec un LEFT JOIN unis \u00e0 une deuxi\u00e8me requ\u00eate avec un RIGHT JOIN Exemple SELECT j.nom, j.prenom, g.nom AS guilde FROM joueur j LEFT JOIN guilde g ON g.id = j.guilde_id UNION SELECT j.nom, j.prenom, g.nom AS guilde FROM joueur j RIGHT JOIN guilde g ON g.id = j.guilde_id; R\u00e9sultat Nom prenom guilde Fr\u00e9chette Mathieu SqlIsGod Ouellet Alexandre SqlIsGod Tousignant Simon Error404 Taleb Fr\u00e9d\u00e9ric NULL NULL NULL IsNobodyHere UNION L'op\u00e9rateur UNION est utilis\u00e9 pour combiner les r\u00e9sultats de deux ou plusieurs requ\u00eate SELECT. On doit par contre respecter les trois r\u00e8gles suivantes : Toutes les requ\u00eates SELECT doivent comporter le m\u00eame nombre de colonnes. Les colonnes correspondantes doivent avoir un type de donn\u00e9es similaire. Les colonnes doivent aussi \u00eatre dans le m\u00eame ordre. Syntaxe SELECT colonne1, colonne2 FROM table1 UNION SELECT colonne1, colonne2 FROM table2; Par d\u00e9faut l'op\u00e9rateur UNION conservera que les valeurs unique des multiples requ\u00eates. Si ont veut conserver les doublons, on doit ajouter ALL. SELECT colonne1, colonne2 FROM table1 UNION ALL SELECT colonne1, colonne2 FROM table2; Le nom des colonnes du r\u00e9sultat sera le nom des colonnes d\u00e9fini dans la premi\u00e8re requ\u00eate.","title":"Les jointures entre les tables"},{"location":"notes_de_cours/join/#les-jointures","text":"","title":"Les jointures"},{"location":"notes_de_cours/join/#base-de-donnees-modeles","text":"J'ai un syst\u00e8me de deux tables, l'une de joueurs et l'autre de guilde. Les joueurs peuvent ou non faire partie d'une guilde et chaque guilde peut avoir de 0 \u00e0 plusieurs joueurs. table joueur id guilde_id nom prenom 1 1 Fr\u00e9chette Mathieu 2 1 Ouellet Alexandre 3 2 Tousignant Simon 4 null Taleb Fr\u00e9d\u00e9ric table guilde id Nom 1 SqlIsGod 2 Error404 3 IsNobodyHere \u200b","title":"Base de donn\u00e9es mod\u00e8les"},{"location":"notes_de_cours/join/#inner-join","text":"Une jointure INNER JOIN retournera tous les enregistrements correspondants entre deux tables. Exemple SELECT j.nom, j.prenom, g.nom AS guilde FROM joueur j INNER JOIN guilde g ON g.id = j.guilde_id; R\u00e9sultat nom prenom guilde Fr\u00e9chette Mathieu SqlIsGod Ouellet Alexandre SqlIsGod Tousignant Simon Error404","title":"INNER JOIN"},{"location":"notes_de_cours/join/#left-join","text":"Une jointure LEFT JOIN retournera tous les enregistrements de la table de gauche et seulement les enregistrements correspondant de la table de droite. Exemple SELECT j.nom, j.prenom, g.nom AS guilde FROM joueur j LEFT JOIN guilde g ON g.id = j.guilde_id; R\u00e9sultat nom prenom guilde Fr\u00e9chette Mathieu SqlIsGod Ouellet Alexandre SqlIsGod Tousignant Simon Error404 Taleb Fr\u00e9d\u00e9ric NULL","title":"LEFT JOIN"},{"location":"notes_de_cours/join/#right-join","text":"Une jointure RIGHT JOIN retournera tous les enregistrements de la table de droite et seulement les enregistrements correspondant de la table de gauche. Exemple SELECT j.nom, j.prenom, g.nom AS guilde FROM joueur j RIGHT JOIN guilde g ON g.id = j.guilde_id; R\u00e9sultat Nom prenom guilde Fr\u00e9chette Mathieu SqlIsGod Ouellet Alexandre SqlIsGod Tousignant Simon Error404 NULL NULL IsNobodyHere","title":"RIGHT JOIN"},{"location":"notes_de_cours/join/#outer-join","text":"Une jointure OUTER JOIN retournera tous les enregistrements des deux tables. On ne peux pas utiliser la commande OUTER JOIN en MySQL mais on peut arriver au m\u00eame r\u00e9sultat en faisant une premi\u00e8re requ\u00eate avec un LEFT JOIN unis \u00e0 une deuxi\u00e8me requ\u00eate avec un RIGHT JOIN Exemple SELECT j.nom, j.prenom, g.nom AS guilde FROM joueur j LEFT JOIN guilde g ON g.id = j.guilde_id UNION SELECT j.nom, j.prenom, g.nom AS guilde FROM joueur j RIGHT JOIN guilde g ON g.id = j.guilde_id; R\u00e9sultat Nom prenom guilde Fr\u00e9chette Mathieu SqlIsGod Ouellet Alexandre SqlIsGod Tousignant Simon Error404 Taleb Fr\u00e9d\u00e9ric NULL NULL NULL IsNobodyHere","title":"OUTER JOIN"},{"location":"notes_de_cours/join/#union","text":"L'op\u00e9rateur UNION est utilis\u00e9 pour combiner les r\u00e9sultats de deux ou plusieurs requ\u00eate SELECT. On doit par contre respecter les trois r\u00e8gles suivantes : Toutes les requ\u00eates SELECT doivent comporter le m\u00eame nombre de colonnes. Les colonnes correspondantes doivent avoir un type de donn\u00e9es similaire. Les colonnes doivent aussi \u00eatre dans le m\u00eame ordre. Syntaxe SELECT colonne1, colonne2 FROM table1 UNION SELECT colonne1, colonne2 FROM table2; Par d\u00e9faut l'op\u00e9rateur UNION conservera que les valeurs unique des multiples requ\u00eates. Si ont veut conserver les doublons, on doit ajouter ALL. SELECT colonne1, colonne2 FROM table1 UNION ALL SELECT colonne1, colonne2 FROM table2; Le nom des colonnes du r\u00e9sultat sera le nom des colonnes d\u00e9fini dans la premi\u00e8re requ\u00eate.","title":"UNION"},{"location":"notes_de_cours/operateur/","text":"Op\u00e9rateurs logique SQL IN L'op\u00e9rateur IN nous permet d'inclure plusieurs valeurs de comparaison dans une clause WHERE. On peut le voir comme plusieurs OR sur une m\u00eame colonne. On peut aussi l'utiliser avec une sous-requ\u00eate. Syntaxe -- Utilisation comme une s\u00e9rie de OR SELECT nom_colonne FROM ma_table WHERE nom_colonne_test IN ('Valeur1', 'Valeur2', 'Valeur3', ...); -- Utilisation avec une sous-requ\u00eate SELECT nom_colonne FROM ma_table WHERE nom_colonne_test IN ( sous-requ\u00eate ); Exemple Je veux la liste des athl\u00e8tes qui sont originaire du Qu\u00e9bec, de l'Ontario ou de la Saskatchewan SELECT * FROM athlete a WHERE a.province IN ('Qu\u00e9bec', 'Ontario', 'Saskatchewan'); \u00c0 partir des tables suivantes, je veux avoir la liste de tous les athl\u00e8tes qui ont d\u00e9j\u00e0 participer \u00e0 un marathon. La base de donn\u00e9es contient une table athl\u00e8te qui contient la liste de tous les athl\u00e8tes et une table r\u00e9sultat qui contient le r\u00e9sultat \u00e0 une course, le id de l'athl\u00e8te et le id de l'\u00e9preuve (le marathon \u00e0 un id de 4). SELECT * FROM athlete a WHERE a.id IN ( SELECT r.athlete_id FROM resultat r WHERE r.epreuve_id = 4 AND r.athlete_id = a.id ); LIKE L'op\u00e9rateur LIKE nous permet d'utiliser les \"jokers\" ( wildcard ) suivant dans une expression pour faire une recherche dans un colonne sp\u00e9cifique avec un certain motif. % remplace n'importe quel texte de n'importe quelle longueur. _ remplace un seul caract\u00e8re. Exemple -- Liste tous les athl\u00e8tes dont le nom d\u00e9bute par Fr\u00e9 SELECT * FROM athlete a WHERE a.nom LIKE 'Fr\u00e9%'; -- Liste tous les athl\u00e8tes dont le nom se termine par ette SELECT * FROM athlete a WHERE a.nom LIKE '%ette'; -- Liste tous les athl\u00e8tes dont le nom contient ch (le terme ch pour \u00eatre situ\u00e9 au tout -- d\u00e9but du nom, dans le milieu ou \u00e0 la fin) SELECT * FROM athlete a WHERE a.nom LIKE '%ch%'; -- Liste tous les athl\u00e8tes dont le nom se d\u00e9bute par Fr, est suivi d'une lettre quelconque --- et se termine par chette. SELECT * FROM athlete a WHERE a.nom LIKE 'Fr_chette'; REGEXP On peut aussi faire des comparaison beaucoup plus complexe en utilisant l'op\u00e9rateur REGEXP et des expressions r\u00e9guli\u00e8res. Syntaxe SELECT nom_colonne FROM ma_table WHERE nom_colonne_test REGEXP (expression_reguliere) Exemple Je veux la liste des athl\u00e8tes qui ont un nom d'exactement 9 caract\u00e8res SELECT * FROM athlete a WHERE a.nom REGEXP \"^.{12}$\"; Pour cr\u00e9er et tester des expressions r\u00e9guli\u00e8res : https://regexr.com/ NOT L'op\u00e9rateur NOT va inverser le r\u00e9sultat d'une condition. Il peut \u00eatre jumel\u00e9 \u00e0 la plupart des autres op\u00e9rateurs. Exemple Je veux la liste des athl\u00e8tes qui ne sont PAS originaire du Qu\u00e9bec, de l'Ontario ou de la Saskatchewan SELECT * FROM athlete a WHERE a.province NOT IN ('Qu\u00e9bec', 'Ontario', 'Saskatchewan'); Je veux la liste des athl\u00e8tes dont l'adresse courriel n'est pas une adresse GMAIL SELECT * FROM athlete a WHERE a.courriel NOT LIKE '%@gmail.com'; Je veux la liste des athl\u00e8tes dont la valeur de la colonne date_naissance n'est pas NULL SELECT * FROM athlete a WHERE a.date_naissance IS NOT NULL EXISTS L'op\u00e9rateur EXISTS est utilis\u00e9e pour d\u00e9terminer si le r\u00e9sultat d'une sous-requ\u00eate retourne des enregistrements ou non. Il retournera TRUE si la sous-requ\u00eate contient un ou plusieurs enregistrement et FALSE dans le cas contraire. Le traitement se termine d\u00e8s qu'une ligne correspondante dans la sous-requ\u00eate est trouv\u00e9e. Syntaxe SELECT nom_colonne FROM ma_table WHERE EXISTS(sous-requ\u00eate); Exemple \u00c0 partir des tables suivantes, je veux avoir la liste de tous les athl\u00e8tes qui ont d\u00e9j\u00e0 participer \u00e0 un marathon. La base de donn\u00e9es contient une table athl\u00e8te qui contient la liste de tous les athl\u00e8tes et une table r\u00e9sultat qui contient le r\u00e9sultat \u00e0 une course, le id de l'athl\u00e8te et le id de l'\u00e9preuve (le marathon \u00e0 un id de 4). select * from athlete a where exists ( select 1 from resultat r where r.epreuve_id = 4 and r.athlete_id = a.id ); Il est aussi int\u00e9ressant de noter ici que m\u00eame si un athl\u00e8te a particip\u00e9 \u00e0 plus d'un marathon il ne sera affich\u00e9 qu'une fois dans la liste car comme dit plus haut, d\u00e8s qu'il y a une correspondance, la sous-requ\u00eate de la fonction se termine. L'op\u00e9rateur EXISTS peut aussi \u00eatre utilis\u00e9e dans la clause WHERE d'un UPDATE, INSERT et DELETE. DELETE FROM athlete WHERE EXISTS( select 1 from resultat r where r.epreuve_id = 4 and r.athlete_id = a.id ); Dans cette exemple, tous les athl\u00e8tes qui ont d\u00e9j\u00e0 particip\u00e9 \u00e0 un marathon seront supprim\u00e9es. On peut aussi utilis\u00e9 l'op\u00e9rateur NOT pour inverser le r\u00e9sultat. Si on reprends l'exemple o\u00f9 on liste les athl\u00e8tes qui ont d\u00e9j\u00e0 participer \u00e0 un marathon mais qu'on voudrait connaitre l'inverse, c'est-\u00e0-dire d'avoir la liste des athl\u00e8tes qui n'ont jamais particip\u00e9 \u00e0 un marathon. Il suffit d'ajouter NOT devant le EXISTS pour inverser le r\u00e9sultat et avoir la r\u00e9ponse recherch\u00e9. select * from athlete a where not exists ( select 1 from resultat r where r.epreuve_id = 4 and r.athlete_id = a.id ); Pour plus d'exemple : https://sql.sh/cours/where/exists https://www.mysqltutorial.org/mysql-exists/ https://www.w3schools.com/sql/sql_exists.asp","title":"Les op\u00e9rateurs logiques"},{"location":"notes_de_cours/operateur/#operateurs-logique-sql","text":"","title":"Op\u00e9rateurs logique SQL"},{"location":"notes_de_cours/operateur/#in","text":"L'op\u00e9rateur IN nous permet d'inclure plusieurs valeurs de comparaison dans une clause WHERE. On peut le voir comme plusieurs OR sur une m\u00eame colonne. On peut aussi l'utiliser avec une sous-requ\u00eate. Syntaxe -- Utilisation comme une s\u00e9rie de OR SELECT nom_colonne FROM ma_table WHERE nom_colonne_test IN ('Valeur1', 'Valeur2', 'Valeur3', ...); -- Utilisation avec une sous-requ\u00eate SELECT nom_colonne FROM ma_table WHERE nom_colonne_test IN ( sous-requ\u00eate ); Exemple Je veux la liste des athl\u00e8tes qui sont originaire du Qu\u00e9bec, de l'Ontario ou de la Saskatchewan SELECT * FROM athlete a WHERE a.province IN ('Qu\u00e9bec', 'Ontario', 'Saskatchewan'); \u00c0 partir des tables suivantes, je veux avoir la liste de tous les athl\u00e8tes qui ont d\u00e9j\u00e0 participer \u00e0 un marathon. La base de donn\u00e9es contient une table athl\u00e8te qui contient la liste de tous les athl\u00e8tes et une table r\u00e9sultat qui contient le r\u00e9sultat \u00e0 une course, le id de l'athl\u00e8te et le id de l'\u00e9preuve (le marathon \u00e0 un id de 4). SELECT * FROM athlete a WHERE a.id IN ( SELECT r.athlete_id FROM resultat r WHERE r.epreuve_id = 4 AND r.athlete_id = a.id );","title":"IN"},{"location":"notes_de_cours/operateur/#like","text":"L'op\u00e9rateur LIKE nous permet d'utiliser les \"jokers\" ( wildcard ) suivant dans une expression pour faire une recherche dans un colonne sp\u00e9cifique avec un certain motif. % remplace n'importe quel texte de n'importe quelle longueur. _ remplace un seul caract\u00e8re. Exemple -- Liste tous les athl\u00e8tes dont le nom d\u00e9bute par Fr\u00e9 SELECT * FROM athlete a WHERE a.nom LIKE 'Fr\u00e9%'; -- Liste tous les athl\u00e8tes dont le nom se termine par ette SELECT * FROM athlete a WHERE a.nom LIKE '%ette'; -- Liste tous les athl\u00e8tes dont le nom contient ch (le terme ch pour \u00eatre situ\u00e9 au tout -- d\u00e9but du nom, dans le milieu ou \u00e0 la fin) SELECT * FROM athlete a WHERE a.nom LIKE '%ch%'; -- Liste tous les athl\u00e8tes dont le nom se d\u00e9bute par Fr, est suivi d'une lettre quelconque --- et se termine par chette. SELECT * FROM athlete a WHERE a.nom LIKE 'Fr_chette';","title":"LIKE"},{"location":"notes_de_cours/operateur/#regexp","text":"On peut aussi faire des comparaison beaucoup plus complexe en utilisant l'op\u00e9rateur REGEXP et des expressions r\u00e9guli\u00e8res. Syntaxe SELECT nom_colonne FROM ma_table WHERE nom_colonne_test REGEXP (expression_reguliere) Exemple Je veux la liste des athl\u00e8tes qui ont un nom d'exactement 9 caract\u00e8res SELECT * FROM athlete a WHERE a.nom REGEXP \"^.{12}$\"; Pour cr\u00e9er et tester des expressions r\u00e9guli\u00e8res : https://regexr.com/","title":"REGEXP"},{"location":"notes_de_cours/operateur/#not","text":"L'op\u00e9rateur NOT va inverser le r\u00e9sultat d'une condition. Il peut \u00eatre jumel\u00e9 \u00e0 la plupart des autres op\u00e9rateurs. Exemple Je veux la liste des athl\u00e8tes qui ne sont PAS originaire du Qu\u00e9bec, de l'Ontario ou de la Saskatchewan SELECT * FROM athlete a WHERE a.province NOT IN ('Qu\u00e9bec', 'Ontario', 'Saskatchewan'); Je veux la liste des athl\u00e8tes dont l'adresse courriel n'est pas une adresse GMAIL SELECT * FROM athlete a WHERE a.courriel NOT LIKE '%@gmail.com'; Je veux la liste des athl\u00e8tes dont la valeur de la colonne date_naissance n'est pas NULL SELECT * FROM athlete a WHERE a.date_naissance IS NOT NULL","title":"NOT"},{"location":"notes_de_cours/operateur/#exists","text":"L'op\u00e9rateur EXISTS est utilis\u00e9e pour d\u00e9terminer si le r\u00e9sultat d'une sous-requ\u00eate retourne des enregistrements ou non. Il retournera TRUE si la sous-requ\u00eate contient un ou plusieurs enregistrement et FALSE dans le cas contraire. Le traitement se termine d\u00e8s qu'une ligne correspondante dans la sous-requ\u00eate est trouv\u00e9e. Syntaxe SELECT nom_colonne FROM ma_table WHERE EXISTS(sous-requ\u00eate); Exemple \u00c0 partir des tables suivantes, je veux avoir la liste de tous les athl\u00e8tes qui ont d\u00e9j\u00e0 participer \u00e0 un marathon. La base de donn\u00e9es contient une table athl\u00e8te qui contient la liste de tous les athl\u00e8tes et une table r\u00e9sultat qui contient le r\u00e9sultat \u00e0 une course, le id de l'athl\u00e8te et le id de l'\u00e9preuve (le marathon \u00e0 un id de 4). select * from athlete a where exists ( select 1 from resultat r where r.epreuve_id = 4 and r.athlete_id = a.id ); Il est aussi int\u00e9ressant de noter ici que m\u00eame si un athl\u00e8te a particip\u00e9 \u00e0 plus d'un marathon il ne sera affich\u00e9 qu'une fois dans la liste car comme dit plus haut, d\u00e8s qu'il y a une correspondance, la sous-requ\u00eate de la fonction se termine. L'op\u00e9rateur EXISTS peut aussi \u00eatre utilis\u00e9e dans la clause WHERE d'un UPDATE, INSERT et DELETE. DELETE FROM athlete WHERE EXISTS( select 1 from resultat r where r.epreuve_id = 4 and r.athlete_id = a.id ); Dans cette exemple, tous les athl\u00e8tes qui ont d\u00e9j\u00e0 particip\u00e9 \u00e0 un marathon seront supprim\u00e9es. On peut aussi utilis\u00e9 l'op\u00e9rateur NOT pour inverser le r\u00e9sultat. Si on reprends l'exemple o\u00f9 on liste les athl\u00e8tes qui ont d\u00e9j\u00e0 participer \u00e0 un marathon mais qu'on voudrait connaitre l'inverse, c'est-\u00e0-dire d'avoir la liste des athl\u00e8tes qui n'ont jamais particip\u00e9 \u00e0 un marathon. Il suffit d'ajouter NOT devant le EXISTS pour inverser le r\u00e9sultat et avoir la r\u00e9ponse recherch\u00e9. select * from athlete a where not exists ( select 1 from resultat r where r.epreuve_id = 4 and r.athlete_id = a.id ); Pour plus d'exemple : https://sql.sh/cours/where/exists https://www.mysqltutorial.org/mysql-exists/ https://www.w3schools.com/sql/sql_exists.asp","title":"EXISTS"},{"location":"notes_de_cours/type_relation/","text":"Types de relations Il existe trois types possibles de relation entre les tables : Un \u00e0 plusieurs (1-n) Prenons par exemple un jeu d'aventure qui comprend les tables usagers et personnages (dans ce jeu un usager peut se cr\u00e9er plus d'une partie simultan\u00e9ment). Un usager peut avoir plusieurs personnages, mais chaque personnage est propre \u00e0 un usager. Pour repr\u00e9senter cette relation dans la structure de la base de donn\u00e9es, on va prendre la cl\u00e9 primaire de la table qui correspond au cas unique (ici l'usager) et on va l'ajouter \u00e0 la table \"plusieurs\" (le personnage). Plusieurs \u00e0 plusieurs (n-n) Encore dans ce m\u00eame jeu, on a une table inventaire et une table item. Le personnage peut avoir un inventaire qui contient plusieurs fois le m\u00eame item, et chaque item peut \u00eatre contenu dans plusieurs inventaires diff\u00e9rents. On a donc une relation de plusieurs \u00e0 plusieurs. Au niveau de sa repr\u00e9sentation, on va cr\u00e9er une troisi\u00e8me table \"de jonction\" qui va d\u00e9composer la relation de plusieurs \u00e0 plusieurs en des relations un \u00e0 plusieurs. Pour se faire, on va utiliser la m\u00eame technique que pour la relation 1-n. Dans notre exemple il y aura une relation entre la cl\u00e9 primaire de la table inventaire et un champ \"inventaire_id\" de la table jonction. M\u00eame chose pour la table item et une relation avec la cl\u00e9 primaire et un champ \"item_id\" dans la table jonction. Un \u00e0 un (1-1) Dans cette relation, chaque entr\u00e9e de la premi\u00e8re table ne peut se retrouver qu'une seule fois dans la seconde et vice versa. Cette forme de relation n'est pas tr\u00e8s courante, car habituellement les donn\u00e9es des deux tables seraient stock\u00e9es dans une seule. On pourrait par exemple l'utiliser pour stocker les informations plus sensibles de l'usager dans une autre table.","title":"Types de relations"},{"location":"notes_de_cours/type_relation/#types-de-relations","text":"Il existe trois types possibles de relation entre les tables :","title":"Types de relations"},{"location":"notes_de_cours/type_relation/#un-a-plusieurs-1-n","text":"Prenons par exemple un jeu d'aventure qui comprend les tables usagers et personnages (dans ce jeu un usager peut se cr\u00e9er plus d'une partie simultan\u00e9ment). Un usager peut avoir plusieurs personnages, mais chaque personnage est propre \u00e0 un usager. Pour repr\u00e9senter cette relation dans la structure de la base de donn\u00e9es, on va prendre la cl\u00e9 primaire de la table qui correspond au cas unique (ici l'usager) et on va l'ajouter \u00e0 la table \"plusieurs\" (le personnage).","title":"Un \u00e0 plusieurs (1-n)"},{"location":"notes_de_cours/type_relation/#plusieurs-a-plusieurs-n-n","text":"Encore dans ce m\u00eame jeu, on a une table inventaire et une table item. Le personnage peut avoir un inventaire qui contient plusieurs fois le m\u00eame item, et chaque item peut \u00eatre contenu dans plusieurs inventaires diff\u00e9rents. On a donc une relation de plusieurs \u00e0 plusieurs. Au niveau de sa repr\u00e9sentation, on va cr\u00e9er une troisi\u00e8me table \"de jonction\" qui va d\u00e9composer la relation de plusieurs \u00e0 plusieurs en des relations un \u00e0 plusieurs. Pour se faire, on va utiliser la m\u00eame technique que pour la relation 1-n. Dans notre exemple il y aura une relation entre la cl\u00e9 primaire de la table inventaire et un champ \"inventaire_id\" de la table jonction. M\u00eame chose pour la table item et une relation avec la cl\u00e9 primaire et un champ \"item_id\" dans la table jonction.","title":"Plusieurs \u00e0 plusieurs (n-n)"},{"location":"notes_de_cours/type_relation/#un-a-un-1-1","text":"Dans cette relation, chaque entr\u00e9e de la premi\u00e8re table ne peut se retrouver qu'une seule fois dans la seconde et vice versa. Cette forme de relation n'est pas tr\u00e8s courante, car habituellement les donn\u00e9es des deux tables seraient stock\u00e9es dans une seule. On pourrait par exemple l'utiliser pour stocker les informations plus sensibles de l'usager dans une autre table.","title":"Un \u00e0 un (1-1)"},{"location":"notes_de_cours/view/","text":"VIEW En SQL, on peut enregistrer une requ\u00eate qu'on utilise r\u00e9guli\u00e8rement et la r\u00e9utiliser facilement dans d'autres requ\u00eates. Pour ce faire on cr\u00e9e ce qu'on appelle une VIEW . Avantages de cr\u00e9er une VIEW Simplification des requ\u00eates S\u00e9curiser des donn\u00e9es sensibles Faciliter la maintenance Il faut se rappeler qu'une view n'est pas une fa\u00e7on d'optimiser nos requ\u00eates. Quand une view est utilis\u00e9 dans une requ\u00eate, la requ\u00eate de la view est ex\u00e9cut\u00e9 en premier lieu et ensuite la requ\u00eate principale. On pourrait voir \u00e7a comme une sous-requ\u00eate qui est plus simple \u00e0 utiliser pour le programmeur. Cr\u00e9er une VIEW Pour cr\u00e9er une view, on utilise la d\u00e9claration CREATE VIEW CREATE [OR REPLACE] VIEW [nom_bd.]nom_view [(liste_colonne)] AS requ\u00eate_select; Le nom de la view doit \u00eatre unique dans la base de donn\u00e9es, aucune autre view ni table ne doit avoir le m\u00eame nom. Si on ajoute l'option OR REPLACE et que la view existe d\u00e9j\u00e0, la nouvelle view va remplacer l'ancienne, sinon \u00e7a n'aura aucun effet. On peut d\u00e9finir optionnellement les noms de colonnes de la view, sinon les noms de colonnes seront celle de la requ\u00eate select. Pour terminer, on ajoute une requ\u00eate select. La requ\u00eate peut interroger des tables et d'autres views. Exemple CREATE OR REPLACE VIEW etudiant_informatique (nom_complet, da) AS SELECT CONCAT(e.nom, ', ', e.prenom), e.da FROM etudiant e INNER JOIN etudiant_concentration ec ON ec.etudiant_id = e.id INNER JOIN concentration c ON c.id = ec.concentration WHERE c.description = \"Technique informatique\"; Ensuite pour se servir de la view, on n'a qu'\u00e0 utiliser la view comme une table : SELECT * FROM etudiant_informatique ORDER BY da; Modifier une VIEW Pour modifier une view, on peut utiliser la d\u00e9claration CREATE OR REPLACE VIEW ou bien ALTER VIEW. Les deux m\u00e9thodes sont similaire dans leur r\u00e9sultat. On a d\u00e9j\u00e0 vu la syntaxe du CREATE OR REPLACE VIEW. Voici un exemple pour le ALTER VIEW : ALTER VIEW nom_view [(liste_colonne)] AS requ\u00eate_select;; On ne peut pas modifier le nom de la view par ces m\u00e9thodes, pour se faire, on doit utiliser la d\u00e9claration RENAME TABLE Renommer une VIEW RENAME TABLE nom_view_original TO nouveau_nom_view; Supprimer une VIEW DROP VIEW [IF EXISTS] nom_view; Source https://dev.mysql.com/doc/refman/8.0/en/create-view.html https://www.mysqltutorial.org/mysql-views-tutorial.aspx","title":"Les Views"},{"location":"notes_de_cours/view/#view","text":"En SQL, on peut enregistrer une requ\u00eate qu'on utilise r\u00e9guli\u00e8rement et la r\u00e9utiliser facilement dans d'autres requ\u00eates. Pour ce faire on cr\u00e9e ce qu'on appelle une VIEW .","title":"VIEW"},{"location":"notes_de_cours/view/#avantages-de-creer-une-view","text":"Simplification des requ\u00eates S\u00e9curiser des donn\u00e9es sensibles Faciliter la maintenance Il faut se rappeler qu'une view n'est pas une fa\u00e7on d'optimiser nos requ\u00eates. Quand une view est utilis\u00e9 dans une requ\u00eate, la requ\u00eate de la view est ex\u00e9cut\u00e9 en premier lieu et ensuite la requ\u00eate principale. On pourrait voir \u00e7a comme une sous-requ\u00eate qui est plus simple \u00e0 utiliser pour le programmeur.","title":"Avantages de cr\u00e9er une VIEW"},{"location":"notes_de_cours/view/#creer-une-view","text":"Pour cr\u00e9er une view, on utilise la d\u00e9claration CREATE VIEW CREATE [OR REPLACE] VIEW [nom_bd.]nom_view [(liste_colonne)] AS requ\u00eate_select; Le nom de la view doit \u00eatre unique dans la base de donn\u00e9es, aucune autre view ni table ne doit avoir le m\u00eame nom. Si on ajoute l'option OR REPLACE et que la view existe d\u00e9j\u00e0, la nouvelle view va remplacer l'ancienne, sinon \u00e7a n'aura aucun effet. On peut d\u00e9finir optionnellement les noms de colonnes de la view, sinon les noms de colonnes seront celle de la requ\u00eate select. Pour terminer, on ajoute une requ\u00eate select. La requ\u00eate peut interroger des tables et d'autres views. Exemple CREATE OR REPLACE VIEW etudiant_informatique (nom_complet, da) AS SELECT CONCAT(e.nom, ', ', e.prenom), e.da FROM etudiant e INNER JOIN etudiant_concentration ec ON ec.etudiant_id = e.id INNER JOIN concentration c ON c.id = ec.concentration WHERE c.description = \"Technique informatique\"; Ensuite pour se servir de la view, on n'a qu'\u00e0 utiliser la view comme une table : SELECT * FROM etudiant_informatique ORDER BY da;","title":"Cr\u00e9er une VIEW"},{"location":"notes_de_cours/view/#modifier-une-view","text":"Pour modifier une view, on peut utiliser la d\u00e9claration CREATE OR REPLACE VIEW ou bien ALTER VIEW. Les deux m\u00e9thodes sont similaire dans leur r\u00e9sultat. On a d\u00e9j\u00e0 vu la syntaxe du CREATE OR REPLACE VIEW. Voici un exemple pour le ALTER VIEW : ALTER VIEW nom_view [(liste_colonne)] AS requ\u00eate_select;; On ne peut pas modifier le nom de la view par ces m\u00e9thodes, pour se faire, on doit utiliser la d\u00e9claration RENAME TABLE","title":"Modifier une VIEW"},{"location":"notes_de_cours/view/#renommer-une-view","text":"RENAME TABLE nom_view_original TO nouveau_nom_view;","title":"Renommer une VIEW"},{"location":"notes_de_cours/view/#supprimer-une-view","text":"DROP VIEW [IF EXISTS] nom_view;","title":"Supprimer une VIEW"},{"location":"notes_de_cours/view/#source","text":"https://dev.mysql.com/doc/refman/8.0/en/create-view.html https://www.mysqltutorial.org/mysql-views-tutorial.aspx","title":"Source"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/","text":"Assurer la confidentialit\u00e9 et la coh\u00e9rence des donn\u00e9es Transactions En SQL, une transaction est une s\u00e9rie d'instructions ou de requ\u00eates qui doivent \u00eatre ex\u00e9cut\u00e9 en un seul bloc. Cette s\u00e9rie d'op\u00e9rations peut \u00eatre accept\u00e9 ( COMMIT ) ou refus\u00e9 ( ROLLBACK ). C'est un pratique qui est essentiel quand on veut lancer une s\u00e9rie d'op\u00e9ration et s'assurer de l'int\u00e9grit\u00e9 de notre base de donn\u00e9es. \u00c7a nous prot\u00e8ge \u00e0 la fois des erreurs humaines (erreur dans le code, mauvaise manipulation des donn\u00e9es, etc.) et des erreurs externes (pannes de serveur durant un traitement par exemple). D\u00e9marrer une transaction AUTOCOMMIT Par d\u00e9faut MySQL n'utilise pas les transactions et toutes les requ\u00eates sont automatiquement valid\u00e9es. On peut modifier ce comportement en changeant la valeur de la variable syst\u00e8me autocommit . Attention, la variable autocommit est une variable de session, c'est-\u00e0-dire que la modification qu'on y fait n'est valide que pour la session en cours et qu'elle reprendra sa valeur par d\u00e9faut \u00e0 la session suivante. Exemple -- Modification pour que les requ\u00eates ne soit plus automatiquement \"commit\u00e9\" SET autocommit = 0; -- Insertion d'un enregistrement insert into athlete (nom, prenom) values ('Fr\u00e9chette', 'Mathieu'); -- \u00c9tant donn\u00e9 que la variable autocommit est maintenant \u00e0 false, -- l'insertion ne sera permanente qu'apr\u00e8s avoir valid\u00e9 la transaction START TRANSACTION La fa\u00e7on la plus courante de d\u00e9marrer une transaction est d'utiliser la commande START TRANSACTION . Une fois la commande lanc\u00e9e, toutes les requ\u00eates suivantes seront \"en attente\" tant que la transaction ne sera pas termin\u00e9e. Exemple -- Pour l'exemple, je m'assure que la valeur de la variable autocommit est bien \u00e0 TRUE. -- C'est la valeur par d\u00e9faut, on n'est pas oblig\u00e9 de le sp\u00e9cifi\u00e9 en temps normal. SET autocommit = 1; -- D\u00e9but de la transaction START TRANSACTION; -- Insertion d'un enregistrement insert into athlete (nom, prenom) values ('Fr\u00e9chette', 'Mathieu'); -- \u00c9tant donn\u00e9 qu'on a d\u00e9but\u00e9 une transaction, l'insertion ne sera permanente -- qu'apr\u00e8s l'avoir valid\u00e9e ou annul\u00e9e. Terminer une transaction COMMIT Si toutes les requ\u00eates se sont bien ex\u00e9cut\u00e9 et qu'on veut confirmer les changements, on va utiliser la commande COMMIT . Les modifications apport\u00e9es seront maintenant permanentes et la transaction va se terminer. Exemple BEGIN TRANSACTION; -- Op\u00e9rations \u00e0 effectuer ... -- Valider la transaction et rendre les op\u00e9rations permanentes. COMMIT; ROLLBACK Pour terminer la transaction en annulant TOUTES les modifications effectu\u00e9es, on va utiliser la commande ROLLBACK . Exemple BEGIN TRANSACTION; -- Op\u00e9rations \u00e0 effectuer ... -- Annuler toutes les op\u00e9rations depuis le d\u00e9but de la transaction ROLLBACK; Utiliser des points de sauvegarde On ne peut pas d\u00e9buter une seconde transaction \"\u00e0 l'int\u00e9rieur\" d'une transaction d\u00e9j\u00e0 d\u00e9but\u00e9e. Par contre on peut cr\u00e9er des points de sauvegarde qui nous permettront d'annuler uniquement les op\u00e9rations effectu\u00e9es depuis un point de sauvegarde. SAVEPOINT Pour cr\u00e9er un point de sauvegarde, on va utiliser la commande SAVEPOINT . On peut d\u00e9finir plusieurs point de sauvegarde \u00e0 l'int\u00e9rieur d'une m\u00eame transaction. SAVEPOINT nom_du_savepoint ROLLBACK TO SAVEPOINT Une fois le point de sauvegarde cr\u00e9er, on peut annuler uniquement les transactions effectu\u00e9es depuis celui-ci. Exemple -- D\u00e9but de la transaction START TRANSACTION; -- Insertion d'un enregistrement insert into athlete (nom, prenom) values ('Fr\u00e9chette', 'Mathieu'); -- Cr\u00e9ation d'un point de sauvegarde SAVEPOINT save_Math; -- Insertion d'un second enregistrement insert into athlete (nom, prenom) values ('Fr\u00e9chette', 'Marianne'); -- Annulation jusqu'au savepoint save_Math ROLLBACK TO SAVEPOINT save_Math; -- Validation de la transaction COMMIT; -- L'athl\u00e8te Mathieu Fr\u00e9chette sera ins\u00e9r\u00e9 dans la base de donn\u00e9es mais pas Marianne Fr\u00e9chette. Commandes qui terminent automatiquement une transaction Attention, certaines commandes SQL vont cl\u00f4turer automatiquement une transaction et aussi valider toutes les op\u00e9rations, comme si on aurait utilis\u00e9 la commande COMMIT . Voici une liste de ces commandes Toutes les commandes qui apportent une modification \u00e0 la base de donn\u00e9es vont valider une transaction La cr\u00e9ation ou suppression d'une base de donn\u00e9es Toutes les modifications apport\u00e9es aux tables, cr\u00e9ation, modification, etc... La cr\u00e9ation ou suppression d'un index. La cr\u00e9ation de proc\u00e9dures stock\u00e9es, de fonctions ou de vues. La cr\u00e9ation, suppression ou modification d'un utilisateur. Le d\u00e9but d'une nouvelle transaction sans avoir termin\u00e9 la premi\u00e8re. Changer la valeur de la variable autocommit \u00e0 TRUE. La cr\u00e9ation ou suppression d'un LOCK sur une table. Sources https://dev.mysql.com/doc/refman/8.0/en/sql-transactional-statements.html https://www.javatpoint.com/mysql-transaction https://openclassrooms.com/fr/courses/1959476-administrez-vos-bases-de-donnees-avec-mysql/1970063-transactions https://www.mysqltutorial.org/mysql-transaction.aspx Gestion des utilisateurs et des autorisations Pour se connecter \u00e0 MySQL on doit avoir en main un utilisateur et un mot de passe. Chaque utilisateurs \u00e0 ses propres privil\u00e8ges sur ce qui peut faire ou non dans la base de donn\u00e9es. Les informations sur les utilisateurs et leur privil\u00e8ges sont stock\u00e9s dans les tables suivantes de la base de donn\u00e9es mysql : user : les informations sur les utilisateurs. db, tables_priv, columns_priv et proc_priv : les privil\u00e8ges de l'utilisateur. On peut modifier les valeurs de ces tables mais il est pr\u00e9f\u00e9rable de ne pas le faire directement dans ces tables mais avec les commandes appropri\u00e9es. Cr\u00e9er un utilisateur On utilise la commande CREATE USER en sp\u00e9cifiant un nom d'utilisateur, un h\u00f4te et un mot de passe. L'h\u00f4te est optionnel et repr\u00e9sente l'adresse \u00e0 partir de laquelle l'utilisateur va se connecter. On utilise souvent localhost ou 127.0.0.1, ce qui veut dire que l'utilisateur pourra se connecter \u00e0 partir de la machine o\u00f9 est situ\u00e9 le serveur. Si on ne sp\u00e9cifie pas d'h\u00f4te, l'utilisateur pourra se connecter depuis n'importe quel h\u00f4te. CREATE USER 'nomUtilisateur'@'hote' IDENTIFIED BY 'motDePasse'; -- Exemple CREATE USER 'math'@'localhost' IDENTIFIED BY 'qwerty4ever'; CREATE USER 'patate'@'156.20.12.2' IDENTIFIED BY 'qwerty4ever'; On peut utiliser le joker % pour permettre la cr\u00e9ation d'un utilisateur qui va pouvoir se connecter depuis plus d'un h\u00f4te : -- L'utilisateur va pourvoir se connecter depuis n'importe quel h\u00f4te dont -- l'adresse ip commence par 156.20.12 CREATE USER 'math'@'156.20.12.%' IDENTIFIED BY 'qwerty4ever'; -- L'utilisateur va pouvoir se connecter depuis n'importe quel h\u00f4te CREATE USER 'math'@'%' IDENTIFIED BY 'qwerty4ever'; Modifier le nom d'un utilisateur Pour modifier le nom d'un utilisateur, on utilise la commande RENAME USER : RENAME USER 'Math'@'localhost' TO 'Mathieu'@'localhost'; Supprimer un utilisateur Pour supprimer un utilisateur, on va utiliser DROP USER : DROP USER 'Math'@'localhost' Gestion des autorisations Ajouter ou enlever de privil\u00e8ges -- Syntaxe pour ajouter un privil\u00e8ge GRANT nomDuPrivilege (listeDesColonnes) ON niveauPrivilege TO nomUsager -- Syntaxe pour enlever un privil\u00e8ge REVOKE nomDuPrivilege ON niveauPrivilege FROM nomUsager nomDuPrivilege : Le nom du privil\u00e8ge \u00e0 ajouter (SELECT, INSERT, CREATE TABLE, etc.). On peut en mettre plusieurs en les s\u00e9parant par une virgule. listeDesColonnes : C'est optionnel mais on peut sp\u00e9cifier les colonnes sur lesquelles le privil\u00e8ge est appliqu\u00e9. On pourrait par exemple accorder le droit \u00e0 un usager de faire un UPDATE mais seulement pour des colonnes sp\u00e9cifiques d'une table. niveauPrivilege : \u00c0 quel niveau s'applique le privil\u00e8ge. (Globalement, seulement pour une base de donn\u00e9es en particulier, pour une table pr\u00e9cise, etc.) nomUsager : \u00c0 quel usager on veut octroyer le privil\u00e8ge. Exemple /* Octroyer \u00e0 l'usager test le droit de faire des requ\u00eates select et insert sur toutes les tables de la base de donn\u00e9es credit_social */ GRANT SELECT, INSERT ON credit_social.* TO test@localhost; Liste des privil\u00e8ges Voici une courte liste de privil\u00e8ges qu'on peut ajouter \u00e0 un usager : ALL, tous les privil\u00e8ges, sauf celui d'en accorder. USAGE, aucun privil\u00e8ges GRANT OPTION, accorde le droit d'ajouter des privil\u00e8ges (il n'est pas inclus quand on utilise ALL) SELECT, INSERT, UPDATE, DELETE, pour les requ\u00eates CRUD correspondante CREATE TABLE, ALTER, DROP, pour des op\u00e9rations sur les tables et la base de donn\u00e9es. CREATE ROUTINE, ALTER ROUTINE, EXECUTE, pour des op\u00e9rations sur les proc\u00e9dures stock\u00e9es. Il y a beaucoup d'autres privil\u00e8ges qu'on peut octroyer, vous pouvez consulter une liste plus compl\u00e8te dans la documentation de MySQL : https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html Niveau des privil\u00e8ges L'indicateur du niveau de privil\u00e8ges se compose en deux sections, la ou les base de donn\u00e9es et ensuite le nom de la table ou de la proc\u00e9dure stock\u00e9e. *.* : Toutes les bases de donn\u00e9es et toutes les tables/proc\u00e9dures stock\u00e9es credit_social.* : Pour la base de donn\u00e9es credit_social, toutes les tables credit_social.classe : Pour la base de donn\u00e9es credit_social, la table classe uniquement. Afficher les autorisations d'un utilisateur SHOW GRANTS FOR 'usager'@'localhost'; Gestions des erreurs En attendant des notes plus compl\u00e8te sur le sujet, voici un petit extrait de code sur une gestion de base dans une proc\u00e9dure stock\u00e9e. DECLARE EXIT HANDLER FOR SQLEXCEPTION BEGIN ROLLBACK; RESIGNAL; END; START TRANSACTION; -- Mes op\u00e9rations COMMIT; Sources https://www.mysqltutorial.org/mysql-error-handling-in-stored-procedures/ https://dev.mysql.com/doc/refman/8.0/en/declare-handler.html https://dev.mysql.com/doc/refman/8.0/en/resignal.html","title":"Assurer la confidentialit\u00e9 et la coh\u00e9rence des donn\u00e9es"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#assurer-la-confidentialite-et-la-coherence-des-donnees","text":"","title":"Assurer la confidentialit\u00e9 et la coh\u00e9rence des donn\u00e9es"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#transactions","text":"En SQL, une transaction est une s\u00e9rie d'instructions ou de requ\u00eates qui doivent \u00eatre ex\u00e9cut\u00e9 en un seul bloc. Cette s\u00e9rie d'op\u00e9rations peut \u00eatre accept\u00e9 ( COMMIT ) ou refus\u00e9 ( ROLLBACK ). C'est un pratique qui est essentiel quand on veut lancer une s\u00e9rie d'op\u00e9ration et s'assurer de l'int\u00e9grit\u00e9 de notre base de donn\u00e9es. \u00c7a nous prot\u00e8ge \u00e0 la fois des erreurs humaines (erreur dans le code, mauvaise manipulation des donn\u00e9es, etc.) et des erreurs externes (pannes de serveur durant un traitement par exemple).","title":"Transactions"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#demarrer-une-transaction","text":"","title":"D\u00e9marrer une transaction"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#autocommit","text":"Par d\u00e9faut MySQL n'utilise pas les transactions et toutes les requ\u00eates sont automatiquement valid\u00e9es. On peut modifier ce comportement en changeant la valeur de la variable syst\u00e8me autocommit . Attention, la variable autocommit est une variable de session, c'est-\u00e0-dire que la modification qu'on y fait n'est valide que pour la session en cours et qu'elle reprendra sa valeur par d\u00e9faut \u00e0 la session suivante. Exemple -- Modification pour que les requ\u00eates ne soit plus automatiquement \"commit\u00e9\" SET autocommit = 0; -- Insertion d'un enregistrement insert into athlete (nom, prenom) values ('Fr\u00e9chette', 'Mathieu'); -- \u00c9tant donn\u00e9 que la variable autocommit est maintenant \u00e0 false, -- l'insertion ne sera permanente qu'apr\u00e8s avoir valid\u00e9 la transaction","title":"AUTOCOMMIT"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#start-transaction","text":"La fa\u00e7on la plus courante de d\u00e9marrer une transaction est d'utiliser la commande START TRANSACTION . Une fois la commande lanc\u00e9e, toutes les requ\u00eates suivantes seront \"en attente\" tant que la transaction ne sera pas termin\u00e9e. Exemple -- Pour l'exemple, je m'assure que la valeur de la variable autocommit est bien \u00e0 TRUE. -- C'est la valeur par d\u00e9faut, on n'est pas oblig\u00e9 de le sp\u00e9cifi\u00e9 en temps normal. SET autocommit = 1; -- D\u00e9but de la transaction START TRANSACTION; -- Insertion d'un enregistrement insert into athlete (nom, prenom) values ('Fr\u00e9chette', 'Mathieu'); -- \u00c9tant donn\u00e9 qu'on a d\u00e9but\u00e9 une transaction, l'insertion ne sera permanente -- qu'apr\u00e8s l'avoir valid\u00e9e ou annul\u00e9e.","title":"START TRANSACTION"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#terminer-une-transaction","text":"","title":"Terminer une transaction"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#commit","text":"Si toutes les requ\u00eates se sont bien ex\u00e9cut\u00e9 et qu'on veut confirmer les changements, on va utiliser la commande COMMIT . Les modifications apport\u00e9es seront maintenant permanentes et la transaction va se terminer. Exemple BEGIN TRANSACTION; -- Op\u00e9rations \u00e0 effectuer ... -- Valider la transaction et rendre les op\u00e9rations permanentes. COMMIT;","title":"COMMIT"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#rollback","text":"Pour terminer la transaction en annulant TOUTES les modifications effectu\u00e9es, on va utiliser la commande ROLLBACK . Exemple BEGIN TRANSACTION; -- Op\u00e9rations \u00e0 effectuer ... -- Annuler toutes les op\u00e9rations depuis le d\u00e9but de la transaction ROLLBACK;","title":"ROLLBACK"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#utiliser-des-points-de-sauvegarde","text":"On ne peut pas d\u00e9buter une seconde transaction \"\u00e0 l'int\u00e9rieur\" d'une transaction d\u00e9j\u00e0 d\u00e9but\u00e9e. Par contre on peut cr\u00e9er des points de sauvegarde qui nous permettront d'annuler uniquement les op\u00e9rations effectu\u00e9es depuis un point de sauvegarde.","title":"Utiliser des points de sauvegarde"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#savepoint","text":"Pour cr\u00e9er un point de sauvegarde, on va utiliser la commande SAVEPOINT . On peut d\u00e9finir plusieurs point de sauvegarde \u00e0 l'int\u00e9rieur d'une m\u00eame transaction. SAVEPOINT nom_du_savepoint","title":"SAVEPOINT"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#rollback-to-savepoint","text":"Une fois le point de sauvegarde cr\u00e9er, on peut annuler uniquement les transactions effectu\u00e9es depuis celui-ci. Exemple -- D\u00e9but de la transaction START TRANSACTION; -- Insertion d'un enregistrement insert into athlete (nom, prenom) values ('Fr\u00e9chette', 'Mathieu'); -- Cr\u00e9ation d'un point de sauvegarde SAVEPOINT save_Math; -- Insertion d'un second enregistrement insert into athlete (nom, prenom) values ('Fr\u00e9chette', 'Marianne'); -- Annulation jusqu'au savepoint save_Math ROLLBACK TO SAVEPOINT save_Math; -- Validation de la transaction COMMIT; -- L'athl\u00e8te Mathieu Fr\u00e9chette sera ins\u00e9r\u00e9 dans la base de donn\u00e9es mais pas Marianne Fr\u00e9chette.","title":"ROLLBACK TO SAVEPOINT"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#commandes-qui-terminent-automatiquement-une-transaction","text":"Attention, certaines commandes SQL vont cl\u00f4turer automatiquement une transaction et aussi valider toutes les op\u00e9rations, comme si on aurait utilis\u00e9 la commande COMMIT . Voici une liste de ces commandes Toutes les commandes qui apportent une modification \u00e0 la base de donn\u00e9es vont valider une transaction La cr\u00e9ation ou suppression d'une base de donn\u00e9es Toutes les modifications apport\u00e9es aux tables, cr\u00e9ation, modification, etc... La cr\u00e9ation ou suppression d'un index. La cr\u00e9ation de proc\u00e9dures stock\u00e9es, de fonctions ou de vues. La cr\u00e9ation, suppression ou modification d'un utilisateur. Le d\u00e9but d'une nouvelle transaction sans avoir termin\u00e9 la premi\u00e8re. Changer la valeur de la variable autocommit \u00e0 TRUE. La cr\u00e9ation ou suppression d'un LOCK sur une table.","title":"Commandes qui terminent automatiquement une transaction"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#sources","text":"https://dev.mysql.com/doc/refman/8.0/en/sql-transactional-statements.html https://www.javatpoint.com/mysql-transaction https://openclassrooms.com/fr/courses/1959476-administrez-vos-bases-de-donnees-avec-mysql/1970063-transactions https://www.mysqltutorial.org/mysql-transaction.aspx","title":"Sources"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#gestion-des-utilisateurs-et-des-autorisations","text":"Pour se connecter \u00e0 MySQL on doit avoir en main un utilisateur et un mot de passe. Chaque utilisateurs \u00e0 ses propres privil\u00e8ges sur ce qui peut faire ou non dans la base de donn\u00e9es. Les informations sur les utilisateurs et leur privil\u00e8ges sont stock\u00e9s dans les tables suivantes de la base de donn\u00e9es mysql : user : les informations sur les utilisateurs. db, tables_priv, columns_priv et proc_priv : les privil\u00e8ges de l'utilisateur. On peut modifier les valeurs de ces tables mais il est pr\u00e9f\u00e9rable de ne pas le faire directement dans ces tables mais avec les commandes appropri\u00e9es.","title":"Gestion des utilisateurs et des autorisations"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#creer-un-utilisateur","text":"On utilise la commande CREATE USER en sp\u00e9cifiant un nom d'utilisateur, un h\u00f4te et un mot de passe. L'h\u00f4te est optionnel et repr\u00e9sente l'adresse \u00e0 partir de laquelle l'utilisateur va se connecter. On utilise souvent localhost ou 127.0.0.1, ce qui veut dire que l'utilisateur pourra se connecter \u00e0 partir de la machine o\u00f9 est situ\u00e9 le serveur. Si on ne sp\u00e9cifie pas d'h\u00f4te, l'utilisateur pourra se connecter depuis n'importe quel h\u00f4te. CREATE USER 'nomUtilisateur'@'hote' IDENTIFIED BY 'motDePasse'; -- Exemple CREATE USER 'math'@'localhost' IDENTIFIED BY 'qwerty4ever'; CREATE USER 'patate'@'156.20.12.2' IDENTIFIED BY 'qwerty4ever'; On peut utiliser le joker % pour permettre la cr\u00e9ation d'un utilisateur qui va pouvoir se connecter depuis plus d'un h\u00f4te : -- L'utilisateur va pourvoir se connecter depuis n'importe quel h\u00f4te dont -- l'adresse ip commence par 156.20.12 CREATE USER 'math'@'156.20.12.%' IDENTIFIED BY 'qwerty4ever'; -- L'utilisateur va pouvoir se connecter depuis n'importe quel h\u00f4te CREATE USER 'math'@'%' IDENTIFIED BY 'qwerty4ever';","title":"Cr\u00e9er un utilisateur"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#modifier-le-nom-dun-utilisateur","text":"Pour modifier le nom d'un utilisateur, on utilise la commande RENAME USER : RENAME USER 'Math'@'localhost' TO 'Mathieu'@'localhost';","title":"Modifier le nom d'un utilisateur"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#supprimer-un-utilisateur","text":"Pour supprimer un utilisateur, on va utiliser DROP USER : DROP USER 'Math'@'localhost'","title":"Supprimer un utilisateur"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#gestion-des-autorisations","text":"","title":"Gestion des autorisations"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#ajouter-ou-enlever-de-privileges","text":"-- Syntaxe pour ajouter un privil\u00e8ge GRANT nomDuPrivilege (listeDesColonnes) ON niveauPrivilege TO nomUsager -- Syntaxe pour enlever un privil\u00e8ge REVOKE nomDuPrivilege ON niveauPrivilege FROM nomUsager nomDuPrivilege : Le nom du privil\u00e8ge \u00e0 ajouter (SELECT, INSERT, CREATE TABLE, etc.). On peut en mettre plusieurs en les s\u00e9parant par une virgule. listeDesColonnes : C'est optionnel mais on peut sp\u00e9cifier les colonnes sur lesquelles le privil\u00e8ge est appliqu\u00e9. On pourrait par exemple accorder le droit \u00e0 un usager de faire un UPDATE mais seulement pour des colonnes sp\u00e9cifiques d'une table. niveauPrivilege : \u00c0 quel niveau s'applique le privil\u00e8ge. (Globalement, seulement pour une base de donn\u00e9es en particulier, pour une table pr\u00e9cise, etc.) nomUsager : \u00c0 quel usager on veut octroyer le privil\u00e8ge. Exemple /* Octroyer \u00e0 l'usager test le droit de faire des requ\u00eates select et insert sur toutes les tables de la base de donn\u00e9es credit_social */ GRANT SELECT, INSERT ON credit_social.* TO test@localhost;","title":"Ajouter ou enlever de privil\u00e8ges"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#liste-des-privileges","text":"Voici une courte liste de privil\u00e8ges qu'on peut ajouter \u00e0 un usager : ALL, tous les privil\u00e8ges, sauf celui d'en accorder. USAGE, aucun privil\u00e8ges GRANT OPTION, accorde le droit d'ajouter des privil\u00e8ges (il n'est pas inclus quand on utilise ALL) SELECT, INSERT, UPDATE, DELETE, pour les requ\u00eates CRUD correspondante CREATE TABLE, ALTER, DROP, pour des op\u00e9rations sur les tables et la base de donn\u00e9es. CREATE ROUTINE, ALTER ROUTINE, EXECUTE, pour des op\u00e9rations sur les proc\u00e9dures stock\u00e9es. Il y a beaucoup d'autres privil\u00e8ges qu'on peut octroyer, vous pouvez consulter une liste plus compl\u00e8te dans la documentation de MySQL : https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html","title":"Liste des privil\u00e8ges"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#niveau-des-privileges","text":"L'indicateur du niveau de privil\u00e8ges se compose en deux sections, la ou les base de donn\u00e9es et ensuite le nom de la table ou de la proc\u00e9dure stock\u00e9e. *.* : Toutes les bases de donn\u00e9es et toutes les tables/proc\u00e9dures stock\u00e9es credit_social.* : Pour la base de donn\u00e9es credit_social, toutes les tables credit_social.classe : Pour la base de donn\u00e9es credit_social, la table classe uniquement.","title":"Niveau des privil\u00e8ges"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#afficher-les-autorisations-dun-utilisateur","text":"SHOW GRANTS FOR 'usager'@'localhost';","title":"Afficher les autorisations d'un utilisateur"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#gestions-des-erreurs","text":"En attendant des notes plus compl\u00e8te sur le sujet, voici un petit extrait de code sur une gestion de base dans une proc\u00e9dure stock\u00e9e. DECLARE EXIT HANDLER FOR SQLEXCEPTION BEGIN ROLLBACK; RESIGNAL; END; START TRANSACTION; -- Mes op\u00e9rations COMMIT;","title":"Gestions des erreurs"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#sources_1","text":"https://www.mysqltutorial.org/mysql-error-handling-in-stored-procedures/ https://dev.mysql.com/doc/refman/8.0/en/declare-handler.html https://dev.mysql.com/doc/refman/8.0/en/resignal.html","title":"Sources"},{"location":"notes_de_cours/mySQL/error_handling/","text":"Gestion des erreurs dans les proc\u00e9dures stock\u00e9es Pour intercepter les erreurs dans un proc\u00e9dure stock\u00e9 on va utiliser des handlers . On peut aussi g\u00e9n\u00e9rer une erreur avec la commande SIGNAL . HANDLER La syntaxe de d\u00e9claration d'un handler est la suivante : DECLARE handler_action HANDLER FOR condition_value statement; handler_action De qu'elle fa\u00e7on l'ex\u00e9cution des instructions va \u00eatre affect\u00e9e lorsque l'erreur survient. CONTINUE : L'ex\u00e9cution des instructions va se continuer. EXIT : L'ex\u00e9cution des instructions comprisent \u00e0 l'int\u00e9rieur du bloc BEGIN ... END d'o\u00f9 l'erreur est survenue se termine. condition_value Qu'elle est l'erreur qu'on veut intercepter avec le handler mysql_error_code : Un code d'erreur MySQL. En voici la liste ici SQLSTATE [VALUE] : O\u00f9 VALUE repr\u00e9sente un code de 5 caract\u00e8re qui repr\u00e9sente un code d'\u00e9tat MySQL. Tr\u00e8s similaire \u00e0 mysql_error_code. Vous pouvez consulter la liste ici condition_name : On peut d\u00e9finir un nom de condition qui est associ\u00e9 \u00e0 un code d'erreur ou d'\u00e9tat et l'utiliser ensuite dans le handler. DECLARE no_such_table CONDITION FOR 1051; DECLARE CONTINUE HANDLER FOR no_such_table BEGIN -- body of handler END; SQLWARNINGS : Un raccourci pour les code d'\u00e9tat SQLSTATE qui commence par 01, le plus souvent des messages d'avertissements NOT FOUND: On l'a vue dans notre utilisation des cursors . Se d\u00e9clenche quand le curseur arrive \u00e0 la fin de ses r\u00e9sultats SQLEXCEPTION: Un raccourci pour les code d'\u00e9tat SQLSTATE qui ne commence pas par 00, 01 ou 02. Exemple Quand ma proc\u00e9dure stock\u00e9e provoque une erreur, je veux annuler les op\u00e9rations d\u00e9j\u00e0 effectu\u00e9es et quitter le traitement en affichant un message d'erreur. On va utiliser ROLLBACK pour annuler les op\u00e9rations et SELECT avec notre message d'erreur. CREATE PROCEDURE exemplebd.test_error(valeur INT) BEGIN DECLARE EXIT HANDLER FOR SQLEXCEPTION BEGIN ROLLBACK; SELECT 'Une erreur est survenue, les op\u00e9rations ont \u00e9t\u00e9 annul\u00e9.'; END; START TRANSACTION; ... COMMIT; END SIGNAL Avec SIGNAL on va pouvoir g\u00e9r\u00e9ner une erreur qui va stopper l'\u00e9x\u00e9cution de la proc\u00e9dure stock\u00e9e. On peut aussi jumeler SIGNAL avec un HANDLER La syntaxe de d\u00e9claration de SIGNAL est la suivante : SIGNAL condition_value SET signal_information_item; condition_value Comme pour le HANDLER, on va utiliser un SQLSTATE ou une condition qu'on aura d\u00e9fini auparavant. Le plus souvent on va utiliser SQLSTATE = '45000' qui indique une erreur d\u00e9finie par l'utilisateur. signal_information_item On peut ensuite d\u00e9finir des valeurs \u00e0 des variables pr\u00e9d\u00e9finis associ\u00e9s \u00e0 SIGNAL . Une de cess variables est MESSAGE_TEXT qui nous permet de retourner un message d'erreur. La liste compl\u00eate est ici . Exemple Dans une proc\u00e9dure je veux arr\u00eater l'\u00e9x\u00e9cution si la valeur de la variable nombre est inf\u00e9rieur \u00e0 0 CREATE PROCEDURE exemplebd.test_error(nombre INT) BEGIN IF (nombre < 0) THEN SIGNAL SQLSTATE SET MESSAGE_TEXT = \"La valeur doit \u00eatre sup\u00e9rieure \u00e0 0\"; END IF; SELECT nombre; END r\u00e9sultat Le m\u00eame exemple avec un HANDLER . CREATE PROCEDURE exemplebd.test_error(nombre INT) BEGIN DECLARE EXIT HANDLER FOR SQLSTATE '45000' BEGIN SELECT \"La valeur doit \u00eatre sup\u00e9rieure \u00e0 0\" AS message_erreur; END; IF (nombre < 0) THEN SIGNAL SQLSTATE '45000'; END IF; SELECT nombre; END r\u00e9sultat L'avantage d'utiliser le handler est qu'on pourrait \u00e9x\u00e9cuter un traitement lors de l'erreur alors qu'avec signal on ne peut pas. La m\u00e9thode pour r\u00e9cup\u00e9rer l'erreur dans notre code ne sera pas la m\u00eame selon ce qu'on utilise. Avec le handler, c'est selon le traitement utilis\u00e9. Dans notre exemple pus haut, quand on lance la proc\u00e9dure on s'attend \u00e0 recevoir un r\u00e9sultat de requ\u00eate. Si une erreur est retourn\u00e9e, on pourrait v\u00e9rifier qu'il y a un champ message_erreur dans le r\u00e9sultat et l'afficher. Avec signal uniquement, on va devoir r\u00e9cup\u00e9rer l'exception avec un try .. catch. Voici un exemple en Python avec MySQL Connector def TestError(): result = [] try: connection = mysql.connect(**db_config) cursor = connection.cursor() cursor.callproc('test_error', (12,)) for result in cursor.stored_results(): # Si j'utilise un handler avec le signal # mon message d'erreur se retrouvera ici print(result.fetchall()) except mysql.Error as erreur: # Le message d'erreur avec signal est ici print(erreur.msg) finally: cursor.close() connection.close() Source https://dev.mysql.com/doc/refman/8.0/en/declare-handler.html https://dev.mysql.com/doc/refman/8.0/en/signal.html https://www.mysqltutorial.org/mysql-error-handling-in-stored-procedures/","title":"Gestion d'erreur dans une proc\u00e9dure stock\u00e9e"},{"location":"notes_de_cours/mySQL/error_handling/#gestion-des-erreurs-dans-les-procedures-stockees","text":"Pour intercepter les erreurs dans un proc\u00e9dure stock\u00e9 on va utiliser des handlers . On peut aussi g\u00e9n\u00e9rer une erreur avec la commande SIGNAL .","title":"Gestion des erreurs dans les proc\u00e9dures stock\u00e9es"},{"location":"notes_de_cours/mySQL/error_handling/#handler","text":"La syntaxe de d\u00e9claration d'un handler est la suivante : DECLARE handler_action HANDLER FOR condition_value statement;","title":"HANDLER"},{"location":"notes_de_cours/mySQL/error_handling/#handler_action","text":"De qu'elle fa\u00e7on l'ex\u00e9cution des instructions va \u00eatre affect\u00e9e lorsque l'erreur survient. CONTINUE : L'ex\u00e9cution des instructions va se continuer. EXIT : L'ex\u00e9cution des instructions comprisent \u00e0 l'int\u00e9rieur du bloc BEGIN ... END d'o\u00f9 l'erreur est survenue se termine.","title":"handler_action"},{"location":"notes_de_cours/mySQL/error_handling/#condition_value","text":"Qu'elle est l'erreur qu'on veut intercepter avec le handler mysql_error_code : Un code d'erreur MySQL. En voici la liste ici SQLSTATE [VALUE] : O\u00f9 VALUE repr\u00e9sente un code de 5 caract\u00e8re qui repr\u00e9sente un code d'\u00e9tat MySQL. Tr\u00e8s similaire \u00e0 mysql_error_code. Vous pouvez consulter la liste ici condition_name : On peut d\u00e9finir un nom de condition qui est associ\u00e9 \u00e0 un code d'erreur ou d'\u00e9tat et l'utiliser ensuite dans le handler. DECLARE no_such_table CONDITION FOR 1051; DECLARE CONTINUE HANDLER FOR no_such_table BEGIN -- body of handler END; SQLWARNINGS : Un raccourci pour les code d'\u00e9tat SQLSTATE qui commence par 01, le plus souvent des messages d'avertissements NOT FOUND: On l'a vue dans notre utilisation des cursors . Se d\u00e9clenche quand le curseur arrive \u00e0 la fin de ses r\u00e9sultats SQLEXCEPTION: Un raccourci pour les code d'\u00e9tat SQLSTATE qui ne commence pas par 00, 01 ou 02.","title":"condition_value"},{"location":"notes_de_cours/mySQL/error_handling/#exemple","text":"Quand ma proc\u00e9dure stock\u00e9e provoque une erreur, je veux annuler les op\u00e9rations d\u00e9j\u00e0 effectu\u00e9es et quitter le traitement en affichant un message d'erreur. On va utiliser ROLLBACK pour annuler les op\u00e9rations et SELECT avec notre message d'erreur. CREATE PROCEDURE exemplebd.test_error(valeur INT) BEGIN DECLARE EXIT HANDLER FOR SQLEXCEPTION BEGIN ROLLBACK; SELECT 'Une erreur est survenue, les op\u00e9rations ont \u00e9t\u00e9 annul\u00e9.'; END; START TRANSACTION; ... COMMIT; END","title":"Exemple"},{"location":"notes_de_cours/mySQL/error_handling/#signal","text":"Avec SIGNAL on va pouvoir g\u00e9r\u00e9ner une erreur qui va stopper l'\u00e9x\u00e9cution de la proc\u00e9dure stock\u00e9e. On peut aussi jumeler SIGNAL avec un HANDLER La syntaxe de d\u00e9claration de SIGNAL est la suivante : SIGNAL condition_value SET signal_information_item;","title":"SIGNAL"},{"location":"notes_de_cours/mySQL/error_handling/#condition_value_1","text":"Comme pour le HANDLER, on va utiliser un SQLSTATE ou une condition qu'on aura d\u00e9fini auparavant. Le plus souvent on va utiliser SQLSTATE = '45000' qui indique une erreur d\u00e9finie par l'utilisateur.","title":"condition_value"},{"location":"notes_de_cours/mySQL/error_handling/#signal_information_item","text":"On peut ensuite d\u00e9finir des valeurs \u00e0 des variables pr\u00e9d\u00e9finis associ\u00e9s \u00e0 SIGNAL . Une de cess variables est MESSAGE_TEXT qui nous permet de retourner un message d'erreur. La liste compl\u00eate est ici .","title":"signal_information_item"},{"location":"notes_de_cours/mySQL/error_handling/#exemple_1","text":"Dans une proc\u00e9dure je veux arr\u00eater l'\u00e9x\u00e9cution si la valeur de la variable nombre est inf\u00e9rieur \u00e0 0 CREATE PROCEDURE exemplebd.test_error(nombre INT) BEGIN IF (nombre < 0) THEN SIGNAL SQLSTATE SET MESSAGE_TEXT = \"La valeur doit \u00eatre sup\u00e9rieure \u00e0 0\"; END IF; SELECT nombre; END r\u00e9sultat Le m\u00eame exemple avec un HANDLER . CREATE PROCEDURE exemplebd.test_error(nombre INT) BEGIN DECLARE EXIT HANDLER FOR SQLSTATE '45000' BEGIN SELECT \"La valeur doit \u00eatre sup\u00e9rieure \u00e0 0\" AS message_erreur; END; IF (nombre < 0) THEN SIGNAL SQLSTATE '45000'; END IF; SELECT nombre; END r\u00e9sultat L'avantage d'utiliser le handler est qu'on pourrait \u00e9x\u00e9cuter un traitement lors de l'erreur alors qu'avec signal on ne peut pas. La m\u00e9thode pour r\u00e9cup\u00e9rer l'erreur dans notre code ne sera pas la m\u00eame selon ce qu'on utilise. Avec le handler, c'est selon le traitement utilis\u00e9. Dans notre exemple pus haut, quand on lance la proc\u00e9dure on s'attend \u00e0 recevoir un r\u00e9sultat de requ\u00eate. Si une erreur est retourn\u00e9e, on pourrait v\u00e9rifier qu'il y a un champ message_erreur dans le r\u00e9sultat et l'afficher. Avec signal uniquement, on va devoir r\u00e9cup\u00e9rer l'exception avec un try .. catch. Voici un exemple en Python avec MySQL Connector def TestError(): result = [] try: connection = mysql.connect(**db_config) cursor = connection.cursor() cursor.callproc('test_error', (12,)) for result in cursor.stored_results(): # Si j'utilise un handler avec le signal # mon message d'erreur se retrouvera ici print(result.fetchall()) except mysql.Error as erreur: # Le message d'erreur avec signal est ici print(erreur.msg) finally: cursor.close() connection.close()","title":"Exemple"},{"location":"notes_de_cours/mySQL/error_handling/#source","text":"https://dev.mysql.com/doc/refman/8.0/en/declare-handler.html https://dev.mysql.com/doc/refman/8.0/en/signal.html https://www.mysqltutorial.org/mysql-error-handling-in-stored-procedures/","title":"Source"},{"location":"notes_de_cours/mySQL/gestion_autorisations/","text":"Gestion des autorisations Ajouter ou enlever de privil\u00e8ges -- Syntaxe pour ajouter un privil\u00e8ge GRANT nomDuPrivilege (listeDesColonnes) ON niveauPrivilege TO nomUsager_nomRole -- Syntaxe pour enlever un privil\u00e8ge REVOKE nomDuPrivilege ON niveauPrivilege FROM nomUsager_nomRole nomDuPrivilege : Le nom du privil\u00e8ge \u00e0 ajouter (SELECT, INSERT, CREATE TABLE, etc.). On peut en mettre plusieurs en les s\u00e9parant par une virgule. listeDesColonnes : C'est optionnel mais on peut sp\u00e9cifier les colonnes sur lesquelles le privil\u00e8ge est appliqu\u00e9. On pourrait par exemple accorder le droit \u00e0 un usager de faire un UPDATE mais seulement pour des colonnes sp\u00e9cifiques d'une table. niveauPrivilege : \u00c0 quel niveau s'applique le privil\u00e8ge. (Globalement, seulement pour une base de donn\u00e9es en particulier, pour une table pr\u00e9cise, etc.) nomUsager_nomRole: \u00c0 quel usager ou role on veut octroyer le privil\u00e8ge. Exemple /* Octroyer \u00e0 l'usager test le droit de faire des requ\u00eates select et insert sur toutes les tables de la base de donn\u00e9es credit_social */ GRANT SELECT, INSERT ON credit_social.* TO test@localhost; /* Octroyer \u00e0 l'usager test2 le droit de faire des requ\u00eates select uniquement sur la table citoyen de la base de donn\u00e9es credit_social. De plus, seulement les colonnes id, nom et prenom seront accessible pour cette table */ GRANT SELECT (id, nom, prenom) ON credit_social.citoyen TO test2@localhost; Liste des privil\u00e8ges Voici une courte liste de privil\u00e8ges qu'on peut ajouter \u00e0 un usager : ALL, tous les privil\u00e8ges, sauf celui d'en accorder. USAGE, aucun privil\u00e8ges GRANT OPTION, accorde le droit d'ajouter des privil\u00e8ges (il n'est pas inclus quand on utilise ALL) SELECT, INSERT, UPDATE, DELETE, pour les requ\u00eates CRUD correspondante CREATE TABLE, ALTER, DROP, REFERENCES pour des op\u00e9rations sur les tables et la base de donn\u00e9es. CREATE ROUTINE, ALTER ROUTINE, EXECUTE, pour des op\u00e9rations sur les proc\u00e9dures stock\u00e9es. Il y a beaucoup d'autres privil\u00e8ges qu'on peut octroyer, vous pouvez consulter une liste plus compl\u00e8te dans la documentation de MySQL : https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html Niveau des privil\u00e8ges L'indicateur du niveau de privil\u00e8ges se compose en deux sections, la ou les base de donn\u00e9es et ensuite le nom de la table ou de la proc\u00e9dure stock\u00e9e. *.* : Toutes les bases de donn\u00e9es et toutes les tables/proc\u00e9dures stock\u00e9es credit_social.* : Pour la base de donn\u00e9es credit_social, toutes les tables credit_social.classe : Pour la base de donn\u00e9es credit_social, la table classe uniquement. Afficher les autorisations d'un utilisateur ou d'un r\u00f4le SHOW GRANTS FOR 'usager_role'@'localhost';","title":"Gestion des autorisations"},{"location":"notes_de_cours/mySQL/gestion_autorisations/#gestion-des-autorisations","text":"","title":"Gestion des autorisations"},{"location":"notes_de_cours/mySQL/gestion_autorisations/#ajouter-ou-enlever-de-privileges","text":"-- Syntaxe pour ajouter un privil\u00e8ge GRANT nomDuPrivilege (listeDesColonnes) ON niveauPrivilege TO nomUsager_nomRole -- Syntaxe pour enlever un privil\u00e8ge REVOKE nomDuPrivilege ON niveauPrivilege FROM nomUsager_nomRole nomDuPrivilege : Le nom du privil\u00e8ge \u00e0 ajouter (SELECT, INSERT, CREATE TABLE, etc.). On peut en mettre plusieurs en les s\u00e9parant par une virgule. listeDesColonnes : C'est optionnel mais on peut sp\u00e9cifier les colonnes sur lesquelles le privil\u00e8ge est appliqu\u00e9. On pourrait par exemple accorder le droit \u00e0 un usager de faire un UPDATE mais seulement pour des colonnes sp\u00e9cifiques d'une table. niveauPrivilege : \u00c0 quel niveau s'applique le privil\u00e8ge. (Globalement, seulement pour une base de donn\u00e9es en particulier, pour une table pr\u00e9cise, etc.) nomUsager_nomRole: \u00c0 quel usager ou role on veut octroyer le privil\u00e8ge. Exemple /* Octroyer \u00e0 l'usager test le droit de faire des requ\u00eates select et insert sur toutes les tables de la base de donn\u00e9es credit_social */ GRANT SELECT, INSERT ON credit_social.* TO test@localhost; /* Octroyer \u00e0 l'usager test2 le droit de faire des requ\u00eates select uniquement sur la table citoyen de la base de donn\u00e9es credit_social. De plus, seulement les colonnes id, nom et prenom seront accessible pour cette table */ GRANT SELECT (id, nom, prenom) ON credit_social.citoyen TO test2@localhost;","title":"Ajouter ou enlever de privil\u00e8ges"},{"location":"notes_de_cours/mySQL/gestion_autorisations/#liste-des-privileges","text":"Voici une courte liste de privil\u00e8ges qu'on peut ajouter \u00e0 un usager : ALL, tous les privil\u00e8ges, sauf celui d'en accorder. USAGE, aucun privil\u00e8ges GRANT OPTION, accorde le droit d'ajouter des privil\u00e8ges (il n'est pas inclus quand on utilise ALL) SELECT, INSERT, UPDATE, DELETE, pour les requ\u00eates CRUD correspondante CREATE TABLE, ALTER, DROP, REFERENCES pour des op\u00e9rations sur les tables et la base de donn\u00e9es. CREATE ROUTINE, ALTER ROUTINE, EXECUTE, pour des op\u00e9rations sur les proc\u00e9dures stock\u00e9es. Il y a beaucoup d'autres privil\u00e8ges qu'on peut octroyer, vous pouvez consulter une liste plus compl\u00e8te dans la documentation de MySQL : https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html","title":"Liste des privil\u00e8ges"},{"location":"notes_de_cours/mySQL/gestion_autorisations/#niveau-des-privileges","text":"L'indicateur du niveau de privil\u00e8ges se compose en deux sections, la ou les base de donn\u00e9es et ensuite le nom de la table ou de la proc\u00e9dure stock\u00e9e. *.* : Toutes les bases de donn\u00e9es et toutes les tables/proc\u00e9dures stock\u00e9es credit_social.* : Pour la base de donn\u00e9es credit_social, toutes les tables credit_social.classe : Pour la base de donn\u00e9es credit_social, la table classe uniquement.","title":"Niveau des privil\u00e8ges"},{"location":"notes_de_cours/mySQL/gestion_autorisations/#afficher-les-autorisations-dun-utilisateur-ou-dun-role","text":"SHOW GRANTS FOR 'usager_role'@'localhost';","title":"Afficher les autorisations d'un utilisateur ou d'un r\u00f4le"},{"location":"notes_de_cours/mySQL/gestion_role/","text":"Gestion des r\u00f4les (Attention, il peut y avoir quelques diff\u00e9rences entre MySQL et MariaDB, les notes pr\u00e9sent\u00e9es ici sont en MariaDB) Un r\u00f4le est une regroupement nomm\u00e9 de privil\u00e8ges qu'on peut accorder \u00e0 un ou plusieurs utilisateurs. On retrouve le m\u00eame fonctionnement qu'avec l'utilisateur : on va cr\u00e9er un r\u00f4le et ensuite lui octroyer des privil\u00e8ges. Cr\u00e9er un r\u00f4le On va cr\u00e9er un ou plusieurs r\u00f4les avec la commande CREATE ROLE suivi du nom du r\u00f4le. On peut cr\u00e9er plus d'un r\u00f4le \u00e0 la fois en s\u00e9parant chaque nom de r\u00f4le par une virgule. CREATE ROLE IF NOT EXISTS 'nomRole1', 'nommRole2'; Ajouter ou enlever des privil\u00e8ges \u00e0 un r\u00f4le Voir la section Gestion des autorisations Accorder un r\u00f4le \u00e0 un utilisateur Pour accorder un r\u00f4le \u00e0 un utilisateur on utilise la commande GRANT suivi du nom du r\u00f4le et du nom d'un ou plusieurs utilisateur. (Attention il faut ajouter l'h\u00f4te de l'utilisateur si celui-ci est diff\u00e9rent de %) GRANT 'nomRole1' TO 'user1', 'user2'@'192.168.1.%'; R\u00e9voquer un r\u00f4le \u00e0 un utilisateur Pour accorder un r\u00f4le \u00e0 un utilisateur on utilise la commande REVOKE suivi du nom du r\u00f4le et du nom d'un ou plusieurs utilisateur. (Attention il faut ajouter l'h\u00f4te de l'utilisateur si celui-ci est diff\u00e9rent de %) REVOKE 'nomRole1' FROM 'user1', 'user2'@'192.168.1.%'; Supprimer un r\u00f4le DROP ROLE 'nomRole1'; Activer un r\u00f4le Une fois le r\u00f4le cr\u00e9\u00e9 il faut qu'il soit activer pour qu'il puisse \u00eatre appliqu\u00e9 entre le connexion. Attention un usager ne peut avoir qu'un role d'activ\u00e9 \u00e0 la fois. On doit \u00eatre connect\u00e9 \u00e0 l'usager pour activer son r\u00f4le. SET ROLE nomRole Afficher le r\u00f4le qui est actif On peut conna\u00eetre le r\u00f4le pr\u00e9sentement activ\u00e9 pour l'utilisateur de cette fa\u00e7on. Le r\u00e9sultat sera null si aucun r\u00f4le n'est activ\u00e9. SELECT current_role(); D\u00e9finir un r\u00f4le par d\u00e9faut Lors de la connexion, le r\u00f4le d\u00e9fini de cette fa\u00e7on sera automatiquement activ\u00e9. SET DEFAULT ROLE nomRole FOR nomUsager","title":"Gestion des r\u00f4les"},{"location":"notes_de_cours/mySQL/gestion_role/#gestion-des-roles","text":"(Attention, il peut y avoir quelques diff\u00e9rences entre MySQL et MariaDB, les notes pr\u00e9sent\u00e9es ici sont en MariaDB) Un r\u00f4le est une regroupement nomm\u00e9 de privil\u00e8ges qu'on peut accorder \u00e0 un ou plusieurs utilisateurs. On retrouve le m\u00eame fonctionnement qu'avec l'utilisateur : on va cr\u00e9er un r\u00f4le et ensuite lui octroyer des privil\u00e8ges.","title":"Gestion des r\u00f4les"},{"location":"notes_de_cours/mySQL/gestion_role/#creer-un-role","text":"On va cr\u00e9er un ou plusieurs r\u00f4les avec la commande CREATE ROLE suivi du nom du r\u00f4le. On peut cr\u00e9er plus d'un r\u00f4le \u00e0 la fois en s\u00e9parant chaque nom de r\u00f4le par une virgule. CREATE ROLE IF NOT EXISTS 'nomRole1', 'nommRole2';","title":"Cr\u00e9er un r\u00f4le"},{"location":"notes_de_cours/mySQL/gestion_role/#ajouter-ou-enlever-des-privileges-a-un-role","text":"Voir la section Gestion des autorisations","title":"Ajouter ou enlever des privil\u00e8ges \u00e0 un r\u00f4le"},{"location":"notes_de_cours/mySQL/gestion_role/#accorder-un-role-a-un-utilisateur","text":"Pour accorder un r\u00f4le \u00e0 un utilisateur on utilise la commande GRANT suivi du nom du r\u00f4le et du nom d'un ou plusieurs utilisateur. (Attention il faut ajouter l'h\u00f4te de l'utilisateur si celui-ci est diff\u00e9rent de %) GRANT 'nomRole1' TO 'user1', 'user2'@'192.168.1.%';","title":"Accorder un r\u00f4le \u00e0 un utilisateur"},{"location":"notes_de_cours/mySQL/gestion_role/#revoquer-un-role-a-un-utilisateur","text":"Pour accorder un r\u00f4le \u00e0 un utilisateur on utilise la commande REVOKE suivi du nom du r\u00f4le et du nom d'un ou plusieurs utilisateur. (Attention il faut ajouter l'h\u00f4te de l'utilisateur si celui-ci est diff\u00e9rent de %) REVOKE 'nomRole1' FROM 'user1', 'user2'@'192.168.1.%';","title":"R\u00e9voquer un r\u00f4le \u00e0 un utilisateur"},{"location":"notes_de_cours/mySQL/gestion_role/#supprimer-un-role","text":"DROP ROLE 'nomRole1';","title":"Supprimer un r\u00f4le"},{"location":"notes_de_cours/mySQL/gestion_role/#activer-un-role","text":"Une fois le r\u00f4le cr\u00e9\u00e9 il faut qu'il soit activer pour qu'il puisse \u00eatre appliqu\u00e9 entre le connexion. Attention un usager ne peut avoir qu'un role d'activ\u00e9 \u00e0 la fois. On doit \u00eatre connect\u00e9 \u00e0 l'usager pour activer son r\u00f4le. SET ROLE nomRole","title":"Activer un r\u00f4le"},{"location":"notes_de_cours/mySQL/gestion_role/#afficher-le-role-qui-est-actif","text":"On peut conna\u00eetre le r\u00f4le pr\u00e9sentement activ\u00e9 pour l'utilisateur de cette fa\u00e7on. Le r\u00e9sultat sera null si aucun r\u00f4le n'est activ\u00e9. SELECT current_role();","title":"Afficher le r\u00f4le qui est actif"},{"location":"notes_de_cours/mySQL/gestion_role/#definir-un-role-par-defaut","text":"Lors de la connexion, le r\u00f4le d\u00e9fini de cette fa\u00e7on sera automatiquement activ\u00e9. SET DEFAULT ROLE nomRole FOR nomUsager","title":"D\u00e9finir un r\u00f4le par d\u00e9faut"},{"location":"notes_de_cours/mySQL/gestion_utilisateurs/","text":"Gestion des utilisateurs (Attention, il peut y avoir quelques diff\u00e9rences entre MySQL et MariaDB, les notes pr\u00e9sent\u00e9es ici sont en MariaDB) Pour se connecter \u00e0 MySQL on doit avoir en main un utilisateur et un mot de passe. Chaque utilisateurs \u00e0 ses propres privil\u00e8ges sur ce qui peut faire ou non dans la base de donn\u00e9es. Les informations sur les utilisateurs et leur privil\u00e8ges sont stock\u00e9s dans les tables suivantes de la base de donn\u00e9es mysql : user : les informations sur les utilisateurs. db, tables_priv, columns_priv et proc_priv : les privil\u00e8ges de l'utilisateur. On peut modifier les valeurs de ces tables mais il est pr\u00e9f\u00e9rable de ne pas le faire directement dans ces tables mais avec les commandes appropri\u00e9es. Cr\u00e9er un utilisateur On utilise la commande CREATE USER en sp\u00e9cifiant un nom d'utilisateur, un h\u00f4te et un mot de passe. L'h\u00f4te est optionnel et repr\u00e9sente l'adresse \u00e0 partir de laquelle l'utilisateur va se connecter. On utilise souvent localhost ou 127.0.0.1, ce qui veut dire que l'utilisateur pourra se connecter \u00e0 partir de la machine o\u00f9 est situ\u00e9 le serveur. Si on ne sp\u00e9cifie pas d'h\u00f4te, l'utilisateur pourra se connecter depuis n'importe quel h\u00f4te. CREATE USER IF NOT EXISTS 'nomUtilisateur'@'hote' IDENTIFIED BY 'motDePasse'; -- Exemple CREATE USER IF NOT EXISTS 'math'@'localhost' IDENTIFIED BY 'qwerty4ever'; CREATE USER IF NOT EXISTS 'math2' IDENTIFIED BY 'qwerty4ever'; CREATE USER IF NOT EXISTS 'patate'@'156.20.12.2' IDENTIFIED BY 'qwerty4ever'; On peut utiliser le joker % pour permettre la cr\u00e9ation d'un utilisateur qui va pouvoir se connecter depuis plus d'un h\u00f4te : -- L'utilisateur va pourvoir se connecter depuis n'importe quel h\u00f4te dont -- l'adresse ip commence par 156.20.12 CREATE USER IF NOT EXISTS 'math'@'156.20.12.%' IDENTIFIED BY 'qwerty4ever'; -- L'utilisateur va pouvoir se connecter depuis n'importe quel h\u00f4te CREATE USER IF NOT EXISTS 'math'@'%' IDENTIFIED BY 'qwerty4ever'; Modifier le nom d'un utilisateur Pour modifier le nom d'un utilisateur, on utilise la commande RENAME USER : RENAME USER 'Math'@'localhost' TO 'Mathieu'@'localhost'; Supprimer un utilisateur Pour supprimer un utilisateur, on va utiliser DROP USER : DROP USER 'Math'@'localhost' Afficher la liste des utilisateurs En mysql il n'y a pas de commande SHOW USERS pour nous afficher la liste de tous les utilisateurs. On a vu plus haut que les informations de l'utilisateur \u00e9tait stock\u00e9 dans la table user de la base de donn\u00e9es mysql . On peut donc avec une requ\u00eate SELECT sur cette table afficher la liste des utilisateurs. Les usagers et les r\u00f4les sont stock\u00e9s ensemble dans cette table. Avec MariaDB on peut les diff\u00e9rencier avec la colonne is_role qui prend la valeur \"N\" quand c'est un usager et \"Y\" quand c'est un r\u00f4le. -- Affiche tout les usagers SELECT * FROM mysql.user WHERE is_role = 'N'; -- Si on veut uniquement la liste des usagers et de leur h\u00f4te SELECT user, host FROM mysql.user WHERE is_role = 'N';","title":"Gestion des utilisateurs"},{"location":"notes_de_cours/mySQL/gestion_utilisateurs/#gestion-des-utilisateurs","text":"(Attention, il peut y avoir quelques diff\u00e9rences entre MySQL et MariaDB, les notes pr\u00e9sent\u00e9es ici sont en MariaDB) Pour se connecter \u00e0 MySQL on doit avoir en main un utilisateur et un mot de passe. Chaque utilisateurs \u00e0 ses propres privil\u00e8ges sur ce qui peut faire ou non dans la base de donn\u00e9es. Les informations sur les utilisateurs et leur privil\u00e8ges sont stock\u00e9s dans les tables suivantes de la base de donn\u00e9es mysql : user : les informations sur les utilisateurs. db, tables_priv, columns_priv et proc_priv : les privil\u00e8ges de l'utilisateur. On peut modifier les valeurs de ces tables mais il est pr\u00e9f\u00e9rable de ne pas le faire directement dans ces tables mais avec les commandes appropri\u00e9es.","title":"Gestion des utilisateurs"},{"location":"notes_de_cours/mySQL/gestion_utilisateurs/#creer-un-utilisateur","text":"On utilise la commande CREATE USER en sp\u00e9cifiant un nom d'utilisateur, un h\u00f4te et un mot de passe. L'h\u00f4te est optionnel et repr\u00e9sente l'adresse \u00e0 partir de laquelle l'utilisateur va se connecter. On utilise souvent localhost ou 127.0.0.1, ce qui veut dire que l'utilisateur pourra se connecter \u00e0 partir de la machine o\u00f9 est situ\u00e9 le serveur. Si on ne sp\u00e9cifie pas d'h\u00f4te, l'utilisateur pourra se connecter depuis n'importe quel h\u00f4te. CREATE USER IF NOT EXISTS 'nomUtilisateur'@'hote' IDENTIFIED BY 'motDePasse'; -- Exemple CREATE USER IF NOT EXISTS 'math'@'localhost' IDENTIFIED BY 'qwerty4ever'; CREATE USER IF NOT EXISTS 'math2' IDENTIFIED BY 'qwerty4ever'; CREATE USER IF NOT EXISTS 'patate'@'156.20.12.2' IDENTIFIED BY 'qwerty4ever'; On peut utiliser le joker % pour permettre la cr\u00e9ation d'un utilisateur qui va pouvoir se connecter depuis plus d'un h\u00f4te : -- L'utilisateur va pourvoir se connecter depuis n'importe quel h\u00f4te dont -- l'adresse ip commence par 156.20.12 CREATE USER IF NOT EXISTS 'math'@'156.20.12.%' IDENTIFIED BY 'qwerty4ever'; -- L'utilisateur va pouvoir se connecter depuis n'importe quel h\u00f4te CREATE USER IF NOT EXISTS 'math'@'%' IDENTIFIED BY 'qwerty4ever';","title":"Cr\u00e9er un utilisateur"},{"location":"notes_de_cours/mySQL/gestion_utilisateurs/#modifier-le-nom-dun-utilisateur","text":"Pour modifier le nom d'un utilisateur, on utilise la commande RENAME USER : RENAME USER 'Math'@'localhost' TO 'Mathieu'@'localhost';","title":"Modifier le nom d'un utilisateur"},{"location":"notes_de_cours/mySQL/gestion_utilisateurs/#supprimer-un-utilisateur","text":"Pour supprimer un utilisateur, on va utiliser DROP USER : DROP USER 'Math'@'localhost'","title":"Supprimer un utilisateur"},{"location":"notes_de_cours/mySQL/gestion_utilisateurs/#afficher-la-liste-des-utilisateurs","text":"En mysql il n'y a pas de commande SHOW USERS pour nous afficher la liste de tous les utilisateurs. On a vu plus haut que les informations de l'utilisateur \u00e9tait stock\u00e9 dans la table user de la base de donn\u00e9es mysql . On peut donc avec une requ\u00eate SELECT sur cette table afficher la liste des utilisateurs. Les usagers et les r\u00f4les sont stock\u00e9s ensemble dans cette table. Avec MariaDB on peut les diff\u00e9rencier avec la colonne is_role qui prend la valeur \"N\" quand c'est un usager et \"Y\" quand c'est un r\u00f4le. -- Affiche tout les usagers SELECT * FROM mysql.user WHERE is_role = 'N'; -- Si on veut uniquement la liste des usagers et de leur h\u00f4te SELECT user, host FROM mysql.user WHERE is_role = 'N';","title":"Afficher la liste des utilisateurs"},{"location":"notes_de_cours/mySQL/transaction/","text":"Transactions En SQL, une transaction est une s\u00e9rie d'instructions ou de requ\u00eates qui doivent \u00eatre ex\u00e9cut\u00e9 en un seul bloc. Cette s\u00e9rie d'op\u00e9rations peut \u00eatre accept\u00e9 ( COMMIT ) ou refus\u00e9 ( ROLLBACK ). C'est une pratique qui est essentiel quand on veut lancer une s\u00e9rie d'op\u00e9ration et s'assurer de l'int\u00e9grit\u00e9 de notre base de donn\u00e9es. \u00c7a nous prot\u00e8ge \u00e0 la fois des erreurs humaines (erreur dans le code, mauvaise manipulation des donn\u00e9es, etc.) et des erreurs externes (pannes de serveur durant un traitement par exemple). D\u00e9marrer une transaction AUTOCOMMIT Par d\u00e9faut MySQL n'utilise pas les transactions et toutes les requ\u00eates sont automatiquement valid\u00e9es. On peut modifier ce comportement en changeant la valeur de la variable syst\u00e8me autocommit . Attention, la variable autocommit est une variable de session, c'est-\u00e0-dire que la modification qu'on y fait n'est valide que pour la session en cours et qu'elle reprendra sa valeur par d\u00e9faut \u00e0 la session suivante. Exemple -- Modification pour que les requ\u00eates ne soit plus automatiquement \"commit\u00e9\" SET autocommit = 0; -- Insertion d'un enregistrement insert into athlete (nom, prenom) values ('Fr\u00e9chette', 'Mathieu'); -- \u00c9tant donn\u00e9 que la variable autocommit est maintenant \u00e0 false, -- l'insertion ne sera permanente qu'apr\u00e8s avoir valid\u00e9 la transaction START TRANSACTION La fa\u00e7on la plus courante de d\u00e9marrer une transaction est d'utiliser la commande START TRANSACTION . Une fois la commande lanc\u00e9e, toutes les requ\u00eates suivantes seront \"en attente\" tant que la transaction ne sera pas termin\u00e9e. Exemple -- Pour l'exemple, je m'assure que la valeur de la variable autocommit est bien \u00e0 TRUE. -- C'est la valeur par d\u00e9faut, on n'est pas oblig\u00e9 de le sp\u00e9cifi\u00e9 en temps normal. SET autocommit = 1; -- D\u00e9but de la transaction START TRANSACTION; -- Insertion d'un enregistrement insert into athlete (nom, prenom) values ('Fr\u00e9chette', 'Mathieu'); -- \u00c9tant donn\u00e9 qu'on a d\u00e9but\u00e9 une transaction, l'insertion ne sera permanente -- qu'apr\u00e8s l'avoir valid\u00e9e ou annul\u00e9e. Terminer une transaction COMMIT Si toutes les requ\u00eates se sont bien ex\u00e9cut\u00e9 et qu'on veut confirmer les changements, on va utiliser la commande COMMIT . Les modifications apport\u00e9es seront maintenant permanentes et la transaction va se terminer. Exemple START TRANSACTION; -- Op\u00e9rations \u00e0 effectuer ... -- Valider la transaction et rendre les op\u00e9rations permanentes. COMMIT; ROLLBACK Pour terminer la transaction en annulant TOUTES les modifications effectu\u00e9es, on va utiliser la commande ROLLBACK . Exemple START TRANSACTION; -- Op\u00e9rations \u00e0 effectuer ... -- Annuler toutes les op\u00e9rations depuis le d\u00e9but de la transaction ROLLBACK; Utiliser des points de sauvegarde On ne peut pas d\u00e9buter une seconde transaction \"\u00e0 l'int\u00e9rieur\" d'une transaction d\u00e9j\u00e0 d\u00e9but\u00e9e. Par contre on peut cr\u00e9er des points de sauvegarde qui nous permettront d'annuler uniquement les op\u00e9rations effectu\u00e9es depuis un point de sauvegarde. SAVEPOINT Pour cr\u00e9er un point de sauvegarde, on va utiliser la commande SAVEPOINT . On peut d\u00e9finir plusieurs point de sauvegarde \u00e0 l'int\u00e9rieur d'une m\u00eame transaction. SAVEPOINT nom_du_savepoint ROLLBACK TO SAVEPOINT Une fois le point de sauvegarde cr\u00e9er, on peut annuler uniquement les transactions effectu\u00e9es depuis celui-ci. Exemple -- D\u00e9but de la transaction START TRANSACTION; -- Insertion d'un enregistrement insert into athlete (nom, prenom) values ('Fr\u00e9chette', 'Mathieu'); -- Cr\u00e9ation d'un point de sauvegarde SAVEPOINT save_Math; -- Insertion d'un second enregistrement insert into athlete (nom, prenom) values ('Fr\u00e9chette', 'Marianne'); -- Annulation jusqu'au savepoint save_Math ROLLBACK TO SAVEPOINT save_Math; -- Validation de la transaction COMMIT; -- L'athl\u00e8te Mathieu Fr\u00e9chette sera ins\u00e9r\u00e9 dans la base de donn\u00e9es mais pas Marianne Fr\u00e9chette. Commandes qui terminent automatiquement une transaction Attention, certaines commandes SQL vont cl\u00f4turer automatiquement une transaction et aussi valider toutes les op\u00e9rations, comme si on aurait utilis\u00e9 la commande COMMIT . Voici une liste de ces commandes Toutes les commandes qui apportent une modification \u00e0 la base de donn\u00e9es vont valider une transaction La cr\u00e9ation ou suppression d'une base de donn\u00e9es Toutes les modifications apport\u00e9es aux tables, cr\u00e9ation, modification, etc... La cr\u00e9ation ou suppression d'un index. La cr\u00e9ation de proc\u00e9dures stock\u00e9es, de fonctions ou de vues. La cr\u00e9ation, suppression ou modification d'un utilisateur. Le d\u00e9but d'une nouvelle transaction sans avoir termin\u00e9 la premi\u00e8re. Changer la valeur de la variable autocommit \u00e0 TRUE. La cr\u00e9ation ou suppression d'un LOCK sur une table. Sources https://dev.mysql.com/doc/refman/8.0/en/sql-transactional-statements.html https://www.javatpoint.com/mysql-transaction https://www.mysqltutorial.org/mysql-transaction.aspx","title":"Les transactions"},{"location":"notes_de_cours/mySQL/transaction/#transactions","text":"En SQL, une transaction est une s\u00e9rie d'instructions ou de requ\u00eates qui doivent \u00eatre ex\u00e9cut\u00e9 en un seul bloc. Cette s\u00e9rie d'op\u00e9rations peut \u00eatre accept\u00e9 ( COMMIT ) ou refus\u00e9 ( ROLLBACK ). C'est une pratique qui est essentiel quand on veut lancer une s\u00e9rie d'op\u00e9ration et s'assurer de l'int\u00e9grit\u00e9 de notre base de donn\u00e9es. \u00c7a nous prot\u00e8ge \u00e0 la fois des erreurs humaines (erreur dans le code, mauvaise manipulation des donn\u00e9es, etc.) et des erreurs externes (pannes de serveur durant un traitement par exemple).","title":"Transactions"},{"location":"notes_de_cours/mySQL/transaction/#demarrer-une-transaction","text":"","title":"D\u00e9marrer une transaction"},{"location":"notes_de_cours/mySQL/transaction/#autocommit","text":"Par d\u00e9faut MySQL n'utilise pas les transactions et toutes les requ\u00eates sont automatiquement valid\u00e9es. On peut modifier ce comportement en changeant la valeur de la variable syst\u00e8me autocommit . Attention, la variable autocommit est une variable de session, c'est-\u00e0-dire que la modification qu'on y fait n'est valide que pour la session en cours et qu'elle reprendra sa valeur par d\u00e9faut \u00e0 la session suivante. Exemple -- Modification pour que les requ\u00eates ne soit plus automatiquement \"commit\u00e9\" SET autocommit = 0; -- Insertion d'un enregistrement insert into athlete (nom, prenom) values ('Fr\u00e9chette', 'Mathieu'); -- \u00c9tant donn\u00e9 que la variable autocommit est maintenant \u00e0 false, -- l'insertion ne sera permanente qu'apr\u00e8s avoir valid\u00e9 la transaction","title":"AUTOCOMMIT"},{"location":"notes_de_cours/mySQL/transaction/#start-transaction","text":"La fa\u00e7on la plus courante de d\u00e9marrer une transaction est d'utiliser la commande START TRANSACTION . Une fois la commande lanc\u00e9e, toutes les requ\u00eates suivantes seront \"en attente\" tant que la transaction ne sera pas termin\u00e9e. Exemple -- Pour l'exemple, je m'assure que la valeur de la variable autocommit est bien \u00e0 TRUE. -- C'est la valeur par d\u00e9faut, on n'est pas oblig\u00e9 de le sp\u00e9cifi\u00e9 en temps normal. SET autocommit = 1; -- D\u00e9but de la transaction START TRANSACTION; -- Insertion d'un enregistrement insert into athlete (nom, prenom) values ('Fr\u00e9chette', 'Mathieu'); -- \u00c9tant donn\u00e9 qu'on a d\u00e9but\u00e9 une transaction, l'insertion ne sera permanente -- qu'apr\u00e8s l'avoir valid\u00e9e ou annul\u00e9e.","title":"START TRANSACTION"},{"location":"notes_de_cours/mySQL/transaction/#terminer-une-transaction","text":"","title":"Terminer une transaction"},{"location":"notes_de_cours/mySQL/transaction/#commit","text":"Si toutes les requ\u00eates se sont bien ex\u00e9cut\u00e9 et qu'on veut confirmer les changements, on va utiliser la commande COMMIT . Les modifications apport\u00e9es seront maintenant permanentes et la transaction va se terminer. Exemple START TRANSACTION; -- Op\u00e9rations \u00e0 effectuer ... -- Valider la transaction et rendre les op\u00e9rations permanentes. COMMIT;","title":"COMMIT"},{"location":"notes_de_cours/mySQL/transaction/#rollback","text":"Pour terminer la transaction en annulant TOUTES les modifications effectu\u00e9es, on va utiliser la commande ROLLBACK . Exemple START TRANSACTION; -- Op\u00e9rations \u00e0 effectuer ... -- Annuler toutes les op\u00e9rations depuis le d\u00e9but de la transaction ROLLBACK;","title":"ROLLBACK"},{"location":"notes_de_cours/mySQL/transaction/#utiliser-des-points-de-sauvegarde","text":"On ne peut pas d\u00e9buter une seconde transaction \"\u00e0 l'int\u00e9rieur\" d'une transaction d\u00e9j\u00e0 d\u00e9but\u00e9e. Par contre on peut cr\u00e9er des points de sauvegarde qui nous permettront d'annuler uniquement les op\u00e9rations effectu\u00e9es depuis un point de sauvegarde.","title":"Utiliser des points de sauvegarde"},{"location":"notes_de_cours/mySQL/transaction/#savepoint","text":"Pour cr\u00e9er un point de sauvegarde, on va utiliser la commande SAVEPOINT . On peut d\u00e9finir plusieurs point de sauvegarde \u00e0 l'int\u00e9rieur d'une m\u00eame transaction. SAVEPOINT nom_du_savepoint","title":"SAVEPOINT"},{"location":"notes_de_cours/mySQL/transaction/#rollback-to-savepoint","text":"Une fois le point de sauvegarde cr\u00e9er, on peut annuler uniquement les transactions effectu\u00e9es depuis celui-ci. Exemple -- D\u00e9but de la transaction START TRANSACTION; -- Insertion d'un enregistrement insert into athlete (nom, prenom) values ('Fr\u00e9chette', 'Mathieu'); -- Cr\u00e9ation d'un point de sauvegarde SAVEPOINT save_Math; -- Insertion d'un second enregistrement insert into athlete (nom, prenom) values ('Fr\u00e9chette', 'Marianne'); -- Annulation jusqu'au savepoint save_Math ROLLBACK TO SAVEPOINT save_Math; -- Validation de la transaction COMMIT; -- L'athl\u00e8te Mathieu Fr\u00e9chette sera ins\u00e9r\u00e9 dans la base de donn\u00e9es mais pas Marianne Fr\u00e9chette.","title":"ROLLBACK TO SAVEPOINT"},{"location":"notes_de_cours/mySQL/transaction/#commandes-qui-terminent-automatiquement-une-transaction","text":"Attention, certaines commandes SQL vont cl\u00f4turer automatiquement une transaction et aussi valider toutes les op\u00e9rations, comme si on aurait utilis\u00e9 la commande COMMIT . Voici une liste de ces commandes Toutes les commandes qui apportent une modification \u00e0 la base de donn\u00e9es vont valider une transaction La cr\u00e9ation ou suppression d'une base de donn\u00e9es Toutes les modifications apport\u00e9es aux tables, cr\u00e9ation, modification, etc... La cr\u00e9ation ou suppression d'un index. La cr\u00e9ation de proc\u00e9dures stock\u00e9es, de fonctions ou de vues. La cr\u00e9ation, suppression ou modification d'un utilisateur. Le d\u00e9but d'une nouvelle transaction sans avoir termin\u00e9 la premi\u00e8re. Changer la valeur de la variable autocommit \u00e0 TRUE. La cr\u00e9ation ou suppression d'un LOCK sur une table.","title":"Commandes qui terminent automatiquement une transaction"},{"location":"notes_de_cours/mySQL/transaction/#sources","text":"https://dev.mysql.com/doc/refman/8.0/en/sql-transactional-statements.html https://www.javatpoint.com/mysql-transaction https://www.mysqltutorial.org/mysql-transaction.aspx","title":"Sources"},{"location":"notes_de_cours/mySQL/triggers/","text":"Les triggers Un trigger (ou d\u00e9clencheur) est une sorte de proc\u00e9dure stock\u00e9e, une s\u00e9rie d'instruction enregistr\u00e9e, qui est reli\u00e9 \u00e0 une table de la base de donn\u00e9es. Les instructions seront ex\u00e9cut\u00e9 automatiquement lors d'une insertion, d'une mise \u00e0 jour ou d'une suppression dans la table \u00e0 laquelle le trigger est attach\u00e9 et \u00e7a pour chacune des lignes affect\u00e9es par la requ\u00eate. On doit aussi sp\u00e9cifier \u00e0 quel moment il sera d\u00e9clench\u00e9, avant l'instruction SQL ou apr\u00e8s. On peut donc d\u00e9finir jusqu'\u00e0 6 triggers par tables : avant ou apr\u00e8s une insertion, avant ou apr\u00e8s une mise \u00e0 jour, avant ou apr\u00e8s une suppression. On peut depuis un trigger modifier et ins\u00e9rer des donn\u00e9es dans n'importe quel table de la base de donn\u00e9es \u00e0 l'exception des tables utilis\u00e9es dans la requ\u00eate qui l'a d\u00e9clench\u00e9. Si on veut travailler sur la table \u00e0 laquelle le trigger est attach\u00e9, on n'a acc\u00e8s qu'\u00e0 la ligne qu'on est en train de traiter. ### Pourquoi utiliser des triggers ? S'assurer de la validit\u00e9 des donn\u00e9es avant leur insertion ou leur modification. Pour pouvoir utiliser des traitements plus complexe lors d'op\u00e9ration qui affectent plusieurs tables. Par exemple si on veut supprimer des donn\u00e9es qui sont reli\u00e9es \u00e0 d'autres tables par des cl\u00e9s \u00e9trang\u00e8res et que les options offerte ne nous suffise pas. Pour garder une trace des op\u00e9rations effectu\u00e9es dans la base de donn\u00e9es. Mettre \u00e0 jour des informations qu'on utilise r\u00e9guli\u00e8rement pour pouvoir les retrouver facilement, comme par exemple le solde actif d'un compte client. Syntaxe On utilise la commande CREATE TRIGGER pour la cr\u00e9ation d'un trigger. Le nom du trigger doit \u00eatre unique dans la base de donn\u00e9es. Il est d'usage de nommer le trigger avec le moment de son d\u00e9clenchement, de l'op\u00e9ration effectu\u00e9e et du nom de la table associ\u00e9e, ex je veux cr\u00e9er un trigger sur la table usager qui se d\u00e9clenchera avant un insertion, je vais le nommer before_insert_usager. CREATE TRIGGER nomTrigger momentDuDeclenchement operationSQL ON nomTable FOR EACH ROW corpsDuTrigger; Le moment du d\u00e9clenchement est BEFORE ou AFTER L'op\u00e9ration SQL est soit INSERT, UPDATE ou DELETE Si le corps du trigger contient plus d'une requ\u00eate et/ou op\u00e9ration, on doit les englober par un BEGIN END. NEW et OLD On peut utiliser les mots cl\u00e9s dans le corps du trigger pour acc\u00e9der aux donn\u00e9es avant ou apr\u00e8s leur modification. OLD repr\u00e9sente les donn\u00e9es avant qu'elles ne soient modifi\u00e9 par le trigger. Ces donn\u00e9es ne peuvent pas \u00eatre modifi\u00e9es. Old est disponible pour les UPDATE et DELETE NEW repr\u00e9sente les donn\u00e9es apr\u00e8s qu'elles aient \u00e9t\u00e9 modifi\u00e9. C'est donn\u00e9es peuvent \u00eatre lu et modifi\u00e9s. New est disponible pour les INSERT et UPDATE. Requ\u00eate OLD NEW INSERT - OUI UPDATE OUI OUI DELETE OUI - Erreur dans un trigger Si un trigger ex\u00e9cut\u00e9 avant (BEFORE) une requ\u00eate cause une erreur, la requ\u00eate ne sera pas ex\u00e9cut\u00e9e. Les triggers ex\u00e9cut\u00e9s apr\u00e8s (AFTER) une requ\u00eate qui g\u00e9n\u00e8re une erreur feront \u00e9chouer celle-ci. Il est donc important de bien concevoir les triggers et d'inclure une gestion des erreurs dans notre traitement. Supprimer un trigger Pour supprimer un trigger, on utilise la commande DROP TRIGGER suivie du nom du trigger. Si on supprimer une table, tous les triggers qui lui sont associ\u00e9e seront aussi supprim\u00e9s. DROP TRIGGER before_insert_usager; Restrictions On en peut pas utiliser de transaction dans un trigger, START TRANSACTION, COMMIT ou ROLLBACK On peut utiliser une proc\u00e9dure stock\u00e9e mais avec les restrictions suivantes : La proc\u00e9dure ne peut pas retourner d'informations, \u00e0 part en utilisant un param\u00e8tre OUT ou IN/OUT. La proc\u00e9dure ne doit pas utiliser de transaction. On ne peut pas modifier les donn\u00e9es d'une table qui est utilis\u00e9e dans la requ\u00eate qui d\u00e9clenche le trigger. \u00c7a compte pour toutes les tables de la requ\u00eate et non seulement la table associ\u00e9e au trigger. Une suppression ou modification de donn\u00e9es d\u00e9clench\u00e9e par une cl\u00e9 \u00e9trang\u00e8re ne provoquera pas l'ex\u00e9cution du trigger associ\u00e9 \u00e0 cette table. Exemple de triggers J'ai une table joueur, un table guilde et une table joueur_guilde_log. Dans la table joueur il y a un champ guilde_id qui fait r\u00e9f\u00e9rence \u00e0 la cl\u00e9 primaire de la table guilde. Quand on modifie la guilde d'un joueur, je voudrais sauvegarder les informations dans une autre table (le id du joueur, l'id de son acienne guile, l'id de la nouvelle et la date de la modification). Je vais cr\u00e9er un trigger AFTER sur la table joueur. Je vais aussi valider que la colonne guilde_id a \u00e9t\u00e9 modifi\u00e9 avant d'ajouter les informations dans la table joueur_guilde_log. CREATE TRIGGER joueur_after_update AFTER UPDATE ON joueur FOR EACH ROW BEGIN IF OLD.guilde_id <> NEW.guilde_id THEN INSERT INTO joueur_guild_log (joueur_id, old_guild_id, new_guild_id, mod_date) VALUES (old.id, old.guilde_id, new.guilde_id, NOW()); END IF; END Documentation https://www.mysqltutorial.org/mysql-triggers/ https://www.javatpoint.com/mysql-trigger https://dev.mysql.com/doc/refman/8.0/en/trigger-syntax.html","title":"Les triggers"},{"location":"notes_de_cours/mySQL/triggers/#les-triggers","text":"Un trigger (ou d\u00e9clencheur) est une sorte de proc\u00e9dure stock\u00e9e, une s\u00e9rie d'instruction enregistr\u00e9e, qui est reli\u00e9 \u00e0 une table de la base de donn\u00e9es. Les instructions seront ex\u00e9cut\u00e9 automatiquement lors d'une insertion, d'une mise \u00e0 jour ou d'une suppression dans la table \u00e0 laquelle le trigger est attach\u00e9 et \u00e7a pour chacune des lignes affect\u00e9es par la requ\u00eate. On doit aussi sp\u00e9cifier \u00e0 quel moment il sera d\u00e9clench\u00e9, avant l'instruction SQL ou apr\u00e8s. On peut donc d\u00e9finir jusqu'\u00e0 6 triggers par tables : avant ou apr\u00e8s une insertion, avant ou apr\u00e8s une mise \u00e0 jour, avant ou apr\u00e8s une suppression. On peut depuis un trigger modifier et ins\u00e9rer des donn\u00e9es dans n'importe quel table de la base de donn\u00e9es \u00e0 l'exception des tables utilis\u00e9es dans la requ\u00eate qui l'a d\u00e9clench\u00e9. Si on veut travailler sur la table \u00e0 laquelle le trigger est attach\u00e9, on n'a acc\u00e8s qu'\u00e0 la ligne qu'on est en train de traiter. ### Pourquoi utiliser des triggers ? S'assurer de la validit\u00e9 des donn\u00e9es avant leur insertion ou leur modification. Pour pouvoir utiliser des traitements plus complexe lors d'op\u00e9ration qui affectent plusieurs tables. Par exemple si on veut supprimer des donn\u00e9es qui sont reli\u00e9es \u00e0 d'autres tables par des cl\u00e9s \u00e9trang\u00e8res et que les options offerte ne nous suffise pas. Pour garder une trace des op\u00e9rations effectu\u00e9es dans la base de donn\u00e9es. Mettre \u00e0 jour des informations qu'on utilise r\u00e9guli\u00e8rement pour pouvoir les retrouver facilement, comme par exemple le solde actif d'un compte client.","title":"Les triggers"},{"location":"notes_de_cours/mySQL/triggers/#syntaxe","text":"On utilise la commande CREATE TRIGGER pour la cr\u00e9ation d'un trigger. Le nom du trigger doit \u00eatre unique dans la base de donn\u00e9es. Il est d'usage de nommer le trigger avec le moment de son d\u00e9clenchement, de l'op\u00e9ration effectu\u00e9e et du nom de la table associ\u00e9e, ex je veux cr\u00e9er un trigger sur la table usager qui se d\u00e9clenchera avant un insertion, je vais le nommer before_insert_usager. CREATE TRIGGER nomTrigger momentDuDeclenchement operationSQL ON nomTable FOR EACH ROW corpsDuTrigger; Le moment du d\u00e9clenchement est BEFORE ou AFTER L'op\u00e9ration SQL est soit INSERT, UPDATE ou DELETE Si le corps du trigger contient plus d'une requ\u00eate et/ou op\u00e9ration, on doit les englober par un BEGIN END.","title":"Syntaxe"},{"location":"notes_de_cours/mySQL/triggers/#new-et-old","text":"On peut utiliser les mots cl\u00e9s dans le corps du trigger pour acc\u00e9der aux donn\u00e9es avant ou apr\u00e8s leur modification. OLD repr\u00e9sente les donn\u00e9es avant qu'elles ne soient modifi\u00e9 par le trigger. Ces donn\u00e9es ne peuvent pas \u00eatre modifi\u00e9es. Old est disponible pour les UPDATE et DELETE NEW repr\u00e9sente les donn\u00e9es apr\u00e8s qu'elles aient \u00e9t\u00e9 modifi\u00e9. C'est donn\u00e9es peuvent \u00eatre lu et modifi\u00e9s. New est disponible pour les INSERT et UPDATE. Requ\u00eate OLD NEW INSERT - OUI UPDATE OUI OUI DELETE OUI -","title":"NEW et OLD"},{"location":"notes_de_cours/mySQL/triggers/#erreur-dans-un-trigger","text":"Si un trigger ex\u00e9cut\u00e9 avant (BEFORE) une requ\u00eate cause une erreur, la requ\u00eate ne sera pas ex\u00e9cut\u00e9e. Les triggers ex\u00e9cut\u00e9s apr\u00e8s (AFTER) une requ\u00eate qui g\u00e9n\u00e8re une erreur feront \u00e9chouer celle-ci. Il est donc important de bien concevoir les triggers et d'inclure une gestion des erreurs dans notre traitement.","title":"Erreur dans un trigger"},{"location":"notes_de_cours/mySQL/triggers/#supprimer-un-trigger","text":"Pour supprimer un trigger, on utilise la commande DROP TRIGGER suivie du nom du trigger. Si on supprimer une table, tous les triggers qui lui sont associ\u00e9e seront aussi supprim\u00e9s. DROP TRIGGER before_insert_usager;","title":"Supprimer un trigger"},{"location":"notes_de_cours/mySQL/triggers/#restrictions","text":"On en peut pas utiliser de transaction dans un trigger, START TRANSACTION, COMMIT ou ROLLBACK On peut utiliser une proc\u00e9dure stock\u00e9e mais avec les restrictions suivantes : La proc\u00e9dure ne peut pas retourner d'informations, \u00e0 part en utilisant un param\u00e8tre OUT ou IN/OUT. La proc\u00e9dure ne doit pas utiliser de transaction. On ne peut pas modifier les donn\u00e9es d'une table qui est utilis\u00e9e dans la requ\u00eate qui d\u00e9clenche le trigger. \u00c7a compte pour toutes les tables de la requ\u00eate et non seulement la table associ\u00e9e au trigger. Une suppression ou modification de donn\u00e9es d\u00e9clench\u00e9e par une cl\u00e9 \u00e9trang\u00e8re ne provoquera pas l'ex\u00e9cution du trigger associ\u00e9 \u00e0 cette table. Exemple de triggers J'ai une table joueur, un table guilde et une table joueur_guilde_log. Dans la table joueur il y a un champ guilde_id qui fait r\u00e9f\u00e9rence \u00e0 la cl\u00e9 primaire de la table guilde. Quand on modifie la guilde d'un joueur, je voudrais sauvegarder les informations dans une autre table (le id du joueur, l'id de son acienne guile, l'id de la nouvelle et la date de la modification). Je vais cr\u00e9er un trigger AFTER sur la table joueur. Je vais aussi valider que la colonne guilde_id a \u00e9t\u00e9 modifi\u00e9 avant d'ajouter les informations dans la table joueur_guilde_log. CREATE TRIGGER joueur_after_update AFTER UPDATE ON joueur FOR EACH ROW BEGIN IF OLD.guilde_id <> NEW.guilde_id THEN INSERT INTO joueur_guild_log (joueur_id, old_guild_id, new_guild_id, mod_date) VALUES (old.id, old.guilde_id, new.guilde_id, NOW()); END IF; END","title":"Restrictions"},{"location":"notes_de_cours/mySQL/triggers/#documentation","text":"https://www.mysqltutorial.org/mysql-triggers/ https://www.javatpoint.com/mysql-trigger https://dev.mysql.com/doc/refman/8.0/en/trigger-syntax.html","title":"Documentation"},{"location":"notes_de_cours/python/mysql_connector/","text":"MySQL Connector pour python C'est la librairie qu'on va utiliser pour permettre \u00e0 nos programme python d'interragir avec une base de donn\u00e9es MySQL Installation En ligne de commande pip install mysql-connector-python Documentation Documentation officielle Documentation sur W3Schools","title":"Connecteur MsSQL"},{"location":"notes_de_cours/python/mysql_connector/#mysql-connector-pour-python","text":"C'est la librairie qu'on va utiliser pour permettre \u00e0 nos programme python d'interragir avec une base de donn\u00e9es MySQL","title":"MySQL Connector pour python"},{"location":"notes_de_cours/python/mysql_connector/#installation","text":"En ligne de commande pip install mysql-connector-python","title":"Installation"},{"location":"notes_de_cours/python/mysql_connector/#documentation","text":"Documentation officielle Documentation sur W3Schools","title":"Documentation"},{"location":"notes_de_cours/python/pyQT5/","text":"pyQT5 C'est une librairie qui va nous servir \u00e0 cr\u00e9er des interfaces graphiques pour nos programmes python Installation En ligne de commande pip install PyQt5 Documentation Tutoriel https://www.pythonguis.com/courses/start/ https://www.tutorialspoint.com/pyqt5/index.html https://build-system.fman.io/pyqt5-tutorial Disposition de notre application https://www.pythonguis.com/tutorials/pyqt-layouts/ Le gridLayout plus en d\u00e9tail : https://www.pythontutorial.net/pyqt/pyqt-qgridlayout/ Les Widgets https://www.tutorialspoint.com/pyqt/pyqt_basic_widgets.htm https://www.pythonguis.com/tutorials/pyqt-basic-widgets/","title":"pyQT5"},{"location":"notes_de_cours/python/pyQT5/#pyqt5","text":"C'est une librairie qui va nous servir \u00e0 cr\u00e9er des interfaces graphiques pour nos programmes python","title":"pyQT5"},{"location":"notes_de_cours/python/pyQT5/#installation","text":"En ligne de commande pip install PyQt5","title":"Installation"},{"location":"notes_de_cours/python/pyQT5/#documentation","text":"","title":"Documentation"},{"location":"notes_de_cours/python/pyQT5/#tutoriel","text":"https://www.pythonguis.com/courses/start/ https://www.tutorialspoint.com/pyqt5/index.html https://build-system.fman.io/pyqt5-tutorial","title":"Tutoriel"},{"location":"notes_de_cours/python/pyQT5/#disposition-de-notre-application","text":"https://www.pythonguis.com/tutorials/pyqt-layouts/ Le gridLayout plus en d\u00e9tail : https://www.pythontutorial.net/pyqt/pyqt-qgridlayout/","title":"Disposition de notre application"},{"location":"notes_de_cours/python/pyQT5/#les-widgets","text":"https://www.tutorialspoint.com/pyqt/pyqt_basic_widgets.htm https://www.pythonguis.com/tutorials/pyqt-basic-widgets/","title":"Les Widgets"},{"location":"notes_de_cours/python/qtdesigner/","text":"Qt Designer Qt Designer est un \u00e9diteur graphique qui nous permet de cr\u00e9er visuellement des interfaces graphiques en pyQt. Les interfaces seront ensuite export\u00e9 en fichier python que nous pourront utiliser dans nos programme. Installation Directement en ligne de commande pip install PyQt5Designer Ou bien depuis le site officiel : https://www.qt.io/download-qt-installer , vous allez devoir vous cr\u00e9er un compte pour l'installation. Lancer Qt Designer En ligne de commande, utilisez la commande designer designer Convertir un fichier ui en python Les interfaces que vous allez cr\u00e9er avec Qt Designer seront enregistr\u00e9es dans des fichiers avec l'extension ui . Pour les utiliser dans vos programme python on va devoir les convertir. On peut le faire directement en ligne de commande et utilisant la commande pyuic5 suivi du nom du fichier source , de l'argument -o et du nom du fichier de destination . Le fichier de destination n'est pas oblig\u00e9 d'exister au moment d'ex\u00e9cuter la commande mais il doit porter l'extension py. pyuic5 masuperfenetre.ui -o MaSuperFenetre.py Exemple Au d\u00e9marrage de l'application Qt Designer la fen\u00eatre nouveau formulaire va s'afficher. S\u00e9lectionnez Main Window dans la section templates\\forms et cliquez sur cr\u00e9er. Une fen\u00eatre vide va \u00eatre cr\u00e9\u00e9 avec une barre de menu dans le haut et une barre de statut dans le bas. Enregistrez cette fen\u00eatre dans le r\u00e9pertoire de votre application. (Dans mon exemple j'ai nomm\u00e9 mon fichier exemple.ui). Vous voil\u00e0 pr\u00eat \u00e0 cr\u00e9er votre interface. On va recr\u00e9er l'interface de l'exercice 09. Commencez par supprimer le menu et la barre de statut. Dans l'inspecteur d'objet s\u00e9lectionnez menubar et statusbar et avec un clique droit choisissez supprimer. Dans la section de gauche vous avez une liste de widgets \u00e0 utiliser. Glissez un Vertical Layout dans la fen\u00eatre principale. Cliquez ensuite sur la fen\u00eatre principale \u00e0 l'ext\u00e9rieur du widget que vous venez d'ajouter et dans la barre de menu du haut de l'\u00e9diteur cliquez sur le bouton mettre en forme verticalement. Le widget Vertical Layout devrait s'\u00e9tendre \u00e0 la totalit\u00e9 de la fen\u00eatre. Ensuite dans l'ordre on va ajouter un Label , un Line Edit , un Push Button et un autre Label . En s\u00e9lectionnant chaque widget, modifiez la propri\u00e9t\u00e9 objectName dans l'\u00e9diteur de propri\u00e9t\u00e9s. Je n'ai pas renomm\u00e9 le premier label, mais pour les suivants j'ai utilis\u00e9 les noms suivants : Line Edit = editCitoyenId Push Button = btnRechercher Label = lblResultat Vous pouvez modifier le texte affich\u00e9 sur un widget avec la propri\u00e9t\u00e9 text . Vous pouvez ajuter le format du texte avec plusieurs propri\u00e9t\u00e9s, dont font et alignment . Derni\u00e8re chose, on va associer une fonction \u00e0 un \u00e9v\u00e9nement, ici un clique de la souris sur le bouton. On peut le faire depuis l'interface de Qt Designer ou dans notre script python. Pour le faire depuis Qt Designer, dDans le menu principal, sous \u00c9dition s\u00e9lectionnez \u00c9diter signaux/slots . Ensuite cliquez sur le bouton et sans rel\u00e2cher le bouton glisser la souris vers la fen\u00eatre principale (attention on cible la fen\u00eatre principale et non le widget layout ). Vous devriez avoir une ligne rouge avec \u00e0 son bout une fl\u00e8che compos\u00e9e de barre rouge. Rel\u00e2cher maintenant le bouton de la souris et la fen\u00eatre Configurer connexion va s'afficher. S\u00e9lectionnez clicked() et cliquez sur \u00c9diter . Dans la fen\u00eatre qui va appara\u00eetre cliquez sur le bouton avec une croix verte dans la section Slots . Modifier ensuite le nom de la fonction (slot1() par d\u00e9faut) pour le nom que vous allez donner \u00e0 votre fonction. Cliquez ensuite sur ok. Dans la fen\u00eatre pr\u00e9c\u00e9dente vous avez maintenant votre fonction dans la section de droite, s\u00e9lectionnez la et cliquez sur ok. Pour connecter un \u00e9v\u00e9nement depuis le script python, voir plus bas dans l'exemble du fichier app.py . Voila le travail pour notre interface vous pouvez sauvegarder le tout et ouvrir un terminal dans le r\u00e9pertoire o\u00f9 le fichier se trouve. Utilisez la commande qu'on a vu plus haut pour convertir le fichier ui et fichier python. pyuic5 exemple.ui -o MainWindow.py Si on regarde dans le fichier python qu'on a cr\u00e9\u00e9 on peut voir qu'il y a une classe Ui_MainWindow qui contient toute notre interface. Maintenant on va cr\u00e9er un fichier python qui va \u00eatre le script principal et qui ont va appeler cette classe et l'afficher. app.py import sys from PyQt5.QtWidgets import QApplication, QMainWindow # Importer la classe Ui_MainWindow du fichier MainWindow.py from demo import Ui_MainWindow # En param\u00eatre de la classe MainWindow on va h\u00e9riter des fonctionnalit\u00e9s # de QMainWindow et de notre interface Ui_MainWindow class MainWindow(QMainWindow, Ui_MainWindow): def __init__(self, *args, obj=None, **kwargs): super(MainWindow, self).__init__(*args, **kwargs) # On va cr\u00e9er la fen\u00eatre avec cette commande self.setupUi(self) # On connecter un \u00e9v\u00e9nement sur le line edit self.editIdCitoyen.returnPressed.connect(self.test) # On d\u00e9fini la fonction qu'on avait d\u00e9clar\u00e9 pour le clique sur le bouton def recherche_citoyen(self): # On r\u00e9cup\u00e8re la valeur du line edit citoyen_id = self.editIdCitoyen.text() # Ensuite on pourrait lancer une fonction qui interroge la BD # Pour l'exemple on va simplement afficher la valeur dans le label # lblResultat self.lblResultat.setText(citoyen_id) # editIdCitoyen et lblResultat sont les noms qu'on a donn\u00e9 au widget # dans l'\u00e9diteur Qt Designer def test(self): self.lblResultat.setText('Tu as appuy\u00e9 sur Enter') app = QApplication(sys.argv) window = MainWindow() window.show() app.exec() Finalement ex\u00e9cutez le script app.py pour afficher le r\u00e9sultat. Ressources https://realpython.com/qt-designer-python/ https://www.pythonguis.com/tutorials/qt-designer-gui-layout/ https://doc.qt.io/qt-5/qtdesigner-manual.html","title":"Qt Designer"},{"location":"notes_de_cours/python/qtdesigner/#qt-designer","text":"Qt Designer est un \u00e9diteur graphique qui nous permet de cr\u00e9er visuellement des interfaces graphiques en pyQt. Les interfaces seront ensuite export\u00e9 en fichier python que nous pourront utiliser dans nos programme.","title":"Qt Designer"},{"location":"notes_de_cours/python/qtdesigner/#installation","text":"Directement en ligne de commande pip install PyQt5Designer Ou bien depuis le site officiel : https://www.qt.io/download-qt-installer , vous allez devoir vous cr\u00e9er un compte pour l'installation.","title":"Installation"},{"location":"notes_de_cours/python/qtdesigner/#lancer-qt-designer","text":"En ligne de commande, utilisez la commande designer designer","title":"Lancer Qt Designer"},{"location":"notes_de_cours/python/qtdesigner/#convertir-un-fichier-ui-en-python","text":"Les interfaces que vous allez cr\u00e9er avec Qt Designer seront enregistr\u00e9es dans des fichiers avec l'extension ui . Pour les utiliser dans vos programme python on va devoir les convertir. On peut le faire directement en ligne de commande et utilisant la commande pyuic5 suivi du nom du fichier source , de l'argument -o et du nom du fichier de destination . Le fichier de destination n'est pas oblig\u00e9 d'exister au moment d'ex\u00e9cuter la commande mais il doit porter l'extension py. pyuic5 masuperfenetre.ui -o MaSuperFenetre.py","title":"Convertir un fichier ui en python"},{"location":"notes_de_cours/python/qtdesigner/#exemple","text":"Au d\u00e9marrage de l'application Qt Designer la fen\u00eatre nouveau formulaire va s'afficher. S\u00e9lectionnez Main Window dans la section templates\\forms et cliquez sur cr\u00e9er. Une fen\u00eatre vide va \u00eatre cr\u00e9\u00e9 avec une barre de menu dans le haut et une barre de statut dans le bas. Enregistrez cette fen\u00eatre dans le r\u00e9pertoire de votre application. (Dans mon exemple j'ai nomm\u00e9 mon fichier exemple.ui). Vous voil\u00e0 pr\u00eat \u00e0 cr\u00e9er votre interface. On va recr\u00e9er l'interface de l'exercice 09. Commencez par supprimer le menu et la barre de statut. Dans l'inspecteur d'objet s\u00e9lectionnez menubar et statusbar et avec un clique droit choisissez supprimer. Dans la section de gauche vous avez une liste de widgets \u00e0 utiliser. Glissez un Vertical Layout dans la fen\u00eatre principale. Cliquez ensuite sur la fen\u00eatre principale \u00e0 l'ext\u00e9rieur du widget que vous venez d'ajouter et dans la barre de menu du haut de l'\u00e9diteur cliquez sur le bouton mettre en forme verticalement. Le widget Vertical Layout devrait s'\u00e9tendre \u00e0 la totalit\u00e9 de la fen\u00eatre. Ensuite dans l'ordre on va ajouter un Label , un Line Edit , un Push Button et un autre Label . En s\u00e9lectionnant chaque widget, modifiez la propri\u00e9t\u00e9 objectName dans l'\u00e9diteur de propri\u00e9t\u00e9s. Je n'ai pas renomm\u00e9 le premier label, mais pour les suivants j'ai utilis\u00e9 les noms suivants : Line Edit = editCitoyenId Push Button = btnRechercher Label = lblResultat Vous pouvez modifier le texte affich\u00e9 sur un widget avec la propri\u00e9t\u00e9 text . Vous pouvez ajuter le format du texte avec plusieurs propri\u00e9t\u00e9s, dont font et alignment . Derni\u00e8re chose, on va associer une fonction \u00e0 un \u00e9v\u00e9nement, ici un clique de la souris sur le bouton. On peut le faire depuis l'interface de Qt Designer ou dans notre script python. Pour le faire depuis Qt Designer, dDans le menu principal, sous \u00c9dition s\u00e9lectionnez \u00c9diter signaux/slots . Ensuite cliquez sur le bouton et sans rel\u00e2cher le bouton glisser la souris vers la fen\u00eatre principale (attention on cible la fen\u00eatre principale et non le widget layout ). Vous devriez avoir une ligne rouge avec \u00e0 son bout une fl\u00e8che compos\u00e9e de barre rouge. Rel\u00e2cher maintenant le bouton de la souris et la fen\u00eatre Configurer connexion va s'afficher. S\u00e9lectionnez clicked() et cliquez sur \u00c9diter . Dans la fen\u00eatre qui va appara\u00eetre cliquez sur le bouton avec une croix verte dans la section Slots . Modifier ensuite le nom de la fonction (slot1() par d\u00e9faut) pour le nom que vous allez donner \u00e0 votre fonction. Cliquez ensuite sur ok. Dans la fen\u00eatre pr\u00e9c\u00e9dente vous avez maintenant votre fonction dans la section de droite, s\u00e9lectionnez la et cliquez sur ok. Pour connecter un \u00e9v\u00e9nement depuis le script python, voir plus bas dans l'exemble du fichier app.py . Voila le travail pour notre interface vous pouvez sauvegarder le tout et ouvrir un terminal dans le r\u00e9pertoire o\u00f9 le fichier se trouve. Utilisez la commande qu'on a vu plus haut pour convertir le fichier ui et fichier python. pyuic5 exemple.ui -o MainWindow.py Si on regarde dans le fichier python qu'on a cr\u00e9\u00e9 on peut voir qu'il y a une classe Ui_MainWindow qui contient toute notre interface. Maintenant on va cr\u00e9er un fichier python qui va \u00eatre le script principal et qui ont va appeler cette classe et l'afficher. app.py import sys from PyQt5.QtWidgets import QApplication, QMainWindow # Importer la classe Ui_MainWindow du fichier MainWindow.py from demo import Ui_MainWindow # En param\u00eatre de la classe MainWindow on va h\u00e9riter des fonctionnalit\u00e9s # de QMainWindow et de notre interface Ui_MainWindow class MainWindow(QMainWindow, Ui_MainWindow): def __init__(self, *args, obj=None, **kwargs): super(MainWindow, self).__init__(*args, **kwargs) # On va cr\u00e9er la fen\u00eatre avec cette commande self.setupUi(self) # On connecter un \u00e9v\u00e9nement sur le line edit self.editIdCitoyen.returnPressed.connect(self.test) # On d\u00e9fini la fonction qu'on avait d\u00e9clar\u00e9 pour le clique sur le bouton def recherche_citoyen(self): # On r\u00e9cup\u00e8re la valeur du line edit citoyen_id = self.editIdCitoyen.text() # Ensuite on pourrait lancer une fonction qui interroge la BD # Pour l'exemple on va simplement afficher la valeur dans le label # lblResultat self.lblResultat.setText(citoyen_id) # editIdCitoyen et lblResultat sont les noms qu'on a donn\u00e9 au widget # dans l'\u00e9diteur Qt Designer def test(self): self.lblResultat.setText('Tu as appuy\u00e9 sur Enter') app = QApplication(sys.argv) window = MainWindow() window.show() app.exec() Finalement ex\u00e9cutez le script app.py pour afficher le r\u00e9sultat.","title":"Exemple"},{"location":"notes_de_cours/python/qtdesigner/#ressources","text":"https://realpython.com/qt-designer-python/ https://www.pythonguis.com/tutorials/qt-designer-gui-layout/ https://doc.qt.io/qt-5/qtdesigner-manual.html","title":"Ressources"}]}