{"config":{"lang":["fr"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Bienvenue en Base de donn\u00e9es 2","text":""},{"location":"examen/epreuve_finale/formatif_part01/","title":"\u00c9preuve finale - partie 1 - Formatif","text":""},{"location":"examen/epreuve_finale/formatif_part01/#consignes","title":"Consignes","text":"<ul> <li>Vous avez droit \u00e0 toutes vos notes et Internet.</li> <li>Aucune communication n'est permise (messagerie, courriel, etc.). Un \u00e9l\u00e8ve pris en flagrant d\u00e9lit se verra attribuer la note de 0 pour plagiat.</li> <li>La dur\u00e9e de l'examen est de 1h50.</li> <li>Une fois l\u2019examen termin\u00e9, vous devez me remettre les fichiers suivants dans un dossier compress\u00e9 nomm\u00e9 au format suivant : NomPrenom_ExamenFinalPartie1. </li> <li>Un diagramme de classe en format image.</li> <li>Un script SQL de cr\u00e9ation de la base de donn\u00e9es et des tables.</li> <li>Un script SQL de cr\u00e9ation des d\u00e9clencheurs.</li> <li>Un script SQL de cr\u00e9ation d'un usager.</li> <li>Le dossier compress\u00e9 doit \u00eatre remis sur Teams dans le devoir de l'examen.</li> <li>Il est de votre devoir de vous assurer que tous les fichiers sont inclus dans la remise. Aucun fichier ne sera accept\u00e9 une fois que vous aurez quitt\u00e9 le lieu de l'examen. </li> </ul>"},{"location":"examen/epreuve_finale/formatif_part01/#mise-en-situation","title":"Mise en situation","text":"<p>L'entreprise qui vous emploie d\u00e9veloppe une application qui permet de cr\u00e9er des questionnaires et vous \u00eates en charge de cr\u00e9er la base de donn\u00e9es qui contiendra ces questionnaires. Vous avez re\u00e7u de votre charg\u00e9 de projet les \u00e9crans suivants pour vous aider dans votre travail.</p> <p></p> <p>Ce premier \u00e9cran repr\u00e9sente une vue du questionnaire dans son ensemble. Pour chaque questionnaire on doit obligatoirement d\u00e9finir un titre et on a l'option d'ajouter un court texte descriptif. On peut ensuite ajouter une ou plusieurs questions qui peuvent \u00eatre de deux types : \u00e0 choix de r\u00e9ponse ou bien au format texte. Chaque type \u00e0 ses propres particularit\u00e9s. </p> <p>Le questionnaire \u00e0 une colonne qu'on ne voit pas \u00e0 l'\u00e9cran et qui contient le pointage cumul\u00e9 de toutes les questions.</p>"},{"location":"examen/epreuve_finale/formatif_part01/#questions-a-choix-de-reponse","title":"Questions \u00e0 choix de r\u00e9ponse.","text":"<p>Voici une capture d'\u00e9cran des options d'une question \u00e0 choix de r\u00e9ponse.</p> <p></p> <ul> <li>La question peut avoir plusieurs choix, mais seulement un de ces choix est la bonne r\u00e9ponse. </li> <li>On peut ajouter un pointage ou pas \u00e0 la question. </li> <li>La question peut \u00eatre obligatoire ou non.</li> </ul>"},{"location":"examen/epreuve_finale/formatif_part01/#questions-au-format-texte","title":"Questions au format texte","text":"<p>Voici une capture d'\u00e9cran d'une question au format texte.</p> <p> - Pour ce type de question, l'usager doit saisir sa r\u00e9ponse en texte. On peut avoir une ou plusieurs bonnes r\u00e9ponses.  - On peut ajouter un pointage ou pas \u00e0 la question. - La question peut \u00eatre obligatoire ou non.</p>"},{"location":"examen/epreuve_finale/formatif_part01/#directives","title":"Directives","text":""},{"location":"examen/epreuve_finale/formatif_part01/#question-1","title":"Question #1","text":"<p>Vous devez cr\u00e9er un mod\u00e8le de la base de donn\u00e9es qui permettra de reproduire des questionnaires selon les sp\u00e9cifications de la mise en situation plus haut. Le mod\u00e8le doit seulement permettre de sauvegarder les informations de cr\u00e9ation du questionnaire, vous ne devez pas \u00e0 g\u00e9rer les r\u00e9ponses des participants.</p> <p>Votre mod\u00e8le doit \u00eatre sous la forme d'un diagramme de classes et r\u00e9pondre aux points suivants : </p> <ul> <li>Votre diagramme doit r\u00e9pondre \u00e0 la convention de nomenclature telle que d\u00e9crite dans les notes de cours \"Analyse et mod\u00e9lisation de syst\u00e8mes\".</li> <li>Pour chaque colonne de chaque table du diagramme, vous devez sp\u00e9cifier un type de donn\u00e9es ad\u00e9quat, si elle est une cl\u00e9 primaire (PK) ou \u00e9trang\u00e8re (FK). Si la colonne est ni une cl\u00e9 primaire ou \u00e9trang\u00e8re, mais qu'elle ne peut \u00eatre nulle, vous devez aussi l'indiquer (NOT NULL).</li> <li>ex. #1 -&gt; id INT PK</li> <li>ex. #2 -&gt; code_usager VARCHAR(50) NOT NULL </li> <li>Pour les relations entre les tables, vous devez m'indiquer le type de relation en utilisant la notation 1&lt;---&gt;1 pour une relation d'un \u00e0 un et 1&lt;---&gt;n ou n&lt;---&gt;1 pour une relation d'un \u00e0 plusieurs</li> <li>Votre mod\u00e9lisation doit r\u00e9pondre aux r\u00e8gles de la troisi\u00e8me forme normale.</li> </ul> <p>Vous devez me fournir votre diagramme de classes dans un format image (jpg, png) et le nommer NomPrenom_diagramme</p>"},{"location":"examen/epreuve_finale/formatif_part01/#question-2","title":"Question #2","text":"<p>Cr\u00e9ez un script SQL qui va cr\u00e9er la base de donn\u00e9es ainsi que toutes les tables repr\u00e9sent\u00e9es dans votre diagramme de classes.</p> <ul> <li>La base de donn\u00e9es doit se nommer ExamenFinal_NomPrenom</li> <li>Dans la cr\u00e9ation des tables, vous devez inclure la cr\u00e9ation des cl\u00e9s primaires et \u00e9trang\u00e8res s'il y a lieu.</li> <li>Le script doit pouvoir \u00eatre lanc\u00e9 plus d'une fois sans provoquer d'erreurs.</li> <li>Chaque lancement du script doit r\u00e9g\u00e9n\u00e9rer la base de donn\u00e9es ainsi que les tables.</li> </ul> <p>Le script SQL \u00e0 remettre doit se nommer NomPrenom_ceationBD.sql.</p>"},{"location":"examen/epreuve_finale/formatif_part01/#question-3","title":"Question #3","text":"<p>Cr\u00e9ez un script SQL qui va ajouter des d\u00e9clencheurs (Triggers) qui permettront de recalculer la colonne du pointage cumul\u00e9 du questionnaire \u00e0 chaque fois que vous allez ajouter, modifier ou supprimer une question.</p> <ul> <li>Pour chacune des op\u00e9rations (ajout, modification et suppression), choisissez le bon moment pour placer le d\u00e9clencheur.</li> <li>Si la question n'a pas de pointage, vous ne devez pas faire la mise \u00e0 jour de la colonne.</li> <li>Le script doit pouvoir \u00eatre lanc\u00e9 plus d'une fois sans provoquer d'erreurs.</li> <li>Chaque lancement du script doit recr\u00e9er les triggers.</li> </ul> <p>Le script SQL \u00e0 remettre doit se nommer NomPrenom_creationTrigger.sql.</p>"},{"location":"examen/epreuve_finale/formatif_part01/#question-4","title":"Question #4","text":"<p>Cr\u00e9ez un script SQL qui fera la cr\u00e9ation d'un usager et lui donnera des permissions selon les informations suivantes: </p> <p>a) Informations de l'usager : </p> <ul> <li>nom : correcteur</li> <li>mot de passe : !3ct3Ur</li> <li>h\u00f4te accept\u00e9 : localhost</li> </ul> <p>b) Permission de l'usager : </p> <ul> <li>Il peut faire des requ\u00eates SELECT et UPDATE sur toutes les colonnes de la table qui contient les informations g\u00e9n\u00e9rales du questionnaire de votre base de donn\u00e9es sauf la colonne du pointage calcul\u00e9.</li> <li>Pour toutes les autres tables de la base de donn\u00e9es, il peut faire des requ\u00eates SELECT et UPDATE.</li> </ul> <p>Le script doit pouvoir \u00eatre lanc\u00e9 plus d'une fois sans provoquer d'erreurs et chaque lancement du script doit recr\u00e9er les triggers.</p> <p>Le script SQL \u00e0 remettre doit se nommer NomPrenom_creationUsager.sql.</p>"},{"location":"examen/epreuve_finale/formatif_part01/#grille-de-correction","title":"Grille de correction","text":"\u00c9l\u00e9ments Points Tous les scripts SQL peuvent \u00eatre ex\u00e9cut\u00e9s plus d'une fois sans provoquer d'erreurs /6 Question #1 /40 La convention de nomenclature est respect\u00e9e. 2 Les types de donn\u00e9es utilis\u00e9s sont exacts et pertinents. 6 Les relations entre les tables sont justes. 10 La mod\u00e9lisation r\u00e9pond aux r\u00e8gles de la troisi\u00e8me forme normale. 2 Le diagramme de classes r\u00e9pond aux besoins  de la mise en situation. 20 Question #2 /20 La base de donn\u00e9es est cr\u00e9\u00e9e et porte le nom requis 5 Toutes les tables sont cr\u00e9\u00e9es ainsi que les cl\u00e9s primaires et \u00e9trang\u00e8res 15 Question #3 /24 Un d\u00e9clencheur est lanc\u00e9 au bon moment lors de l'ajout d'une question et met \u00e0 jour le pointage calcul\u00e9 au besoin. 8 Un d\u00e9clencheur est lanc\u00e9 au bon moment lors de la modification d'une question et met \u00e0 jour le pointage calcul\u00e9 au besoin. 8 Un d\u00e9clencheur est lanc\u00e9 au bon moment lors de la suppression d'une question et met \u00e0 jour le pointage calcul\u00e9 au besoin. 8 Question #4 /10 L'usager est cr\u00e9\u00e9 selon les informations donn\u00e9es. 5 Les permissions requises sont accord\u00e9es \u00e0 l'usager. 5 Total /100"},{"location":"examen/epreuve_finale/formatif_part01/#corrige","title":"Corrig\u00e9","text":"<ul> <li>Question #1 : VersionCorrige_diagramme</li> <li>Question #2 : VersionCorrige_creationBD</li> <li>Question #3 : VersionCorrige_creationTrigger</li> <li>Question #4 : VersionCorrige_creationUsager</li> </ul>"},{"location":"examen/epreuve_finale/formatif_part02/","title":"\u00c9preuve finale - partie 2 - Formatif","text":""},{"location":"examen/epreuve_finale/formatif_part02/#consignes","title":"Consignes","text":"<ul> <li>Vous avez droit \u00e0 toutes vos notes et Internet.</li> <li>Aucune communication n'est permise (messagerie, courriel, etc.). Un \u00e9l\u00e8ve pris en flagrant d\u00e9lit se verra attribuer la note de 0 pour plagiat.</li> <li>La dur\u00e9e de l'examen est de 1h50.</li> <li>Une fois l\u2019examen termin\u00e9, vous devez faire un commit avec le message \"Remise   finale\" et faire un push de votre d\u00e9p\u00f4t pour le synchroniser avec GitHub.</li> <li>Il est de votre devoir de vous assurer que votre fichier est inclus dans la remise. Aucun fichier ne sera accept\u00e9 une fois que vous aurez quitt\u00e9 le lieu de l'examen. </li> </ul>"},{"location":"examen/epreuve_finale/formatif_part02/#directives","title":"Directives","text":"<ul> <li>Clonez le d\u00e9p\u00f4t GitHub suivant : https://github.com/Base-de-donnee-2/epreuvefinal-formatif2.git</li> <li>Importez le script SQL create_bd.sql pr\u00e9sent dans le r\u00e9pertoire ressources du d\u00e9p\u00f4t Git clon\u00e9.</li> <li>N'oubliez pas dans le script Python d'ajuster les informations de connexion \u00e0 la base de donn\u00e9es.</li> </ul> <p>Diagramme de classe de la base de donn\u00e9es import\u00e9e</p> <p></p> <p>Menu principale du script questionnaire.py</p> <p></p>"},{"location":"examen/epreuve_finale/formatif_part02/#question-1","title":"Question #1","text":"<p>Compl\u00e9tez la section afficher une question du script questionnaire.py.</p> <ul> <li>Vous devez demander \u00e0 l'usager le id de la question.</li> <li>Si le id est valide et que la question existe, afficher les informations suivantes : </li> <li>Sur la premi\u00e8re ligne, le texte de la question, un ast\u00e9risque si la question est obligatoire et le pointage de la question entre parenth\u00e8ses. Ex: \"Quelle est la capitale du Botswana * (5 points)\"</li> <li>Sur la deuxi\u00e8me ligne, le type de la question. \"Question \u00e0 choix\"</li> <li>Sur les lignes suivantes, si c'est une question \u00e0 choix de r\u00e9ponse, afficher un choix par ligne et entre parenth\u00e8ses \"(bonne r\u00e9ponse)\" \u00e0 la suite de la ligne avec le choix de la bonne r\u00e9ponse.</li> <li>Si c'est une question texte, afficher sur une troisi\u00e8me ligne \"Bonne r\u00e9ponse : \" et la liste des r\u00e9ponses de la table question_texte_reponse s\u00e9par\u00e9es par des virgules. Ex : \"Bonne r\u00e9ponse : Anglais, Tswana\" </li> </ul> <p>Exemple de r\u00e9sultat pour une question \u00e0 choix</p> <p></p> <p>Exemple de r\u00e9sultat pour une question texte</p> <p></p>"},{"location":"examen/epreuve_finale/formatif_part02/#question-2","title":"Question #2","text":"<p>Compl\u00e9tez la section ajouter une r\u00e9ponse du script questionnaire.py.</p> <ul> <li>Vous devez demander \u00e0 l'usager le id de la question.</li> <li>Demandez le texte de la r\u00e9ponse \u00e0 ajouter.</li> <li>Si la question est \u00e0 choix de r\u00e9ponse</li> <li>Vous devez demander si c'est la bonne r\u00e9ponse. Ex \"Est-ce la bonne r\u00e9ponse (o/n)\"</li> <li>Vous devez demander l'ordre du choix. (Vous n'\u00eates pas oblig\u00e9 de valider si le nombre est d\u00e9j\u00e0 utilis\u00e9 pour cette question)</li> <li>Faites ensuite la requ\u00eate d'ajout de ces informations dans la bonne table selon le type de question (question_choix ou question_texte_reponse).</li> </ul>"},{"location":"examen/epreuve_finale/formatif_part02/#question-3","title":"Question #3","text":"<p>Compl\u00e9tez la section supprimer une question du script questionnaire.py.</p> <ul> <li>Cr\u00e9ez une proc\u00e9dure stock\u00e9e nomm\u00e9e suppressionQuestion et qui prendra en param\u00e8tre le id de la question.</li> <li>Dans votre proc\u00e9dure stock\u00e9e, faites la suppression de la question ainsi que les choix de r\u00e9ponse de la table question_choix ou les bonnes r\u00e9ponses de la table question_texte_reponse.</li> <li>Les requ\u00eates de suppression doivent \u00eatre comprise dans une transaction et elle sera approuv\u00e9 que si toutes les requ\u00eates ont r\u00e9ussi. (Voir les notes de cours ou notre bon ami Google).</li> <li>Lancez la proc\u00e9dure stock\u00e9e quand vous s\u00e9lectionnez l'option supprimer une question du menu principale.</li> <li>Ajoutez un script sql nomm\u00e9 create_suppressionQuestion.sql dans le r\u00e9pertoire ressources du projet qui permettra de recr\u00e9er votre proc\u00e9dure stock\u00e9e.</li> </ul>"},{"location":"examen/epreuve_finale/formatif_part02/#grille-de-correction","title":"Grille de correction","text":"\u00c9l\u00e9ments Points Question #1 /25 Les informations requises de la question sont affich\u00e9es \u00e0 l'\u00e9cran selon les directives. 10 Les choix de r\u00e9ponses ou la liste de bonne r\u00e9ponse sont affich\u00e9es \u00e0 l'\u00e9cran. 15 Question #2 /25 La r\u00e9ponse est ajout\u00e9 avec toutes les informations requises dans la bonne table. 25 Question #3 /50 Une proc\u00e9dure stock\u00e9e est cr\u00e9\u00e9 et permet de supprimer une question et ses choix de r\u00e9ponses ou bonnes r\u00e9ponses. 20 La proc\u00e9dure stock\u00e9e est lanc\u00e9 depuis l'option Supprimer une question du menu principal. 10 Les requ\u00eates de suppression de la proc\u00e9dure stock\u00e9e sont comprise dans une transaction. 5 La transaction \u00e9choue si une des requ\u00eates provoque une erreur. 10 Un script SQL est pr\u00e9sent dans le r\u00e9pertoire ressources et permet de recr\u00e9er la proc\u00e9dure stock\u00e9e 5 Total /100"},{"location":"examen/epreuve_finale/formatif_part02/#corrige","title":"Corrig\u00e9","text":"<ul> <li>Script python ainsi que le script SQL de la cr\u00e9ation de la proc\u00e9dure stock\u00e9e : exfinal_partie2_formatif.zip</li> </ul>"},{"location":"examen/intra/examen_intra/","title":"Examen intra - Dune","text":""},{"location":"examen/intra/examen_intra/#consignes","title":"Consignes","text":"<ul> <li>Vous avez droit \u00e0 toutes vos notes et Internet.</li> <li>Aucune communication n'est permise (messagerie, courriel, etc.). Un \u00e9l\u00e8ve pris en flagrant d\u00e9lit se verra attribuer la note de 0 pour plagiat.</li> <li>La dur\u00e9e de l'examen est de 1h50.</li> <li>Une fois l\u2019examen termin\u00e9, vous devez me remettre un fichier image de votre diagramme de classes via   le devoir de l\u2019examen sur Teams. Le fichier doit \u00eatre nomm\u00e9 au format suivant : NomPrenom_Examen1. </li> <li>Il est de votre devoir de vous assurer que votre fichier est inclus dans la remise. Aucun fichier ne sera accept\u00e9 une fois que vous aurez quitt\u00e9 le lieu de l'examen. </li> </ul>"},{"location":"examen/intra/examen_intra/#mise-en-situation","title":"Mise en situation","text":"<p>La maison des Atreides fait appel \u00e0 vos services pour informatiser leur op\u00e9ration d'extraction de l'\u00c9pice sur la plan\u00e8te Arrakis. </p> <p>L'\u00c9pice se retrouve naturellement dans les d\u00e9serts de sable qui recouvrent la plan\u00e8te, concentr\u00e9e dans des endroits bien d\u00e9finis qu'on nomme champ. Pour chaque champ, on attribue un code alphanum\u00e9rique de 5 caract\u00e8res et un nom. Ex. un champ nomm\u00e9 \"petit erg austral\" portant le code ea012. Les champs peuvent parfois \u00eatre immenses et l'on d\u00e9finit des zones d'extractions dans chaque champ o\u00f9 la r\u00e9colte d'\u00c9pice se fera. Une zone d'extraction a aussi un code alphanum\u00e9rique de 5 caract\u00e8res. On doit aussi conna\u00eetre sa localisation par sa latitude, longitude et son altitude. La latitude est un nombre variant entre 90 et -90 degr\u00e9s avec une pr\u00e9cision de 6 d\u00e9cimales. La longitude varie entre 180 et -180 degr\u00e9s avec elle aussi une pr\u00e9cision de 6 d\u00e9cimales. Finalement, l'altitude est une valeur enti\u00e8re en m\u00e8tres qui peut \u00eatre n\u00e9gative. Ex : Latitude : 46.059537 | Longitude : -71.94353 | Altitude : 140. On effectue r\u00e9guli\u00e8rement des estimations pour chaque zone du nombre de lingots d'\u00c9pice (lge) qu'on pourrait extraire. Pour chaque estimation, on veut savoir la date de l'estimation ainsi que le nombre de lge estim\u00e9 qui est une valeur num\u00e9rique enti\u00e8re.</p> <p>Parlons maintenant des op\u00e9rations d'extractions. Les extractions se font \u00e0 l'aide de \"moissonneuse\", un v\u00e9hicule adapt\u00e9 pour ce travail. Pour l'instant, la seule information \u00e0 conna\u00eetre sur nos moissonneuses est son num\u00e9ro de s\u00e9rie, un code alphanum\u00e9rique de 20 caract\u00e8res. Ensuite, pour chaque op\u00e9ration, il y a qu'une moissonneuse d'impliqu\u00e9e, mais chaque moissonneuse va participer \u00e0 plusieurs op\u00e9rations. L'op\u00e9ration est aussi reli\u00e9e \u00e0 une zone d'extraction. Bien s\u00fbr une zone d'extraction va \"subir\" plusieurs op\u00e9rations d'extraction. Les autres informations \u00e0 retenir pour l'op\u00e9ration sont la date de l'op\u00e9ration, le poids au d\u00e9part et \u00e0 l'arriv\u00e9e de la moissonneuse (une valeur num\u00e9rique enti\u00e8re), la quantit\u00e9 de lingots d'\u00c9pice r\u00e9colt\u00e9s ainsi que le niveau de risque de l'op\u00e9ration. Le niveau de risque est choisi parmi une liste de terme (\"Bas\", \"Mod\u00e9r\u00e9\", \"\u00c9lev\u00e9\", \"Est-ce que \u00e7a en vaut vraiment la peine\").</p> <p>Pour assurer la protection des op\u00e9rations, on engage un ou plusieurs groupes de mercenaires. Pour le groupe de mercenaire, on ne veut conna\u00eetre que le nom du groupe, la personne contact (on peut inscrire son nom et pr\u00e9nom dans la m\u00eame colonne \ud83d\ude1c ) et une cote de confiance. La cote de confiance est un pourcentage de 0 \u00e0 100% avec une pr\u00e9cision de 2 d\u00e9cimales (75.50%).</p> <p>On va aussi joindre \u00e0 chaque op\u00e9ration une ou plusieurs \u00e9quipes de travail. Les \u00e9quipes sont identifi\u00e9es par un code alphanum\u00e9rique de 5 caract\u00e8res. Ces \u00e9quipes sont form\u00e9es de plusieurs employ\u00e9s, mais un employ\u00e9 ne peut pas faire partie de plus d'une \u00e9quipe \u00e0 la fois. Pour chaque employ\u00e9 on doit conna\u00eetre son nom et pr\u00e9nom, sa date de naissance, sa plan\u00e8te d'origine, la maison \u00e0 laquelle il appartient (la maison est un peu comme son clan) et sa profession. L'employ\u00e9 ne peut avoir qu'une profession et appartenir qu'\u00e0 une maison. </p> <p>Notes aux puristes : Ok je sais que dans l'univers de Dune les ordinateurs comme nous les connaissons ont \u00e9t\u00e9 banni depuis longtemps mais bon on va dire qu'ils existent encore.</p>"},{"location":"examen/intra/examen_intra/#directives","title":"Directives","text":"<p>Vous devez cr\u00e9er un diagramme de classes qui r\u00e9pond aux besoins de la mise en situation en respectant les points suivants : </p> <ul> <li>Votre mod\u00e8le doit r\u00e9pondre \u00e0 la convention de nomenclature telle que d\u00e9crite dans les notes de cours \"Analyse et mod\u00e9lisation de syst\u00e8mes\".</li> <li>Vous devez sp\u00e9cifier un type de donn\u00e9es pertinent pour chaque colonne de chaque table du diagramme.</li> <li>Pour les relations entre les tables, vous devez m'indiquer le type de relation en utilisant la notation (1 -- 1..n).</li> <li>Votre mod\u00e9lisation doit r\u00e9pondre aux r\u00e8gles de la troisi\u00e8me forme normale.</li> </ul>"},{"location":"examen/intra/examen_intra/#grille-de-correction","title":"Grille de correction","text":"\u00c9l\u00e9ments points Total /100 La convention de nomenclature est respect\u00e9e 5 Les types de donn\u00e9es utilis\u00e9s sont exacte et pertinent 5 Les relations entrent les tables sont juste 30 La mod\u00e9lisation r\u00e9ponds aux r\u00e8gles de la troisi\u00e8me forme normale 10 Le diagramme de classes r\u00e9ponds aux besoins  de la mise en situation 50"},{"location":"examen/intra/intra_formatif_01/","title":"Formatif formel - Voyage vers Mars","text":""},{"location":"examen/intra/intra_formatif_01/#mise-en-situation","title":"Mise en situation","text":"<p>Le projet de colonisation de la plan\u00e8te Mars est entr\u00e9 dans une nouvelle phase et le lancement du premier vol habit\u00e9 est pour bient\u00f4t. Vous  avez \u00e9t\u00e9 choisi pour \u00eatre responsable de la gestion des informations sur  l'\u00e9quipage. C'est une responsabilit\u00e9 tr\u00e8s importante, car une partie du succ\u00e8s  de la mission r\u00e9side dans l'\u00e9quilibre psychologique du personnel embarqu\u00e9 dans  le vaisseau. Voici une description de ce qu\u2019il est imp\u00e9ratif d'avoir comme  informations. </p> <p>Pour chaque membre de l'\u00e9quipage, on veut avoir leur nom, leur  genre, leur pays d'origine et leur \u00e9tat civil. Vous devez aussi dresser la liste des enfants de cette personne. Attention, on nous rapporte qu'il y a des parents qui  se sont port\u00e9s volontaires ensemble pour cette mission, alors deux membres d'\u00e9quipage  peuvent avoir le m\u00eame enfant. Pr\u00e9cision suppl\u00e9mentaire, les enfants ne font pas partie du voyage. Chaque passager se voit aussi attribuer un  matricule alphanum\u00e9rique de 10 \u00e0 20 caract\u00e8res. Finalement, on veut savoir si  cette personne a effectu\u00e9 son service militaire ou non. Pour les enfants de  l'\u00e9quipage, on n'a besoin que de leur nom et de pouvoir conna\u00eetre leur  \u00e2ge. </p> <p>L'\u00e9quipage a \u00e9t\u00e9 s\u00e9lectionn\u00e9 selon les expertises de chacun  qui ont \u00e9t\u00e9 jug\u00e9es utiles au bon d\u00e9roulement de la mission. Donc chaque membre  de l'\u00e9quipage a une ou plusieurs professions. Pour palier en d'\u00e9ventuelles  pertes humaines, nous avons s\u00e9lectionn\u00e9 plusieurs personnes ayant une m\u00eame  profession. Pour \u00e9tablir une sorte de hi\u00e9rarchie, chaque personne a un grade  d'attribuer pour chacune de ses professions. Le grade est un titre : Maitre,  second ou rempla\u00e7ant. Ex.: Arthur Dallas est un pilote de grade \"second\".  </p> <p>Derni\u00e8re chose \u00e0 retenir, chaque membre de l'\u00e9quipage devra  subir des \u00e9valuations psychologiques r\u00e9guli\u00e8rement. Il est primordial que vous  conserviez une trace de ces \u00e9valuations. Les \u00e9valuations se font de mani\u00e8re  individuelle. Pour chaque \u00e9valuation, vous devez conserver le membre d'\u00e9quipage  concern\u00e9 ainsi que le psychologue qui a men\u00e9 l'\u00e9valuation ( des passagers dont  la profession est psychologue seront charg\u00e9s de faire les \u00e9valuations). Vous  devez aussi conserver la date de l'\u00e9valuation ainsi que les notes et les  recommandations du psychologue traitant.</p>"},{"location":"examen/intra/intra_formatif_01/#directives","title":"Directives","text":"<p>Vous devez cr\u00e9er un diagramme de classes qui r\u00e9pond aux besoins de la mise en situation en respectant les points suivants : </p> <ul> <li>Votre mod\u00e8le doit r\u00e9pondre \u00e0 la convention de nomenclature telle que d\u00e9crite dans les notes de cours \"Analyse et mod\u00e9lisation de syst\u00e8mes\".</li> <li>Vous devez sp\u00e9cifier un type de donn\u00e9es pertinent pour chaque colonne de chaque table du diagramme.</li> <li>Pour les relations entre les tables, vous devez m'indiquer le type de relation en utilisant la notation (1 -- 1..n).</li> <li>Votre mod\u00e9lisation doit r\u00e9pondre aux r\u00e8gles de la troisi\u00e8me forme normale.</li> <li>Sur le diagramme, ajoutez le titre \"Examen Intra - Formatif\" ainsi que votre nom. </li> </ul> <p>La remise du diagramme se fera sous forme d'un fichier image nomm\u00e9 \"NomPr\u00e9nom - Examen Intra Formatif\" dans le devoir associ\u00e9 sur Teams.</p>"},{"location":"examen/intra/intra_formatif_01/#corrige","title":"Corrig\u00e9","text":"<p>Si \u00e7a vous int\u00e9resse j'ai cr\u00e9\u00e9 un script SQL pour g\u00e9n\u00e9rer les tables du diagramme et y ins\u00e9rer des donn\u00e9es. Il est disponible ici.</p> <p>Ma version du diagramme </p>"},{"location":"examen/intra/intra_formatif_02/","title":"Examen intra formatif 02 - xLabs","text":""},{"location":"examen/intra/intra_formatif_02/#consignes","title":"Consignes","text":"<ul> <li>Vous avez droit \u00e0 toutes vos notes et Internet.</li> <li>Aucune communication n'est permise (messagerie, courriel, etc.). Un \u00e9l\u00e8ve pris en flagrant d\u00e9lit se verra attribuer la note de 0 pour plagiat.</li> <li>La dur\u00e9e de l'examen est de 1h50.</li> <li>Une fois l\u2019examen termin\u00e9, vous devez me remettre un fichier image de votre diagramme de classes via   le devoir de l\u2019examen sur Teams. Le fichier doit \u00eatre nomm\u00e9 au format suivant : NomPrenom_Examen1. </li> <li>Il est de votre devoir de vous assurer que votre fichier est inclus dans la remise. Aucun fichier ne sera accept\u00e9 une fois que vous aurez quitt\u00e9 le lieu de l'examen. </li> </ul>"},{"location":"examen/intra/intra_formatif_02/#mise-en-situation","title":"Mise en situation","text":"<p>Le centre de recherche xLabs se sp\u00e9cialise dans des recherches dites marginales. Elle emploie une pl\u00e9thore de cobayes pour ses diff\u00e9rents projets et pr\u00e9sentement il est difficile de garder une trace de l'\u00e9tat de tous ces \"volontaires\". La direction vous a donn\u00e9 le mandat de mod\u00e9liser leur op\u00e9ration.</p> <p>Pour chaque cobaye, on veut connaitre sa date de naissance, la date \u00e0 laquelle il a commenc\u00e9 sa premi\u00e8re exp\u00e9rience et aussi sa date de d\u00e9c\u00e8s s'il y a lieu, car chez xlabs on est cobaye \u00e0 vie. Un surnom et un num\u00e9ro d'identification unique est attribu\u00e9 aux cobayes. Par contre ce num\u00e9ro peut \u00eatre r\u00e9utilis\u00e9 \u00e0 la mort du cobaye.</p> <p>Les cobayes peuvent participer \u00e0 plus d'une exp\u00e9rience \u00e0 la fois et chaque exp\u00e9rience doit comporter au minimum un cobaye mais peut en avoir plusieurs. On veut connaitre la date de d\u00e9but et de fin de la participation de chaque cobaye \u00e0 chaque exp\u00e9rience. Chaque exp\u00e9rience \u00e0 un titre, un niveau de s\u00e9curit\u00e9 qui se situe entre 0 et 10 et une courte description qui d\u00e9fini le sujet de l'exp\u00e9rience. Un ou plusieurs chercheurs peuvent \u00eatre associ\u00e9s \u00e0 une exp\u00e9rience et un chercheur peut participer \u00e0 plus d'une exp\u00e9rience \u00e0 la fois. Parmi les chercheurs impliqu\u00e9s, un r\u00f4le est attribu\u00e9 \u00e0 chacun. Il y a pr\u00e9sentement trois r\u00f4les disponible (directeur de recherche, assistant, appariteur) mais il n'est pas impossible que \u00e7a change dans l'avenir. Le r\u00f4le d'un chercheur peut aussi varier d'une exp\u00e9rience \u00e0 l'autre. Au niveau des chercheurs, on veut connaitre uniquement leur nom et leur num\u00e9ro d'identification personnelle. </p> <p>Durant le temps que dure une exp\u00e9rience, les chercheurs vont faire des observations. Pour chaque observation, il y a un chercheur impliqu\u00e9, un cobaye, une exp\u00e9rience, une date d'observation et les notes de l'observation. </p> <p>Afin de s'assurer de la bonne rentabilit\u00e9 des cobayes, un chercheur effectue chaque jour une \u00e9valuation g\u00e9n\u00e9rale de ceux-ci. L'\u00e9valuation consiste uniquement en une prise de notes. On veut donc conserver pour chaque \u00e9valuation le cobaye \u00e9valu\u00e9, le chercheur impliqu\u00e9, la date de l'\u00e9valuation ainsi que les notes prises. </p>"},{"location":"examen/intra/intra_formatif_02/#directives","title":"Directives","text":"<p>\u00c0 partir de cette mise en situation vous devez cr\u00e9er: </p> <ol> <li>Un schema conceptuel en format image portant le nom NomPrenom_shema</li> <li>Un diagramme de classes en format image portant le nom NomPrenom_diagramme</li> <li> <p>Un script de cr\u00e9ation des tables portant le nom NomPrenom_script</p> </li> <li> <p>Votre mod\u00e8le doit r\u00e9pondre \u00e0 la convention de nomenclature telle que d\u00e9crite dans les notes de cours \"Analyse et mod\u00e9lisation de syst\u00e8mes\".</p> </li> <li>Vous devez sp\u00e9cifier un type de donn\u00e9es pertinent pour chaque colonne de chaque table du diagramme.</li> <li>Pour les relations entre les tables, vous devez m'indiquer la multiplicit\u00e9.</li> <li>Votre mod\u00e9lisation doit r\u00e9pondre aux r\u00e8gles de la troisi\u00e8me forme normale.</li> </ol>"},{"location":"examen/intra/intra_formatif_02/#grille-de-correction","title":"Grille de correction","text":"\u00c9l\u00e9ments points Sh\u00e9ma conceptuel La convention de nomenclature est respect\u00e9e 5 Les types de donn\u00e9es utilis\u00e9s sont exacte et pertinent 5 Les relations entrent les tables sont juste 30 La mod\u00e9lisation r\u00e9ponds aux r\u00e8gles de la troisi\u00e8me forme normale 10 Le diagramme de classes r\u00e9ponds aux besoins  de la mise en situation 50"},{"location":"exercices/ex01_enonce/","title":"Exercice 1 - R\u00e9vision","text":"<p>Question de se remettre en mode \"BD\", voici un petit exercice de r\u00e9vision des concepts vus durant le cours de Base de donn\u00e9es 1. Inscrivez-moi dans un fichier SQL les commandes et requ\u00eates que vous avez utilis\u00e9es pour compl\u00e9ter les questions de la section Manipulation des donn\u00e9es. Le fichier est \u00e0 remettre dans le devoir Teams correspondant. </p> <p>La base de donn\u00e9es contient une liste de sorts pour le jeu Donjons et Dragons 5e \u00e9dition. Chaque sort appartient \u00e0 une seule \u00e9cole de magie, mais il peut \u00eatre utilis\u00e9 par plus d'une classe de personnage. Il y a aussi une liste d'usagers qui peuvent cr\u00e9er une liste de leurs sorts favoris.</p> <p>Voici le diagramme de classes de la base de donn\u00e9es</p> <p></p>"},{"location":"exercices/ex01_enonce/#creation-dune-base-de-donnees-et-execution-dun-script-sql","title":"Cr\u00e9ation d'une base de donn\u00e9es et ex\u00e9cution d'un script SQL","text":"<ul> <li>Cr\u00e9ez une nouvelle base de donn\u00e9es et nommez la bd2_01</li> <li>T\u00e9l\u00e9chargez le fichier ex01_create_tables.sql. </li> <li>Lancez le script pour cr\u00e9er les tables et ajouter les donn\u00e9es.</li> <li>Allez-y en ligne de commande ou avec DBeaver</li> </ul>"},{"location":"exercices/ex01_enonce/#manipulation-des-donnees","title":"Manipulation des donn\u00e9es","text":"<p>Pour chacune des questions, j'ai ajout\u00e9 une image du r\u00e9sultat attendu avec le nom des colonnes d\u00e9sir\u00e9.</p> <ol> <li> <p>S\u00e9lectionnez le nom de toutes les classes tri\u00e9 en ordre alphab\u00e9tique invers\u00e9. </p> </li> <li> <p>Comptez le nombre de sorts qui appartient \u00e0 l'\u00e9cole Conjuration. </p> </li> <li> <p>Comptez le nombre de sorts de chacune des \u00e9coles. (ecole | nb_sorts) </p> </li> <li> <p>S\u00e9lectionnez la liste des sorts de la classe Bard de niveau 0, triez en ordre alphab\u00e9tique de nom de sort. </p> </li> <li> <p>S\u00e9lectionnez la liste de tous les sorts qui contiennent le mot fire dans leur nom. </p> </li> <li> <p>Trouvez les trois \u00e9coles de magie qui comptent le plus de sorts faisant partie des sorts favoris des usagers. Triez les \u00e9coles en commen\u00e7ant par la plus populaire. </p> </li> <li> <p>S\u00e9lectionnez la liste des sorts qui ont le composant verbal mais pas somatic et material et qui ont une dur\u00e9e d'une heure OU qu'ils n'ont pas le composant verbal et qui ont une port\u00e9e de Touch </p> </li> <li> <p>S\u00e9lectionnez le nombre de sorts pour chaque classe. </p> </li> <li> <p>En vous aidant de la requ\u00eate pr\u00e9c\u00e9dente, affichez la moyenne de sort par classe de personnage. Essayez d'utiliser une sous-requ\u00eate et la fonction SQL AVG </p> </li> <li> <p>S\u00e9lectionnez tous les sorts d'une classe donn\u00e9e et d'un niveau donn\u00e9e. Pour chaque sort affichez le id et le nom du sort ainsi qu'une colonne composante qui sera g\u00e9n\u00e9r\u00e9 comme suit. Pour les champs verbal, somatic et material, affichez respectivement un V, S ou M si la valeur est \u00e9gale \u00e0 1, sinon n'affichez rien. Chaque lettre doit \u00eatre s\u00e9par\u00e9e par une virgule. Finalement affichez la valeur du champ material_cost. Vous pouvez vous aider des fonctions IF() et CONCAT(). Dans mon exemple j'affiche tous les sorts de la classe Bard du niveau 0. </p> </li> </ol>"},{"location":"exercices/ex02_enonce/","title":"Exercice 02 - Syst\u00e8me de saisie d'absence","text":"<p>On veut reproduire le syst\u00e8me de saisie d'absence en cours. Analysez le fonctionnement \u00e0 l'aide du texte qui suit et des images et cr\u00e9ez le sch\u00e9ma conceptuel de votre solution.</p>"},{"location":"exercices/ex02_enonce/#fonctionnement","title":"Fonctionnement","text":"<p>L'usager commence par saisir un cours et ensuite la date de ce cours.</p> <p></p> <p>Ensuite dans un tableau on a la liste de tous les \u00e9l\u00e8ves inscrit \u00e0 ce cours. On peut saisir le nombre d'heure par un nombre entier positif. Une fois la saisie termin\u00e9e l'usager clique sur Sauvegarder les modifications</p> <p></p> <p>Finalement l'usager peut aussi sortir un rapport cumulatif des absences des \u00e9l\u00e8ves pour un cours donn\u00e9.</p> <p></p>"},{"location":"exercices/ex03_enonce/","title":"Exercice 03 - Analyse du syst\u00e8me de stationnement du c\u00e9gep","text":"<p>Pour notre deuxi\u00e8me cas, on va analyser le syst\u00e8me de droit de stationnement du c\u00e9gep. Vous devez analyser le syst\u00e8me et ensuite cr\u00e9er les deux diagrammes suivants a l'aide d'un logiciel appropri\u00e9 : </p> <ul> <li>un sch\u00e9ma conceptuel selon le mod\u00e8le entit\u00e9-association.</li> <li>un diagramme de classe UML</li> </ul> <p>Une fois termin\u00e9, me remettre le sch\u00e9ma et le diagramme en format image sur Teams dans la section devoir.</p>"},{"location":"exercices/ex03_enonce/#mise-en-situation","title":"Mise en situation","text":"<p>On doit tout d'abord se cr\u00e9er un usager avec un courriel et un mot de passe. Ensuite l'usager cr\u00e9\u00e9 peut effectuer une commande qui d\u00e9terminera la dur\u00e9e du droit de stationnement et les v\u00e9hicules autoris\u00e9s selon leur plaque d'immatriculation. </p> <ul> <li>L'usager \u00e0 le choix entre trois type de droit : <ul> <li>30 jours</li> <li>1 session</li> <li>annuelle</li> </ul> </li> <li>Il peut entrer un maximum de 4 plaques d'immatriculation par commande.</li> <li>Un compte peut contenir plus de 4 plaque d'immatriculation, mais chaque plaque est associ\u00e9 \u00e0 une commande, un droit de stationnement.</li> <li>Pour les autres informations, r\u00e9f\u00e9rez-vous aux images suivantes : </li> </ul> <p></p> <p></p> <p>Dans la section Informations personnelles on retrouve le num\u00e9ro de DA ou d'employ\u00e9, le nom complet, le courriel et le num\u00e9ro de t\u00e9l\u00e9phone.</p> <p></p> <p></p> <p></p> <p></p>"},{"location":"exercices/ex04_enonce/","title":"Exercice 04 - Mod\u00e9lisation d'un livre de recettes","text":""},{"location":"exercices/ex04_enonce/#consignes","title":"Consignes","text":"<p>Vous devez analyser et mod\u00e9liser un livre de recettes. Les deux images qui suivent vous indique ce qui doit \u00eatre inclus dans la base de donn\u00e9es. Toutes les informations pr\u00e9sentent doivent \u00eatre sauvegard\u00e9es.</p> <p>Pr\u00e9cision sur les pictogrammes dans les recettes : </p> <ul> <li>Le bol repr\u00e9sente le temps de pr\u00e9paration de la recette</li> <li>La flamme est le temps de cuisson</li> <li>La main est un temps de pr\u00e9paration autre</li> </ul> <p>Vous devez me produire et remettre : </p> <ul> <li> Le mod\u00e8le entit\u00e9-association en format image.</li> <li> Un diagramme de classes UML, aussi \u00e0 remettre en format image.</li> <li> Un script sql de g\u00e9n\u00e9ration de la base de donn\u00e9es et des tables qui inclus la cr\u00e9ation de la base de donn\u00e9es, des tables et des cl\u00e9s primaires et \u00e9trang\u00e8res.</li> <li> La base de donn\u00e9es doit se nommer ex04_recette et avoir comme collation <code>utf8mb4_unicode_ci</code></li> <li> La table qui contiendra les recettes doit avoir une cl\u00e9 primaire qui d\u00e9bute \u00e0 la valeur 1000</li> <li> Le script doit pouvoir \u00eatre lanc\u00e9 cons\u00e9cutivement sans causer d'erreur (Pensez \u00e0 ajouter des commandes drop ... if exists)</li> <li> Vous devez respecter les trois premi\u00e8re forme normale et la convention de nommage qui est d\u00e9crite dans les notes de cours.</li> </ul> <p>Le tout dans un dossier compress\u00e9 dans le devoir sur Teams</p>"},{"location":"exercices/ex04_enonce/#images","title":"Images","text":""},{"location":"exercices/ex04_enonce/#recette-1","title":"Recette 1","text":""},{"location":"exercices/ex04_enonce/#recette-2","title":"Recette 2","text":""},{"location":"exercices/ex05_enonce/","title":"Exercice 5 - INSERT","text":"<p>\u00c0 partir de la base de donn\u00e9es athl\u00e8te, (le script sql de g\u00e9n\u00e9ration est disponible ici), r\u00e9alisez les requ\u00eates d'insertion suivante.</p> <ol> <li>Ins\u00e9rez-vous dans la table athl\u00e8te sans sp\u00e9cifier les noms de colonnes dans la requ\u00eate.</li> <li>Ins\u00e9rez un autre athl\u00e8te fictif mais en sp\u00e9cifiant seulement son nom, pr\u00e9nom et la date de naissance.</li> <li>R\u00e9cup\u00e9rez le id qui a \u00e9t\u00e9 g\u00e9n\u00e9r\u00e9 automatiquement lors de la requ\u00eate pr\u00e9c\u00e9dente et faites afficher avec une requ\u00eate SELECT le message suivant : \"L'athl\u00e8te [prenom] [nom] a \u00e9t\u00e9 ajout\u00e9 avec succ\u00e8s!\". Utilisez le id r\u00e9cup\u00e9r\u00e9 dans la clause WHERE de votre requ\u00eate.</li> <li>Cr\u00e9ez une nouvelle table appel\u00e9 athlete_quebec avec les colonnes suivante ( id cl\u00e9 primaire auto-incr\u00e9ment\u00e9, nom, pr\u00e9nom, ville )</li> <li>Ins\u00e9rez dans cette table tous les athl\u00e8tes qui proviennent de la province du Qu\u00e9bec \u00e0 l'aide d'une requ\u00eate select.</li> </ol> <p>Je veux que vous me remettiez les requ\u00eates dans un script SQL avec pour chaque requ\u00eate d'insertion une requ\u00eate select qui va valider que les donn\u00e9es ont bien \u00e9t\u00e9 ajout\u00e9.</p>"},{"location":"exercices/ex06_enonce/","title":"Exercice 6 - VIEW","text":"<p>\u00c0 partir de la base de donn\u00e9es athl\u00e8te de l'exercice pr\u00e9c\u00e9dente, (le script sql de g\u00e9n\u00e9ration est disponible ici), creez les views suivantes : </p> <ol> <li>Cr\u00e9ez une view nomm\u00e9e resultat_hhmmss qui affiche le r\u00e9sultat format\u00e9 en heures, minutes, secondes (hh:mm:ss). Les colonnes de la view doivent \u00eatre les m\u00eames que la table resultat mais en ajoutant une colonne nomm\u00e9e resultat_hhmmss dans laquelle le calcul sera fait (id, athlete_id, epreuve_id, date_resultat, resultat_ms, resultat_hhmmss).</li> <li>Cr\u00e9ez une view nomm\u00e9e athlete_complet qui, en combinant les tables n\u00e9cessaires, affiche les athl\u00e8tes avec les colonnes suivantes, (id, nom pr\u00e9nom concat, date_epreuve, nom_epreuve, r\u00e9sultat). Attention, je veux que les noms de colonnes de la view soit identique \u00e0 ce que je demande entre parenth\u00e8se)</li> <li>\u00c0 partir de la view pr\u00e9c\u00e9dente, athlete_complet, s\u00e9lectionn\u00e9 les informations des athl\u00e8tes qui ont particip\u00e9 \u00e0 un marathon. </li> <li>Cr\u00e9ez une view nomm\u00e9e resultat_21juillet2020 qui va contenir toutes les informations de la table r\u00e9sultat mais uniquement pour la date du 21 juillet 2020.</li> <li>Modifier la view resultat_21juillet2020 pour qu'elle affiche les r\u00e9sultats du 14 juillet 2019. Modifier aussi son nom pour resultat_14juillet2019</li> <li>Supprimer la view resultat_14juillet2019</li> </ol> <p>Je veux que vous me remettiez les requ\u00eates dans un script SQL.</p>"},{"location":"exercices/ex07_enonce/","title":"Exercice 7 - Triggers","text":""},{"location":"exercices/ex07_enonce/#preparation-des-donnees","title":"Pr\u00e9paration des donn\u00e9es","text":"<ul> <li>Importer le script sql ex07_create_tables.sql disponible ici</li> </ul>"},{"location":"exercices/ex07_enonce/#triggers-a-creer","title":"Triggers \u00e0 cr\u00e9er","text":""},{"location":"exercices/ex07_enonce/#question-1","title":"Question #1","text":"<p>Pour chaque modification \u00e0 la table resultat, ins\u00e9rez les informations n\u00e9cessaires dans la table resultat_log APR\u00c8S l'ex\u00e9cution de la requ\u00eate INSERT, UPDATE et DELETE. Attention, lors d'un UPDATE, ajoutez les informations seulement si la colonne resultat_ms a \u00e9t\u00e9 modifi\u00e9.</p> colonne insert update delete operation \"insert\" \"update\" \"delete\" ancien_resultat null old.resultat_ms old.resultat_ms nouveau_resultat new.resultat_ms new.resultat_ms null resultat_id new.id new.id new.id date_operation La date du jour La date du jour La date du jour"},{"location":"exercices/ex07_enonce/#question-2","title":"Question #2","text":"<p>Quand on ajoute un r\u00e9sultat, validez que la valeur de la colonne cree_par existe dans la table usager. Si la valeur est invalide, emp\u00eachez la requ\u00eate INSERT et retournez un message d'erreurs. La valeur \u00e0 ins\u00e9rer dans le champ cree_par est le id d'un usager de la table usager. </p>"},{"location":"exercices/ex07_enonce/#question-3","title":"Question #3","text":"<p>Effectuez les m\u00eames op\u00e9rations que la question #2 quand on modifie un r\u00e9sultat mais sur la colonne modifie_par.</p>"},{"location":"exercices/ex07_enonce/#question-4","title":"Question #4","text":"<p>AVANT l'insertion ou la modification de la description d'une \u00e9preuve dans la table epreuve_type, valider que la description n'est pas d\u00e9j\u00e0 utilis\u00e9. Si oui, modifiez la valeur \u00e0 ajouter ou modifier en ajoutant (x) \u00e0 la description. ( x vaudra le nombre de fois que le nom se retrouve dans la table -1 ) Ex. On veut ins\u00e9rer Marathon comme valeur mais elle est d\u00e9j\u00e0 pr\u00e9sente comme description dans la table. On va utiliser Marathon (1) comme nouvelle valeur \u00e0 ins\u00e9rer.</p>"},{"location":"exercices/ex08_enonce/","title":"Exercice 8 - Fonctions","text":"<p>Dans la base de donn\u00e9es que vous avec import\u00e9e \u00e0 l'exercice 7 cr\u00e9ez les deux fonctions suivantes : </p>"},{"location":"exercices/ex08_enonce/#formater-un-resutlat","title":"Formater un r\u00e9sutlat","text":"<p>Cr\u00e9ez une fonction nomm\u00e9e resultatHMS qui prendra en param\u00e8tre un r\u00e9sultat en millisecondes et qui le retournera en texte sous le format heures minutes et secondes (HH:MM:SS).</p>"},{"location":"exercices/ex08_enonce/#fonction-de-calcul-de-moyenne-au-5-kilometres","title":"Fonction de calcul de moyenne au 5 kilom\u00e8tres","text":"<p>Ajoutez les informations suivantes : </p> <pre><code>-- Insertion de l'athl\u00e8te John Smith avec trois r\u00e9sultats au 5 km\nINSERT INTO athlete (nom, prenom, date_naissance, adresse, ville, province, pays, courriel)\nVALUES ('Smith', 'John', '1980-01-01', '475 Rue Notre Dame E', 'Victoriaville', 'Qu\u00e9bec', 'Canada', 'john.smith@gmail.com');\n\nSET @id_athlete := LAST_INSERT_ID();\n\nINSERT INTO resultat (athlete_id , epreuve_type_id, date_resultat, resultat_ms, evenement_id)\nVALUES (@id_athlete, 1, '2023-07-17', 1529499, 2),\n       (@id_athlete, 1, '2023-08-17', 1995742, 2),\n       (@id_athlete, 1, '2023-09-17', 1480882, 2);\n</code></pre> <p>Cr\u00e9ez une fonction nomm\u00e9e moyenne5k qui va prendre en param\u00e8tre le id d'un athl\u00e8te et qui va retourner la moyenne de ses r\u00e9sultats pour toutes ses r\u00e9sultats au 5 km. La valeur de sortie doit \u00eatre la moyenne des r\u00e9sultats exprim\u00e9es en heures, minutes, secondes (hh:mm:ss) et de type VARCHAR(). </p> <p>Utilisez l'athl\u00e8te John Smith qu'on vient d'ajouter pour tester la fonction, le r\u00e9sultat devrait \u00eatre <code>00:27:48</code>.</p>"},{"location":"exercices/ex09_enonce/","title":"Exercice 9 - Cr\u00e9dit social","text":""},{"location":"exercices/ex09_enonce/#installation","title":"Installation","text":"<p>Les scripts sql de g\u00e9n\u00e9ration de la base de donn\u00e9es sont disponible ici</p> <ul> <li>Cr\u00e9ez la base de donn\u00e9es et les tables en ex\u00e9cutant le script sql 01_create_table.sql</li> <li>Ins\u00e9rez les donn\u00e9es en ex\u00e9cutant les scripts suivants (l'ordre est important). Certains scripts comportent beaucoup de ligne, 50 000 pour 04_insert_citoyen, c'est normal que le temps ex\u00e9cution soit long. Importez les scripts en ligne de commande pour gagner beaucoup de temps!!!</li> </ul> <p>Liste des scripts \u00e0 ex\u00e9cuter</p> <ul> <li>02_insert_classe</li> <li>03_insert_evenement_type</li> <li>04_insert_citoyen</li> <li>05_insert_evenement</li> <li>06_insert_citoyen_evenement</li> </ul> <p>Inscrivez moi les scripts des 5 num\u00e9ros dans un fichier sql. Une fois termin\u00e9 remettez moi le fichier dans le devoir sur Teams.</p>"},{"location":"exercices/ex09_enonce/#diagramme-des-classes","title":"Diagramme des classes","text":""},{"location":"exercices/ex09_enonce/#descriptions","title":"Descriptions","text":"<p>La base de donn\u00e9es sert \u00e0 stocker des informations sur les citoyens pour \u00e9tablir leur score de cr\u00e9dit social, une note de bon comportement qui d\u00e9termine dans quel classe le citoyen est situ\u00e9. </p>"},{"location":"exercices/ex09_enonce/#calcul-du-credit-social","title":"Calcul du cr\u00e9dit social","text":"<p>\u00c0 la naissance, un citoyen se voit octroyer un cr\u00e9dit initial de 500 (par contre ce nombre pourrait \u00eatre modifi\u00e9 par le parti). Tout au long de sa vie, le total de ce cr\u00e9dit va fluctuer selon des \u00e9v\u00e9nements auquel le citoyen va participer. Donc le cr\u00e9dit social de chaque citoyen est la somme de son cr\u00e9dit initial et du score de tous les \u00e9v\u00e9nements auxquels il a particip\u00e9. Les \u00e9v\u00e9nements sont d\u00e9fini par un type et un score par d\u00e9faut (dans la table evenement_type, mais ce score peut \u00eatre ajust\u00e9 selon la nature de l'\u00e9v\u00e9nement (le champ score_ajustement de la table citoyen_evenement, s'il est \u00e0 null ne pas en tenir compte, sinon il outrepasse le score par d\u00e9faut de l'\u00e9v\u00e9nement). Le score de cr\u00e9dit social peut varier entre 0 et 1000.</p>"},{"location":"exercices/ex09_enonce/#calcul-de-la-classe-du-citoyen","title":"Calcul de la classe du citoyen","text":"<p>Chaque citoyen appartient \u00e0 une classe selon son score de cr\u00e9dit social. \u00c7a lui donne droit \u00e0 certain avantage de sa classe mais aussi aux avantages de toutes les classes inf\u00e9rieurs. Pour appartenir \u00e0 une classe, le score de cr\u00e9dit social du citoyen doit \u00eatre sup\u00e9rieur au cr\u00e9dit minimum de cette classe ( colonne credit_min de la table classe). La classe est recalcul\u00e9 chaque nuit selon son score actuel. Donc pour connaitre la classe d'un citoyen vous n'avez qu'\u00e0 utiliser le champ classe_id de la table citoyen.</p>"},{"location":"exercices/ex09_enonce/#exercices","title":"Exercices","text":""},{"location":"exercices/ex09_enonce/#1-fonction-calcul_credit","title":"1. Fonction calcul_credit()","text":"<p>Cr\u00e9ez une fonction nomm\u00e9e calcul_credit qui prends en param\u00e8tre le id d'un citoyen et retourne le total du calcul de son cr\u00e9dit social. </p> Param\u00e8tres IN/OUT tYPE Valeur test id IN INT 20958 RETURNS - INT 365 <p>Ex. Le citoyen Harry Walsh, id 20958, pin 51d8fbc8-d473-45f5-991e-15aea899e8f9, a un score de cr\u00e9dit social de 365. </p> <pre><code>select calcul_credit(20958) as score_credit\n</code></pre>"},{"location":"exercices/ex09_enonce/#2-fonction-privilege_valide","title":"2. Fonction privilege_valide()","text":"<p>Cr\u00e9ez une fonction nomm\u00e9e privilege_valide qui prend en param\u00e8tre le code pin du citoyen ainsi que le id d'une classe. Si la classe du citoyen est \u00e9gale ou sup\u00e9rieur \u00e0 la classe pass\u00e9e en param\u00e8tre, retournez TRUE, sinon retournez FALSE. Pour d\u00e9termin\u00e9 si une classe est sup\u00e9rieur \u00e0 une autre, vous devez vous fiez \u00e0 la colonne credit_min de la table classe.</p> Param\u00e8tres IN/OUT tYPE Valeur test pin IN VARCHAR(100) 51d8fbc8-d473-45f5-991e-15aea899e8f9 classe_id IN INT 4 RETURNS - BOOLEAN FALSE <p>Ex. Le citoyen Harry Walsh, id 20958, pin 51d8fbc8-d473-45f5-991e-15aea899e8f9 appartient \u00e0 la classe Delta. </p> <pre><code>-- Cette requ\u00eate retournera 1\nselect privilege_valide('51d8fbc8-d473-45f5-991e-15aea899e8f9',4) as valide\n-- Cette requ\u00eate retournera 0\nselect privilege_valide('51d8fbc8-d473-45f5-991e-15aea899e8f9',3) as valide\n</code></pre>"},{"location":"exercices/ex09_enonce/#3-vue-citoyen_avec_credit","title":"3. Vue citoyen_avec_credit","text":"<p>Cr\u00e9ez une vue nomm\u00e9e citoyen_avec_credit qui contiendra les champs suivants</p> Nom colonne table colonne citoyen_id citoyen id nom citoyen nom, prenom (\"Walsh, Harry\") pin citoyen pin classe classe titre credit calcul\u00e9 <p>Faites ensuite une requ\u00eate sur cette view pour afficher les informations du citoyen id 20958</p>"},{"location":"exercices/ex09_enonce/#4-procedure-stockee-liste_manifestant","title":"4. Proc\u00e9dure stock\u00e9e liste_manifestant","text":"<p>Cr\u00e9ez une proc\u00e9dure stock\u00e9e nomm\u00e9e liste_manifestant qui prend une date en param\u00e8tre et retourne une liste de manifestants qui \u00e9tait pr\u00e9sent. Assurez-vous que pour la date s\u00e9lectionn\u00e9e s'il y a un \u00e9v\u00e9nement il soit de type manifestation. Le r\u00e9sultat doit \u00eatre class\u00e9 en ordre alphab\u00e9tique de nom et pr\u00e9nom.</p> Nom colonne table colonne citoyen_id citoyen id evenement_id evenement id nom citoyen nom, prenom (\"Walsh, Harry\") pin citoyen pin classe classe titre date_evenement evenement date_evenement notes evenement notes <p>Faite ensuite une validation avec la date 2021-04-01, vous devriez avoir 17 enregistrements. Si vous essayer avec la date 2022-09-15 vous devriez en avoir aucun.</p>"},{"location":"exercices/ex09_enonce/#5-procedure-stockee-update_classe","title":"5. Proc\u00e9dure stock\u00e9e update_classe","text":"<p>Cr\u00e9ez une proc\u00e9dure stock\u00e9e nomm\u00e9e update_classe qui va mettre \u00e0 jour la classe de chaque citoyen. Il vous faudra calculer le cr\u00e9dit social de chacun, ensuite d\u00e9terminer dans quelle classe il appartient selon le cr\u00e9dit minimum de chaque classe. </p> <ul> <li>Vous devez parcourir tous les enregistrements de la table citoyen en utilisant un curseur.</li> <li>Si vous d\u00e9tectez une diff\u00e9rence entre la classe du citoyen et votre calcul, vous devez \"logger\" le probl\u00e8me dans la table log_update_classe.</li> </ul> <p>Pour tester votre procedure, limitez la requ\u00eate SELECT qui alimente le curseur \u00e0 un seul citoyen et modifier la valeur du champs credit_initial de ce citoyen pour que la valeur du champs classe_id ne soit plus valide. Dans l'exemple plus bas j'ai modifi\u00e9 la valeur du cr\u00e9dit initial du citoyen 2 pour 850, ce qui lui donne une classe de 2 (Beta) au lieu de 4 (Delta).</p> <p> </p> <p>Apr\u00e8s avoir lancer ma proc\u00e9dure, on peut voir que la valeur de classe_id a bien \u00e9t\u00e9 modifi\u00e9 et que l'op\u00e9ration a \u00e9t\u00e9 enregistr\u00e9 dans la table log_update_classe.</p> <p></p> <p></p>"},{"location":"exercices/ex10_enonce/","title":"Exercice 10 - Curseur","text":"<p>Cet exercice \u00e0 pour objectif de vous rendre plus \u00e0 l'aise avec la cr\u00e9ation et l'utilisation de curseurs.</p> <ul> <li>T\u00e9l\u00e9chargez et ex\u00e9cutez le script sql disponible ici : ex10_create_tables. </li> </ul>"},{"location":"exercices/ex10_enonce/#premiere-question","title":"Premi\u00e8re question","text":"<p>Dans la table houblon de la base de donn\u00e9es, il y a un champ pays qui contient le nom du pays producteur du type de houblon.  </p> <p>Cr\u00e9ez une proc\u00e9dure stock\u00e9e avec curseur qui va lister tous les pays pr\u00e9sents dans la table.</p> <ul> <li>Le format du r\u00e9sultat est un string avec la liste des pays s\u00e9par\u00e9s par un point-virgule (\"Canada;\u00c9tats-Unis\")</li> <li>Il ne doit pas avoir de doublon dans la liste</li> <li>Les pays doivent \u00eatre class\u00e9 en ordre alphab\u00e9tique</li> <li>Utilisez une variable OUT pour r\u00e9cup\u00e9rer le r\u00e9sultat</li> </ul> <p>Vous devriez avoir comme r\u00e9sultat  r\u00e9sultat<pre><code>\"Allemagne;Australie;\u00c9tats-Unis;France;Japon;Nouvelle-Z\u00e9lande;Pologne;R\u00e9publique-Tch\u00e8que;Royaume-Uni;Russie;Slov\u00e9nie\"\n</code></pre></p> <p>Cr\u00e9ez un script SQL nomm\u00e9e NomPrenom_ex10_1.sql qui va contenir la cr\u00e9ation de la proc\u00e9dure et un test \u00e0 la fin de votre proc\u00e9dure.</p>"},{"location":"exercices/ex10_enonce/#deuxieme-question","title":"Deuxi\u00e8me question","text":"<p>Encore dans la table houblon, il y a un champ similitude qui contient une liste de houblon similaire au houblon s\u00e9lectionn\u00e9. Le but est de pouvoir proposer des houblons qui s'accompagnent bien ensemble. On va extraire cette information dans une nouvelle table.</p> <p>Cr\u00e9ez un script SQL nomm\u00e9e NomPrenom_ex10_2.sql qui va contenir l'ensemble des \u00e9l\u00e9ments de votre r\u00e9ponse.</p> <p>Cr\u00e9ez les tables selon le diagramme UML suivant</p> <p></p> <p>Cr\u00e9ez une proc\u00e9dure stock\u00e9e selon les crit\u00e8res suivants:</p> <ul> <li>La proc\u00e9dure doit utiliser un curseur</li> <li>Cr\u00e9ez une transaction qui sera compl\u00eate uniquement si le traitement se d\u00e9roule bien jusqu'\u00e0 la fin</li> <li>Supprimez le contenu des tables similitude et similitude_log</li> <li>Pour chaque ligne de la table houblon, isoler les valeurs de la colonne similitude (elles sont s\u00e9par\u00e9es par des virgules)</li> <li>Pour chaque valeur, d\u00e9terminez si un houblon du m\u00eame nom existe d\u00e9j\u00e0.</li> <li>Si oui, ajoutez dans la nouvelle table similitude le id du houblon de la ligne et le id du houblon de la valeur trouv\u00e9e.</li> <li>Si non, ajoutez dans la table similitude_log le id du houblon de la ligne et la valeur en texte.</li> <li>Si on rencontre une erreur de type SQLEXCEPTION le traitement doit s'arr\u00eater et les modifications annul\u00e9es. Affichez aussi un message d'erreur \u00e0 l'usager.</li> </ul> <p>Pour tester votre proc\u00e9dure, lancez l\u00e0 et ensuite faites une requ\u00eate sur le houblon \"Admiral\" pour sortir ses houblons similaires depuis la table similitude. Vous devriez avoir comme r\u00e9sultat les houblons \"Target\" et \"Challenger\".</p> <p>Je vais r\u00e9cup\u00e9rer vos deux scripts SQL dans le devoir sur Teams</p>"},{"location":"exercices/ex11_enonce/","title":"Exercice 11 - Gestion des usagers","text":"<p>Pour cet exercice nous allons utiliser la base de donn\u00e9es credit_social (voir le script de cr\u00e9ation dans l'exercice 9).Vous devez me produire un script SQL qui va effectuer les op\u00e9rations suivantes. Assurez-vous de tester que les permissions sont bien appliqu\u00e9es. Vous pouvez ajouter les r\u00e9ponses des sections \"e\" dans le m\u00eame script en commentaire.</p>"},{"location":"exercices/ex11_enonce/#1-usager-mike","title":"1. Usager mike","text":"<p>a) Cr\u00e9ez un usager avec les informations suivantes : </p> <ul> <li>nom : mike</li> <li>mot de passe : !alph2</li> <li>h\u00f4te accept\u00e9 : tous</li> </ul> <p>b) Creez un r\u00f4le nomm\u00e9e <code>alpha</code></p> <p>c) Donnez les permissions suivantes \u00e0 ce r\u00f4le : </p> <ul> <li>Il a la permission de tout faire dans la base de donn\u00e9es credit_social.</li> <li>Il peut aussi ajouter des permissions \u00e0 d'autre usagers.</li> <li>Il peut cr\u00e9er des usagers pour toutes les bases de donn\u00e9es, pas seulement credit_social.</li> </ul> <p>d) Attribuez \u00e0 l'usager <code>mike</code> le r\u00f4le <code>alpha</code> et assurez-vous que le r\u00f4les est activ\u00e9 automatiquement lors de la connexion de l'usager</p> <p>e) Testez les \u00e9l\u00e9ments suivants</p> <ul> <li>Inscrivez le r\u00e9sultat d'une requ\u00eate SELECT sur une table d'une autre base de donn\u00e9es que credit_social. Par exemple bd2_ex10.</li> <li>Faites la cr\u00e9ation de l'usager suivant (le point #2) avec cet usager. Est-ce que \u00e7a fonctionne?</li> </ul>"},{"location":"exercices/ex11_enonce/#2-usager-john","title":"2. Usager john","text":"<p>a) Cr\u00e9er un usager avec les informations suivantes : </p> <ul> <li>nom : john</li> <li>mot de passe : !b3ta</li> <li>h\u00f4te accept\u00e9 : tous</li> </ul> <p>b) Creez un r\u00f4le nomm\u00e9e <code>beta</code></p> <p>c) Donnez les permissions suivantes \u00e0 ce r\u00f4le : </p> <ul> <li>Il peut faire des requ\u00eates SELECT, UPDATE, INSERT sur les tables citoyen et evenement de la base de donn\u00e9es credit_social.</li> <li>Il peut ex\u00e9cuter toutes les proc\u00e9dures stock\u00e9es.</li> </ul> <p>d) Attribuez \u00e0 l'usager <code>john</code> le r\u00f4le <code>beta</code></p> <p>e) Testez les \u00e9l\u00e9ments suivants</p> <ul> <li>Essayez de supprimer l'\u00e9v\u00e9nement avec le id 6 de la table evenement. Inscrivez la requ\u00eate effectu\u00e9e et le r\u00e9sultat.</li> <li>Ex\u00e9cutez une proc\u00e9dure stock\u00e9e de la base de donn\u00e9es credit_social, par exemple liste_manifestant(). Est-ce que \u00e7a fonctionne?</li> <li>Modifiez le cr\u00e9dit initial du citoyen avec le id 2107 pour 800. Inscrivez la requ\u00eate effectu\u00e9e pour la mise \u00e0 jour et pour valider que la valeur a \u00e9t\u00e9 modifi\u00e9.</li> </ul>"},{"location":"exercices/ex11_enonce/#3-usager-bob","title":"3. Usager bob","text":"<p>a) Cr\u00e9er un usager avec les informations suivantes : </p> <ul> <li>nom : bob</li> <li>mot de passe : !g2mm2</li> <li>h\u00f4te accept\u00e9 : tous</li> </ul> <p>b) Creez un r\u00f4le nomm\u00e9e <code>gamma</code></p> <p>c) Donnez les permissions suivantes \u00e0 ce r\u00f4le : </p> <ul> <li>Il peut faire des requ\u00eates SELECT sur les colonnes nom, prenom et pin de la table citoyen de la base de donn\u00e9es credit_social.</li> <li>Il peut ex\u00e9cuter uniquement la proc\u00e9dure stock\u00e9e update_classe de la base de donn\u00e9es credit_social</li> </ul> <p>d) Attribuez \u00e0 l'usager <code>bob</code> le r\u00f4le <code>gamma</code></p> <p>e) Testez les \u00e9l\u00e9ments suivants</p> <ul> <li>\u00cates-vous capable de donner le nom et pr\u00e9nom du citoyen avec le id 1111? Sinon pourquoi?</li> <li>Faites les modifications n\u00e9cessaires pour en \u00eatre capable. Inscrivez l'op\u00e9ration effectu\u00e9e.</li> <li>Trouvez une fa\u00e7on pour permettre \u00e0 cet usager de pouvoir afficher le nom, prenom et la classe d'un citoyen selon son PIN sans ajouter la table classe dans les permissions SELECT de l'usager (indice : on a vu une fa\u00e7on de visualiser les donn\u00e9es d'une table sans y avoir acc\u00e8s). Inscrivez les op\u00e9rations effectu\u00e9es.</li> <li>Testez votre solution avec le PIN <code>39c0cf42-510c-4811-8c3c-47ab100443ce</code> et inscrivez le nom complet du citoyen correspondant.</li> </ul>"},{"location":"exercices/ex12_enonce/","title":"Exercice 12 - pyCRUD","text":"<p>Comme premier exercice avec Python, on va cr\u00e9er une application console simple qui va couvrir sommairement les op\u00e9ration CRUD. Nous allons utiliser la base de donn\u00e9es credit_social. Je vous laisse aller pour l'apprentissage de Python et des notions dont vous allez avoir besoin (afficher \u00e0 l'\u00e9cran, lire une saisie clavier, boucle, fonction, module?).</p>"},{"location":"exercices/ex12_enonce/#creation-du-menu","title":"Cr\u00e9ation du menu","text":"<p>Au lancement du programme, un menu s'affichera avec les options suivantes : </p> <ol> <li>Ajouter un nouveau citoyen</li> <li>Obtenir les informations d'un citoyen</li> <li>Modifier un citoyen</li> <li>Supprimer un citoyen</li> <li>Quitter</li> </ol> <p>Exemple de menu</p> <p></p>"},{"location":"exercices/ex12_enonce/#options-du-menu","title":"Options du menu","text":""},{"location":"exercices/ex12_enonce/#1-ajouter-un-citoyen","title":"1. Ajouter un citoyen","text":"<p>Demandez \u00e0 l'usager les informations suivantes sur le citoyen \u00e0 ajouter : </p> <ul> <li>nom</li> <li>pr\u00e9nom</li> <li>no_civique</li> <li>adresse</li> <li>ville</li> <li>pin</li> </ul> <p>Les champs classe_id et credit_initial seront \"forc\u00e9s\" \u00e0 respectivement 4 et 500. Une fois l'ajout fait, affichez un message de confirmation et revenez au menu principal.</p> <p></p>"},{"location":"exercices/ex12_enonce/#2-obtenir-les-informations-dun-citoyen","title":"2. Obtenir les informations d'un citoyen","text":"<p>Demandez \u00e0 l'usager de saisir le id du citoyen. Affichez ensuite les informations suivantes \u00e0 l'\u00e9cran : </p> <ul> <li>Pr\u00e9nom et nom</li> <li>Classe</li> <li>Score de cr\u00e9dit social</li> </ul> <p>Ensuite revenez au menu principal.</p> <p></p>"},{"location":"exercices/ex12_enonce/#3-modifier-un-citoyen","title":"3. Modifier un citoyen","text":"<p>Permettre en saisissant le id d'un citoyen de modifier son adresse ( no_civique, adresse, ville). Affichez un message de confirmation et revenez au menu principal.</p> <p></p>"},{"location":"exercices/ex12_enonce/#4-supprimer-un-citoyen","title":"4. Supprimer un citoyen","text":"<p>Supprimez un citoyen de la base de donn\u00e9es avec son id. Attention pr\u00e9sentement dans la base de donn\u00e9es il n'y a aucune cl\u00e9s \u00e9trang\u00e8res entre les tables citoyen, citoyen_evenement et evenement. On peut donc supprimer un citoyen sans supprimer les \u00e9v\u00e8nements auxquelles il a particip\u00e9. Il faudrait s'assurer qu'en supprimant un citoyen, ses \u00e9v\u00e8nements soient aussi supprim\u00e9. \u00c0 vous de choisir l'approche que vous voulez (le faire dans la requ\u00eate suppression, supprimer en cascade depuis une cl\u00e9 \u00e9trang\u00e8re, etc.)</p> <p></p>"},{"location":"exercices/ex12_enonce/#5-quitter","title":"5. Quitter","text":"<p>On quitte la boucle et le programme.</p>"},{"location":"exercices/ex13_enonce/","title":"Exercice 13 - pyQt5","text":"<p>\u00c0 l'aide de la librairie pyQT5 et de la base de donn\u00e9es credit_social, cr\u00e9ez une interface graphique qui permettra de saisir un id de citoyen et de retourner son nom.</p>"},{"location":"exercices/ex13_enonce/#resultat","title":"R\u00e9sultat","text":"<ul> <li>On entre un id dans le textBox.</li> <li>En cliquant sur rechercher, on effectue une requ\u00eate \u00e0 la base de donn\u00e9es.</li> <li>On affiche le nom du citoyen sous le bouton.</li> </ul>"},{"location":"exercices/ex13_enonce/#exemple-de-code","title":"Exemple de code","text":"<p>L'exemple de code suivant va afficher une fen\u00eatre vide.</p> <pre><code># Pour pouvoir passer des arguments \u00e0 notre application\nimport sys\n# Les librairies PyQT5\nfrom PyQt5.QtCore import *\nfrom PyQt5.QtWidgets import *\nfrom PyQt5.QtGui import *\n\nclass MainWindow(QMainWindow):\n\n    def __init__(self):\n        super(MainWindow, self).__init__()\n\n        self.setWindowTitle(\"Oh la belle fen\u00eatre vide\")\n        self.setFixedSize(QSize(600, 300))\n\n# Une instance de QApplication, on doit en avoir absolument \n# une et seulement une par application \napp = QApplication(sys.argv)\n\n# Cr\u00e9ation de notre fen\u00eatre principale en appelant la fonction\n# MainWindow appel\u00e9 plus haut\nwindow = MainWindow()\n# Tr\u00e8s important de l'afficher car par d\u00e9faut elle est masqu\u00e9.\nwindow.show()\n\n# D\u00e9marre la boucle d'\u00e9v\u00e8nement. L'application va s'afficher.\napp.exec()\n</code></pre> <p>Exemple d'un classe MainWindows avec un bouton et un champ texte. Il y a un \u00e9v\u00e9nement sur le bouton pour appeler une fonction quand on le clique.</p> <pre><code>class MainWindows(QMainWindow):\n    def __init__(self):\n        super().__init__()\n\n        self.setWindowTitle(\"Mon App\")\n        self.setFixedSize(QSize(300, 300))\n\n        # On cr\u00e9e un widget qui va contenir les autres et on \n        # d\u00e9fini le type de layout \u00e0 utiliser\n        layout = QGridLayout()\n\n        # On cr\u00e9e un bouton avec le texte rechercher\n        bouton = QPushButton('Rechercher')\n        # On ajoute le bouton au widget layout \n        # \u00e0 la position 2,0 (troisi\u00e8me ligne, premi\u00e8re colonne)\n        layout.addWidget(bouton, 2, 0)\n\n        # On cr\u00e9e un widget label\n        self.resultat = QLabel('-')\n        # Formatage du texte\n        self.resultat.setAlignment(Qt.AlignCenter)\n        font = self.resultat.font()\n        font.setPointSize(12)\n        self.resultat.setFont(font)\n        self.resultat.setFixedHeight(100)\n        # On ajoute le label dans le layout\n        layout.addWidget(self.resultat, 3, 0)\n\n        # On associe l'\u00e9v\u00e9nement clic du bouton \u00e0 la fonction \n        # afficher_nom\n        bouton.clicked.connect(self.afficher_nom)\n\n        # On cr\u00e9e un container qui repr\u00e9sente le widget principal, \n        # tout le contenu de notre fen\u00eatre\n        container = QWidget()\n        # On y ajoute le widget layout\n        container.setLayout(layout)\n        # On d\u00e9fini le container comme le widget principal\n        self.setCentralWidget(container)\n\n    def afficher_nom(self):\n        self.resultat.setText('Mathieu Fr\u00e9chette')\n</code></pre>"},{"location":"exercices/ex14_enonce/","title":"Exercice 14 - qtDesigner","text":"<p>Vous devez cr\u00e9er un \u00e9cran avec qtDesigner qui permettra de cr\u00e9er un nouvel \u00e9v\u00e9nement dans la base de donn\u00e9es credit_social et du m\u00eame coup ajouter des citoyens qui \u00e9taient pr\u00e9sent.</p> <p>Voici une capture d'\u00e9cran de la disposition de la fen\u00eatre ainsi que des divers Widgets.</p> <p></p>"},{"location":"exercices/ex14_enonce/#widgets-a-utiliser","title":"Widgets \u00e0 utiliser","text":"<ul> <li>Liste des types d'\u00e9v\u00e9nements : QComboBox, la liste est aliment\u00e9 par le r\u00e9sultat d'une requ\u00eate de la table evenement_type.</li> <li>Date : QDateEdit, pour initialiser \u00e0 la date du jour : <code>self.inputDate.setDateTime(QDateTime.currentDateTime())</code></li> <li>Notes : QTextEdit</li> <li>Liste des citoyens pr\u00e9sents : QTableWidget, info ici</li> <li>Id du citoyen et score : QLineEdit</li> <li>Les boutons : QPushButton</li> </ul>"},{"location":"exercices/ex14_enonce/#comportement","title":"Comportement","text":""},{"location":"exercices/ex14_enonce/#initialisation-de-la-fenetre","title":"Initialisation de la fen\u00eatre","text":"<p>Au chargement de la fen\u00eatre, remplissez la liste d\u00e9roulante des types d'\u00e9v\u00e9nements avec les types pr\u00e9sents dans la table evenement_type. Ajouter le texte et aussi le id dans chaque item de la liste pour pouvoir utiliser le id lors de la cr\u00e9ation de l'\u00e9v\u00e9nement.</p>"},{"location":"exercices/ex14_enonce/#ajout-de-citoyen","title":"Ajout de citoyen","text":"<p>Pour ajouter un citoyen, on doit inscrire un id et optionnellement un score ajustement. Ensuite en cliquand sur le bouton Ajouter un requ\u00eate est fait \u00e0 la BD pour valider que le citoyen existe. Si oui ajoutez une ligne dans le tableau avec le id du citoyen, son nom complet ainsi que la valeur du score ajustement.</p> <p>On peut aussi s\u00e9lectionner un citoyen dans le tableau et cliquer sur le bouton Supprimer pour l'enlever de la liste. Si aucun citoyen n'est s\u00e9lectionn\u00e9, affichez un message d'erreur avec un QMessageBox.</p>"},{"location":"exercices/ex14_enonce/#creation-de-levenement","title":"Cr\u00e9ation de l'\u00e9v\u00e9nement","text":"<p>Quand on clique sur le bouton Cr\u00e9er l'\u00e9v\u00e9nement, commencez par cr\u00e9er l'\u00e9v\u00e9nement avec les informations du type, de la date et des notes. Ensuite, pour chaque citoyen dans le tableau, faite une entr\u00e9e dans la table citoyen_evenement. Si le score ajustement \u00e9tait rest\u00e9 vide, ins\u00e9rez Null dans la table. Utilisez None en Python pour simuler le Null lors de l'insertion.</p> <p>Finalement une fois les enregistrements faits, effacer les diff\u00e9rents champs et r\u00e9initialisez la date \u00e0 celle d'aujourd'hui.</p> <p> </p> La fen\u00eatre avec des donn\u00e9es"},{"location":"exercices/ex99_enonce/","title":"Exercices 09 - Op\u00e9rateurs logiques","text":"<p>\u00c0 partir de la base de donn\u00e9es credit_social, r\u00e9alisez les requ\u00eates suivantes. Vous devez utiliser l'op\u00e9rateur de la \"section\"  dans votre solution.</p>"},{"location":"exercices/ex99_enonce/#in","title":"IN","text":"<ol> <li>S\u00e9lectionnez tous les citoyens qui habitent \u00e0 Minneapolis,  Philadelphia ou Phoenix</li> <li>S\u00e9lectionnez tous les \u00e9v\u00e9nements qui sont de type  Manifestation ou Idees dissidentes.</li> <li>S\u00e9lectionnez tous les \u00e9v\u00e9nements qui sont de type Manifestation et qui ont eu lieu durant les mois de mars, avril et mai, peu importe l'ann\u00e9e.</li> <li>\u00c0 l'aide d'une sous-requ\u00eate, s\u00e9lectionnez tous les citoyens qui n'ont jamais particip\u00e9 \u00e0 une r\u00e9union du parti.</li> <li>\u00c0 l'aide d'une sous-requ\u00eate, s\u00e9lectionnez tous les citoyens de classe Epsilon qui ont d\u00e9j\u00e0 particip\u00e9 \u00e0 une manifestation.</li> </ol>"},{"location":"exercices/ex99_enonce/#like","title":"LIKE","text":"<ol> <li>S\u00e9lectionnez tous les citoyens dont les initiales sont MF.</li> <li>S\u00e9lectionnez tous les citoyens dont le pr\u00e9nom est compos\u00e9 d'exactement 3 caract\u00e8res.</li> <li>S\u00e9lectionnez tous les citoyens qui ont la s\u00e9rie -6935- dans leur code PIN.</li> <li>S\u00e9lectionnez tous les citoyens qui ont particip\u00e9 \u00e0 un \u00e9v\u00e9nement et que dans la note de l'\u00e9v\u00e9nement on retrouve le mot math. </li> <li>S\u00e9lectionnez tous les citoyens dont le code PIN commence par deux caract\u00e8res, peut-importe lesquels, et ensuite contient les caract\u00e8res 6c4b66. Le reste du code peut \u00eatre n'importe quoi.</li> </ol>"},{"location":"exercices/ex99_enonce/#group-by","title":"GROUP BY","text":"<ol> <li>Calculez le nombre de citoyen par classe. Affichez comme r\u00e9sultat le titre de la classe et le nombre de citoyen. Si la classe \u00e0 aucun citoyen, afficher 0;</li> <li>S\u00e9lectionnez les manifestations qui avait plus de 5 participants qui furent arr\u00eat\u00e9. (Une entr\u00e9e a \u00e9t\u00e9 cr\u00e9\u00e9 dans la table \u00e9v\u00e9nement).</li> <li>Calculer la moyenne des scores de cr\u00e9dit social pour chaque d\u00e9nonciation.</li> <li>S\u00e9lectionnez citoyen qui a le plus haut score de cr\u00e9dit social. Le r\u00e9sultat doit contenir son nom, pr\u00e9nom et score. N'utilisez pas de GROUP BY pour cette requ\u00eate, allez-y avec ce que vous voulez.</li> <li>Calculer la somme des scores de cr\u00e9dit social pour tous les participants de la r\u00e9union du parti du 2021-07-17. Il y a eu plusieurs r\u00e9unions cette journ\u00e9e, soit vous en cibler qu'un avec aussi l'heure ou bien vous faite la somme de toutes les r\u00e9unions de cette journ\u00e9e.</li> </ol>"},{"location":"exercices/ex99_enonce/#exists","title":"EXISTS","text":"<ol> <li>S\u00e9lectionnez tous les citoyens qui r\u00e9sident au Qu\u00e9bec. (Ce n'est pas tr\u00e8s optimal comme requ\u00eate mais c'est pour pratiquer le exists).</li> <li>S\u00e9lectionnez tous les citoyens qui n'ont jamais eu de r\u00e9alignement sanitaire.</li> <li>S\u00e9lectionnez tous les citoyens qui n'ont jamais particip\u00e9 \u00e0 aucun \u00e9v\u00e9nement.</li> <li>Faites une mise \u00e0 jour du code pin de tous les citoyens de la ville de Madrid. Remplacer le premier caract\u00e8re par un x. Vous pouvez vous servir de la fonction concat() et right(). La difficult\u00e9 ici est qu'on ne peut pas faire de update avec dans le where une sous-requ\u00eate sur la m\u00eame table. </li> <li>Faites une mise \u00e0 jour de la colonne score_ajustement de la table citoyen_evenement pour tous les \u00e9v\u00e9nement de type d\u00e9nonciation. La valeur de score_ajustement devra \u00eatre un nombre g\u00e9n\u00e9r\u00e9 al\u00e9atoirement entre 25 et 100.</li> </ol>"},{"location":"exercices/ex99_enonce/#procedures-stockees-et-fonctions","title":"Proc\u00e9dures stock\u00e9es et fonctions","text":"<ol> <li>Cr\u00e9ez une proc\u00e9dure stock\u00e9e qui va s\u00e9lectionner, pour un citoyen (le id du citoyen sera re\u00e7u en param\u00e8tre) donn\u00e9, le nombre de fois qu'il a particip\u00e9 \u00e0 chacun des types d'\u00e9v\u00e9nements. Le r\u00e9sultat devra comporter le id du citoyen, son nom et pr\u00e9nom, et une colonne par \u00e9v\u00e9nement (elles peuvent \u00eatre \"hardcod\u00e9\").</li> <li>Cr\u00e9ez une fonction qui va valider le code PIN d'un citoyen. Le id du citoyen sera re\u00e7u en param\u00e8tre. La structure valide du code pin est AAAAAAAA-AAAA-AAAA-AAAA-AAAAAAAAAAAA (A = caract\u00e8re alphanum\u00e9rique). Utilisez la fonction REGEX pour valider le PIN. La valeur de retour doit \u00eatre TRUE si le pin est valide, sinon FALSE.</li> </ol>"},{"location":"exercices/examen01_revision_a/","title":"Examen 1 - R\u00e9vision A","text":""},{"location":"exercices/examen01_revision_a/#consignes","title":"Consignes","text":"<p>\u00c0 partir de la mise en situation suivante, vous devez produire un sch\u00e9ma conceptuel qui r\u00e9pondra aux normes suivantes: </p> <ul> <li>Le sch\u00e9ma respecte les exigences de la mise en situation.</li> <li>La multiplicit\u00e9 des associations est juste.</li> <li>Le sch\u00e9ma respecte les normes de conception.</li> </ul> <p>On va faire une auto-correction de vos sch\u00e9mas ensemble en classe.</p>"},{"location":"exercices/examen01_revision_a/#mise-en-situation","title":"Mise en situation","text":"<p>L'entreprise qui vous emploie d\u00e9veloppe une plateforme Web de vente de musique appel\u00e9e GroupCamp. Le principe du service est que les artistes  peuvent proposer leur album au prix qu'ils d\u00e9cident. L'acheteur peut ensuite d\u00e9cider de payer le prix demand\u00e9 ou bien plus cher s'il veut encourager  l'artiste. Vous \u00eates en charge de produire une premi\u00e8re \u00e9bauche d'enregistrement des informations dans une base de donn\u00e9es MySQL. Pour l'instant, tout le volet transactionnel et s\u00e9curit\u00e9 ne sera pas pris en charge par votre mod\u00e8le, vous devez seulement vous concentrer sur les \u00e9l\u00e9ments suivants.</p> <p>Les artistes seront invit\u00e9s \u00e0  s'inscrire \u00e0 notre service en nous fournissant leur nom (nom d'artiste ou nom du groupe), une image qui les  repr\u00e9sente ainsi que la localisation d'o\u00f9 ils proviennent. La localisation est  un court texte o\u00f9 ils peuvent entrer une information du genre \"Victoriaville,  Qu\u00e9bec\", \"Californie\", \"Le garage chez Fred\", etc. </p> <p>Ensuite bien s\u00fbr les artistes vont nous informer sur les albums qui vont mettre en vente. Chaque album  comporte un titre, une description, une date de parution et une image. Que ce soit pour l'image de l'artiste ou de l'album, nous allons sauvegarder l'URL de l'image qui sera stock\u00e9e sur un de nos serveurs. L'artiste va aussi nous indiquer le prix minimum qu'il demande pour l'album. Pour l'instant, tous les  montants seront en devise canadienne. L'album comportera une ou plusieurs pistes, dont on enregistrera son titre, son ordre dans l'album et sa dur\u00e9e en secondes.</p> <p>Pour chaque album l'artiste  peut ajouter une s\u00e9rie de mots-cl\u00e9s qui d\u00e9finit le type de musique de l'album.  Il pourra choisir parmi la liste des mots-cl\u00e9s de tous les albums de tous les artistes ou en entrer de nouveaux. Le but \u00e9tant de permettre ensuite \u00e0 l'utilisateur de faire une recherche par mot-cl\u00e9. Cette option n'est pas obligatoire, l'artiste pourrait n\u2019en ajouter aucun \u00e0 l'album. Les mots-cl\u00e9s peuvent aussi varier d'un album \u00e0 l'autre du m\u00eame artiste. De plus, parmi tous les mots-cl\u00e9s choisis pour l'album, l'artiste peut en d\u00e9finir un qui sera \"principal\", ce mot-cl\u00e9 sera mis de l'avant \u00e0 l'affichage et lors des recherches. Un album ne peut pas avoir plus d'un mot-cl\u00e9 principal.</p> <p>Parlons maintenant du volet utilisateur. N'importe qui peut se cr\u00e9er un compte sur notre service. La personne devra nous fournir un nom d'usager et si elle le veut un court texte d'un maximum de 500 caract\u00e8res qui la d\u00e9crit. Le nom d'usager doit \u00eatre unique dans la base de donn\u00e9es.</p> <p>Quand un utilisateur ach\u00e8te un album, celui-ci va \u00eatre stock\u00e9 dans sa \"collection\". On va y sauvegarder le prix que l'usager a pay\u00e9. Il pourra aussi s'il le d\u00e9cide indiquer sa piste pr\u00e9f\u00e9r\u00e9e de l'album et laisser un commentaire sur l'album en g\u00e9n\u00e9rale qui sera affich\u00e9 sur la page de description de l'album. L'usager aura aussi la possibilit\u00e9 de se  cr\u00e9er une liste de souhaits d'album qu'il aime, mais qu'il n'a pas encore achet\u00e9. Dans ce cas, on enregistre uniquement un lien vers l'album. Si l'usager ach\u00e8te un album de sa liste de souhaits, il disparaitra de celle-ci.</p>"},{"location":"exercices/ff_enonce/","title":"Formatif formel","text":""},{"location":"exercices/ff_enonce/#consignes","title":"Consignes","text":"<ul> <li>Vous avez droit \u00e0 toutes vos notes et Internet.</li> <li>Aucune communication n'est permise (messagerie, courriel, etc.). Un \u00e9l\u00e8ve pris en flagrant d\u00e9lit se verra attribuer la note de 0 pour plagiat.</li> <li>La dur\u00e9e de l'examen est de 1h50.</li> <li>Une fois l\u2019examen termin\u00e9, vous devez me remettre vos fichiers image via le devoir de l\u2019examen sur Teams. </li> <li>Il est de votre devoir de vous assurer que votre fichier est inclus dans la remise. Aucun fichier ne sera accept\u00e9 une fois que vous aurez quitt\u00e9 le lieu de l'examen. </li> </ul>"},{"location":"exercices/ff_enonce/#mise-en-situation","title":"Mise en situation","text":"<p>Le centre de recherche xLabs se sp\u00e9cialise dans des recherches dites marginales. Elle emploie une pl\u00e9thore de cobayes pour ses diff\u00e9rents projets et pr\u00e9sentement il est difficile de garder une trace de l'\u00e9tat de tous ces \"volontaires\". La direction vous a donn\u00e9 le mandat de mod\u00e9liser leur op\u00e9ration.</p> <p>Pour chaque cobaye, on veut connaitre sa date de naissance, la date \u00e0 laquelle il a commenc\u00e9 sa premi\u00e8re exp\u00e9rience et aussi sa date de d\u00e9c\u00e8s s'il y a lieu, car chez xlabs on est cobaye \u00e0 vie. Un surnom et un num\u00e9ro d'identification unique est attribu\u00e9 aux cobayes. Par contre ce num\u00e9ro peut \u00eatre r\u00e9utilis\u00e9 \u00e0 la mort du cobaye.</p> <p>Les cobayes peuvent participer \u00e0 plus d'une exp\u00e9rience \u00e0 la fois et chaque exp\u00e9rience doit comporter au minimum un cobaye mais peut en avoir plusieurs. On veut connaitre la date de d\u00e9but et de fin de la participation de chaque cobaye \u00e0 chaque exp\u00e9rience. Chaque exp\u00e9rience \u00e0 un titre, un niveau de s\u00e9curit\u00e9 qui se situe entre 0 et 10 et une courte description qui d\u00e9fini le sujet de l'exp\u00e9rience. Un ou plusieurs chercheurs peuvent \u00eatre associ\u00e9s \u00e0 une exp\u00e9rience et un chercheur peut participer \u00e0 plus d'une exp\u00e9rience \u00e0 la fois. Parmi les chercheurs impliqu\u00e9s, un r\u00f4le est attribu\u00e9 \u00e0 chacun. Il y a pr\u00e9sentement trois r\u00f4les disponible (directeur de recherche, assistant, appariteur) mais il n'est pas impossible que \u00e7a change dans l'avenir. Le r\u00f4le d'un chercheur peut aussi varier d'une exp\u00e9rience \u00e0 l'autre. Au niveau des chercheurs, on veut connaitre uniquement leur nom et leur num\u00e9ro d'identification personnelle. </p> <p>Durant le temps que dure une exp\u00e9rience, les chercheurs vont faire des observations. Pour chaque observation, il y a un chercheur impliqu\u00e9, un cobaye, une exp\u00e9rience, une date d'observation et les notes de l'observation. </p> <p>Afin de s'assurer de la bonne rentabilit\u00e9 des cobayes, un chercheur effectue chaque jour une \u00e9valuation g\u00e9n\u00e9rale de ceux-ci. L'\u00e9valuation consiste uniquement en une prise de notes. On veut donc conserver pour chaque \u00e9valuation le cobaye \u00e9valu\u00e9, le chercheur impliqu\u00e9, la date de l'\u00e9valuation ainsi que les notes prises. </p>"},{"location":"exercices/ff_enonce/#directives","title":"Directives","text":"<p>\u00c0 partir de cette mise en situation vous devez cr\u00e9er: </p> <ol> <li>Un schema conceptuel en format image portant le nom NomPrenom_shema</li> <li>Un diagramme de classes en format image portant le nom NomPrenom_diagramme</li> <li>Un script de cr\u00e9ation des tables portant le nom NomPrenom_script</li> </ol>"},{"location":"exercices/ff_enonce/#schema-conceptuelle","title":"Sch\u00e9ma conceptuelle","text":"<ul> <li>La multiplicit\u00e9 des associations doit \u00eatre inscrite. </li> </ul>"},{"location":"exercices/ff_enonce/#diagramme-de-classes","title":"Diagramme de classes","text":"<ul> <li>Votre diagramme doit r\u00e9pondre aux r\u00e8gles de la troisi\u00e8me forme normale.</li> <li>Vous devez respecter la convention de nomenclature telle que d\u00e9crite dans les notes de cours \"Convention de nommage MySQL\".</li> </ul>"},{"location":"exercices/ff_enonce/#script-sql","title":"Script SQL","text":"<ul> <li>Le script SQL doit pouvoir \u00eatre lanc\u00e9 \u00e0 plusieurs reprises sans causer d'erreurs.</li> <li>Vous devez cr\u00e9er toutes les tables et les champs de votre diagramme.</li> <li>Les cl\u00e9s primaires et \u00e9trang\u00e8res doivent aussi \u00eatre cr\u00e9es.</li> </ul>"},{"location":"exercices/ff_enonce/#grille-de-correction","title":"Grille de correction","text":"\u00c9l\u00e9ments Atteint Satisfaisant Faible Non-atteint Sh\u00e9ma conceptuel Le sch\u00e9ma respecte la mise en situation 40 28 16 0 La multiplicit\u00e9 des associations est juste 10 7 4 0 Le sch\u00e9ma respecte les normes de conception 5 4 2 0 Diagramme de classes Les relations entrent les tables sont juste 10 7 4 0 Le diagramme respecte la troisi\u00e8me forme normale 10 7 4 0 Les type de donn\u00e9es sont juste 10 7 4 0 Script SQL Le script peut \u00eatre lanc\u00e9 sans causer d'erreurs 5 4 2 0 Toutes les informations n\u00e9cessaires sont cr\u00e9\u00e9es 10 7 4 0"},{"location":"exercices/ldvelh_enonce/","title":"Livre dont vous \u00eates le h\u00e9ro","text":""},{"location":"exercices/ldvelh_enonce/#description-de-lexercice","title":"Description de l'exercice","text":"<p>L'objectif du projet est de cr\u00e9er une application qui permettra de lire et de naviguer dans un livre dont vous \u00eates le h\u00e9ros.</p> <ul> <li>Vous devez faire l'analyse du cas et me produire un diagramme de classes UML de cette analyse. </li> <li>Ensuite cr\u00e9ez la base de donn\u00e9es en lien avec votre analyse. Je vais vous fournir le texte d'un livre divis\u00e9 en chapitres pour l'inclure dans la base de donn\u00e9es ainsi que les liens entre les chapitres sous deux scripts SQL. Libre \u00e0 vous de modifier ou non ces fichiers. </li> <li>Finalement vous allez d\u00e9velopper une application fonctionnelle en python avec une interface graphique. </li> </ul> <p>L'exercice sera \u00e9valu\u00e9 et comptera pour 15% de la note finale. L'exercice se fera individuellement. </p>"},{"location":"exercices/ldvelh_enonce/#remise-de-lexercice","title":"Remise de l'exercice","text":"<p>Cr\u00e9ez un d\u00e9p\u00f4t Github de l'exercice \u00e0 l'int\u00e9rieur duquel vous allez avoir les \u00e9l\u00e9ments suivants : </p> <ul> <li>Dans un r\u00e9pertoire nomm\u00e9 ressources, votre diagramme de classes ainsi que les scripts SQL n\u00e9cessaires \u00e0 la cr\u00e9ation de votre base de donn\u00e9es et \u00e0 l'insertion des donn\u00e9es une fois l'application fonctionnel.</li> <li>Le code de votre application.</li> <li>La remise du projet se fera durant le cours du 27 novembre 2023 durant lequel vous allez me pr\u00e9senter votre application.</li> </ul>"},{"location":"exercices/ldvelh_enonce/#analyse-du-cas","title":"Analyse du cas","text":"<p>Les points suivants du livre  doivent \u00eatre couverts par votre analyse :</p> <ul> <li>Le texte du livre divis\u00e9 entre chapitres ainsi que le principe de navigation entre les chapitres. (Pour chaque chapitre il n'y a qu'un choix restreint de chapitres auxquels on peut acc\u00e9der)</li> <li>Pour l'instant on n'aura qu'un livre dans l'application, mais on pourrait en avoir plusieurs. On va prendre pour acquis que tout les livres auraient la m\u00eame fiche de personnage.</li> <li>La fiche du personnage (feuille d'aventure \u00e0 la page 5 et le haut de la page 6). Pour les sections disciplines Kai et Armes, les valeurs qu'on peut y entrer doivent provenir d'une liste de choix, celle-ci est d\u00e9crite plus loin dans le livre. (\u00c0 partir de la page 9 pour les disciplines et 11 pour les armes)</li> <li>On ne couvrira pas le syst\u00e8me de r\u00e8gles, \u00e7a sera \u00e0 l'usager de le faire manuellement. (Combat, perte d'endurance, etc...)</li> <li>Vous pouvez traiter les cellules objets, repas, objets sp\u00e9ciaux et bourse comme des champs texte.</li> <li>On doit pouvoir enregistrer notre progression dans le livre et faire plusieurs parties en m\u00eame temps.</li> </ul> <p>Votre analyse doit respecter les r\u00e8gles de la troisi\u00e8me forme normale, \u00e0 moins de cas d'exception qui devront \u00eatre justifi\u00e9s.</p>"},{"location":"exercices/ldvelh_enonce/#diagramme-de-classes","title":"Diagramme de classes","text":"<ul> <li>Le diagramme de classes doit respecter votre analyse. </li> <li>Les normes de nomenclature d\u00e9fini dans les notes de cours doivent \u00eatre suivi.</li> </ul>"},{"location":"exercices/ldvelh_enonce/#base-de-donnees","title":"Base de donn\u00e9es","text":"<p>Il n'y a pas de minimum ou maximum quand aux nombre de tables \u00e0 avoir, mais vous devez inclure les \u00e9l\u00e9ments suivants : </p> <ul> <li>Un usager avec des droits restreint qui sera utilis\u00e9 par l'application. Pour les droits, allez-y au minimum, seulement les tables et commandes n\u00e9cessaires au fonctionnement de l'application. </li> <li>Vous devez au minimum inclure 2 proc\u00e9dures stock\u00e9es, fonctions ou triggers (Une fonction et un trigger, une proc\u00e9dure stock\u00e9e et une fonction, deux triggers, etc...).</li> </ul>"},{"location":"exercices/ldvelh_enonce/#application","title":"Application","text":"<p>L'application doit \u00eatre programm\u00e9 avec pyqt5 et comporter les fonctionnalit\u00e9s suivantes : </p> <ul> <li>Lire un livre et naviguer entre ses chapitres selon leur num\u00e9ro.</li> <li>Permettre \u00e0 l'usager de modifier sa fiche de personnage.</li> <li>Sauvegarde notre progression de lecture, (num\u00e9ro de chapitre, feuille d'aventure)</li> <li>Supprimer une sauvegarde.</li> </ul>"},{"location":"exercices/ldvelh_enonce/#ressources","title":"Ressources","text":"<ul> <li>Loup solitaire T.1 : Le livre de r\u00e9f\u00e9rence</li> <li>insert_chapitre.sql : Les textes de chaque chapitre</li> <li>insert_lien_chapitre.sql : Les liens du chapitre vers les autres</li> </ul>"},{"location":"exercices/ldvelh_enonce/#grille-de-correction","title":"Grille de correction","text":"Crit\u00e8res R\u00e9ussi Satisfaisant insatisfaisant Points Les scripts SQL de cr\u00e9ation de tables et d'insertion de donn\u00e9es sont fonctionnels et couvrent l'ensemble de l'application. 2 1 0 /2 Le diagramme de classes respecte les points \u00e0 couvrir de l'analyse de cas et les normes de nomenclature d\u00e9finies dans les notes de cours. 3 1 0 /3 Un usager avec des droits restreints est utilis\u00e9 pour la connexion entre l'application et la base de donn\u00e9es. Sa cr\u00e9ation est incluse dans les scripts SQL remis. 2 1 0 /2 La base de donn\u00e9es comportent 2 proc\u00e9dures stock\u00e9es, fonctions ou triggers. 2 1 0 /2 L'application permet de lire un livre et de naviguer entre les chapitres par leur num\u00e9ro. 2 1 0 /2 L'application permet \u00e0 l'usager de modifier manuellement la feuille de personnage du livre. 3 1 0 /3 L'application permet de sauvegarder la progression de lecture (le chapitre en cours) et la feuille de personnage. 4 2 0 /4 L'application permet de supprimer une sauvegarde 2 1 0 /2 Total /20"},{"location":"exercices/corrige/ex05_corrige/","title":"Exercice 4 - INSERT","text":"<p>\u00c0 partir de la base de donn\u00e9es athl\u00e8te de l'exercice 01, (le script sql de g\u00e9n\u00e9ration est disponible ici), r\u00e9alisez les requ\u00eates d'insertion suivante.</p> <ol> <li>Ins\u00e9rez-vous dans la table athl\u00e8te sans sp\u00e9cifier les noms de colonnes dans la requ\u00eate.</li> <li>Ins\u00e9rez un autre athl\u00e8te fictif mais en sp\u00e9cifiant seulement son nom, pr\u00e9nom et la date de naissance.</li> <li>R\u00e9cup\u00e9rez le id qui a \u00e9t\u00e9 g\u00e9n\u00e9r\u00e9 automatiquement lors de la requ\u00eate pr\u00e9c\u00e9dente et faites afficher avec une requ\u00eate SELECT le message suivant : \"L'athl\u00e8te [prenom] [nom] a \u00e9t\u00e9 ajout\u00e9 avec succ\u00e8s!\". Utilisez le id r\u00e9cup\u00e9r\u00e9 dans la clause WHERE de votre requ\u00eate.</li> <li>Cr\u00e9ez une nouvelle table appel\u00e9 athlete_quebec avec les colonnes suivante ( id cl\u00e9 primaire auto-incr\u00e9ment\u00e9, nom, pr\u00e9nom, ville )</li> <li>Ins\u00e9rez dans cette table tous les athl\u00e8tes qui proviennent de la province du Qu\u00e9bec \u00e0 l'aide d'une requ\u00eate select.</li> </ol> <p>Je veux que vous me remettiez les requ\u00eates dans un script SQL avec pour chaque requ\u00eate d'insertion une requ\u00eate select qui va valider que les donn\u00e9es ont bien \u00e9t\u00e9 ajout\u00e9.</p>"},{"location":"exercices/corrige/ex05_corrige/#corrige","title":"Corrig\u00e9","text":"<pre><code>-- 1. Ins\u00e9rez-vous dans la table athl\u00e8te sans sp\u00e9cifier les noms de colonnes \n--    dans la requ\u00eate.\nINSERT INTO athlete \nVALUES (501,\n        'Fr\u00e9chette',\n        'Mathieu',\n        '1980-01-01', \n        '1 rue Street', \n        'Princeville', \n        'Qu\u00e9bec', \n        'Canada', \n        'math.frechette@gmail.com');\n\nSELECT * FROM athlete WHERE id = 501; \n\n-- 2. Ins\u00e9rez un autre athl\u00e8te fictif mais en sp\u00e9cifiant seulement son nom, \n--    pr\u00e9nom et la date de naissance.\nINSERT INTO athlete (nom, prenom, date_naissance) \nVALUES ('Fr\u00e9chette','Mathieu 2','1980-01-01');\n\nSELECT * FROM athlete WHERE id = LAST_INSERT_ID() ;\n\n-- 3. R\u00e9cup\u00e9rez le id qui a \u00e9t\u00e9 g\u00e9n\u00e9r\u00e9 automatiquement lors de la requ\u00eate \n--    pr\u00e9c\u00e9dente et faites afficher avec une requ\u00eate SELECT le message \n--    suivant : \"L'athl\u00e8te [prenom] [nom] a \u00e9t\u00e9 ajout\u00e9 avec succ\u00e8s!\". Utilisez \n--    le id r\u00e9cup\u00e9r\u00e9 dans la clause WHERE de votre requ\u00eate.\nSELECT CONCAT(\"L'athl\u00e8te \", a.prenom, \" \", a.nom, \" a \u00e9t\u00e9 ajout\u00e9 avec succ\u00e8s!\")\nFROM athlete a \nWHERE a.id = LAST_INSERT_ID();\n\n-- 4. Cr\u00e9ez une nouvelle table appel\u00e9 athlete_quebec avec les colonnes \n--    suivante ( id cl\u00e9 primaire auto-incr\u00e9ment\u00e9, nom, pr\u00e9nom, ville )\nCREATE TABLE IF NOT EXISTS athlete_quebec (\n    id INT AUTO_INCREMENT NOT NULL,\n    nom VARCHAR(50),\n    prenom VARCHAR(50),\n    ville VARCHAR(50),\n    CONSTRAINT PRIMARY KEY (id)\n);\n\n-- 5. Ins\u00e9rez dans cette table tous les athl\u00e8tes qui proviennent de la \n--    province du Qu\u00e9bec \u00e0 l'aide d'une requ\u00eate select.\nINSERT INTO athlete_quebec (nom, prenom, ville)\nSELECT a.nom, a.prenom, a.ville \nFROM athlete a\nWHERE a.province = \"Qu\u00e9bec\"; \n\nSELECT * FROM athlete_quebec;\n</code></pre>"},{"location":"exercices/corrige/ex06_enonce/","title":"Exercice 6 - VIEW","text":"<p>\u00c0 partir de la base de donn\u00e9es athl\u00e8te de l'exercice 01, (le script sql de g\u00e9n\u00e9ration est disponible ici), creez les views suivantes : </p> <ol> <li>Cr\u00e9ez une view nomm\u00e9e resultat_hhmmss qui affiche le r\u00e9sultat format\u00e9 en heures, minutes, secondes (hh:mm:ss). Les colonnes de la view doivent \u00eatre les m\u00eames que la table resultat mais en ajoutant une colonne nomm\u00e9e resultat_hhmmss dans laquelle le calcul sera fait (id, athlete_id, epreuve_id, date_resultat, resultat_ms, resultat_hhmmss).</li> <li>Cr\u00e9ez une view nomm\u00e9e athlete_complet qui, en combinant les tables n\u00e9cessaires, affiche les athl\u00e8tes avec les colonnes suivantes, (id, nom pr\u00e9nom concat, date_epreuve, nom_epreuve, r\u00e9sultat). Attention, je veux que les noms de colonnes de la view soit identique \u00e0 ce que je demande entre parenth\u00e8se)</li> <li>\u00c0 partir de la view pr\u00e9c\u00e9dente, athlete_complet, s\u00e9lectionn\u00e9 les informations des athl\u00e8tes qui ont particip\u00e9 \u00e0 un marathon. </li> <li>Cr\u00e9ez une view nomm\u00e9e resultat_21juillet2020 qui va contenir toutes les informations de la table r\u00e9sultat mais uniquement pour la date du 21 juillet 2020.</li> <li>Modifier la view resultat_21juillet2020 pour qu'elle affiche les r\u00e9sultats du 14 juillet 2019. Modifier aussi son nom pour resultat_14juillet2019</li> <li>Supprimer la view resultat_14juillet2019</li> </ol> <p>Je veux que vous me remettiez les requ\u00eates dans un script SQL.</p>"},{"location":"exercices/corrige/ex06_enonce/#corrige","title":"Corrig\u00e9","text":"<pre><code>-- #1\nCREATE OR REPLACE VIEW resultat_hhmmss\nAS \n    SELECT r.id,\n           r.athlete_id,\n           r.epreuve_id,\n           r.date_resultat,\n           r.resultat_ms,\n           TIME_FORMAT(SEC_TO_TIME(r.resultat_ms / 1000), '%H:%i:%s') AS resultat_hhmmss \n    FROM resultat r;\n\n-- #2\nCREATE OR REPLACE VIEW athlete_complet \n(id, nom, date_epreuve, nom_epreuve, resultat)\nAS \n    SELECT a.id,\n           CONCAT(a.prenom, ' ', a.nom),\n           rh.date_resultat,\n           e.description,\n           rh.resultat_hhmmss \n    FROM athlete a \n        INNER JOIN resultat_hhmmss rh ON rh.athlete_id = a.id \n            INNER JOIN epreuve e ON e.id = rh.epreuve_id;\n-- J'ai r\u00e9utiliser ici la view cr\u00e9\u00e9 au num\u00e9ro 1 pour vous montrer \n-- qu'on peut tr\u00e8s bien utiliser une view dans une view\n\n-- #3\nSELECT *\nFROM athlete_complet ac \nWHERE ac.nom_epreuve = 'Marathon';\n\n-- #4\nCREATE OR REPLACE VIEW resultat_21juillet2020\nAS\n    SELECT *\n    FROM resultat r \n    WHERE r.date_resultat = '2020-07-21';\n\n-- #5\nALTER VIEW resultat_21juillet2020\nAS\n    SELECT *\n    FROM resultat r \n    WHERE r.date_resultat = '2019-07-14';\n\nRENAME TABLE resultat_21juillet2020 TO resultat_14juillet2019;\n\n-- #6\nDROP VIEW IF EXISTS resultat_14juillet2019;\n</code></pre>"},{"location":"exercices/corrige/ex07_corrige/","title":"Exercice 7 - Corrig\u00e9","text":""},{"location":"exercices/corrige/ex07_corrige/#question-1","title":"Question #1","text":"<pre><code>/*\n * Pour chaque modification \u00e0 la table resultat, ins\u00e9rez les informations n\u00e9cessaires dans la table \n * resultat_log APR\u00c8S l'ex\u00e9cution de la requ\u00eate INSERT, UPDATE et DELETE. Attention, lors d'un UPDATE, \n * ajoutez les informations seulement si la colonne resultat_ms a \u00e9t\u00e9 modifi\u00e9.\n */\n\nDELIMITER $$\n\n-- Ajout lors d'un INSERT \nDROP TRIGGER IF EXISTS resultat_after_insert$$\nCREATE TRIGGER resultat_after_insert\n    AFTER INSERT \n    ON resultat FOR EACH ROW \n\n    BEGIN \n\n        INSERT INTO resultat_log (operation, ancien_resultat, nouveau_resultat, resultat_id, date_operation)\n        VALUES ('insert', null, NEW.resultat_ms, NEW.id, NOW());\n\n    END$$\n\n\n-- Ajout lors d'un UPDATE \nDROP TRIGGER IF EXISTS resultat_after_update$$\nCREATE TRIGGER resultat_after_update\n    AFTER UPDATE \n    ON resultat FOR EACH ROW \n\n    BEGIN \n\n        IF (OLD.resultat_ms &lt;&gt; NEW.resultat_ms) THEN \n            INSERT INTO resultat_log (operation, ancien_resultat, nouveau_resultat, resultat_id, date_operation)\n            VALUES ('update', OLD.resultat_ms, NEW.resultat_ms, OLD.id, NOW());\n        END IF;\n\n    END$$\n\n\n-- Ajout lors d'un DELETE \nDROP TRIGGER IF EXISTS resultat_after_delete$$\nCREATE TRIGGER resultat_after_delete\n    AFTER DELETE \n    ON resultat FOR EACH ROW \n\n    BEGIN \n\n        INSERT INTO resultat_log (operation, ancien_resultat, nouveau_resultat, resultat_id, date_operation)\n        VALUES ('delete', OLD.resultat_ms, null, OLD.id, NOW());\n\n    END$$\n\n\nDELIMITER ;\n</code></pre>"},{"location":"exercices/corrige/ex07_corrige/#question-2","title":"Question #2","text":"<pre><code>/*\n * Quand on ajoute un r\u00e9sultat, validez AVANT l'ajout que la valeur de la colonne cree_par existe \n * dans la table usager. Si la valeur est invalide, emp\u00eachez la requ\u00eate INSERT et retournez un message \n * d'erreurs ( Regardez du c\u00f4t\u00e9 de SIGNAL en MySQL)\n */\n\nDELIMITER $$\n\nDROP TRIGGER IF EXISTS resultat_before_insert$$\nCREATE TRIGGER resultat_before_insert\n    BEFORE INSERT \n    ON resultat FOR EACH ROW \n\n    BEGIN \n\n        IF NOT EXISTS (SELECT id FROM usager WHERE id = NEW.cree_par) THEN\n            SIGNAL SQLSTATE '45000'\n            SET MESSAGE_TEXT = 'Le id usager est inconnu';\n        END IF;\n\n    END$$\n\nDELIMITER ;\n</code></pre>"},{"location":"exercices/corrige/ex07_corrige/#question-3","title":"Question #3","text":"<pre><code>/* \n * Effectuez les m\u00eames op\u00e9rations que la question #2 quand on modifie un r\u00e9sultat mais sur la colonne modifie_par.\n */\n\nDELIMITER $$\n\nDROP TRIGGER IF EXISTS resultat_before_update$$\nCREATE TRIGGER resultat_before_update\n    BEFORE UPDATE \n    ON resultat FOR EACH ROW \n\n    BEGIN \n        IF NOT EXISTS (SELECT id FROM usager WHERE id = NEW.modifie_par) THEN\n            SIGNAL SQLSTATE '45000'\n            SET MESSAGE_TEXT = 'Le id usager est inconnu';\n        END IF;\n\n    END$$\n\nDELIMITER ;\n</code></pre>"},{"location":"exercices/corrige/ex07_corrige/#question-4","title":"Question #4","text":"<pre><code>/*\n * AVANT l'insertion ou la modification de la description d'une \u00e9preuve dans la table epreuve_type, \n * valider que la description n'est pas d\u00e9j\u00e0 utilis\u00e9. Si oui, modifiez la valeur \u00e0 ajouter ou modifier \n * en ajoutant (x) \u00e0 la description. ( x vaudra le nombre de fois que le nom se \n * retrouve dans la table -1 ) Ex. On veut ins\u00e9rer Marathon comme valeur mais elle est d\u00e9j\u00e0 pr\u00e9sente \n * comme description dans la table. On va utiliser Marathon (1) comme nouvelle valeur \u00e0 ins\u00e9rer.  \n */\n\n\nDELIMITER $$\n\nDROP TRIGGER IF EXISTS epreuve_type_before_insert$$\nCREATE TRIGGER epreuve_type_before_insert\n    BEFORE INSERT\n    ON epreuve_type FOR EACH ROW \n\n    BEGIN \n\n        DECLARE nb_occurence INT DEFAULT 0;\n\n        SELECT count(*) \n        INTO nb_occurence \n        FROM epreuve_type \n        WHERE description = NEW.description \n              OR description LIKE CONCAT(NEW.description, ' (%)');\n\n        IF nb_occurence &gt; 0 THEN\n            SET NEW.description = CONCAT(NEW.description, \" (\", nb_occurence, \")\");\n        END IF;\n\n    END$$\n\nDELIMITER ;\n</code></pre>"},{"location":"exercices/corrige/ex08_corrige/","title":"Exercice 7 - Corrig\u00e9","text":""},{"location":"exercices/corrige/ex08_corrige/#resultathms","title":"resultatHMS","text":"<pre><code>DROP FUNCTION IF EXISTS resultatHMS;\n\nDELIMITER $$\n\nCREATE FUNCTION resultatHMS(_resultat_ms INTEGER)\nRETURNS VARCHAR(20)\nDETERMINISTIC\nBEGIN\n\n    RETURN TIME_FORMAT(SEC_TO_TIME(_resultat_ms / 1000), '%H:%i:%s');\n\nEND$$\n\nDELIMITER ;\n</code></pre> <pre><code>DROP FUNCTION IF EXISTS moyenne5k;\n\nDELIMITER $$\n\nCREATE FUNCTION moyenne5k(_athlete_id INTEGER)\nRETURNS VARCHAR(20)\nNOT DETERMINISTIC\nBEGIN\n    DECLARE moyenne VARCHAR(20);\n\n    SELECT resultatHMS(AVG(resultat_ms))\n    INTO moyenne\n    FROM resultat r \n    WHERE athlete_id = _athlete_id AND epreuve_type_id = 1;\n\n    RETURN moyenne;\n\nEND$$\n\nDELIMITER ;\n</code></pre>"},{"location":"exercices/corrige/ex09_corrige/","title":"Exercice 09 - Corrig\u00e9","text":""},{"location":"exercices/corrige/ex09_corrige/#1-fonction-calcul_credit","title":"1. Fonction calcul_credit()","text":"<pre><code>DROP FUNCTION IF EXISTS calcul_credit;\n\nDELIMITER $$\n\nCREATE FUNCTION calcul_credit (citoyen_id INT)\nRETURNS INT\nNOT DETERMINISTIC\nBEGIN\n\n    DECLARE score_actuel INT DEFAULT 0;\n    DECLARE score_min INT DEFAULT 0;\n    DECLARE score_max INT DEFAULT 1000;\n    DECLARE score_initial INT DEFAULT 0;\n    DECLARE score_variation INT DEFAULT 0;\n\n    -- R\u00e9cup\u00e9ration du score initial\n    SELECT c.credit_initial \n    INTO score_initial\n    FROM citoyen c \n    WHERE c.id = citoyen_id;\n\n    -- Calcul de la variation de son score\n    SELECT SUM(COALESCE(ce.score_ajustement, et.score_defaut, 0))\n    INTO score_variation\n    FROM citoyen c \n        LEFT JOIN citoyen_evenement ce ON ce.citoyen_id = c.id \n            LEFT JOIN evenement e ON e.id = ce.evenement_id \n                LEFT JOIN evenement_type et ON et.id = e.type_evenement_id \n    WHERE c.id = citoyen_id;\n\n    -- Calcul du score actuel\n    SET score_actuel = score_initial + score_variation;\n\n    -- Ajustement du score \n    IF score_actuel &lt; score_min THEN\n        SET score_actuel = score_min;\n    END IF;\n\n    IF score_actuel &gt; score_max THEN\n        SET score_actuel = score_max;\n    END IF;\n\n\n    RETURN (score_actuel);\n\nEND$$\n\nDELIMITER ;\n</code></pre>"},{"location":"exercices/corrige/ex09_corrige/#2-fonction-privilege_valide","title":"2. Fonction privilege_valide()","text":"<pre><code>DROP FUNCTION IF EXISTS privilege_valide;\n\nDELIMITER $$\n\nCREATE FUNCTION privilege_valide (_pin VARCHAR(100), _classe_id INT)\nRETURNS BIT\nNOT DETERMINISTIC\nBEGIN\n\n    DECLARE is_valid BIT DEFAULT 0;\n\n    SELECT \n        (\n        SELECT cl.credit_min \n        FROM citoyen c \n            INNER JOIN classe cl ON cl.id = c.classe_id \n        WHERE c.pin = _pin\n        )\n    &gt;=\n        (\n        SELECT c.credit_min \n        FROM classe c \n        WHERE c.id = _classe_id\n        )\n    INTO is_valid;\n\n\n    RETURN (is_valid);\n\nEND$$\n\nDELIMITER ;\n</code></pre>"},{"location":"exercices/corrige/ex09_corrige/#3-vue-citoyen_avec_credit","title":"3. Vue citoyen_avec_credit","text":"<pre><code>CREATE OR REPLACE VIEW citoyen_avec_credit\nAS\n    SELECT c.id AS citoyen_id,\n           CONCAT(c.nom,', ',c.prenom),\n           c.pin,\n           cl.titre,\n           calcul_credit(c.id) AS credit\n    FROM citoyen c \n        INNER JOIN classe cl ON cl.id = c.classe_id;\n</code></pre>"},{"location":"exercices/corrige/ex09_corrige/#4-procedure-stockee-liste_manifestant","title":"4. Proc\u00e9dure stock\u00e9e liste_manifestant","text":"<pre><code>DROP PROCEDURE IF EXISTS liste_manifestant;\n\nDELIMITER $$\n\nCREATE PROCEDURE liste_manifestant(\n    IN _date_manifestation DATE\n)\nBEGIN\n\n    SELECT c.id AS citoyen_id,\n           e.id AS evenement_id,\n           CONCAT(c.nom,', ',c.prenom) AS nom,\n           c.pin,\n           cl.titre AS classe,\n           e.date_evenement,\n           e.notes\n    FROM citoyen c \n        INNER JOIN classe cl ON cl.id = c.classe_id \n        INNER JOIN citoyen_evenement ce ON ce.citoyen_id = c.id \n            INNER JOIN evenement e ON e.id = ce.evenement_id  \n    WHERE e.type_evenement_id = 4 -- Le id 4 correspont au type manifestation \n          AND DATE_FORMAT(e.date_evenement, '%Y-%m-%d') = _date_manifestation\n    ORDER BY c.nom, c.prenom;\n\nEND $$\n\nDELIMITER ;\n</code></pre>"},{"location":"exercices/corrige/ex09_corrige/#5-procedure-stockee-update_classe","title":"5. Proc\u00e9dure stock\u00e9e update_classe","text":"<pre><code>DROP PROCEDURE IF EXISTS update_classe;\n\nDELIMITER $$\n\nCREATE PROCEDURE update_classe ()\nBEGIN\n\n    DECLARE fin_enregistrement INT DEFAULT 0;\n    DECLARE citoyen_id INT DEFAULT 0;\n    DECLARE id_classe_calcule INT DEFAULT 0;\n    DECLARE id_classe_actuel INT DEFAULT 0;\n\n    DECLARE curseur_citoyen CURSOR FOR \n        SELECT id\n        FROM citoyen;\n\n    DECLARE CONTINUE HANDLER FOR NOT FOUND SET fin_enregistrement = 1;\n\n    OPEN curseur_citoyen;\n\n    liste_citoyen:LOOP\n\n        FETCH curseur_citoyen INTO citoyen_id;\n\n        IF fin_enregistrement = 1 THEN\n            LEAVE liste_citoyen;\n        END IF;\n\n        SELECT classe_id\n        INTO id_classe_actuel\n        FROM citoyen\n        WHERE id = citoyen_id;\n\n        SELECT id\n        INTO id_classe_calcule\n        FROM classe c \n        WHERE c.credit_min &lt;= calcul_credit(citoyen_id)\n        ORDER BY c.credit_min DESC LIMIT 1; \n\n        IF id_classe_calcule &lt;&gt; id_classe_actuel THEN\n            -- Mettre \u00e0 jour la classe du citoyen\n            UPDATE citoyen \n            SET classe_id = id_classe_calcule\n            WHERE id = citoyen_id;\n            -- Laisser une trace de l'op\u00e9ration\n            INSERT INTO log_update_classe (date_update, citoyen_id, ancienne_classe_id, nouvelle_classe_id)\n            VALUES (NOW(), citoyen_id, id_classe_actuel, id_classe_calcule);\n        END IF;\n\n    END LOOP liste_citoyen;\n\n    CLOSE curseur_citoyen;\n\nEND $$\n\nDELIMITER ;\n</code></pre>"},{"location":"exercices/corrige/ex10_corrige/","title":"Exercice 10 - Curseur","text":""},{"location":"exercices/corrige/ex10_corrige/#corrige-question-1","title":"Corrig\u00e9 question #1","text":"<pre><code>DROP PROCEDURE IF EXISTS concat_pays;\nDELIMITER $$\nCREATE PROCEDURE concat_pays (OUT liste_pays VARCHAR(1000))\nBEGIN\n\n    DECLARE fin_enregistrement INTEGER DEFAULT 0;\n    DECLARE nom VARCHAR(30);\n    DECLARE curseur_pays CURSOR FOR\n        SELECT pays FROM houblon GROUP BY pays ORDER BY pays;\n\n    DECLARE CONTINUE HANDLER FOR NOT FOUND SET fin_enregistrement = 1;\n\n    SET liste_pays = \"\";\n\n    OPEN curseur_pays;\n\n    loop_pays: LOOP\n        FETCH curseur_pays INTO nom;\n        IF fin_enregistrement = 1 THEN\n        LEAVE loop_pays;\n        END IF;\n\n        SET liste_pays = CONCAT(liste_pays, \";\", nom);\n    END LOOP loop_pays;\n\n    -- Supprime le premier caract\u00e8re, un point-virgule\n    SET liste_pays = SUBSTR(liste_pays, 2);\n\n    CLOSE curseur_pays;\nEND$$\nDELIMITER ;\n\nCALL concat_pays(@listePays);\nSELECT @listePays;\n</code></pre>"},{"location":"exercices/corrige/ex10_corrige/#corrige-question-2","title":"Corrig\u00e9 question #2","text":"<pre><code>DROP TABLE IF EXISTS similitude;\nCREATE TABLE similitude (\n    houblon_id INTEGER,\n    similitude_id INTEGER,\n    PRIMARY KEY(houblon_id, similitude_id),\n    CONSTRAINT `houblon_fk` FOREIGN KEY (houblon_id) REFERENCES houblon (id) ON UPDATE RESTRICT ON DELETE CASCADE,\n    CONSTRAINT `similitude_fk` FOREIGN KEY (similitude_id) REFERENCES houblon (id) ON UPDATE RESTRICT ON DELETE CASCADE\n);\n\nDROP TABLE IF EXISTS similitude_log;\nCREATE TABLE similitude_log (\n    id INTEGER AUTO_INCREMENT,  \n    houblon_id INTEGER,\n    nom VARCHAR(50),\n    PRIMARY KEY(id),\n    CONSTRAINT `houblon_log_fk` FOREIGN KEY (houblon_id) REFERENCES houblon (id) ON UPDATE RESTRICT ON DELETE CASCADE\n);\n\n\nDROP PROCEDURE IF EXISTS extract_similitude;\nDELIMITER $$\nCREATE PROCEDURE extract_similitude()\nBEGIN\n\n    DECLARE fin_enregistrement INTEGER DEFAULT 0;\n    -- Variable pour le curseur\n    DECLARE id_houblon INTEGER;\n    DECLARE similitude VARCHAR(200);\n    -- Variable de la deuxi\u00e8me boucle\n    DECLARE nom_suggestion VARCHAR(50);\n    DECLARE id_houblon_suggestion INT;\n    DECLARE position_separateur INT;\n\n    DECLARE curseur_houblon CURSOR FOR\n        SELECT id, similitude FROM houblon h WHERE NOT similitude IS NULL;\n\n    -- Condition de sortie du curseur\n    DECLARE CONTINUE HANDLER FOR NOT FOUND SET fin_enregistrement = 1;\n\n    -- Pour attraper les erreurs SQLEXCEPTION\n    DECLARE EXIT HANDLER FOR SQLEXCEPTION\n    BEGIN\n        ROLLBACK;\n        SELECT 'Une erreur est survenue, les op\u00e9rations ont \u00e9t\u00e9 annul\u00e9.';\n    END;\n\n    START TRANSACTION;\n\n    OPEN curseur_houblon;\n\n    -- Boucle qui parcourt le curseur\n    loop_houblon: LOOP\n        -- R\u00e9cup\u00e8re les valeurs de la ligne active du curseur\n        FETCH curseur_houblon INTO id_houblon, similitude;\n\n        IF fin_enregistrement = 1 THEN\n            LEAVE loop_houblon;\n        END IF;\n\n        -- Extrait chaque valeur s\u00e9par\u00e9 par une virgule du champs similitude\n        loop_suggestions: LOOP\n\n            -- D\u00e9tecte la position du s\u00e9parateur \n            SET position_separateur = INSTR(similitude, ',');\n            -- Isole le nom du houblon qui est devant le premier s\u00e9parateur trouv\u00e9\n            SET nom_suggestion = SUBSTRING_INDEX(similitude, ',', 1);\n            -- S\u00e9lectionne le id du houblon ou retourne NULL s'il n'est pas trouv\u00e9\n            SELECT IFNULL((SELECT id FROM houblon WHERE nom LIKE CONCAT('%',nom_suggestion,'%')), NULL) INTO id_houblon_suggestion;     \n\n            IF NOT id_houblon_suggestion IS NULL THEN\n                -- Si trouv\u00e9, l'ajoute dans la table similitude\n                INSERT INTO similitude(houblon_id, similitude_id) VALUES(id_houblon, id_houblon_suggestion);\n            ELSE\n                -- Si non, l'ajoute dans la table similitude_log\n                INSERT INTO similitude_log(houblon_id, nom) VALUES(id_houblon, nom_suggestion);\n            END IF;\n\n            -- Conserve le texte apr\u00e8s le s\u00e9parateur pour la prochaine it\u00e9ration\n            SELECT trim(substring(similitude, position_separateur + 1)) INTO similitude; \n\n\n            -- Condition de sortie\n            IF (position_separateur) = 0 THEN\n                LEAVE loop_suggestions;\n            END IF;\n            LEAVE loop_suggestions;\n        END LOOP loop_suggestions;\n\n\n    END LOOP loop_houblon;\n\n    CLOSE curseur_houblon;\n\n    COMMIT;\nEND$$\nDELIMITER ;\n\nCALL extract_similitude();\n</code></pre>"},{"location":"exercices/corrige/ex12_corrige/","title":"Exercice 08 - Exemple de programme","text":"<p>Le programme est divis\u00e9 en deux fichiers, un premier pour l'affichage et les interactions avec l'utilisateur et un second qui s'occupe uniquement des op\u00e9rations avec la base de donn\u00e9es</p> <p>py_crud.py</p> <pre><code>from db_citoyen import deleteCitoyen, getCitoyen, insertCitoyen, updateCitoyen\nimport os\n\n# Permet d'effacer la console\ndef cls():\n    os.system('cls' if os.name=='nt' else 'clear')\n\ndef afficheTitre(texte):\n    titre = '=  {}  ='.format(texte)\n    ligne = '=' * len(titre)\n    print(ligne + '\\n' + titre + '\\n' + ligne + '\\n')\n\ndef retourMenu():\n    input(\"\\nAppuyez sur une touche pour revenir au menu...\")\n    cls()\n\n# Affichage du menu et attente d'une option\ndef menu():\n    choix = 0\n\n    afficheTitre('Cr\u00e9dit social')\n    try:\n        choix = int(input((\"\"\" \nMenu principal\n1- Ajouter un nouveau citoyen\n2- Obtenir les informations d'un citoyen\n3- Modifier un citoyen\n4- Supprimer un citoyen\n5- Quitter\n\nVeuillez choisir une option : \"\"\")))\n\n        cls()\n\n    except ValueError:\n        print(\"\\nLe choix est invalide\")\n    return choix\n\n# 1- Ajouter un nouveau citoyen\ndef ajouteCitoyen():\n    afficheTitre('Ajouter un nouveau citoyen')\n\n    print('\\nVeuillez nous donner les informations suivantes au sujet du nouveau citoyen')\n    prenom = input('{0:14} : '.format('Pr\u00e9nom'))\n    nom = input('{0:14} : '.format('Nom'))\n    noCivique = input('{0:14} : '.format('Num\u00e9ro civique'))\n    adresse = input('{0:14} : '.format('Adresse'))\n    ville = input('{0:14} : '.format('Ville'))\n    pin = input('{0:14} : '.format('PIN'))\n\n    citoyenId = insertCitoyen(nom, prenom, noCivique, adresse, ville, pin)\n    print('Le citoyen {} {} - id [{}] a \u00e9t\u00e9 ajout\u00e9 avec succ\u00e8s'.format(prenom, nom, citoyenId))\n    retourMenu()\n\n# 2- Obtenir les informations d'un citoyen\ndef selectCitoyen():\n    afficheTitre('Obtenir les informations d\\'un citoyen')\n\n    citoyen_id = input(\"Entrez le id du citoyen : \")\n    resultat = getCitoyen(citoyen_id)\n    if resultat is None:\n        print(\"Le citoyen n'existe pas/plus\")\n    else:\n        nom, classe, score = resultat\n        print('\\n&gt; {} - Classe: {} - Score: {}\\n'.format(nom, classe, score))\n\n    retourMenu()\n\n# 3- Modifier un citoyen\ndef modifieCitoyen():\n    afficheTitre('Modifier un citoyen')\n\n    print('\\nVeuillez nous donner les informations suivantes au sujet du citoyen \u00e0 modifier')\n    citoyen_id = input('{0:14} : '.format('Id du citoyen'))\n    no_civique = input('{0:14} : '.format('Num\u00e9ro civique'))\n    adresse = input('{0:14} : '.format('Adresse'))\n    ville = input('{0:14} : '.format('Ville'))\n\n    citoyen_update = updateCitoyen(citoyen_id, no_civique, adresse, ville)\n\n    if(citoyen_update):\n        print(\"Le citoyen [{0}] a \u00e9t\u00e9 modifi\u00e9.\".format(citoyen_id))\n\n    retourMenu()\n\n# 4- Supprimer un citoyen\ndef supprimeCitoyen():\n    afficheTitre('Supprimer un citoyen')\n\n    print('\\nVeuillez nous donner les informations suivantes au sujet du citoyen \u00e0 modifier')\n    citoyen_id = input('{0:14} : '.format('Id du citoyen'))\n\n    citoyen_delete = deleteCitoyen(citoyen_id)\n\n    if(citoyen_delete):\n        print(\"Le citoyen [{0}] a \u00e9t\u00e9 'pacifi\u00e9'.\".format(citoyen_id))\n\n    retourMenu()\n\n# Boucle principale\ncls()\nwhile True:\n    choixMenu = menu()\n\n    match choixMenu:\n        case 1:\n            ajouteCitoyen()\n        case 2:\n            selectCitoyen()\n        case 3:\n            modifieCitoyen()\n        case 4:\n            supprimeCitoyen()\n        case 5:\n            print(\"Goodbye!!\")\n            break\n        case _:\n            cls()\n            print(\"Choix invalide\")\n</code></pre> <p>db_citoyen.py</p> <pre><code>import mysql.connector as mysql\n\ndb_config = {\n    'host' : 'localhost',\n    'user' : 'root',\n    'password' : '*******',\n    'database' : 'credit_social'\n}\n\ndef insertCitoyen(nom: str, prenom: str, noCivique: int, adresse: str, ville: str, pin: str) -&gt; int:\n    \"\"\"\n    Ajoute un citoyen\n    Arguments:\n        nom: un string\n        prenom: un string\n        noCivique: un integer\n        adresse: un string\n        ville: un string\n        pin: un string\n    Returns:\n        Le id du citoyen cr\u00e9\u00e9 (integer)\n    \"\"\"\n\n    query = \"\"\"\n        INSERT INTO citoyen (classe_id, nom, prenom, no_civique, adresse, ville, pin, credit_initial) \n        VALUES (%(classe_id)s, %(nom)s, %(prenom)s, %(no_civique)s, %(adresse)s, %(ville)s, %(pin)s, %(credit_initial)s);\n    \"\"\"\n    parametre = {\n        'classe_id' : 4,\n        'nom' : nom,\n        'prenom' : prenom,\n        'no_civique' : noCivique,\n        'adresse' : adresse,\n        'ville' : ville,\n        'pin' : pin,\n        'credit_initial' : 500,\n    }\n\n    try:\n        connection = mysql.connect(**db_config)\n        cursor = connection.cursor()\n        cursor.execute(query, parametre)\n        citoyenId = cursor.lastrowid\n\n        connection.commit()\n    except mysql.Error as erreur:\n        print(erreur)\n    finally:\n        cursor.close()\n        connection.close()\n\n    return citoyenId\n\n# S\u00e9lectionne le nom, la classe et le score d'un citoyen selon son id\ndef getCitoyen(id):\n    \"\"\"\n    S\u00e9lectionne un citoyen\n    Arguments:\n        id: le id du citoyen (integer)\n    Returns:\n        Un tuple avec le nom, la classe et le score d'un citoyen\n    \"\"\"\n\n    query = \"\"\"\n        select concat(c.prenom, ' ', c.nom) as nom,\n        cl.titre as classe,\n        calcul_credit(c.id) as score\n        from citoyen c\n            inner join classe cl on cl.id = c.classe_id \n        where c.id = %(citoyen_id)s;\n    \"\"\"\n    parametres = {\n        'citoyen_id' : id\n        }\n    try:\n        connection = mysql.connect(**db_config)\n        cursor = connection.cursor()\n        cursor.execute(query, parametres)\n        result = cursor.fetchone()\n    except mysql.Error as erreur:\n        print(erreur)\n    finally:\n        cursor.close()\n        connection.close()\n\n    return result\n\ndef updateCitoyen(id_citoyen: int, no_civique: int, adresse: str, ville: str)-&gt; bool:\n    \"\"\"\n    Modifie un citoyen\n    Arguments:\n        id: le id du citoyen (integer)\n        no_civique: un integer\n        adresse: un string\n        ville: un string\n    Returns:\n        True si la modification a fonctionn\u00e9\n    \"\"\"\n\n    query = \"\"\"\n        UPDATE citoyen\n        SET no_civique = %(no_civique)s, \n            adresse = %(adresse)s, \n            ville = %(ville)s\n        WHERE id = %(citoyen_id)s;\n    \"\"\"\n    parametre = {\n        'citoyen_id' : id_citoyen,\n        'no_civique' : no_civique,\n        'adresse' : adresse,\n        'ville' : ville,\n    }\n\n    citoyenUpdate = False\n\n    try:\n        connection = mysql.connect(\n            host=\"localhost\",\n            user=\"root\",\n            password=\"r00t_bd2\",\n            database=\"credit_social\"\n        )\n        cursor = connection.cursor()\n        cursor.execute(query, parametre)\n\n        connection.commit()\n        citoyenUpdate = True\n\n    except mysql.Error as erreur:\n        print(erreur)\n\n    finally:\n        cursor.close()\n        connection.close()\n\n\n    return citoyenUpdate\n\ndef deleteCitoyen(citoyen_id: int)-&gt;bool:\n    \"\"\"\n    Supprime un citoyen\n    Arguments:\n        id: le id du citoyen (integer)\n    Returns:\n        True si la modification a fonctionn\u00e9\n    \"\"\"\n    citoyenDelete = False\n    query_citoyen_evenement = \"DELETE FROM citoyen_evenement WHERE citoyen_id = %(citoyen_id)s\"\n    query_citoyen = \"DELETE FROM citoyen WHERE id = %(citoyen_id)s\"\n    parametres = {'citoyen_id' : citoyen_id}\n\n    try:\n        connection = mysql.connect(**db_config)\n        cursor = connection.cursor()\n\n        cursor.execute(query_citoyen_evenement, parametres)\n        cursor.execute(query_citoyen, parametres)\n\n        connection.commit()\n\n        citoyenDelete = True\n    except mysql.Error as erreur:\n        print(erreur)\n    finally:\n        cursor.close()\n        connection.close()\n\n    return citoyenDelete\n</code></pre>"},{"location":"exercices/corrige/ex13_corrige/","title":"Exercice 09 - pyQt5","text":"<p>\u00c0 l'aide de la librairie pyQT5 et de la base de donn\u00e9es credit_social, cr\u00e9ez une interface graphique qui permettra de saisir un id de citoyen et de retourner son nom.</p>"},{"location":"exercices/corrige/ex13_corrige/#installation-de-pyqt5","title":"Installation de pyQT5","text":"<pre><code>pip install PyQt5\n</code></pre> <p>Documentation : https://pypi.org/project/PyQt5/</p>"},{"location":"exercices/corrige/ex13_corrige/#resultat","title":"R\u00e9sultat","text":"<ul> <li>On entre un id dans le textBox.</li> <li>En cliquant sur rechercher, on effectue une requ\u00eate \u00e0 la base de donn\u00e9es.</li> <li>On affiche le nom du citoyen sous le bouton.</li> </ul>"},{"location":"exercices/corrige/ex13_corrige/#exemple-de-code","title":"Exemple de code","text":"<p>L'exemple de code suivant va afficher une fen\u00eatre vide.</p> <pre><code># Pour pouvoir passer des arguments \u00e0 notre application\nimport sys\n# Les librairies PyQT5\nfrom PyQt5.QtCore import *\nfrom PyQt5.QtWidgets import *\nfrom PyQt5.QtGui import *\n\nclass MainWindow(QMainWindow):\n\n    def __init__(self):\n        super(MainWindow, self).__init__()\n\n        self.setWindowTitle(\"Oh la belle fen\u00eatre vide\")\n\n# Une instance de QApplication, on doit en avoir absolument \n# une et seulement une par application \napp = QApplication(sys.argv)\n\n# Cr\u00e9ation de notre fen\u00eatre principale en appelant la fonction\n# MainWindow appel\u00e9 plus haut\nwindow = MainWindow()\n# Tr\u00e8s important de l'afficher car par d\u00e9faut elle est masqu\u00e9.\nwindow.show()\n\n# D\u00e9marre la boucle d'\u00e9v\u00e8nement. L'application va s'afficher.\napp.exec()\n</code></pre> <p>Exemple d'un classe MainWindows avec un bouton et un champ texte. Il y a un \u00e9v\u00e9nement sur le bouton pour appeler une fonction quand on le clique.</p> <pre><code>class MainWindows(QMainWindow):\n    def __init__(self):\n        super().__init__()\n\n        self.setWindowTitle(\"Mon App\")\n        self.setFixedSize(QSize(300, 300))\n\n        # On cr\u00e9e un widget qui va contenir les autres et on \n        # d\u00e9fini le type de layout \u00e0 utiliser\n        layout = QGridLayout()\n\n        # On cr\u00e9e un bouton avec le texte rechercher\n        bouton = QPushButton('Rechercher')\n        # On ajoute le bouton au widget layout \n        # \u00e0 la position 2,0 (troisi\u00e8me ligne, premi\u00e8re colonne)\n        layout.addWidget(bouton, 2, 0)\n\n        # On cr\u00e9e un widget label\n        self.resultat = QLabel('-')\n        # Formatage du texte\n        self.resultat.setAlignment(Qt.AlignCenter)\n        font = self.resultat.font()\n        font.setPointSize(12)\n        self.resultat.setFont(font)\n        self.resultat.setFixedHeight(100)\n        # On ajoute le label dans le layout\n        layout.addWidget(self.resultat, 3, 0)\n\n        # On associe l'\u00e9v\u00e9nement clic du bouton \u00e0 la fonction \n        # afficher_nom\n        bouton.clicked.connect(self.afficher_nom)\n\n        # On cr\u00e9e un container qui repr\u00e9sente le widget principal, \n        # tout le contenu de notre fen\u00eatre\n        container = QWidget()\n        # On y ajoute le widget layout\n        container.setLayout(layout)\n        # On d\u00e9fini le container comme le widget principal\n        self.setCentralWidget(container)\n\n    def afficher_nom(self):\n        self.resultat.setText('Mathieu Fr\u00e9chette')\n</code></pre>"},{"location":"exercices/corrige/ex13_corrige/#corrige","title":"Corrig\u00e9","text":"<p>Voici ma version de l'exercice</p> app.py<pre><code>import sys\n\nfrom PyQt5.QtCore import QSize, Qt\nfrom PyQt5.QtWidgets import QApplication, QGridLayout, QHBoxLayout, QLabel, QLineEdit, QMainWindow, QPushButton, QVBoxLayout, QWidget\nfrom db_citoyen import getCitoyen\n\nclass MainWindows(QMainWindow):\n    def __init__(self):\n        super().__init__()\n\n        self.setWindowTitle(\"Mon App\")\n        # self.setFixedSize(QSize(300, 300))\n\n        layout = QGridLayout()\n        layout.setContentsMargins(40,10,40,10)\n\n        titre = QLabel('Entrez le id du citoyen')\n        titre.setAlignment(Qt.AlignCenter)\n        font = titre.font()\n        font.setPointSize(12)\n        titre.setFont(font)\n        titre.setFixedHeight(50)\n        layout.addWidget(titre, 0, 0)\n\n        # Edit box\n        self.input_id_citoyen = QLineEdit()\n        self.input_id_citoyen.returnPressed.connect(self.RechercherCitoyen)\n        layout.addWidget(self.input_id_citoyen, 1, 0)\n\n        bouton = QPushButton('Rechercher')\n        bouton.clicked.connect(self.RechercherCitoyen)\n        layout.addWidget(bouton, 2, 0)\n\n        self.label_nom_citoyen = QLabel('-')\n        self.label_nom_citoyen.setAlignment(Qt.AlignCenter)\n        font = self.label_nom_citoyen.font()\n        font.setPointSize(12)\n        self.label_nom_citoyen.setFont(font)\n        self.label_nom_citoyen.setFixedHeight(100)\n        layout.addWidget(self.label_nom_citoyen, 3, 0)\n\n\n        container = QWidget()\n        container.setLayout(layout)\n\n        self.setCentralWidget(container)\n\n    def RechercherCitoyen(self):\n        citoyen_id = self.input_id_citoyen.text()\n        resultat = getCitoyen(citoyen_id)\n        nom_citoyen = \"Le citoyen n'existe pas\"\n        if resultat is not None:\n            nom_citoyen, classe, score = resultat\n        self.label_nom_citoyen.setText(nom_citoyen)\n\n\napp = QApplication(sys.argv)\n\nwindow = MainWindows()\nwindow.show()\n\napp.exec()\n</code></pre> db_citoyen.py<pre><code>import mysql.connector as mysql\n\ndb_config = {\n    'host' : 'localhost',\n    'user' : 'root',\n    'password' : '********',\n    'database' : 'credit_social'\n}\n\n# S\u00e9lectionne le nom, la classe et le score d'un citoyen selon son id\ndef getCitoyen(id):\n    \"\"\"\n    S\u00e9lectionne un citoyen\n    Arguments:\n        id: le id du citoyen (integer)\n    Returns:\n        Un tuple avec le nom, la classe et le score d'un citoyen\n    \"\"\"\n\n    query = \"\"\"\n        select concat(c.prenom, ' ', c.nom) as nom,\n        cl.titre as classe,\n        calcul_credit(c.id) as score\n        from citoyen c\n            inner join classe cl on cl.id = c.classe_id \n        where c.id = %(citoyen_id)s;\n    \"\"\"\n    parametres = {\n        'citoyen_id' : id\n        }\n    result = ()\n    try:\n        connection = mysql.connect(**db_config)\n        cursor = connection.cursor()\n        cursor.execute(query, parametres)\n        result = cursor.fetchone()\n    except mysql.Error as erreur:\n        print(erreur)\n    finally:\n        cursor.close() \n        connection.close()\n\n    return result\n</code></pre>"},{"location":"exercices/corrige/ex99_corrige/","title":"Exercice 09 - Corrig\u00e9","text":""},{"location":"exercices/corrige/ex99_corrige/#in","title":"IN","text":""},{"location":"exercices/corrige/ex99_corrige/#question-1","title":"Question 1","text":"<pre><code>select * \nfrom citoyen \nwhere ville in ('Minneapolis', 'Philadelphia', 'Phoenix');\n</code></pre>"},{"location":"exercices/corrige/ex99_corrige/#question-2","title":"Question 2","text":"<pre><code>select *\nfrom evenement e \nwhere e.type_evenement_id in (4, 5);\n</code></pre>"},{"location":"exercices/corrige/ex99_corrige/#question-3","title":"Question 3","text":"<pre><code>select *\nfrom evenement e \nwhere e.type_evenement_id = 4 \n      and month(e.date_evenement) in (3,4,5)\n</code></pre>"},{"location":"exercices/corrige/ex99_corrige/#question-4","title":"Question 4","text":"<pre><code>select *\nfrom citoyen c \nwhere c.id not in (\n    select ce.citoyen_id \n    from evenement e \n        inner join citoyen_evenement ce on ce.evenement_id = e.id \n    where e.type_evenement_id = 1\n);\n</code></pre>"},{"location":"exercices/corrige/ex99_corrige/#question-5","title":"Question 5","text":"<pre><code>select *\nfrom citoyen c \n    inner join classe cl on cl.id = c.classe_id \nwhere cl.titre = 'Alpha' \n    and c.id in (\n        select ce.citoyen_id \n        from evenement e \n            inner join citoyen_evenement ce on ce.evenement_id = e.id \n        where e.type_evenement_id = 4\n    );\n</code></pre>"},{"location":"exercices/corrige/ex99_corrige/#like","title":"LIKE","text":""},{"location":"exercices/corrige/ex99_corrige/#question-1_1","title":"Question 1","text":"<pre><code>select *\nfrom citoyen\nwhere prenom like 'M%' and nom like 'F%'\n</code></pre>"},{"location":"exercices/corrige/ex99_corrige/#question-2_1","title":"Question 2","text":"<pre><code>select *\nfrom citoyen \nwhere prenom like '___';\n</code></pre>"},{"location":"exercices/corrige/ex99_corrige/#question-3_1","title":"Question 3","text":"<pre><code>select *\nfrom citoyen\nwhere pin like '%-6935-%';\n</code></pre>"},{"location":"exercices/corrige/ex99_corrige/#question-4_1","title":"Question 4","text":"<pre><code>select c.*\nfrom citoyen c \n    inner join citoyen_evenement ce on ce.citoyen_id  = c.id \n        inner join evenement e on e.id = ce.evenement_id \nwhere e.notes like '%math%';\n</code></pre>"},{"location":"exercices/corrige/ex99_corrige/#question-5_1","title":"Question 5","text":"<pre><code>select *\nfrom citoyen\nwhere pin like '__6c4b66%';\n</code></pre>"},{"location":"exercices/corrige/ex99_corrige/#group-by","title":"GROUP BY","text":""},{"location":"exercices/corrige/ex99_corrige/#question-1_2","title":"Question 1","text":"<pre><code>select cl.titre,\n       count(c.id) as nb_citoyen\nfrom citoyen c \n    right join classe cl on cl.id = c.classe_id\ngroup by cl.titre;\n</code></pre>"},{"location":"exercices/corrige/ex99_corrige/#question-2_2","title":"Question 2","text":"<pre><code>select e.id as evenement_id,\n       e.date_evenement,\n       e.notes,\n       count(*) as nombre_arrestations\nfrom evenement e \n    inner join evenement_type et on et.id = e.type_evenement_id \n    inner join citoyen_evenement ce on ce.evenement_id = e.id\nwhere et.titre = \"Manifestation\"\ngroup by e.id\nhaving count(*) &gt; 5\norder by e.id;\n</code></pre>"},{"location":"exercices/corrige/ex99_corrige/#question-3_2","title":"Question 3","text":"<pre><code>select ce.evenement_id,\n       ceiling(avg(calcul_credit(ce.citoyen_id))) as moyenne_score\nfrom evenement e \n    inner join evenement_type et on et.id = e.type_evenement_id \n    inner join citoyen_evenement ce on ce.evenement_id = e.id \nwhere et.titre = \"Denonciation\"\ngroup by ce.evenement_id \norder by ce.evenement_id;\n</code></pre>"},{"location":"exercices/corrige/ex99_corrige/#question-4_2","title":"Question 4","text":"<p>Pour cette question ce n'\u00e9tait pas vraiment pertinent de le faire avec un group by.</p> <pre><code>select c.nom,\n       c.prenom, \n       calcul_credit(c.id) as score\nfrom citoyen c\nwhere calcul_credit(c.id) = (\n    select max(calcul_credit(c.id))\n    from citoyen c \n    where c.id &lt; 100\n)\nand c.id &lt; 100;\n</code></pre>"},{"location":"exercices/corrige/ex99_corrige/#question-5_2","title":"Question 5","text":"<pre><code>select date(e.date_evenement) as date_evenement,\n       sum(calcul_credit(ce.citoyen_id)) as total_score\nfrom evenement e \n    inner join citoyen_evenement ce on ce.evenement_id = e.id \n    inner join evenement_type et on et.id = e.type_evenement_id \nwhere et.titre = \"Reunion du parti\"\n      and date(e.date_evenement) = '2021-07-17'\ngroup by date(e.date_evenement);\n</code></pre>"},{"location":"exercices/corrige/ex99_corrige/#exists","title":"EXISTS","text":""},{"location":"exercices/corrige/ex99_corrige/#question-1_3","title":"Question 1","text":"<pre><code>select *\nfrom citoyen c1\nwhere exists (\n        select 1\n        from citoyen c2\n        where ville = 'Quebec' and c2.id = c1.id \n    );\n</code></pre>"},{"location":"exercices/corrige/ex99_corrige/#question-2_3","title":"Question 2","text":"<pre><code>select *\nfrom citoyen c \nwhere exists (\n    select 1\n    from evenement e \n        inner join citoyen_evenement ce on ce.evenement_id = e.id \n    where e.type_evenement_id = 3 and ce.citoyen_id = c.id\n)\norder by c.id;\n</code></pre>"},{"location":"exercices/corrige/ex99_corrige/#question-3_3","title":"Question 3","text":"<pre><code>select *\nfrom citoyen c \nwhere not exists (\n    select 1\n    from citoyen_evenement ce\n    where ce.citoyen_id = c.id\n);\n</code></pre>"},{"location":"exercices/corrige/ex99_corrige/#question-4_3","title":"Question 4","text":"<p>La difficult\u00e9 ici \u00e9tait qu'on ne peut pas faire de update avec dans le where une sous-requ\u00eate sur la m\u00eame table. Une fa\u00e7on de contourner le probl\u00e8me est de cr\u00e9er une table temporaire dans la sous-requ\u00eate.</p> <pre><code>update citoyen\nset pin = concat('x', right(citoyen.pin, length(citoyen.pin) - 1))\nwhere exists (\n    select 1\n    from (select * from citoyen) c -- Cr\u00e9e une table temporaire\n    where c.ville = \"Madrid\"\n          and c.id = citoyen.id\n);\n</code></pre>"},{"location":"exercices/corrige/ex99_corrige/#question-5_3","title":"Question 5","text":"<pre><code>update citoyen_evenement ce\nset ce.score_ajustement = FLOOR(RAND()*(100-25+1))+25\nwhere exists (\n    select 1\n    from evenement_type et \n        inner join evenement e on e.type_evenement_id = et.id \n    where et.titre = \"Denonciation\"\n          and e.id = ce.evenement_id \n);\n</code></pre>"},{"location":"exercices/corrige/ex99_corrige/#procedures-stockees-et-fonctions","title":"Proc\u00e9dures stock\u00e9es et fonctions","text":""},{"location":"exercices/corrige/ex99_corrige/#question-1_4","title":"Question 1","text":"<pre><code>DROP PROCEDURE IF EXISTS credit_social.participation_evenement;\n\nDELIMITER $$\n$$\ncreate procedure credit_social.participation_evenement(_citoyen_id INT)\nbegin\n\n    declare nb_reunion INT default 0;\n    declare nb_denonciation INT default 0;\n    declare nb_realignement INT default 0;\n    declare nb_manifestation INT default 0;\n    declare nb_idees INT default 0;\n    declare nb_comportement INT default 0;\n\n    -- Nombre de participation \u00e0 une r\u00e9union du parti\n    select count(*)\n    into nb_reunion\n    from evenement e \n        inner join citoyen_evenement ce on ce.evenement_id = e.id \n    where e.type_evenement_id = 1 and ce.citoyen_id = _citoyen_id;\n\n    -- Nombre de participation \u00e0 une d\u00e9nonciation\n    select count(*)\n    into nb_denonciation\n    from evenement e \n        inner join citoyen_evenement ce on ce.evenement_id = e.id \n    where e.type_evenement_id = 2 and ce.citoyen_id = _citoyen_id;\n\n    -- Nombre de participation \u00e0 un r\u00e9alignement sanitaire\n    select count(*)\n    into nb_realignement\n    from evenement e \n        inner join citoyen_evenement ce on ce.evenement_id = e.id \n    where e.type_evenement_id = 3 and ce.citoyen_id = _citoyen_id;\n\n    -- Nombre de participation \u00e0 une manifestation\n    select count(*)\n    into nb_manifestation\n    from evenement e \n        inner join citoyen_evenement ce on ce.evenement_id = e.id \n    where e.type_evenement_id = 4 and ce.citoyen_id = _citoyen_id;\n\n    -- Nombre d'arrestation pour idees dissidentes\n    select count(*)\n    into nb_idees\n    from evenement e \n        inner join citoyen_evenement ce on ce.evenement_id = e.id \n    where e.type_evenement_id = 5 and ce.citoyen_id = _citoyen_id;\n\n    -- Nombre d'arrestation pour comportement reprehensible\n    select count(*)\n    into nb_comportement\n    from evenement e \n        inner join citoyen_evenement ce on ce.evenement_id = e.id \n    where e.type_evenement_id = 6 and ce.citoyen_id = _citoyen_id;\n\n    -- Retour\n    select c.id as id_citoyen,\n           c.nom, \n           c.prenom,\n           nb_reunion,\n           nb_denonciation,\n           nb_realignement,\n           nb_manifestation,\n           nb_idees,\n           nb_comportement\n    from citoyen c \n    where c.id = _citoyen_id;\n\nend\n$$\nDELIMITER ;\n</code></pre>"},{"location":"exercices/corrige/ex99_corrige/#question-2_4","title":"Question 2","text":"<pre><code>DROP FUNCTION IF EXISTS credit_social.valide_pin;\n\nDELIMITER $$\n$$\nCREATE FUNCTION credit_social.valide_pin(_citoyen_id int)\nRETURNS INT\ndeterministic\nbegin\n\n    return (select pin regexp('([a-zA-Z0-9]{8})([-]{1})([a-zA-Z0-9]{4})([-]{1})([a-zA-Z0-9]{4})([-]{1})([a-zA-Z0-9]{4})([-]{1})([a-zA-Z0-9]{12})')\n            from citoyen \n            where id = _citoyen_id);\n\nEND$$\nDELIMITER ;\n</code></pre>"},{"location":"exercices/ex11/ex11_enonce/","title":"Exercice 11 - Livres dont vous \u00eates le h\u00e9ro","text":""},{"location":"exercices/ex11/ex11_enonce/#description-de-lexercice","title":"Description de l'exercice","text":"<p>L'objectif du projet est de cr\u00e9er une application qui permettra de lire et de naviguer dans un livre dont vous \u00eates le h\u00e9ros. </p> <p>Vous devrez faire l'analyse du cas et me produire un diagramme de classes de cette analyse. Ensuite cr\u00e9er la base de donn\u00e9es en lien avec votre analyse. Je vais vous fournir le texte d'un livre divis\u00e9 en chapitres pour l'inclure dans la base de donn\u00e9es. Finalement vous allez d\u00e9velopper une application fonctionnelle en python avec une interface graphique. </p> <p>L'exercice sera \u00e9valu\u00e9 et comptera pour 15% de la note finale. Vous pouvez le faire en \u00e9quipe de 2 ou individuellement. </p>"},{"location":"exercices/ex11/ex11_enonce/#remise-de-lexercice","title":"Remise de l'exercice","text":"<p>Cr\u00e9ez un d\u00e9p\u00f4t Github de l'exercice \u00e0 l'int\u00e9rieur duquel vous allez avoir les \u00e9l\u00e9ments suivants : </p> <ul> <li>Dans un r\u00e9pertoire nomm\u00e9 ressources, votre diagramme de classes ainsi que les scripts SQL n\u00e9cessaires \u00e0 la cr\u00e9ation de votre base de donn\u00e9es et \u00e0 l'insertion des donn\u00e9es une fois l'application fonctionnel.</li> <li>Le code de votre application. Si vous travaillez en \u00e9quipe, je veux que chacun travaille sur une version locale du projet et fasse des commits et merge sur le projet ma\u00eetre sur Github pour que je puisse \u00e9valuer l'implication de chaque co\u00e9quipiers.</li> <li>La remise du projet se fera durant le cours du 18 novembre 2022</li> </ul>"},{"location":"exercices/ex11/ex11_enonce/#analyse-du-cas","title":"Analyse du cas","text":"<p>Les points suivants du livre  doivent \u00eatre couverts par votre analyse :</p> <ul> <li>Le texte du livre divis\u00e9 entre chapitres ainsi que le principe de navigation entre les chapitres. (Pour chaque chapitre il n'y a qu'un choix restreint de chapitres auxquels on peut acc\u00e9der)</li> <li>Pour l'instant on n'aura qu'un livre dans l'application, mais on pourrait en avoir plusieurs. On va prendre pour acquis que tout les livres auraient la m\u00eame fiche de personnage.</li> <li>La fiche du personnage (feuille d'aventure). Pour les sections disciplines Kai et Armes, les valeurs qu'on peut y entrer doivent provenir d'une liste de choix, celle-ci est d\u00e9crite plus loin dans le livre. (\u00c0 partir de la page 9 pour les disciplines et 11 pour les armes)</li> <li>On ne couvrira pas le syst\u00e8me de r\u00e8gles, \u00e7a sera \u00e0 l'usager de le faire manuellement. (Combat, perte d'endurance, etc...)</li> <li>On doit pouvoir enregistrer notre progression dans le livre et faire plusieurs parties en m\u00eame temps.</li> </ul> <p>Votre analyse doit respecter les r\u00e8gles de la troisi\u00e8me forme normale, \u00e0 moins de cas d'exception qui devront \u00eatre justifi\u00e9s.</p>"},{"location":"exercices/ex11/ex11_enonce/#diagramme-de-classes","title":"Diagramme de classes","text":"<p>Le diagramme de classes doit respecter le plus fid\u00e8lement votre analyse. Les normes de nomenclature d\u00e9fini dans les notes de cours doivent \u00eatre suivi.</p>"},{"location":"exercices/ex11/ex11_enonce/#base-de-donnees","title":"Base de donn\u00e9es","text":"<p>Il n'y a pas de minimum ou maximum quand aux nombre de tables \u00e0 avoir, mais vous devez inclure les \u00e9l\u00e9ments suivants : </p> <ul> <li>Un usager avec des droits restreint qui sera utilis\u00e9 par l'application. Pour les droits, allez-y au minimum, seulement les tables et commandes n\u00e9cessaires au fonctionnement de l'application. </li> <li>Vous devez au minimum inclure 2 proc\u00e9dures stock\u00e9es, fonctions ou triggers (Une fonction et un trigger, une proc\u00e9dure stock\u00e9e et une fonction, deux triggers, etc...).</li> </ul>"},{"location":"exercices/ex11/ex11_enonce/#application","title":"Application","text":"<p>L'application doit comporter les fonctionnalit\u00e9s suivantes : </p> <ul> <li>Lire un livre, naviguer entre les chapitres selon leur num\u00e9ro.</li> <li>Permettre \u00e0 l'usager de modifier sa fiche de personnage.</li> <li>Sauvegarde notre progression de lecture, (num\u00e9ro de chapitre, feuille d'aventure)</li> <li>Supprimer une sauvegarde.</li> </ul>"},{"location":"exercices/ex11/ex11_enonce/#ressources","title":"Ressources","text":"<ul> <li>Loup solitaire T.1 : Le livre de r\u00e9f\u00e9rence</li> <li>insert_chapitre.sql : Les textes de chaque chapitre</li> <li>insert_lien_chapitre.sql : Les liens du chapitre vers les autres</li> </ul>"},{"location":"exercices/ex11/ex11_enonce/#grille-de-correction","title":"Grille de correction","text":"Crit\u00e8res R\u00e9ussi Satisfaisant insatisfaisant Points Les scripts SQL de cr\u00e9ation de tables et d'insertion de donn\u00e9es sont fonctionnels et couvrent l'ensemble de l'application. 2 1 0 /2 Le diagramme de classes respecte les points \u00e0 couvrir de l'analyse de cas et les normes de nomenclature d\u00e9finies dans les notes de cours. 2 1 0 /2 Un usager avec des droits restreints est utilis\u00e9 pour la connexion entre l'application et la base de donn\u00e9es. Sa cr\u00e9ation est incluse dans les scripts SQL remis. 2 1 0 /2 La base de donn\u00e9es comportent 2 proc\u00e9dures stock\u00e9es, fonctions ou triggers. 2 1 0 /2 L'application permet de lire un livre et de naviguer entre les chapitres par leur num\u00e9ro. 2 1 0 /2 L'application permet \u00e0 l'usager de modifier manuellement la feuille de personnage du livre. 2 1 0 /2 L'application permet de sauvegarder la progression de lecture (le chapitre en cours) et la feuille de personnage. 4 2 0 /4 L'application permet de supprimer une sauvegarde 2 1 0 /2 Le projet est li\u00e9 \u00e0 un d\u00e9p\u00f4t sur GitHub et un suivi a \u00e9t\u00e9 effectu\u00e9 durant le d\u00e9veloppement. (Commit, push, pull request) 2 1 0 /2 Total /20"},{"location":"exercices/ex13/ex13_enonce/","title":"Exercice 13 - R\u00e9vision analyse","text":""},{"location":"exercices/ex13/ex13_enonce/#mise-en-situation","title":"Mise en situation","text":"<p>\u00c0 partir de l'image suivante, vous devez mod\u00e9liser le syst\u00e8me de facturation d'un garage de voiture.</p> <p></p>"},{"location":"exercices/ex13/ex13_enonce/#precisions","title":"Pr\u00e9cisions","text":"<ul> <li>Seulement les informations surlign\u00e9es en jaunes doivent \u00eatre sauvegard\u00e9s (ou peuvent \u00eatre reproduit exactement avec les autres informations sauvegard\u00e9es).</li> <li>Le nombre 2134521 situ\u00e9 au-dessus du nom \"Mathieu Fr\u00e9chette\" est le code de ce client.</li> <li>La description du v\u00e9hicule est un champs texte associ\u00e9 au compte du client. Le client peut avoir plus d'un v\u00e9hicule associ\u00e9 \u00e0 son compte.</li> <li>La case PLAQUE est le num\u00e9ro de la plaque d'immatriculation du v\u00e9hicule</li> <li>Les trois champs ODO ... repr\u00e9sente trois prise de odom\u00e8tre du v\u00e9hicule durant le travail factur\u00e9.</li> <li>Dans le d\u00e9tail de la facture : </li> <li>Le texte \"Remettre Pneus dans l'auto\" est un texte global \u00e0 la facture qu'un le commis a entr\u00e9 manuellement.</li> <li>Il y a trois ligne de d\u00e9tail, chacune commen\u00e7ant par une quantit\u00e9 et un code de produit.</li> <li>Le texte \"N'oubliez pas la rotation... \" est aussi un texte globale \u00e0 la facture qu'un le commis a entr\u00e9 manuellement.</li> <li>Un peu payer la facture selon plus d'un mode de paiement. Donc \u00e0 la ligne \"M\u00e9thode de paiement. Visa=730.92$\" on pourrait retrouver plus d'un mode de paiement avec le montant pour chaque mode.</li> <li>Les \"produits\" sont class\u00e9s en trois cat\u00e9gorie : Pi\u00e8ces, Main-d'\u0153uvre (M.O.) et autre. Un produit ne peut avoir qu'une cat\u00e9gorie.</li> <li>Dans la table facturation, ajoutez deux colonnes, date_creation (type date) et user_creation (type varchar) qui seront remplies automatiquement avec un d\u00e9clencheur.</li> </ul>"},{"location":"exercices/ex13/ex13_enonce/#diagramme-de-classes","title":"Diagramme de classes","text":"<p>Produisez le diagramme de classes en relation \u00e0 partir des informations plus haut.</p> <ul> <li>Vous devez indiquer les relations entres les tables en pr\u00e9cisant le type de relation. </li> <li>Utilisez la notation 1&lt;---&gt;1 pour une relation d'un \u00e0 un et 1&lt;---&gt;n ou n&lt;---&gt;1 pour une relation d'un \u00e0 plusieurs</li> <li>Vous devez inscrire les types de donn\u00e9es</li> <li>Vous devez inscrire les cl\u00e9s primaires (PK) et \u00e9trang\u00e8res (FK)</li> </ul>"},{"location":"exercices/ex13/ex13_enonce/#creation-de-la-base-de-donnees","title":"Cr\u00e9ation de la base de donn\u00e9es","text":"<p>Cr\u00e9ez un script SQL qui effectuera les op\u00e9rations suivantes : </p> <ul> <li>Cr\u00e9ation d'un nouvelle base de donn\u00e9es</li> <li>Cr\u00e9ation des tables selon le diagramme de classes.</li> </ul>"},{"location":"exercices/ex13/ex13_enonce/#triggers","title":"Triggers","text":"<p>Cr\u00e9ez un script SQL qui fera la cr\u00e9ation des deux d\u00e9clencheurs (Triggers) suivants : </p> <ul> <li>AVANT la cr\u00e9ation d'une facture, ajoutez la date du syst\u00e8me au champ date_creation de la table de facturation.</li> <li>AVANT la cr\u00e9ation d'une facture, ajoutez le nom de l'usager courant dans le champs user_creation si aucun code de commis n'a \u00e9t\u00e9 sp\u00e9cifi\u00e9 lors de la requ\u00eate d'insertion. La commande current_user() permet de connaitre le nom de l'usager courant.</li> </ul>"},{"location":"exercices/ex13/ex13_enonce/#creation-dun-usager","title":"Cr\u00e9ation d'un usager","text":"<p>Cr\u00e9ez un script SQL qui effectuera les op\u00e9rations suivantes : </p> <p>a) Cr\u00e9ez un usager selon ces informations : </p> <ul> <li>nom : facturation</li> <li>mot de passe : $acture</li> <li>h\u00f4te accept\u00e9 : localhost</li> </ul> <p>b) Donnez les permissions suivantes \u00e0 cette usager : </p> <ul> <li>Il peut faire des requ\u00eates SELECT, UPDATE, INSERT sur les tables de facturations de la base de donn\u00e9es cr\u00e9\u00e9.</li> <li>Il peut faire des requ\u00eates SELECT, UPDATE sur la table des clients.</li> <li>Il peut faire des requ\u00eates SELECT sur la table des produits.</li> </ul>"},{"location":"notes_de_cours/dbeaver/","title":"DBeaver","text":"<p>DBeaver est un outil de gestion de base de donn\u00e9es que nous utiliserons pour le cours. Il est gratuit, multiplateforme et supporte beaucoup de type de base de donn\u00e9es. </p> <ul> <li>T\u00e9l\u00e9chargez l'installateur ici : https://dbeaver.io</li> </ul>"},{"location":"notes_de_cours/dbeaver/#creer-une-connexion-vers-devilbox-avec-dbeaver","title":"Cr\u00e9er une connexion vers devilbox avec DBeaver","text":"<p>Vous devez tout d'abord vous assurer que les containeurs Devilbox sont bien lanc\u00e9s. Ensuite dans DBeaver cliquez sur le bouton Nouvelle connexion en haut \u00e0 gauche</p> <p></p> <p>S\u00e9lectionnez ensuite MariaDB dans la liste des type de connexion</p> <p></p> <p>Si vous n'avez pas chang\u00e9 les configurations de Devilbox, vous pouvez laisser les informations par d\u00e9faut, sinon entrez le bon mot de passe.</p> <p></p> <p>Cliquez ensuite sur Connection details et entrez un nom significatif \u00e0 votre connexion.</p> <p></p> <p>Cliquez sur Test de la connexion..., on vous demandera de t\u00e9l\u00e9charger le driver pour MariaDB, acceptez et une fois termin\u00e9 vous devriez avoir un message de succ\u00e8s. Cliquez sur Finish et votre connexion va s'ajouter dans le panneau \u00e0 gauche.</p> <p></p>"},{"location":"notes_de_cours/definition/","title":"Qu'est-ce qu'est la mod\u00e9lisation de donn\u00e9es?","text":"<p>La mod\u00e9lisation est une s\u00e9rie d'outils et de processus visant la cr\u00e9ation d'une base de donn\u00e9es pouvant stocker efficacement les donn\u00e9es d'un syst\u00e8me. On va diviser notre travail en trois niveaux :  </p>"},{"location":"notes_de_cours/definition/#le-niveau-conceptuel","title":"Le niveau conceptuel","text":"<p>\u00c0 cette \u00e9tape, on va analyser le syst\u00e8me \u00e0 mod\u00e9liser en r\u00e9coltant des donn\u00e9es et en d\u00e9finissant les besoins en utilisant le mod\u00e8le entit\u00e9-association. Ce travail de r\u00e9flexion va nous amener \u00e0 construire le sch\u00e9ma conceptuel, sorte de premi\u00e8re \u00e9bauche de notre future base de donn\u00e9es.</p>"},{"location":"notes_de_cours/definition/#le-niveau-relationnel","title":"Le niveau relationnel","text":"<p>La prochaine \u00e9tape consiste \u00e0 transformer notre sch\u00e9ma en un diagramme de classes UML. C'est \u00e0 cette \u00e9tape qu'on va d\u00e9finir le type de donn\u00e9es \u00e0 utiliser pour chaque champ, les cl\u00e9s primaires ainsi que secondaires et les types de relations entre les tables. Plusieurs r\u00e8gles, qu'on appelle la normalisation, viendront nous aider \u00e0 cr\u00e9er un diagramme efficace.</p>"},{"location":"notes_de_cours/definition/#le-niveau-sql","title":"Le niveau SQL","text":"<p>Finalement, on va cr\u00e9er les scripts SQL de cr\u00e9ation de tables, d\u00e9finir les contraintes, cr\u00e9er les d\u00e9clencheurs (triggers).</p>"},{"location":"notes_de_cours/devilbox/","title":"Outils","text":""},{"location":"notes_de_cours/devilbox/#devilbox","title":"Devilbox","text":"<p>L'environnement de d\u00e9veloppement que nous allons utiliser pour le cours s'appelle Devilbox. </p> <p>Christiane Lagac\u00e9 a cr\u00e9\u00e9 une fiche pour vous guider avec l'installation : </p> <ul> <li>Installation de devilbox</li> </ul> <p>Vous trouverez aussi de l'information pertinente sur la fa\u00e7on d'acc\u00e9der au terminal des diff\u00e9rents conteneurs de Devilbox : </p> <ul> <li>Acceder au terminal d'un conteneur docker</li> </ul> <p>Astuce</p> <p>Prenez le temps de vous cr\u00e9er des scripts pour d\u00e9marrer rapidement l'environnement Devilbox et acc\u00e9der au terminal Php.</p> <p>Pour ma part j'utilise la console Git Bash pour d\u00e9marrer mon environnement et je me suis cr\u00e9er des alias au lieu d'un script : </p> <pre><code>alias devilbox=\"cd c:\\devilbox ; docker-compose up\"\nalias dphp=\"cd c:\\devilbox ; docker exec -it devilbox-php-1 bash\"\n</code></pre> <ul> <li>Une solution ici</li> </ul>"},{"location":"notes_de_cours/diagramme_classe/","title":"Le diagramme de classes","text":""},{"location":"notes_de_cours/drawio/","title":"Draw.io","text":"<p>Draw.io est un logiciel de cr\u00e9ation de diagramme. Il en existe une version en ligne et desktop, je vous conseille d'installer la version desktop.</p> <ul> <li>Version en ligne : https://app.diagrams.net/</li> <li>Version desktop : https://www.drawio.com/</li> </ul>"},{"location":"notes_de_cours/modele/","title":"Mod\u00e8le entit\u00e9-association","text":""},{"location":"notes_de_cours/modele/#definition","title":"D\u00e9finition","text":"<p>Le mod\u00e8le entit\u00e9-association (ou entit\u00e9-relation) permet de repr\u00e9senter de fa\u00e7on conceptuelle les donn\u00e9es d'un probl\u00e8me. Il nous fournit une repr\u00e9sentation graphique des associations entre les donn\u00e9es. \u00c7a nous sera tr\u00e8s utile pour cr\u00e9er des diagrammes et mod\u00e9liser diff\u00e9rents syst\u00e8mes.</p>"},{"location":"notes_de_cours/modele/#les-entites","title":"Les entit\u00e9s","text":"<p>Le mod\u00e8le contient des entit\u00e9s qui repr\u00e9sentent les \u00e9l\u00e9ments du syst\u00e8me. On peut d\u00e9finir une entit\u00e9 comme : </p> <ul> <li>Une chose capable d\u2019avoir une existence ind\u00e9pendante.</li> <li>Une chose qui peut \u00eatre identifi\u00e9e de fa\u00e7on unique.</li> </ul> <p>Une entit\u00e9 peut repr\u00e9senter quelque chose de physique (un athl\u00e8te, un livre, un auteur) ou bien un concept (un r\u00e9sultat de course, un style litt\u00e9raire). On peut aussi \u00e0 ce niveau identifier les identifiants uniques naturels d'une entit\u00e9 s'il y en a.</p>"},{"location":"notes_de_cours/modele/#les-attributs","title":"Les attributs","text":"<p>Chaque entit\u00e9 sera compos\u00e9e d'attributs repr\u00e9sentant les donn\u00e9es qui seront stock\u00e9es dans la future base de donn\u00e9es. Attention de bien diff\u00e9rencier les donn\u00e9es brutes \u00e0 enregistrer des informations qui peuvent \u00eatre calcul\u00e9es ou d\u00e9duites.</p> <p>Exemple d'attributs d'un entit\u00e9 \u00e9l\u00e8ve</p> <ul> <li>Le nom d'un \u00e9l\u00e8ve</li> <li>Son num\u00e9ro d'admission</li> <li>Sa date de naissance</li> </ul> <p>Exemple d'information \u00e0 ne pas inclure</p> <ul> <li>L'\u00e2ge de l'\u00e9l\u00e8ve</li> </ul>"},{"location":"notes_de_cours/modele/#les-associations","title":"Les associations","text":"<p>Les associations nous indiquent</p> <ul> <li>Quelles sont les interactions entre les diff\u00e9rentes entit\u00e9s du syst\u00e8me.</li> <li>Quelles sont les contraintes sur ces associations.</li> </ul> <p>On va utiliser un verbe ou un mot le plus pr\u00e9cis possible pour d\u00e9crire les associations entre les entit\u00e9s : </p> <ul> <li>Un athl\u00e8te r\u00e9alise un r\u00e9sultat</li> <li>Un auteur \u00e9crit un livre</li> </ul> <p>Les associations peuvent aussi avoir des contraintes</p> <ul> <li>Un r\u00e9sultat ne peut \u00eatre r\u00e9alis\u00e9 que par un athl\u00e8te</li> <li>Un athl\u00e8te peut r\u00e9aliser plusieurs r\u00e9sultats</li> </ul> <p>Pour vous aider \u00e0 comprendre, si on traduit en langage de base de donn\u00e9es, une entit\u00e9 va correspondre \u00e0 une table et un attribut \u00e0 un champ. Les associations repr\u00e9senteront les relations entre les tables.</p>"},{"location":"notes_de_cours/normalisation/","title":"Formes normales","text":"<p>Les formes normales sont un ensemble de r\u00e8gles qui, si elles sont suivies, nous assure de la robustesse de notre mod\u00e8le de donn\u00e9es. Elles nous offrent aussi les avantages suivants :</p> <ul> <li>\u00c9viter la redondance des donn\u00e9es</li> <li>Simplifier les mises \u00e0 jour</li> <li>Interdire les incoh\u00e9rences de donn\u00e9es venant des redondances</li> </ul> <p>Il existe 8 niveaux de formes normales, mais le plus souvent seulement les trois premi\u00e8res sont appliqu\u00e9es. C'est aussi ce que nous verrons dans le cadre du cours. Chaque forme normale doit respecter toutes les formes qui la pr\u00e9c\u00e8dent. Pour qu'on puisse dire qu'on est en troisi\u00e8me forme normale, il faut que la premi\u00e8re et deuxi\u00e8me forme soit respect\u00e9e.</p>"},{"location":"notes_de_cours/normalisation/#premiere-forme-normale-1fn","title":"Premi\u00e8re forme normale (1FN)","text":"<p>Les r\u00e8gles de la premi\u00e8re forme normale sont : </p> <p>Note</p> <ol> <li>Chaque table doit avoir une cl\u00e9 primaire</li> <li>Chaque attribut doit \u00eatre atomique et ne pas \u00eatre une liste de valeur.</li> <li>Un attribut ne doit contenir qu'un type de valeur.</li> <li>On ne doit pas r\u00e9p\u00e9ter la m\u00eame information sur plusieurs colonnes</li> </ol> <p>Une table doit toujours comporter une cl\u00e9 primaire. Si aucune donn\u00e9es ne peut remplir se r\u00f4le naturellement, on va ajouter un champ autoincr\u00e9ment\u00e9 comme cl\u00e9 primaire.</p> <p>Dans la premi\u00e8re forme normale, on doit s'assurer que chaque attribut soit atomique, c'est-\u00e0-dire qu'il n'est pas une liste de valeurs ou bien compos\u00e9 (si on le d\u00e9compose, on obtient d'autres informations). </p> <p>Exemple de deux tables usager qui ne sont pas 1FN</p> id nom email 1 Fr\u00e9chette, Mathieu math.frechette@gmail.com 2 Fr\u00e9chette, J\u00e9r\u00f4me jero@gmail.com, jerome.frechette@caramail.com 3 Mathis, Jennifer jennyM@gmail.com id nom email1 email2 1 Fr\u00e9chette, Mathieu math.frechette@gmail.com null 2 Fr\u00e9chette, J\u00e9r\u00f4me jero@gmail.com jerome.frechette@caramail.com 3 Mathis, Jennifer jennyM@gmail.com null <p>La forme n'est pas respect\u00e9e, car les valeurs de l'attribut nom sont compos\u00e9es et l'attribut email contient une liste de valeur dans la premi\u00e8re table et est \u00e9tal\u00e9 sur deux colonnes dans la deuxi\u00e8me table. Pour \u00eatre 1FN, on devrait cr\u00e9er une nouvelle table avec l'attribut email et s\u00e9parer l'attribut nom en deux, nom et pr\u00e9nom :  </p> <p>table usager</p> ID NOM PRENOM 1 Fr\u00e9chette Mathieu 2 Fr\u00e9chette J\u00e9r\u00f4me 3 Mathis Jennifer <p>table email</p> ID USAGER_ID EMAIL 1 1 math.frechette@gmail.com 2 2 jero@gmail.com 3 2 jerome.frechette@caramail.com 4 3 jennyM@gmail.com <p>Impact de l'application de la r\u00e8gle</p> <ul> <li>Aucun attribut n\u2019est compos\u00e9 ou de valeurs multiples</li> <li>Augmente grandement la performance en \u00e9vitant de parcourir des attributs sous forme de liste et en cr\u00e9ant des indexes plus performants.</li> </ul>"},{"location":"notes_de_cours/normalisation/#deuxieme-forme-normale-2fn","title":"Deuxi\u00e8me forme normale (2FN)","text":"<p>Pour \u00eatre en 2FN, il faut : </p> <p>Note</p> <ul> <li>Respecter la premi\u00e8re forme normale</li> <li>Que tous les attributs qui ne sont pas une cl\u00e9 primaire soient d\u00e9pendant en totalit\u00e9 de la ou des cl\u00e9s primaires.</li> </ul> <p>Supposons la table note_cours dans laquelle on veut enregistrer la note obtenue par cours par \u00e9tudiant :  </p> ETUDIANT_ID COURS_ID NOTE NOM_COURS 1 1 95 Programmation 1 2 1 88 Programmation 1 1 2 64 Design Web <p>On peut noter rapidement quelques probl\u00e8mes dans cette disposition : </p> <ol> <li>Il faut g\u00e9rer les possibles doublons si on veut obtenir le nom d'un cours, par exemple le cours de Programmation 1.</li> <li>Est-ce que j'ai encore acc\u00e8s au nom du cours de Design Web si je supprime l'entr\u00e9e de l'\u00e9tudiant avec le id 1 pour ce cours?</li> <li>Si je modifie le nom Programmation 1 mais qu'il y a un probl\u00e8me et que seulement le premier est modifi\u00e9, on se retrouve avec une inconsistence de donn\u00e9es.</li> <li>Qu'est-ce qui se passe si je veux ajouter un nouveau cours mais que je n'ai pas encore de notes d'\u00e9tudiants?</li> </ol> <p>Cette table n'est pas 2FN car: </p> <ul> <li> NOTE est d\u00e9pendant de ETUDIANT_ID et COURS_ID</li> <li> NOM_COURS est seulement d\u00e9pendant de COURS_ID</li> </ul> <p>Comment on pourrait normaliser cette table? Le cours est un concept qui m\u00e9rite sa propre entit\u00e9, alors on doit cr\u00e9er une nouvelle table pour stocker le nom de cours.</p> <p>table note_cours</p> ETUDIANT_ID COURS_ID NOTE 1 1 95 2 1 88 1 2 64 <p>table cours</p> ID NOM 1 Programmation 1 2 Design Web <p>Impact de l'application de la r\u00e8gle</p> <ul> <li>Permets d'\u00e9liminer plusieurs redondances des donn\u00e9es.</li> <li>Facilite la mise \u00e0 jour des donn\u00e9es</li> </ul>"},{"location":"notes_de_cours/normalisation/#troisieme-forme-normale-3fn","title":"Troisi\u00e8me forme normale (3FN)","text":"<p>Pour respecter la troisi\u00e8me forme normale, on doit : </p> <p>Note</p> <ul> <li>Remplir toutes les exigences de la deuxi\u00e8me r\u00e8gle normale, donc implicitement de la premi\u00e8re r\u00e8gle aussi.</li> <li>Tous les attributs qui ne sont pas une cl\u00e9 primaire doivent d\u00e9pendre directement de la cl\u00e9 primaire et non d'autres attributs de la table.</li> </ul> <p>Prenons par exemple la table inventaire suivante</p> ID QUANTITE ITEM_ID DESCRIPTION 1 3 1 Potion de soins mineures 2 11 2 \u00c9p\u00e9e de cuivre <p>Ici l'attribut DESCRIPTION est d\u00e9pendant de l'attribut ITEM_ID, mais pas de la cl\u00e9 primaire ID. La solution ici serait de supprimer l'attribut description de la table, en supposant que l'information se retrouve dans la table item.</p> <p>Impact de l'application de la r\u00e8gle</p> <ul> <li>Permets d'\u00e9liminer plusieurs redondances des donn\u00e9es.</li> <li>Facilite la mise \u00e0 jour des donn\u00e9es</li> </ul> <p>Dans certaines situations, une fois la troisi\u00e8me forme atteinte, il peut \u00eatre acceptable de briser la r\u00e8gle \u00e0 cause de certaines exigences ou probl\u00e9matiques pr\u00e9cise. Par exemple dans une table o\u00f9 on enregistre le d\u00e9tail d'une ligne de facture, le total de la ligne ne doit pas \u00eatre sauvegard\u00e9, car il peut \u00eatre calcul\u00e9 \u00e0 partir de la quantit\u00e9 et du prix unitaire. Par contre, si on a \u00e0 faire beaucoup d'op\u00e9ration avec le total de la ligne, on pourrait conserver le total dans une colonne pour faciliter le traitement.</p>"},{"location":"notes_de_cours/normalisation/#ressources","title":"Ressources","text":"<ul> <li>Une vid\u00e9o qui explique tr\u00e8s bien la normalisation (en anglais) : https://youtu.be/GFQaEYEc8_8</li> </ul>"},{"location":"notes_de_cours/operateur/","title":"Op\u00e9rateurs logique SQL","text":""},{"location":"notes_de_cours/operateur/#in","title":"IN","text":"<p>L'op\u00e9rateur IN nous permet d'inclure plusieurs valeurs de comparaison dans une clause WHERE. On peut le voir comme plusieurs OR sur une m\u00eame colonne. On peut aussi l'utiliser avec une sous-requ\u00eate.</p> <p>Syntaxe</p> <pre><code>-- Utilisation comme une s\u00e9rie de OR\nSELECT nom_colonne\nFROM ma_table\nWHERE nom_colonne_test IN ('Valeur1', 'Valeur2', 'Valeur3', ...);\n\n-- Utilisation avec une sous-requ\u00eate\nSELECT nom_colonne\nFROM ma_table\nWHERE nom_colonne_test IN (\n    sous-requ\u00eate \n);\n</code></pre> <p>Exemple</p> <p>Je veux la liste des athl\u00e8tes qui sont originaire du Qu\u00e9bec, de l'Ontario ou de la Saskatchewan</p> <pre><code>SELECT *\nFROM athlete a\nWHERE a.province IN ('Qu\u00e9bec', 'Ontario', 'Saskatchewan');\n</code></pre> <p>\u00c0 partir des tables suivantes, je veux avoir la liste de tous les athl\u00e8tes qui ont d\u00e9j\u00e0 participer \u00e0 un marathon. La base de donn\u00e9es contient une table athl\u00e8te qui contient la liste de tous les athl\u00e8tes et une table r\u00e9sultat qui contient le r\u00e9sultat \u00e0 une course, le id de l'athl\u00e8te et le id de l'\u00e9preuve (le marathon \u00e0 un id de 4).</p> <pre><code>SELECT *\nFROM athlete a \nWHERE a.id IN (\n    SELECT r.athlete_id \n    FROM resultat r \n    WHERE r.epreuve_id = 4 \n          AND r.athlete_id = a.id\n    );\n</code></pre>"},{"location":"notes_de_cours/operateur/#like","title":"LIKE","text":"<p>L'op\u00e9rateur LIKE nous permet d'utiliser les \"jokers\" (wildcard) suivant dans une expression pour faire une recherche dans un colonne sp\u00e9cifique avec un certain motif.</p> <ul> <li>% remplace n'importe quel texte de n'importe quelle longueur.</li> <li>_ remplace un seul caract\u00e8re.</li> </ul> <p>Exemple </p> <pre><code>-- Liste tous les athl\u00e8tes dont le nom d\u00e9bute par Fr\u00e9\nSELECT * FROM athlete a WHERE a.nom LIKE 'Fr\u00e9%';\n\n-- Liste tous les athl\u00e8tes dont le nom se termine par ette\nSELECT * FROM athlete a WHERE a.nom LIKE '%ette';\n\n-- Liste tous les athl\u00e8tes dont le nom contient ch (le terme ch pour \u00eatre situ\u00e9 au tout  \n-- d\u00e9but du nom, dans le milieu ou \u00e0 la fin)\nSELECT * FROM athlete a WHERE a.nom LIKE '%ch%';\n\n-- Liste tous les athl\u00e8tes dont le nom se d\u00e9bute par Fr, est suivi d'une lettre quelconque --- et se termine par chette.\nSELECT * FROM athlete a WHERE a.nom LIKE 'Fr_chette';\n</code></pre>"},{"location":"notes_de_cours/operateur/#regexp","title":"REGEXP","text":"<p>On peut aussi faire des comparaison beaucoup plus complexe en utilisant l'op\u00e9rateur REGEXP et des expressions r\u00e9guli\u00e8res.</p> <p>Syntaxe</p> <pre><code>SELECT nom_colonne\nFROM ma_table\nWHERE nom_colonne_test REGEXP (expression_reguliere)\n</code></pre> <p>Exemple </p> <p>Je veux la liste des athl\u00e8tes qui ont un nom d'exactement 9 caract\u00e8res</p> <pre><code>SELECT *\nFROM athlete a \nWHERE a.nom REGEXP \"^.{12}$\";\n</code></pre> <p>Pour cr\u00e9er et tester des expressions r\u00e9guli\u00e8res : https://regexr.com/</p>"},{"location":"notes_de_cours/operateur/#not","title":"NOT","text":"<p>L'op\u00e9rateur NOT va inverser le r\u00e9sultat d'une condition. Il peut \u00eatre jumel\u00e9 \u00e0 la plupart des autres op\u00e9rateurs.</p> <p>Exemple</p> <p>Je veux la liste des athl\u00e8tes qui ne sont PAS originaire du Qu\u00e9bec, de l'Ontario ou de la Saskatchewan</p> <pre><code>SELECT *\nFROM athlete a\nWHERE a.province NOT IN ('Qu\u00e9bec', 'Ontario', 'Saskatchewan');\n</code></pre> <p>Je veux la liste des athl\u00e8tes dont l'adresse courriel n'est pas une adresse GMAIL</p> <pre><code>SELECT *\nFROM athlete a\nWHERE a.courriel NOT LIKE '%@gmail.com';\n</code></pre> <p>Je veux la liste des athl\u00e8tes dont la valeur de la colonne date_naissance n'est pas NULL</p> <pre><code>SELECT *\nFROM athlete a\nWHERE a.date_naissance IS NOT NULL\n</code></pre>"},{"location":"notes_de_cours/operateur/#exists","title":"EXISTS","text":"<p>L'op\u00e9rateur EXISTS est utilis\u00e9e pour d\u00e9terminer si le r\u00e9sultat d'une sous-requ\u00eate retourne des enregistrements ou non.   Il retournera TRUE si la sous-requ\u00eate contient un ou plusieurs enregistrement et FALSE dans le cas contraire. Le traitement se termine d\u00e8s qu'une ligne correspondante dans la sous-requ\u00eate est trouv\u00e9e. </p> <p>Syntaxe</p> <pre><code>SELECT nom_colonne\nFROM ma_table\nWHERE EXISTS(sous-requ\u00eate);\n</code></pre> <p>Exemple</p> <p>\u00c0 partir des tables suivantes, je veux avoir la liste de tous les athl\u00e8tes qui ont d\u00e9j\u00e0 participer \u00e0 un marathon. La base de donn\u00e9es contient une table athl\u00e8te qui contient la liste de tous les athl\u00e8tes et une table r\u00e9sultat qui contient le r\u00e9sultat \u00e0 une course, le id de l'athl\u00e8te et le id de l'\u00e9preuve (le marathon \u00e0 un id de 4).</p> <pre><code>select *\nfrom athlete a \nwhere exists (\n    select 1 \n    from resultat r \n    where r.epreuve_id = 4 \n          and r.athlete_id = a.id\n    );\n</code></pre> <p>Il est aussi int\u00e9ressant de noter ici que m\u00eame si un athl\u00e8te a particip\u00e9 \u00e0 plus d'un marathon il ne sera affich\u00e9 qu'une fois dans la liste car comme dit plus haut, d\u00e8s qu'il y a une correspondance, la sous-requ\u00eate de la fonction se termine.</p> <p>L'op\u00e9rateur EXISTS peut aussi \u00eatre utilis\u00e9e dans la clause WHERE d'un UPDATE, INSERT et DELETE.</p> <pre><code>DELETE FROM athlete\nWHERE EXISTS(\n    select 1 \n    from resultat r \n    where r.epreuve_id = 4 \n          and r.athlete_id = a.id\n    );\n</code></pre> <p>Dans cette exemple, tous les athl\u00e8tes qui ont d\u00e9j\u00e0 particip\u00e9 \u00e0 un marathon seront supprim\u00e9es.</p> <p>On peut aussi utilis\u00e9 l'op\u00e9rateur NOT pour inverser le r\u00e9sultat. Si on reprends l'exemple o\u00f9 on liste les athl\u00e8tes qui ont d\u00e9j\u00e0 participer \u00e0 un marathon mais qu'on voudrait connaitre l'inverse, c'est-\u00e0-dire d'avoir la liste des athl\u00e8tes qui n'ont jamais particip\u00e9 \u00e0 un marathon. Il suffit d'ajouter NOT devant le EXISTS pour inverser le r\u00e9sultat et avoir la r\u00e9ponse recherch\u00e9.</p> <pre><code>select *\nfrom athlete a \nwhere not exists (\n    select 1 \n    from resultat r \n    where r.epreuve_id = 4 \n          and r.athlete_id = a.id\n    );\n</code></pre> <p>Pour plus d'exemple :</p> <ul> <li>https://sql.sh/cours/where/exists</li> <li>https://www.mysqltutorial.org/mysql-exists/</li> <li>https://www.w3schools.com/sql/sql_exists.asp</li> </ul>"},{"location":"notes_de_cours/schema_conceptuel/","title":"Le schema conceptuel","text":"<p>Dans le sch\u00e9ma conceptuel, les diff\u00e9rents \u00e9l\u00e9ments du mod\u00e8le entit\u00e9-association seront repr\u00e9sent\u00e9s de la fa\u00e7on suivante:</p> <ul> <li>Les entit\u00e9s sont d\u00e9fini par des rectangles avec leur nom en ent\u00eate.</li> <li>Les attributs seront nomm\u00e9s dans le rectangle leur entit\u00e9 ou association.</li> <li>Les associations seront repr\u00e9sent\u00e9es par un cercle avec le verbe ou le mot le d\u00e9finissant.</li> </ul> <p>Des traits relieront les entit\u00e9s aux associations. On va aussi ajouter une multiplicit\u00e9 \u00e0 chaque trait marquant une association. Une multiplicit\u00e9 se note x..y, o\u00f9 x indique le nombre minimal d'objets reli\u00e9s et y la valeur minimal. On utilise des nombres entiers positifs comme valeur, mais on peut aussi indiquer le symbole * qui d\u00e9signe plusieurs sans donner de limite.</p> <p>Prenons l'exemple suivant</p> <p></p> <p>On a dans cette exemple 4 entit\u00e9s (pays, auteur, livre et genre) ayant chacune des attributs. Remarquez que j'ai ajout\u00e9 des attributs id \u00e0 chaque entit\u00e9 car elles ne poss\u00e9daient pas d'identifiant naturel. On peut aussi voir qu'il y a trois associations: Est originaire de, R\u00e9dige et Appartient. Regardons maintenant les multiplicit\u00e9s. </p> <p>Astuce</p> <p>Les multiplicit\u00e9s sont importantes pour d\u00e9terminer les contraintes.</p> <p>Un truc pour les lire est de commencer par le nom de l'entit\u00e9, ensuite le verbe de l'association, la multiplicit\u00e9 et finalement la deuxi\u00e8me entit\u00e9. Si on prend par exemple l'association R\u00e9dige, on va lire que l'auteur peut r\u00e9diger entre 0 et plusieurs livres (0..*). \u00c0 l'inverse un livre peut \u00eatre r\u00e9dig\u00e9 par au moins un auteur mais aussi par plusieurs (1..*).</p>"},{"location":"notes_de_cours/type_relation/","title":"Types de relations","text":"<p>Il existe trois types possibles de relation entre les tables : </p>"},{"location":"notes_de_cours/type_relation/#un-a-plusieurs-1-n","title":"Un \u00e0 plusieurs (1-n)","text":"<ul> <li>Prenons par exemple un jeu d'aventure qui comprend les tables usagers et personnages (dans ce jeu un usager peut se cr\u00e9er plus d'une partie simultan\u00e9ment). Un usager peut avoir plusieurs personnages, mais chaque personnage est propre \u00e0 un usager.</li> <li>Pour repr\u00e9senter cette relation dans la structure de la base de donn\u00e9es, on va prendre la cl\u00e9 primaire de la table qui correspond au cas unique (ici l'usager) et on va l'ajouter \u00e0 la table \"plusieurs\" (le personnage). </li> </ul>"},{"location":"notes_de_cours/type_relation/#plusieurs-a-plusieurs-n-n","title":"Plusieurs \u00e0 plusieurs (n-n)","text":"<ul> <li>Encore dans ce m\u00eame jeu, on a une table inventaire et une table item. Le personnage peut avoir un inventaire qui contient plusieurs fois le m\u00eame item, et chaque item peut \u00eatre contenu dans plusieurs inventaires diff\u00e9rents. On a donc une relation de plusieurs \u00e0 plusieurs.</li> <li>Au niveau de sa repr\u00e9sentation, on va cr\u00e9er une troisi\u00e8me table \"de jonction\" qui va d\u00e9composer la relation de plusieurs \u00e0 plusieurs en des relations un \u00e0 plusieurs. Pour se faire, on va utiliser la m\u00eame technique que pour la relation 1-n. Dans notre exemple il y aura une relation entre la cl\u00e9 primaire de la table inventaire et un champ \"inventaire_id\" de la table jonction. M\u00eame chose pour la table item et une relation avec la cl\u00e9 primaire et un champ \"item_id\" dans la table jonction.</li> </ul>"},{"location":"notes_de_cours/type_relation/#un-a-un-1-1","title":"Un \u00e0 un (1-1)","text":"<p>Dans cette relation, chaque entr\u00e9e de la premi\u00e8re table ne peut se retrouver qu'une seule fois dans la seconde et vice versa. Cette forme de relation n'est pas tr\u00e8s courante, car habituellement les donn\u00e9es des deux tables seraient stock\u00e9es dans une seule. On pourrait par exemple l'utiliser pour stocker les informations plus sensibles de l'usager dans une autre table.</p> <p></p>"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/","title":"Assurer la confidentialit\u00e9 et la coh\u00e9rence des donn\u00e9es","text":""},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#transactions","title":"Transactions","text":"<p>En SQL, une transaction est une s\u00e9rie d'instructions ou de requ\u00eates qui doivent \u00eatre ex\u00e9cut\u00e9 en un seul bloc. Cette s\u00e9rie d'op\u00e9rations peut \u00eatre accept\u00e9 (COMMIT) ou refus\u00e9 (ROLLBACK). C'est un pratique qui est essentiel quand on veut lancer une s\u00e9rie d'op\u00e9ration et s'assurer de l'int\u00e9grit\u00e9 de notre base de donn\u00e9es. \u00c7a nous prot\u00e8ge \u00e0 la fois des erreurs humaines (erreur dans le code, mauvaise manipulation des donn\u00e9es, etc.) et des erreurs externes (pannes de serveur durant un traitement par exemple).</p>"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#demarrer-une-transaction","title":"D\u00e9marrer une transaction","text":""},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#autocommit","title":"AUTOCOMMIT","text":"<p>Par d\u00e9faut MySQL n'utilise pas les transactions et toutes les requ\u00eates sont automatiquement valid\u00e9es. On peut modifier ce comportement en changeant la valeur de la variable syst\u00e8me autocommit. Attention, la variable autocommit est une variable de session, c'est-\u00e0-dire que la modification qu'on y fait n'est valide que pour la session en cours et qu'elle reprendra sa valeur par d\u00e9faut \u00e0 la session suivante.</p> <p>Exemple</p> <pre><code>-- Modification pour que les requ\u00eates ne soit plus automatiquement \"commit\u00e9\"\nSET autocommit = 0;\n\n-- Insertion d'un enregistrement\ninsert into athlete (nom, prenom) \nvalues ('Fr\u00e9chette', 'Mathieu');\n\n-- \u00c9tant donn\u00e9 que la variable autocommit est maintenant \u00e0 false, \n-- l'insertion ne sera permanente qu'apr\u00e8s avoir valid\u00e9 la transaction\n</code></pre>"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#start-transaction","title":"START TRANSACTION","text":"<p>La fa\u00e7on la plus courante de d\u00e9marrer une transaction est d'utiliser la commande START TRANSACTION. Une fois la commande lanc\u00e9e, toutes les requ\u00eates suivantes seront \"en attente\" tant que la transaction ne sera pas termin\u00e9e. </p> <p>Exemple</p> <pre><code>-- Pour l'exemple, je m'assure que la valeur de la variable autocommit est bien \u00e0 TRUE.\n-- C'est la valeur par d\u00e9faut, on n'est pas oblig\u00e9 de le sp\u00e9cifi\u00e9 en temps normal.\nSET autocommit = 1;\n-- D\u00e9but de la transaction\nSTART TRANSACTION;\n\n-- Insertion d'un enregistrement\ninsert into athlete (nom, prenom) \nvalues ('Fr\u00e9chette', 'Mathieu');\n\n-- \u00c9tant donn\u00e9 qu'on a d\u00e9but\u00e9 une transaction, l'insertion ne sera permanente \n-- qu'apr\u00e8s l'avoir valid\u00e9e ou annul\u00e9e.\n</code></pre>"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#terminer-une-transaction","title":"Terminer une transaction","text":""},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#commit","title":"COMMIT","text":"<p>Si toutes les requ\u00eates se sont bien ex\u00e9cut\u00e9 et qu'on veut confirmer les changements, on va utiliser la commande COMMIT. Les modifications apport\u00e9es seront maintenant permanentes et la transaction va se terminer. </p> <p>Exemple</p> <pre><code>BEGIN TRANSACTION;\n-- Op\u00e9rations \u00e0 effectuer\n...\n\n-- Valider la transaction et rendre les op\u00e9rations permanentes.\nCOMMIT;\n</code></pre>"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#rollback","title":"ROLLBACK","text":"<p>Pour terminer la transaction en annulant TOUTES les modifications effectu\u00e9es, on va utiliser la commande ROLLBACK. </p> <p>Exemple</p> <pre><code>BEGIN TRANSACTION;\n-- Op\u00e9rations \u00e0 effectuer\n...\n\n-- Annuler toutes les op\u00e9rations depuis le d\u00e9but de la transaction\nROLLBACK;\n</code></pre>"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#utiliser-des-points-de-sauvegarde","title":"Utiliser des points de sauvegarde","text":"<p>On ne peut pas d\u00e9buter une seconde transaction \"\u00e0 l'int\u00e9rieur\" d'une transaction d\u00e9j\u00e0 d\u00e9but\u00e9e. Par contre on peut cr\u00e9er des points de sauvegarde qui nous permettront d'annuler uniquement les op\u00e9rations effectu\u00e9es depuis un point de sauvegarde. </p>"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#savepoint","title":"SAVEPOINT","text":"<p>Pour cr\u00e9er un point de sauvegarde, on va utiliser la commande SAVEPOINT.  On peut d\u00e9finir plusieurs point de sauvegarde \u00e0 l'int\u00e9rieur d'une m\u00eame transaction.</p> <pre><code>SAVEPOINT nom_du_savepoint\n</code></pre>"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#rollback-to-savepoint","title":"ROLLBACK TO SAVEPOINT","text":"<p>Une fois le point de sauvegarde cr\u00e9er, on peut annuler uniquement les transactions effectu\u00e9es depuis celui-ci.</p> <p>Exemple</p> <pre><code>-- D\u00e9but de la transaction\nSTART TRANSACTION;\n\n-- Insertion d'un enregistrement\ninsert into athlete (nom, prenom) \nvalues ('Fr\u00e9chette', 'Mathieu');\n\n-- Cr\u00e9ation d'un point de sauvegarde\nSAVEPOINT save_Math;\n\n-- Insertion d'un second enregistrement\ninsert into athlete (nom, prenom) \nvalues ('Fr\u00e9chette', 'Marianne');\n\n-- Annulation jusqu'au savepoint save_Math\nROLLBACK TO SAVEPOINT save_Math;\n\n-- Validation de la transaction\nCOMMIT;\n\n-- L'athl\u00e8te Mathieu Fr\u00e9chette sera ins\u00e9r\u00e9 dans la base de donn\u00e9es mais pas Marianne Fr\u00e9chette.\n</code></pre>"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#commandes-qui-terminent-automatiquement-une-transaction","title":"Commandes qui terminent automatiquement une transaction","text":"<p>Attention, certaines commandes SQL vont cl\u00f4turer automatiquement une transaction et aussi valider toutes les op\u00e9rations, comme si on aurait utilis\u00e9 la commande COMMIT. Voici une liste de ces commandes</p> <ul> <li>Toutes les commandes qui apportent une modification \u00e0 la base de donn\u00e9es vont valider une transaction</li> <li>La cr\u00e9ation ou suppression d'une base de donn\u00e9es</li> <li>Toutes les modifications apport\u00e9es aux tables, cr\u00e9ation, modification, etc...</li> <li>La cr\u00e9ation ou suppression d'un index.</li> <li>La cr\u00e9ation de proc\u00e9dures stock\u00e9es, de fonctions ou de vues.</li> <li>La cr\u00e9ation, suppression ou modification d'un utilisateur.</li> <li>Le d\u00e9but d'une nouvelle transaction sans avoir termin\u00e9 la premi\u00e8re.</li> <li>Changer la valeur de la variable autocommit \u00e0 TRUE.</li> <li>La cr\u00e9ation ou suppression d'un LOCK sur une table.</li> </ul>"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#sources","title":"Sources","text":"<ul> <li>https://dev.mysql.com/doc/refman/8.0/en/sql-transactional-statements.html</li> <li>https://www.javatpoint.com/mysql-transaction</li> <li>https://openclassrooms.com/fr/courses/1959476-administrez-vos-bases-de-donnees-avec-mysql/1970063-transactions</li> <li>https://www.mysqltutorial.org/mysql-transaction.aspx</li> </ul>"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#gestion-des-utilisateurs-et-des-autorisations","title":"Gestion des utilisateurs et des autorisations","text":"<p>Pour se connecter \u00e0 MySQL on doit avoir en main un utilisateur et un mot de passe. Chaque utilisateurs \u00e0 ses propres privil\u00e8ges sur ce qui peut faire ou non dans la base de donn\u00e9es. Les informations sur les utilisateurs et leur privil\u00e8ges sont stock\u00e9s dans les tables suivantes de la base de donn\u00e9es mysql : </p> <ul> <li>user : les informations sur les utilisateurs.</li> <li>db, tables_priv, columns_priv et proc_priv : les privil\u00e8ges de l'utilisateur.</li> </ul> <p>On peut modifier les valeurs de ces tables mais il est pr\u00e9f\u00e9rable de ne pas le faire directement dans ces tables mais avec les commandes appropri\u00e9es.</p>"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#creer-un-utilisateur","title":"Cr\u00e9er un utilisateur","text":"<p>On utilise la commande CREATE USER en sp\u00e9cifiant un nom d'utilisateur, un h\u00f4te et un mot de passe. L'h\u00f4te est optionnel et repr\u00e9sente l'adresse \u00e0 partir de laquelle l'utilisateur va se connecter. On utilise souvent localhost ou 127.0.0.1, ce qui veut dire que l'utilisateur pourra se connecter \u00e0 partir de la machine o\u00f9 est situ\u00e9 le serveur. Si on ne sp\u00e9cifie pas d'h\u00f4te, l'utilisateur pourra se connecter depuis n'importe quel h\u00f4te.</p> <pre><code>CREATE USER 'nomUtilisateur'@'hote' IDENTIFIED BY 'motDePasse';\n\n-- Exemple\nCREATE USER 'math'@'localhost' IDENTIFIED BY 'qwerty4ever';\nCREATE USER 'patate'@'156.20.12.2' IDENTIFIED BY 'qwerty4ever';\n</code></pre> <p>On peut utiliser le joker % pour permettre la cr\u00e9ation d'un utilisateur qui va pouvoir se connecter depuis plus d'un h\u00f4te : </p> <pre><code>-- L'utilisateur va pourvoir se connecter depuis n'importe quel h\u00f4te dont \n-- l'adresse ip commence par 156.20.12\nCREATE USER 'math'@'156.20.12.%' IDENTIFIED BY 'qwerty4ever';\n\n-- L'utilisateur va pouvoir se connecter depuis n'importe quel h\u00f4te\nCREATE USER 'math'@'%' IDENTIFIED BY 'qwerty4ever';\n</code></pre>"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#modifier-le-nom-dun-utilisateur","title":"Modifier le nom d'un utilisateur","text":"<p>Pour modifier le nom d'un utilisateur, on utilise la commande RENAME USER : </p> <pre><code>RENAME USER 'Math'@'localhost' TO 'Mathieu'@'localhost';\n</code></pre>"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#supprimer-un-utilisateur","title":"Supprimer un utilisateur","text":"<p>Pour supprimer un utilisateur, on va utiliser DROP USER : </p> <pre><code>DROP USER 'Math'@'localhost'\n</code></pre>"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#gestion-des-autorisations","title":"Gestion des autorisations","text":""},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#ajouter-ou-enlever-de-privileges","title":"Ajouter ou enlever de privil\u00e8ges","text":"<pre><code>-- Syntaxe pour ajouter un privil\u00e8ge\nGRANT nomDuPrivilege (listeDesColonnes)\nON niveauPrivilege\nTO nomUsager\n\n-- Syntaxe pour enlever un privil\u00e8ge\nREVOKE nomDuPrivilege\nON niveauPrivilege\nFROM nomUsager\n</code></pre> <ul> <li>nomDuPrivilege : Le nom du privil\u00e8ge \u00e0 ajouter (SELECT, INSERT, CREATE TABLE, etc.). On peut en mettre plusieurs en les s\u00e9parant par une virgule.</li> <li>listeDesColonnes : C'est optionnel mais on peut sp\u00e9cifier les colonnes sur lesquelles le privil\u00e8ge est appliqu\u00e9. On pourrait par exemple accorder le droit \u00e0 un usager de faire un UPDATE mais seulement pour des colonnes sp\u00e9cifiques d'une table.</li> <li>niveauPrivilege : \u00c0 quel niveau s'applique le privil\u00e8ge. (Globalement, seulement pour une base de donn\u00e9es en particulier, pour une table pr\u00e9cise, etc.)</li> <li>nomUsager : \u00c0 quel usager on veut octroyer le privil\u00e8ge.</li> </ul> <p>Exemple</p> <pre><code>/* Octroyer \u00e0 l'usager test le droit de faire des requ\u00eates select et insert sur toutes \nles tables de la base de donn\u00e9es credit_social\n */\nGRANT SELECT, INSERT\nON credit_social.*\nTO test@localhost;\n</code></pre>"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#liste-des-privileges","title":"Liste des privil\u00e8ges","text":"<p>Voici une courte liste de privil\u00e8ges qu'on peut ajouter \u00e0 un usager : </p> <ul> <li>ALL, tous les privil\u00e8ges, sauf celui d'en accorder.</li> <li>USAGE, aucun privil\u00e8ges</li> <li>GRANT OPTION, accorde le droit d'ajouter des privil\u00e8ges (il n'est pas inclus quand on utilise ALL)</li> <li>SELECT, INSERT, UPDATE, DELETE, pour les requ\u00eates CRUD correspondante</li> <li>CREATE TABLE, ALTER, DROP, pour des op\u00e9rations sur les tables et la base de donn\u00e9es.</li> <li>CREATE ROUTINE, ALTER ROUTINE, EXECUTE, pour des op\u00e9rations sur les proc\u00e9dures stock\u00e9es.</li> </ul> <p>Il y a beaucoup d'autres privil\u00e8ges qu'on peut octroyer, vous pouvez consulter une liste plus compl\u00e8te dans la documentation de MySQL : </p> <ul> <li>https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html</li> </ul>"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#niveau-des-privileges","title":"Niveau des privil\u00e8ges","text":"<p>L'indicateur du niveau de privil\u00e8ges se compose en deux sections, la ou les base de donn\u00e9es et ensuite le nom de la table ou de la proc\u00e9dure stock\u00e9e.</p> <ul> <li>*.* : Toutes les bases de donn\u00e9es et toutes les tables/proc\u00e9dures stock\u00e9es</li> <li>credit_social.* : Pour la base de donn\u00e9es credit_social, toutes les tables</li> <li>credit_social.classe : Pour la base de donn\u00e9es credit_social, la table classe uniquement.</li> </ul>"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#afficher-les-autorisations-dun-utilisateur","title":"Afficher les autorisations d'un utilisateur","text":"<pre><code>SHOW GRANTS FOR 'usager'@'localhost';\n</code></pre>"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#gestions-des-erreurs","title":"Gestions des erreurs","text":"<p>En attendant des notes plus compl\u00e8te sur le sujet, voici un petit extrait de code sur une gestion de base dans une proc\u00e9dure stock\u00e9e.</p> <pre><code>DECLARE EXIT HANDLER FOR SQLEXCEPTION\nBEGIN \n    ROLLBACK; \n    RESIGNAL;\nEND;\n\nSTART TRANSACTION;      \n\n    -- Mes op\u00e9rations\n\nCOMMIT;\n</code></pre>"},{"location":"notes_de_cours/mySQL/Assurer%20la%20confidentialit%C3%A9%20et%20la%20coh%C3%A9rence%20des%20donn%C3%A9es/#sources_1","title":"Sources","text":"<ul> <li>https://www.mysqltutorial.org/mysql-error-handling-in-stored-procedures/</li> <li>https://dev.mysql.com/doc/refman/8.0/en/declare-handler.html</li> <li>https://dev.mysql.com/doc/refman/8.0/en/resignal.html</li> </ul>"},{"location":"notes_de_cours/mySQL/convention/","title":"Convention de nommage MySQL","text":"<p>Bien que MySQL n'a pas vraiment de convention de nommage officiel, voici certaines des r\u00e8gles les plus utilis\u00e9es : </p>"},{"location":"notes_de_cours/mySQL/convention/#regles-generales","title":"R\u00e8gles g\u00e9n\u00e9rales","text":"<ul> <li>Toujours \u00e9crire les noms en minuscule. \u00c7a peut aider \u00e0 \u00e9viter les erreurs, car MySQL est sensible \u00e0 la case</li> <li>Ne jamais utiliser d'espace, la remplacer par une barre de soulignement \"_\"</li> <li>Utilisez seulement des lettres dans les noms, pas de nombres ni de caract\u00e8res sp\u00e9ciaux</li> <li>\u00c9vitez d'utiliser un pr\u00e9fix dans le nom, \u00e7a complique inutilement le nom et nuit \u00e0 la visibilit\u00e9.</li> </ul>"},{"location":"notes_de_cours/mySQL/convention/#nom-des-tables","title":"Nom des tables","text":"<ul> <li>Le nom doit \u00eatre au singulier</li> <li>Le nom doit \u00eatre en minuscule</li> <li>Ne pas utiliser de pr\u00e9fix sauf si c'est in\u00e9vitable.</li> <li>Le nom doit \u00eatre clair et explicite</li> <li>Ne pas utiliser d'abr\u00e9viation</li> </ul>"},{"location":"notes_de_cours/mySQL/convention/#nom-des-champs","title":"Nom des champs","text":"<ul> <li>Le nom doit \u00eatre en minuscule, sans espace et sans nombres.</li> <li>On doit \u00e9viter les pr\u00e9fixes</li> <li>Utilisez un nom court, sans utiliser abr\u00e9viation par contre.</li> <li>Ne pas utiliser de mot r\u00e9serv\u00e9 comme nom de champs, comme date par exemple</li> <li>Le nom d'une cl\u00e9 \u00e9trang\u00e8re devrait contenir le nom de la table et de sa cl\u00e9 primaire. Une cl\u00e9 \u00e9trang\u00e8re vers la table usager dont la cl\u00e9 primaire est le champ id devrait \u00eatre nomm\u00e9e usager_id</li> </ul>"},{"location":"notes_de_cours/mySQL/create_database/","title":"Cr\u00e9ation de base de donn\u00e9es","text":""},{"location":"notes_de_cours/mySQL/create_database/#creer","title":"Cr\u00e9er","text":"<p>La commande cr\u00e9er une base de donn\u00e9es est <code>CREATE DATABASE</code> suivi du nom \u00e0 donner. On peut aussi ajouter le type de jeu de charact\u00e8re \u00e0 et la collation ou laisser les valeurs par d\u00e9faut.</p>"},{"location":"notes_de_cours/mySQL/create_database/#jeu-de-caractere","title":"Jeu de caract\u00e8re","text":"<p>D\u00e9termine les caract\u00e8res que MySQL utilise pour stocker les valeurs dans les tables. Par d\u00e9faut on utilise utf8mb4 qui repr\u00e9sente les caract\u00e8res utilis\u00e9s par la majorit\u00e9 des langues occidentales. Pour changer la valeur par d\u00e9faut on va utiliser <code>CHARACTER SET</code> suivi du nom du jeu de caract\u00e8re. </p> <p>On peut lister tous les jeu de caract\u00e8res avec la requ\u00eate <code>SHOW CHARACTER SET;</code></p>"},{"location":"notes_de_cours/mySQL/create_database/#collation","title":"Collation","text":"<p>La collation est une s\u00e9rie de r\u00e8gle qui va indiquer comment les caract\u00e8res sont compar\u00e9s entre eux, comme par exemple la sensibilit\u00e9 \u00e0 la case ou la fa\u00e7on de trier le texte. La valeur par d\u00e9faut <code>utf8mb4_general_ci</code>. Cette collation a \u00e9t\u00e9 d\u00e9velopp\u00e9 pour acc\u00e9lerer le traitemment au prix de la pr\u00e9cision. Je vous conseille d'utiliser la collation <code>utf8mb4_unicode_ci</code>. Pour changer la valeur par d\u00e9faut on va utiliser <code>COLLATE</code> suivi du nom de la collation.</p> <p>On peut lister tous les jeu de caract\u00e8res avec la requ\u00eate <code>SHOW COLLATION;</code></p> <p>Syntaxe du create database : </p> <pre><code>    CREATE DATABASE 'nom_de_la_bd'\n    CHARACTER SET = 'utf8mb4'\n    COLLATE = 'utf8mb4_unicode_ci';\n</code></pre>"},{"location":"notes_de_cours/mySQL/create_database/#modifier","title":"Modifier","text":"<p>Pour modifier une base de donn\u00e9es on utilise la commande <code>ALTER DATABASE</code>. On peut utiliser aussi les m\u00eames options qu'avec le create database.</p> <p>Syntaxe du alter database : </p> <pre><code>    ALTER DATABASE 'nom_de_la_bd'\n    CHARACTER SET = 'utf8mb4'\n    COLLATE = 'utf8mb4_unicode_ci';\n</code></pre>"},{"location":"notes_de_cours/mySQL/create_database/#supprimer","title":"Supprimer","text":"<p>Nous allons utiliser la commande <code>DROP DATABASE</code> suivi du nom de la base de donn\u00e9es \u00e0 supprimer. Si elle n'existe pas, MySQL va g\u00e9n\u00e9rer une erreur. Pour l'eviter, on peut ajouter <code>IF EXISTS</code> avant le nom de la base de donn\u00e9es.</p> <pre><code>    DROP DATABASE IF EXISTS nom_de_la_bd;\n</code></pre>"},{"location":"notes_de_cours/mySQL/create_database/#source","title":"Source","text":"<ul> <li>Documentation Create table</li> <li>Jeux de caract\u00e8re et collation</li> <li>Diff\u00e9rence entre utf8mb4_general_ci et utf8mb4_unicode_ci</li> </ul>"},{"location":"notes_de_cours/mySQL/create_table/","title":"Cr\u00e9ation de table MySQL","text":""},{"location":"notes_de_cours/mySQL/create_table/#creer","title":"Cr\u00e9er","text":"<p>La commande pour cr\u00e9er une table est <code>CREATE TABLE</code>. On peut d\u00e9finir un paquet d'options \u00e0 cette commande, on va s'en tenir ici aux principales. Vous avez la liste de toutes les options dans la documentation que j'ai mis en lien en bas de page.</p> <p>On commence par utilisez la commande <code>CREATE TABLE</code> avec le nom de la table \u00e0 cr\u00e9er. On peut ajouter <code>IF NOT EXISTS</code> avant le nom de la table pour le cr\u00e9er uniquement si elle ne l'est pas d\u00e9j\u00e0. Ensuite entre parenth\u00e8se on va lister les colonnes avec leur nom, leur type de donn\u00e9es et d'autres attributs qu'on voudrait leur donner. On peut aussi d\u00e9finir dans ses parenth\u00e8ses les cl\u00e9 primaires, \u00e9trang\u00e8res et les contraintes. Apr\u00e8s la parenth\u00e8se on pourra ajouter des options relatives \u00e0 la table, comme le moteur de bd (engine) et la collation.</p> <p>Exemple de syntaxe</p> <pre><code>CREATE TABLE IF NOT EXISTS `nom_table` (\n    `colonne1` INT AUTO_INCREMENT,\n    `colonne2` INT,\n    `colonne3` VARCHAR(255) NOT NULL,\n    PRIMARY KEY (`colonne1`),\n    CONSTRAINT `colonne2_fk` FOREIGN KEY (`colonne2`) REFERENCES `table_destination` (`colonne_id`) ON UPDATE RESTRICT ON DELETE CASCADE\n) ENGINE=INNODB;\n</code></pre> <p>Atention</p> <p>Si vous ajouter des cl\u00e9s \u00e9trang\u00e8res dans la cr\u00e9ation de la table, vous devez vous assurez que les colonnes et les tables sont d\u00e9j\u00e0 cr\u00e9\u00e9es. Vous pouvez toujours les cr\u00e9er apr\u00e8s avoir fait la cr\u00e9ation de table en faisant une modification de table.</p>"},{"location":"notes_de_cours/mySQL/create_table/#modifier","title":"Modifier","text":"<p>Pour modifier une table on utilise la commande <code>ALTER TABLE</code>. On peut utiliser aussi les m\u00eames options qu'avec le create table.</p> <p>Syntaxe du alter table : </p> <pre><code>    ALTER TABLE `nom_table`\n    ADD CONSTRAINT `colonne2_fk` \n        FOREIGN KEY (`colonne2`) \n        REFERENCES table_destination (`colonne_id`) \n        ON UPDATE RESTRICT ON DELETE CASCADE;\n</code></pre>"},{"location":"notes_de_cours/mySQL/create_table/#supprimer","title":"Supprimer","text":"<p>Nous allons utiliser la commande <code>DROP TABLE</code> suivi du nom de la table \u00e0 supprimer. Si elle n'existe pas, MySQL va g\u00e9n\u00e9rer une erreur. Pour l'eviter, on peut ajouter <code>IF EXISTS</code> avant le nom de la table.</p> <pre><code>    DROP TABLE IF EXISTS `nom_de_la_bd`;\n</code></pre>"},{"location":"notes_de_cours/mySQL/create_table/#source","title":"Source","text":"<ul> <li>Documentation Create table</li> <li>Article avec exemple plus bref</li> </ul>"},{"location":"notes_de_cours/mySQL/curseur/","title":"Les curseurs","text":"<p>Parfois on peut vouloir effectuer un traitement sur chaque lignes du r\u00e9sultat d'une requ\u00eate. Les curseurs (cursor) nous permettent justement de parcourir ligne par ligne un r\u00e9sultat, un peu \u00e0 la mani\u00e8re d'une boucle \"while\" en programmation. </p> <p>Il y a trois caract\u00e9ristiques \u00e0 savoir sur les curseurs :</p> <ul> <li>Ils sont en lecture seule, on ne peut pas modifier les valeurs du r\u00e9sultat.</li> <li>On ne peut que parcourir les lignes du r\u00e9sultat de la premi\u00e8re \u00e0 la derni\u00e8re et on ne peut pas sauter de ligne. Pour modifier \"l'ordre de lecture\" on doit utiliser le r\u00e9sultat avec la clause ORDER BY de la requ\u00eate qui g\u00e9n\u00e9rera le r\u00e9sultat. </li> <li>En MySQL, les donn\u00e9es du curseurs pointent vers les vrais donn\u00e9es de la base de donn\u00e9es. Ce qui veut dire que si une modification est faite durant l'utilisation du curseur, les donn\u00e9es de celui-ci seront aussi modifi\u00e9es.</li> </ul> <p>On peut utiliser les curseurs dans des proc\u00e9dures stock\u00e9es, des fonctions et des \"triggers\".</p> <p>L'utilisation des curseurs se fait en quatre \u00e9tapes : </p> <ul> <li>DECLARE : On d\u00e9clare notre curseur en lui sp\u00e9cifiant la requ\u00eate qui sera utilis\u00e9e</li> <li>OPEN : On \"ouvre\" notre curseur. On le place dans un \u00e9tat o\u00f9 il pourra recevoir les donn\u00e9es</li> <li>FETCH : On ajoute les donn\u00e9es de la ligne courante du r\u00e9sultat de la requ\u00eate. La valeur de chaque colonnes de la ligne de r\u00e9sultat sera ajout\u00e9 dans une variable que l'on aura d\u00e9clar\u00e9e pr\u00e9alablement.</li> <li>CLOSE : On ferme le curseur une fois notre utilisation termin\u00e9e.</li> </ul>"},{"location":"notes_de_cours/mySQL/curseur/#declaration-du-curseur","title":"D\u00e9claration du curseur","text":"<p>La d\u00e9claration du curseur doit se faire apr\u00e8s la d\u00e9claration des autres variables sinon MySQL va g\u00e9n\u00e9rer un erreur. La syntaxe pour d\u00e9clarer un curseur est la suivante : </p> <pre><code>DECLARE mon_curseur CURSOR FOR requete_select;\n</code></pre> <p>On doit toujours utiliser une requ\u00eate SELECT pour g\u00e9n\u00e9rer le r\u00e9sultat qui va \u00eatre utilis\u00e9 par le curseur. Voici un exemple o\u00f9 l'on voudrait utiliser le matricule des employ\u00e9es qui ont \u00e9t\u00e9 embauch\u00e9 il y a 5 ans ou plus</p> <pre><code>DECLARE curseur_employe CURSOR FOR\n    SELECT matricule \n    FROM employe\n    WHERE TIMESTAMPDIFF(year,date_embauche, now()) &gt;= 5;\n</code></pre>"},{"location":"notes_de_cours/mySQL/curseur/#ouverture-du-curseur","title":"Ouverture du curseur","text":"<p>Pour ouvrir le curseur, on doit simplement utiliser la commande OPEN suivie du nom du curseur : </p> <pre><code>OPEN mon_curseur;\n</code></pre> <p>Si on reprend l'exemple plus haut, on ferais </p> <pre><code>OPEN curseur_employe;\n</code></pre>"},{"location":"notes_de_cours/mySQL/curseur/#ajout-de-donnees-au-curseur","title":"Ajout de donn\u00e9es au curseur","text":"<p>Une fois le curseur disponible, on peut y ajouter des donn\u00e9es avec la commande FETCH. On le verra plus loin mais le cette op\u00e9ration s'effectue \u00e0 l'int\u00e9rieur d'une boucle. Le r\u00e9sultat du FETCH sera les valeurs des colonnes du r\u00e9sultat pour la ligne courante. La syntaxe est la suivante : </p> <pre><code>FETCH mon_curseur INTO liste de variable;\n</code></pre> <p>Les variables doivent \u00eatre s\u00e9par\u00e9es par des espaces et correspondre au nombre de colonnes du r\u00e9sultat. Ces variables auront \u00e9t\u00e9 d\u00e9clar\u00e9 au d\u00e9but de la proc\u00e9dure comme on l'expliquait plus haut. En reprenant notre exemple, nom allons assigner la valeur du matricule de la ligne courante du r\u00e9sultat dans une variable nomm\u00e9e no_matricule : </p> <pre><code>FETCH curseur_employe INTO no_matricule;\n</code></pre> <p>Chaque fois qu'on execute la commande FETCH,  MySQL essaie de lire la ligne suivante du r\u00e9sultat. S'il n'y a plus d'enregistrement (qu'on est \u00e0 la derni\u00e8re ligne), une exception sera lev\u00e9. On doit g\u00e9rer cette exception si on veut que tout se d\u00e9roule bien. Pour se faire, on va ajouter un HANDLER. Sa d\u00e9claration se fera apr\u00e8s la d\u00e9claration du curseur (on va voir plus loin l'ordre en d\u00e9tail avec un exemple).</p> <pre><code>DECLARE CONTINUE HANDLER FOR NOT FOUND SET fin_enregistrement = 1;\n</code></pre> <p>En r\u00e9sum\u00e9, on indique \u00e0 MySQL que si il rencontre l'exception NOT FOUND de continuer le traitement (CONTINUE) et d'assigner \u00e0 la variable fin_enregistrement la valeur 1. La variable fin_enregistrement aura \u00e9t\u00e9 d\u00e9clar\u00e9 plus haut.</p>"},{"location":"notes_de_cours/mySQL/curseur/#fermeture-du-curseur","title":"Fermeture du curseur","text":"<p>Finalement, une fois notre traitement termin\u00e9, il nous reste qu'\u00e0 fermer le curseur. </p> <p><pre><code>CLOSE mon_curseur;\n</code></pre> ou avec notre exemple</p> <pre><code>CLOSE curseur_employe;\n</code></pre>"},{"location":"notes_de_cours/mySQL/curseur/#exemple-dune-procedure-utilisant-un-curseur","title":"Exemple d'une proc\u00e9dure utilisant un curseur","text":"<p>Une entreprise veut cr\u00e9er deux listes de diffusion pour ses employ\u00e9es, une premi\u00e8re pour les employ\u00e9es qui compte moins de x ann\u00e9es d'anciennet\u00e9s et une pour les autres (le nombre d'ann\u00e9es sera re\u00e7u en param\u00eatre). La liste comportera le nom et pr\u00e9nom de l'employ\u00e9 ainsi que son adresse courriel. Dans la base de donn\u00e9es il y a d\u00e9j\u00e0 deux tables qui ont \u00e9t\u00e9 cr\u00e9\u00e9 pour recevoir ces listes : employe_moins et employe_plus. En r\u00e9alit\u00e9 il y aurait plus d'\u00e9tapes en mettre en place dans notre proc\u00e9dure pour s'assurer de l'int\u00e9grit\u00e9 de nos donn\u00e9es (utiliser une transaction, vider les tables avant l'ajout, \"attraper\" les erreurs, etc...). Pour simplifier les choses prenons pour acquis que les tables sont vides et que tout va se d\u00e9rouler sans erreurs comme par magie.</p> <pre><code>DELIMITER $$\nCREATE PROCEDURE generer_liste_employe (IN nombre_annee)\nBEGIN\n    -- D\u00e9claration de la variable utilis\u00e9e dans le handler \"NOT FOUND\"\n    DECLARE fin_enregistrement INTEGER DEFAULT 0;\n    -- D\u00e9claration des variables utilis\u00e9es dans le fetch du curseur\n    DECLARE nom varchar(30) DEFAULT \"\";\n    DECLARE prenom varchar(30) DEFAULT \"\";\n    DECLARE courriel varchar(255) DEFAULT \"\";\n    DECLARE calcul_anciennete INT DEFAULT 0;\n\n    -- D\u00e9claration du curseur des employ\u00e9es\n    DEClARE curseur_employe CURSOR FOR \n        SELECT nom, prenom, email, TIMESTAMPDIFF(year,date_embauche, now()) \n        FROM employees;\n\n    -- D\u00e9claration du handler NOT FOUND\n    DECLARE CONTINUE HANDLER FOR NOT FOUND SET fin_enregistrement = 1;\n\n    -- Ouverture du curseur\n    OPEN curseur_employe;\n\n    -- D\u00e9but de la boucle\n    liste_employee: LOOP\n        -- On assigne les valeurs de la ligne du r\u00e9sultat aux variables\n        FETCH curseur_employe INTO nom, prenom, courriel, calcul_anciennete;\n        -- On s'assure qu'on n'a pas atteind la fin des enregistrements avant de continuer\n        IF fin_enregistrement = 1 THEN \n            LEAVE liste_employee;\n        END IF;\n\n        -- En utilisant la variable calcul_anciennete utilis\u00e9e dans le fetch et le param\u00eatre\n        -- nombre_annee, on valide avec un si dans quelle tables ajout\u00e9es les donn\u00e9es\n        IF  calcul_anciennete &lt; nombre_annee THEN\n            INSERT INTO employe_moins(nom, prenom, courriel) VALUES (nom, prenom, courriel)\n        ELSE\n            INSERT INTO employe_plus(nom, prenom, courriel) VALUES (nom, prenom, courriel)\n        END IF;\n\n    END LOOP liste_employee;\n\n    -- Fermeture du curseur\n    CLOSE curseur_employe;\n\nEND$$\nDELIMITER ;\n</code></pre>"},{"location":"notes_de_cours/mySQL/curseur/#sources-et-documentation-supplementaire","title":"Sources et documentation suppl\u00e9mentaire","text":"<ul> <li>https://dev.mysql.com/doc/refman/8.0/en/cursors.html</li> <li>https://www.mysqltutorial.org/mysql-cursor/</li> </ul>"},{"location":"notes_de_cours/mySQL/error_handling/","title":"Gestion des erreurs","text":"<p>Pour intercepter les erreurs dans un script, une proc\u00e9dure stock\u00e9e, un trigger, on va utiliser des handlers. On peut aussi g\u00e9n\u00e9rer une erreur avec la commande SIGNAL.</p>"},{"location":"notes_de_cours/mySQL/error_handling/#handler","title":"HANDLER","text":"<p>La syntaxe de d\u00e9claration d'un handler est la suivante :  <pre><code>DECLARE handler_action HANDLER FOR condition_value statement;\n</code></pre></p>"},{"location":"notes_de_cours/mySQL/error_handling/#handler_action","title":"handler_action","text":"<p>De qu'elle fa\u00e7on l'ex\u00e9cution des instructions va \u00eatre affect\u00e9e lorsque l'erreur survient.</p> <ul> <li>CONTINUE : L'ex\u00e9cution des instructions va se continuer.</li> <li>EXIT : L'ex\u00e9cution des instructions comprisent \u00e0 l'int\u00e9rieur du bloc BEGIN ... END d'o\u00f9 l'erreur est survenue se termine.</li> </ul>"},{"location":"notes_de_cours/mySQL/error_handling/#condition_value","title":"condition_value","text":"<p>Qu'elle est l'erreur qu'on veut intercepter avec le handler</p> <ul> <li>mysql_error_code : Un code d'erreur MySQL. En voici la liste ici</li> <li>SQLSTATE [VALUE] : O\u00f9 VALUE repr\u00e9sente un code de 5 caract\u00e8re qui repr\u00e9sente un code d'\u00e9tat MySQL. Tr\u00e8s similaire \u00e0 mysql_error_code. Vous pouvez consulter la liste ici</li> <li>condition_name : On peut d\u00e9finir un nom de condition qui est associ\u00e9 \u00e0 un code d'erreur ou d'\u00e9tat et l'utiliser ensuite dans le handler. <pre><code>DECLARE no_such_table CONDITION FOR 1051;\nDECLARE CONTINUE HANDLER FOR no_such_table\n  BEGIN\n    -- body of handler\n  END;\n</code></pre></li> <li>SQLWARNINGS : Un raccourci pour les code d'\u00e9tat SQLSTATE qui commence par 01, le plus souvent des messages d'avertissements</li> <li>NOT FOUND: On l'a vue dans notre utilisation des cursors. Se d\u00e9clenche quand le curseur arrive \u00e0 la fin de ses r\u00e9sultats</li> <li>SQLEXCEPTION: Un raccourci pour les code d'\u00e9tat SQLSTATE qui ne commence pas par 00, 01 ou 02.</li> </ul>"},{"location":"notes_de_cours/mySQL/error_handling/#exemple","title":"Exemple","text":"<p>Quand ma proc\u00e9dure stock\u00e9e provoque une erreur, je veux annuler les op\u00e9rations d\u00e9j\u00e0 effectu\u00e9es et quitter le traitement en affichant un message d'erreur. On va utiliser ROLLBACK pour annuler les op\u00e9rations et SELECT avec notre message d'erreur.</p> <pre><code>CREATE PROCEDURE exemplebd.test_error(valeur INT)\nBEGIN\n\n    DECLARE EXIT HANDLER FOR SQLEXCEPTION\n    BEGIN\n        ROLLBACK;\n        SELECT 'Une erreur est survenue, les op\u00e9rations ont \u00e9t\u00e9 annul\u00e9.';\n    END;\n\n    START TRANSACTION;\n\n    ...\n\n    COMMIT;\nEND\n</code></pre>"},{"location":"notes_de_cours/mySQL/error_handling/#signal","title":"SIGNAL","text":"<p>Avec SIGNAL on va pouvoir g\u00e9r\u00e9ner une erreur qui va stopper l'\u00e9x\u00e9cution du script. On peut aussi jumeler SIGNAL avec un HANDLER</p> <p>La syntaxe de d\u00e9claration de SIGNAL est la suivante : <pre><code>SIGNAL condition_value SET signal_information_item;\n</code></pre></p>"},{"location":"notes_de_cours/mySQL/error_handling/#condition_value_1","title":"condition_value","text":"<p>Comme pour le HANDLER, on va utiliser un SQLSTATE ou une condition qu'on aura d\u00e9fini auparavant. Le plus souvent on va utiliser SQLSTATE = '45000' qui indique une erreur d\u00e9finie par l'utilisateur.</p>"},{"location":"notes_de_cours/mySQL/error_handling/#signal_information_item","title":"signal_information_item","text":"<p>On peut ensuite d\u00e9finir des valeurs \u00e0 des variables pr\u00e9d\u00e9finis associ\u00e9s \u00e0 SIGNAL. Une de cess variables est MESSAGE_TEXT qui nous permet de retourner un message d'erreur. La liste compl\u00eate est ici.</p>"},{"location":"notes_de_cours/mySQL/error_handling/#exemple_1","title":"Exemple","text":"<p>Dans une proc\u00e9dure je veux arr\u00eater l'\u00e9x\u00e9cution si la valeur de la variable nombre est inf\u00e9rieur \u00e0 0</p> <p><pre><code>CREATE PROCEDURE exemplebd.test_error(nombre INT)\nBEGIN\n    IF (nombre &lt; 0) THEN\n        SIGNAL SQLSTATE SET MESSAGE_TEXT = \"La valeur doit \u00eatre sup\u00e9rieure \u00e0 0\";\n    END IF;\n\n    SELECT nombre;\n\nEND\n</code></pre> r\u00e9sultat</p> <p></p> <p>Le m\u00eame exemple avec un HANDLER. <pre><code>CREATE PROCEDURE exemplebd.test_error(nombre INT)\nBEGIN\n\n    DECLARE EXIT HANDLER FOR SQLSTATE '45000' \n    BEGIN \n        SELECT \"La valeur doit \u00eatre sup\u00e9rieure \u00e0 0\" AS message_erreur;\n    END;\n\n    IF (nombre &lt; 0) THEN\n        SIGNAL SQLSTATE '45000';\n    END IF;\n\n    SELECT nombre;\n\nEND\n</code></pre> r\u00e9sultat</p> <p></p> <p>L'avantage d'utiliser le handler est qu'on pourrait \u00e9x\u00e9cuter un traitement lors de l'erreur alors qu'avec signal on ne peut pas. La m\u00e9thode pour r\u00e9cup\u00e9rer l'erreur dans notre code ne sera pas la m\u00eame selon ce qu'on utilise. </p> <p>Avec le handler, c'est selon le traitement utilis\u00e9. Dans notre exemple plus haut, quand on lance la proc\u00e9dure on s'attend \u00e0 recevoir un r\u00e9sultat de requ\u00eate. Si une erreur est retourn\u00e9e, on pourrait v\u00e9rifier qu'il y a un champ message_erreur dans le r\u00e9sultat et l'afficher.</p> <p>Avec signal uniquement, on va devoir r\u00e9cup\u00e9rer l'exception avec un try .. catch. Voici un exemple en Python avec MySQL Connector</p> <pre><code>def TestError():\n\n    result = []\n    try:\n        connection = mysql.connect(**db_config)\n        cursor = connection.cursor()\n        cursor.callproc('test_error', (12,))\n        for result in cursor.stored_results():\n            # Si j'utilise un handler avec le signal\n            # mon message d'erreur se retrouvera ici\n            print(result.fetchall())\n\n    except mysql.Error as erreur:\n        # Le message d'erreur avec signal est ici\n        print(erreur.msg)\n    finally:\n        cursor.close()\n        connection.close()\n</code></pre>"},{"location":"notes_de_cours/mySQL/error_handling/#source","title":"Source","text":"<ul> <li>https://dev.mysql.com/doc/refman/8.0/en/declare-handler.html</li> <li>https://dev.mysql.com/doc/refman/8.0/en/signal.html</li> <li>https://www.mysqltutorial.org/mysql-error-handling-in-stored-procedures/</li> </ul>"},{"location":"notes_de_cours/mySQL/function/","title":"Les fonctions stock\u00e9es (Stored function)","text":"<p>Une fonction est une petite routine qui retourne une valeur unique et qu'on peut r\u00e9utiliser. MySQL comporte d\u00e9j\u00e0 plusieurs fonctions (NOW(), CONCAT()) mais il est aussi possible d'en cr\u00e9er de nouvelle.</p>"},{"location":"notes_de_cours/mySQL/function/#creation-dune-fonction","title":"Cr\u00e9ation d'une fonction","text":"<p>Voici la syntaxe de cr\u00e9ation d'une fonction</p> <p><pre><code>DELIMITER $$\n\nCREATE FUNCTION [IF NOT EXISTS] nom_fonction(\n    param\u00e8tre1,\n    param\u00e8tre2,\u2026\n)\nRETURNS type_de_donn\u00e9e\n[NOT] DETERMINISTIC\nBEGIN\n -- Le traitement\nEND $$\n\nDELIMITER ;\n</code></pre> param\u00e8tres</p> <ul> <li>Les param\u00e8tres sont d\u00e9finis par un nom, un type de donn\u00e9es et un indicateur IN, OUT ou INOUT.</li> <li>IN indique que le param\u00eatre est en entr\u00e9e, OUT en sortie et INOUT pour les deux. La valeur d'un param\u00eatre IN est \"pass\u00e9e\" dans la fonction et utilis\u00e9e dans celle-ci. Pour un param\u00eatre OUT on peut r\u00e9cup\u00e9rer sa valeur \u00e0 la sortie de la fonction. Ce n'est pas la m\u00eame valeur que le retour de la fonction, on peut donc s'en servir pour retourner plus d'une valeur \u00e0 la fonction. INOUT permet les deux. Par d\u00e9faut et si on ne l'indique pas le param\u00eatre sera IN.</li> <li>Chaque param\u00eatre est s\u00e9par\u00e9 par une virgule.</li> </ul> <p>Type de retour</p> <p>Apr\u00e8s le mot-cl\u00e9 RETURNS on indique le type de donn\u00e9es de la valeur de retour de la fonction. \u00c7a peut \u00eatre n'importe quel type MySQL valide (INTEGER, VARCHAR(), TINYINT(1))</p> <p>DETERMINISTIC vs NOT DETERMINISTIC</p> <p>Une fonction DETERMINISTIC va toujours retourner la m\u00eame valeur si on lui donne les m\u00eames param\u00e8tres. Une fonction NOT DETERMINISTIC peut retourner un r\u00e9sultat diff\u00e9rent m\u00eame si on lui donne les m\u00eames param\u00e8tres. C'est une valeur \"indicative\" et MySQL fait confiance au d\u00e9veloppeur quand \u00e0 la v\u00e9racit\u00e9 de l'affimation. Par contre pour une question d'optimisation et de performance il est pr\u00e9f\u00e9rable d'indiquer le bon type. Par d\u00e9faut la fonction sera NOT DETERMINISTIC.</p> <p>Note</p> <pre><code>On peut se donner comme trucs qu'une fonction qui va retourner un r\u00e9sultat en fonction d'un ou plusieurs champs d'une table sera NOT DETERMINISTIC\n</code></pre> <p>Le traitement</p> <ul> <li>Habituellement dans le traitment on va d\u00e9clarer une variavble au tout d\u00e9but qui sera utilis\u00e9e pour contenir le r\u00e9sultat de retour de la fonction. </li> <li>Le traitement doit absolument contenir un instruction RETURN qui marque la fin de la fonction et retourne la valeur.</li> <li>On peut utiliser des HANDLERs dans une fonction pour controller les erreurs et le traitement.</li> </ul> <p>Exemple d'une fonction qui re\u00e7oit en param\u00e8tre une note et qui retourne un commentaire selon la note. <pre><code>DELIMITER $$\n\nCREATE FUNCTION note_commentaire(resultat INTEGER)\nRETURNS VARCHAR(20)\nDETERMINISTIC\nBEGIN\n    DECLARE commentaire VARCHAR(20);\n\n    IF resultat &gt;= 60 THEN\n        SET commentaire = \"R\u00e9ussite\";\n    ELSE\n        SET commentaire = \"\u00c9chec\";\n    END IF;\n\n    RETURN commentaire;\n\nEND$$\n\nDELIMITER ;\n</code></pre></p>"},{"location":"notes_de_cours/mySQL/function/#utilisation-dune-fonction","title":"Utilisation d'une fonction","text":"<p>On peut utiliser la fonction dans n'importe quel instruction MySQL et dans une proc\u00e9dure stock\u00e9e.</p> <pre><code>SELECT note_commentaire(r.note)\nFROM resultat r\nWHERE r.etudiant_id = 1234; \n</code></pre>"},{"location":"notes_de_cours/mySQL/function/#modification-dune-fonction","title":"Modification d'une fonction","text":"<p>On ne peut pas modifier le traitement d'une fonction. Si on doit faire des modifications, on devra la supprimer et la cr\u00e9er \u00e0 nouveau.</p>"},{"location":"notes_de_cours/mySQL/function/#suppression-dune-fonction","title":"Suppression d'une fonction","text":"Syntaxe<pre><code>DROP FUNCTION [IF EXISTS] function_name;\n</code></pre>"},{"location":"notes_de_cours/mySQL/gestion_autorisations/","title":"Gestion des autorisations","text":"<p>Avec les privil\u00e8ges on peut d\u00e9finir pr\u00e9cis\u00e9ment ce qu'un usager peut faire ou non. On donne la permission \u00e0 l'usager d'ex\u00e9cuter tel ou tel commande SQL.</p>"},{"location":"notes_de_cours/mySQL/gestion_autorisations/#ajouter-ou-enlever-de-privileges","title":"Ajouter ou enlever de privil\u00e8ges","text":"<pre><code>-- Syntaxe pour ajouter un privil\u00e8ge\nGRANT nomDuPrivilege (listeDesColonnes)\nON niveauPrivilege\nTO nomUsager_nomRole\n\n-- Syntaxe pour enlever un privil\u00e8ge\nREVOKE nomDuPrivilege\nON niveauPrivilege\nFROM nomUsager_nomRole\n</code></pre> <ul> <li>nomDuPrivilege : Le nom du privil\u00e8ge \u00e0 ajouter (SELECT, INSERT, CREATE TABLE, etc.). On peut en mettre plusieurs en les s\u00e9parant par une virgule.</li> <li>listeDesColonnes : C'est optionnel mais on peut sp\u00e9cifier les colonnes sur lesquelles le privil\u00e8ge est appliqu\u00e9. On pourrait par exemple accorder le droit \u00e0 un usager de faire un UPDATE mais seulement pour des colonnes sp\u00e9cifiques d'une table.</li> <li>niveauPrivilege : \u00c0 quel niveau s'applique le privil\u00e8ge. (Globalement, seulement pour une base de donn\u00e9es en particulier, pour une table pr\u00e9cise, etc.)</li> <li>nomUsager_nomRole: \u00c0 quel usager ou role on veut octroyer le privil\u00e8ge.</li> </ul> <p>Exemple</p> <pre><code>/* Octroyer \u00e0 l'usager test le droit de faire des requ\u00eates select et insert sur \n   toutes les tables de la base de donn\u00e9es credit_social\n */\nGRANT SELECT, INSERT\nON credit_social.*\nTO test@localhost;\n\n/* Octroyer \u00e0 l'usager test2 le droit de faire des requ\u00eates select uniquement sur \n   la table citoyen de la base de donn\u00e9es credit_social. De plus, seulement les \n   colonnes id, nom et prenom seront accessible pour cette table\n */\nGRANT SELECT (id, nom, prenom)\nON credit_social.citoyen\nTO test2@localhost;\n</code></pre> <p>Apr\u00e8s l'ajout ou la suppression de privil\u00e8ges, il est important de rafraichir la liste des privil\u00e8ges avec la commande : </p> <pre><code>FLUSH PRIVILEGES;\n</code></pre>"},{"location":"notes_de_cours/mySQL/gestion_autorisations/#liste-des-privileges","title":"Liste des privil\u00e8ges","text":"<p>Voici une courte liste de privil\u00e8ges qu'on peut ajouter \u00e0 un usager : </p> <ul> <li>ALL, tous les privil\u00e8ges, sauf celui d'en accorder.</li> <li>USAGE, aucun privil\u00e8ges</li> <li>GRANT OPTION, accorde le droit d'ajouter des privil\u00e8ges (il n'est pas inclus quand on utilise ALL)</li> <li>SELECT, INSERT, UPDATE, DELETE, pour les requ\u00eates CRUD correspondante</li> <li>CREATE TABLE, ALTER, DROP, REFERENCES pour des op\u00e9rations sur les tables et la base de donn\u00e9es.</li> <li>CREATE ROUTINE, ALTER ROUTINE, EXECUTE, pour des op\u00e9rations sur les proc\u00e9dures stock\u00e9es.</li> </ul> <p>Il y a beaucoup d'autres privil\u00e8ges qu'on peut octroyer, vous pouvez consulter une liste plus compl\u00e8te dans la documentation de MySQL : </p> <ul> <li>https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html</li> </ul>"},{"location":"notes_de_cours/mySQL/gestion_autorisations/#niveau-des-privileges","title":"Niveau des privil\u00e8ges","text":"<p>L'indicateur du niveau de privil\u00e8ges se compose en deux sections, la ou les base de donn\u00e9es et ensuite le nom de la table ou de la proc\u00e9dure stock\u00e9e.</p> <ul> <li>*.* : Toutes les bases de donn\u00e9es et toutes les tables/proc\u00e9dures stock\u00e9es</li> <li>credit_social.* : Pour la base de donn\u00e9es credit_social, toutes les tables</li> <li>credit_social.classe : Pour la base de donn\u00e9es credit_social, la table classe uniquement.</li> </ul>"},{"location":"notes_de_cours/mySQL/gestion_autorisations/#afficher-les-autorisations-dun-utilisateur-ou-dun-role","title":"Afficher les autorisations d'un utilisateur ou d'un r\u00f4le","text":"<pre><code>SHOW GRANTS FOR 'usager_role'@'localhost';\n</code></pre>"},{"location":"notes_de_cours/mySQL/gestion_role/","title":"Gestion des r\u00f4les","text":"<p>Danger</p> <pre><code>Attention, il peut y avoir quelques diff\u00e9rences entre MySQL et MariaDB, les notes pr\u00e9sent\u00e9es ici sont en MariaDB\n</code></pre> <p>Un r\u00f4le est une regroupement nomm\u00e9 de privil\u00e8ges qu'on peut accorder \u00e0 un ou plusieurs utilisateurs. On retrouve le m\u00eame fonctionnement qu'avec l'utilisateur : on va cr\u00e9er un r\u00f4le et ensuite lui octroyer des privil\u00e8ges. </p>"},{"location":"notes_de_cours/mySQL/gestion_role/#creer-un-role","title":"Cr\u00e9er un r\u00f4le","text":"<p>On va cr\u00e9er un ou plusieurs r\u00f4les avec la commande <code>CREATE ROLE</code> suivi du nom du r\u00f4le. On peut cr\u00e9er plus d'un r\u00f4le \u00e0 la fois en s\u00e9parant chaque nom de r\u00f4le par une virgule.</p> <pre><code>CREATE ROLE IF NOT EXISTS 'nomRole1', 'nommRole2';\n</code></pre>"},{"location":"notes_de_cours/mySQL/gestion_role/#ajouter-ou-enlever-des-privileges-a-un-role","title":"Ajouter ou enlever des privil\u00e8ges \u00e0 un r\u00f4le","text":"<p>Voir la section Gestion des autorisations</p>"},{"location":"notes_de_cours/mySQL/gestion_role/#accorder-un-role-a-un-utilisateur","title":"Accorder un r\u00f4le \u00e0 un utilisateur","text":"<p>Pour accorder un r\u00f4le \u00e0 un utilisateur on utilise la commande <code>GRANT</code> suivi du nom du r\u00f4le et du nom d'un ou plusieurs utilisateur. (Attention il faut ajouter l'h\u00f4te de l'utilisateur si celui-ci est diff\u00e9rent de %)</p> <pre><code>GRANT 'nomRole1' TO 'user1', 'user2'@'192.168.1.%';\n</code></pre>"},{"location":"notes_de_cours/mySQL/gestion_role/#revoquer-un-role-a-un-utilisateur","title":"R\u00e9voquer un r\u00f4le \u00e0 un utilisateur","text":"<p>Pour accorder un r\u00f4le \u00e0 un utilisateur on utilise la commande <code>REVOKE</code> suivi du nom du r\u00f4le et du nom d'un ou plusieurs utilisateur. (Attention il faut ajouter l'h\u00f4te de l'utilisateur si celui-ci est diff\u00e9rent de %)</p> <pre><code>REVOKE 'nomRole1' FROM 'user1', 'user2'@'192.168.1.%';\n</code></pre>"},{"location":"notes_de_cours/mySQL/gestion_role/#supprimer-un-role","title":"Supprimer un r\u00f4le","text":"<pre><code>DROP ROLE 'nomRole1';\n</code></pre>"},{"location":"notes_de_cours/mySQL/gestion_role/#activer-un-role","title":"Activer un r\u00f4le","text":"<p>Une fois le r\u00f4le cr\u00e9\u00e9 il faut qu'il soit activer pour qu'il puisse \u00eatre appliqu\u00e9. Attention un usager ne peut avoir qu'un role d'activ\u00e9 \u00e0 la fois. On doit \u00eatre connect\u00e9 \u00e0 l'usager pour activer son r\u00f4le.</p> <pre><code>SET ROLE nomRole\n</code></pre>"},{"location":"notes_de_cours/mySQL/gestion_role/#afficher-le-role-qui-est-actif","title":"Afficher le r\u00f4le qui est actif","text":"<p>On peut conna\u00eetre le r\u00f4le pr\u00e9sentement activ\u00e9 pour l'utilisateur de cette fa\u00e7on. Le r\u00e9sultat sera null si aucun r\u00f4le n'est activ\u00e9. <pre><code>SELECT current_role();\n</code></pre></p>"},{"location":"notes_de_cours/mySQL/gestion_role/#definir-un-role-par-defaut","title":"D\u00e9finir un r\u00f4le par d\u00e9faut","text":"<p>Lors de la connexion, le r\u00f4le d\u00e9fini de cette fa\u00e7on sera automatiquement activ\u00e9.</p> <pre><code>SET DEFAULT ROLE nomRole FOR nomUsager\n</code></pre>"},{"location":"notes_de_cours/mySQL/gestion_utilisateurs/","title":"Gestion des utilisateurs","text":"<p>Danger</p> <pre><code>Attention, il peut y avoir quelques diff\u00e9rences entre MySQL et MariaDB, les notes pr\u00e9sent\u00e9es ici sont en MariaDB\n</code></pre> <p>Pour se connecter \u00e0 MySQL on doit avoir en main un utilisateur et un mot de passe. Chaque utilisateur \u00e0 ses propres privil\u00e8ges sur ce qui peut faire ou ne pas faire dans la base de donn\u00e9es. Les informations sur les utilisateurs et leur privil\u00e8ges sont stock\u00e9s dans les tables suivantes de la base de donn\u00e9es mysql : </p> <ul> <li>user : les informations sur les utilisateurs.</li> <li>db, tables_priv, columns_priv et proc_priv : les privil\u00e8ges de l'utilisateur.</li> </ul> <p>On peut modifier les valeurs de ces tables mais il est pr\u00e9f\u00e9rable de ne pas le faire directement dans ces tables, il y a des commandes appropri\u00e9es qu'on va voir.</p>"},{"location":"notes_de_cours/mySQL/gestion_utilisateurs/#creer-un-utilisateur","title":"Cr\u00e9er un utilisateur","text":"<p>On utilise la commande CREATE USER en sp\u00e9cifiant un nom d'utilisateur, un h\u00f4te et un mot de passe. L'h\u00f4te est optionnel et repr\u00e9sente l'adresse \u00e0 partir de laquelle l'utilisateur va se connecter. On utilise souvent localhost ou 127.0.0.1, ce qui veut dire que l'utilisateur pourra se connecter \u00e0 partir de la machine o\u00f9 est situ\u00e9 le serveur. Si on ne sp\u00e9cifie pas d'h\u00f4te, l'utilisateur pourra se connecter depuis n'importe quel h\u00f4te.</p> <pre><code>CREATE USER IF NOT EXISTS 'nomUtilisateur'@'hote' IDENTIFIED BY 'motDePasse';\n\n-- Exemple\nCREATE USER IF NOT EXISTS 'math'@'localhost' IDENTIFIED BY 'qwerty4ever';\nCREATE USER IF NOT EXISTS 'math2' IDENTIFIED BY 'qwerty4ever';\nCREATE USER IF NOT EXISTS 'patate'@'156.20.12.2' IDENTIFIED BY 'qwerty4ever';\n</code></pre> <p>Danger</p> <p>Avec notre installation de Devilbox, les utilisateurs doivent \u00eatre cr\u00e9\u00e9s avec l'h\u00f4te % et non localhost.</p> <p>On peut utiliser le joker % pour permettre la cr\u00e9ation d'un utilisateur qui va pouvoir se connecter depuis une plage d'h\u00f4tes : </p> <pre><code>-- L'utilisateur va pourvoir se connecter depuis n'importe quel h\u00f4te dont \n-- l'adresse ip commence par 156.20.12\nCREATE USER IF NOT EXISTS 'math'@'156.20.12.%' IDENTIFIED BY 'qwerty4ever';\n\n-- L'utilisateur va pouvoir se connecter depuis n'importe quel h\u00f4te\nCREATE USER IF NOT EXISTS 'math'@'%' IDENTIFIED BY 'qwerty4ever';\n</code></pre>"},{"location":"notes_de_cours/mySQL/gestion_utilisateurs/#modifier-le-nom-dun-utilisateur","title":"Modifier le nom d'un utilisateur","text":"<p>Pour modifier le nom d'un utilisateur, on utilise la commande RENAME USER : </p> <pre><code>RENAME USER 'Math'@'localhost' TO 'Mathieu'@'localhost';\n</code></pre>"},{"location":"notes_de_cours/mySQL/gestion_utilisateurs/#supprimer-un-utilisateur","title":"Supprimer un utilisateur","text":"<p>Pour supprimer un utilisateur, on va utiliser DROP USER : </p> <pre><code>DROP USER 'Math'@'localhost'\n</code></pre>"},{"location":"notes_de_cours/mySQL/gestion_utilisateurs/#afficher-la-liste-des-utilisateurs","title":"Afficher la liste des utilisateurs","text":"<p>En mysql il n'y a pas de commande <code>SHOW USERS</code> pour nous afficher la liste de tous les utilisateurs. On a vu plus haut que les informations de l'utilisateur \u00e9tait stock\u00e9 dans la table user de la base de donn\u00e9es mysql. On peut donc avec une requ\u00eate SELECT sur cette table afficher la liste des utilisateurs. Les usagers et les r\u00f4les sont stock\u00e9s ensemble dans cette table. Avec MariaDB on peut les diff\u00e9rencier avec la colonne is_role qui prend la valeur \"N\" quand c'est un usager et \"Y\" quand c'est un r\u00f4le. </p> <pre><code>-- Affiche tout les usagers et les r\u00f4les\nSELECT * FROM mysql.user WHERE is_role = 'N';\n-- Si on veut uniquement la liste des usagers et de leur h\u00f4te\nSELECT user, host FROM mysql.user WHERE is_role = 'N';\n</code></pre>"},{"location":"notes_de_cours/mySQL/having/","title":"HAVING","text":"<p>La clause HAVING peut \u00eatre utilis\u00e9e dans une instruction SELECT pour sp\u00e9cifier une condition sur le r\u00e9sultat d'une agr\u00e9gation (un regroupement de lignes de r\u00e9sultat). La plupart du temps on va utiliser HAVING avec l'expression GROUP BY, la condition sp\u00e9cifi\u00e9 s'appliquera sur le r\u00e9sultat du regroupement. Si HAVING est utilis\u00e9 seul, il va se comporter comme un WHERE, dans ce cas pr\u00e9vil\u00e9giez l'utilisation du WHERE. </p> <p>Dans l'instruction SQL le HAVING si situe apr\u00e8s le GROUP BY et avant le ORDER BY : </p> <pre><code>SELECT liste_de_colonnes\nFROM liste_de_tables\nWHERE condition_where\nGROUP BY liste_de_colonnes\nHAVING condition_having\nORDER BY liste_de_colonnes\n</code></pre>"},{"location":"notes_de_cours/mySQL/having/#sources","title":"Sources","text":"<ul> <li>https://dev.mysql.com/doc/refman/8.0/en/select.html</li> <li>https://www.mysqltutorial.org/mysql-having.aspx</li> </ul>"},{"location":"notes_de_cours/mySQL/insert/","title":"INSERT","text":"<p>La commande INSERT est utilis\u00e9e pour ajouter des enregistrements dans une table.</p>"},{"location":"notes_de_cours/mySQL/insert/#syntaxe-de-base","title":"Syntaxe de base","text":""},{"location":"notes_de_cours/mySQL/insert/#la-methode-la-plus-simple","title":"La m\u00e9thode la plus simple","text":"<p><pre><code>INSERT INTO ma_table\nVALUES (valeur1, valeur2, valeur3);\n</code></pre> Avantages - Requ\u00eate plus courte - Si on modifie les noms de colonnes, pas besoin de modifier la requ\u00eate.</p> <p>Inconv\u00e9nients</p> <ul> <li>Possibilit\u00e9 d'erreurs plus grande, il faut que les valeurs concordent avec le nombre de colonnes et leur position.</li> </ul>"},{"location":"notes_de_cours/mySQL/insert/#la-methode-la-plus-precise","title":"La m\u00e9thode la plus pr\u00e9cise","text":"<p><pre><code>INSERT INTO ma_table (colonne1, colonne2, colonne3)\nVALUES (valeur1, valeur2, valeur3);\n</code></pre> Avantages - Plus de pr\u00e9cisions dans la requ\u00eate - On n'est pas forc\u00e9 de suivre l'ordre des colonnes ni d'ajouter une valeur pour chacune d'entre elles.</p> <p>Inconv\u00e9nient - Les requ\u00eates sont plus longue \u00e0 \u00e9crire.</p> <ul> <li>Au niveau de la maintenance, si on modifie un nom de colonne, il faut modifier toutes les requ\u00eates ajoutant des valeurs dans cette colonne.</li> </ul>"},{"location":"notes_de_cours/mySQL/insert/#inserer-des-donnees-seulement-dans-certaines-colonnes","title":"Ins\u00e9rer des donn\u00e9es seulement dans certaines colonnes","text":"<p><pre><code>INSERT INTO ma_table (colonne1)\nVALUES (valeur1);\n</code></pre> Les autres champs non sp\u00e9cifi\u00e9s prendront la valeur par d\u00e9faut si elle est d\u00e9fini ou NULL sinon.</p>"},{"location":"notes_de_cours/mySQL/insert/#inserer-plusieurs-lignes-dans-la-meme-requete","title":"Ins\u00e9rer plusieurs lignes dans la m\u00eame requ\u00eate","text":"<p>La syntaxe est la m\u00eame, on doit seulement s\u00e9parer les s\u00e9ries de valeurs par une virgule :  <pre><code>INSERT INTO ma_table\nVALUES  (valeur_a1, valeur_a2, valeur_a3),\n        (valeur_b1, valeur_b2, valeur_b3),\n        (valeur_c1, valeur_c2, valeur_c3),\n        (valeur_d1, valeur_d2, valeur_d3);\n</code></pre> <pre><code>INSERT INTO ma_table (colonne1, colonne2, colonne3)\nVALUES  (valeur_a1, valeur_a2, valeur_a3),\n        (valeur_b1, valeur_b2, valeur_b3),\n        (valeur_c1, valeur_c2, valeur_c3),\n        (valeur_d1, valeur_d2, valeur_d3);\n</code></pre></p>"},{"location":"notes_de_cours/mySQL/insert/#inserer-des-valeurs-provenant-dune-autre-table","title":"Ins\u00e9rer des valeurs provenant d'une autre table","text":"<p>On peut ins\u00e9rer les valeurs d'autres tables en utilisant une sous-requ\u00eate de s\u00e9lection au lieu de sp\u00e9cifier les valeurs dans la section VALUES.</p> <p><pre><code>INSERT INTO ma_table (colonne1, colonne2, colonne3)\n    SELECT valeur1, valeur2, valeur3\n    FROM table_source;\n</code></pre> La requ\u00eate SELECT n'a pas de contraintes et peut contenir plusieurs jointures, des conditions WHERE et HAVING, d'autres sous-requ\u00eate, etc. </p> <p>Si on veut ins\u00e9rer tout le contenu d'une table dans une autre, on peut utiliser l'instruction TABLE et le nom de la table d'o\u00f9 proviennent les donn\u00e9es \u00e0 ins\u00e9rer.</p> <pre><code>INSERT INTO ma_table TABLE table_source\n</code></pre>"},{"location":"notes_de_cours/mySQL/insert/#les-colonnes-de-type-auto-increment","title":"Les colonnes de type auto-incr\u00e9ment","text":"<p>Ce type de colonne est incr\u00e9ment\u00e9e automatiquement lors d'une insertion de donn\u00e9es, on ne doit pas les ajouter dans nos requ\u00eates d'insertion.</p>"},{"location":"notes_de_cours/mySQL/insert/#recuperer-la-valeur-dune-colonne-auto-increment","title":"R\u00e9cup\u00e9rer la valeur d'une colonne auto-incr\u00e9ment","text":"<p>On peut r\u00e9cup\u00e9rer la premi\u00e8re valeur provenant d'un champ auto-incr\u00e9ment qui a \u00e9t\u00e9 ins\u00e9rer avec succ\u00e8s en utilisant la fonction last_insert_id(). </p> <pre><code>INSERT INTO ma_table (colonne1) \nVALUES (valeur1);\n\nSELECT last_insert_id();\n</code></pre>"},{"location":"notes_de_cours/mySQL/join/","title":"Les jointures","text":""},{"location":"notes_de_cours/mySQL/join/#base-de-donnees-exemples","title":"Base de donn\u00e9es exemples","text":"<p>J'ai un syst\u00e8me de deux tables, l'une de joueurs et l'autre de guilde. Les joueurs peuvent ou non faire partie d'une guilde et chaque guilde peut avoir de 0 \u00e0 plusieurs joueurs.</p> <p></p> <p>Voici un script de cr\u00e9ation si vous voulez r\u00e9aliser les exemples</p> <p><pre><code>CREATE DATABASE IF NOT EXISTS bd2_exemple \nCOLLATE = 'utf8mb4_unicode_ci';\nUSE bd2_exemple;\n\n\nDROP TABLE IF EXISTS guilde;\nCREATE TABLE guilde (\n    id INT AUTO_INCREMENT,\n    nom VARCHAR(30),\n    PRIMARY KEY (id)\n);\nINSERT INTO guilde (nom) \nVALUES ('SqlIsGod'), \n       ('Error404'), \n       ('IsNobodyHere');\n\nDROP TABLE IF EXISTS joueur;\nCREATE TABLE joueur (\n    id INT AUTO_INCREMENT,\n    guilde_id INT NULL,\n    nom VARCHAR(50),\n    prenom VARCHAR(50),\n    PRIMARY KEY (id),\n    CONSTRAINT guilde_fk FOREIGN KEY (guilde_id) \n        REFERENCES guilde (id) \n        ON UPDATE RESTRICT ON DELETE CASCADE\n);\nINSERT INTO joueur (guilde_id, nom, prenom) \nVALUES (1, 'Fr\u00e9chette', 'Mathieu'), \n       (1, 'Ouellet', 'Alexandre'), \n       (2, 'Tousignant', 'Simon'), \n       (null, 'Taleb', 'Fr\u00e9d\u00e9ric');\n</code></pre> \u200b   </p>"},{"location":"notes_de_cours/mySQL/join/#inner-join","title":"INNER JOIN","text":"<p>Une jointure INNER JOIN retournera tous les enregistrements correspondants entre deux tables. </p> <p>Exemple</p> <pre><code>SELECT j.nom, j.prenom, g.nom AS guilde\nFROM joueur j \n    INNER JOIN guilde g ON g.id = j.guilde_id;\n</code></pre> <p>R\u00e9sultat</p> nom prenom guilde Fr\u00e9chette Mathieu SqlIsGod Ouellet Alexandre SqlIsGod Tousignant Simon Error404"},{"location":"notes_de_cours/mySQL/join/#left-join","title":"LEFT JOIN","text":"<p>Une jointure LEFT JOIN retournera tous les enregistrements de la table de gauche et seulement les enregistrements correspondant de la table de droite. </p> <p>Exemple</p> <pre><code>SELECT j.nom, j.prenom, g.nom AS guilde\nFROM joueur j \n    LEFT JOIN guilde g ON g.id = j.guilde_id;\n</code></pre> <p>R\u00e9sultat</p> nom prenom guilde Fr\u00e9chette Mathieu SqlIsGod Ouellet Alexandre SqlIsGod Tousignant Simon Error404 Taleb Fr\u00e9d\u00e9ric NULL"},{"location":"notes_de_cours/mySQL/join/#right-join","title":"RIGHT JOIN","text":"<p>Une jointure RIGHT JOIN retournera tous les enregistrements de la table de droite et seulement les enregistrements correspondant de la table de gauche. </p> <p>Exemple</p> <pre><code>SELECT j.nom, j.prenom, g.nom AS guilde\nFROM joueur j \n    RIGHT JOIN guilde g ON g.id = j.guilde_id;\n</code></pre> <p>R\u00e9sultat</p> Nom prenom guilde Fr\u00e9chette Mathieu SqlIsGod Ouellet Alexandre SqlIsGod Tousignant Simon Error404 NULL NULL IsNobodyHere"},{"location":"notes_de_cours/mySQL/join/#union","title":"UNION","text":"<p>L'op\u00e9rateur UNION est utilis\u00e9 pour combiner les r\u00e9sultats de deux ou plusieurs requ\u00eate SELECT. On doit par contre respecter les trois r\u00e8gles suivantes : </p> <ul> <li>Toutes les requ\u00eates SELECT doivent comporter le m\u00eame nombre de colonnes.</li> <li>Les colonnes correspondantes doivent avoir un type de donn\u00e9es similaire.</li> <li>Les colonnes doivent aussi \u00eatre dans le m\u00eame ordre.</li> </ul> <p>Syntaxe</p> <pre><code>SELECT colonne1, colonne2 FROM table1\nUNION\nSELECT colonne1, colonne2 FROM table2;\n</code></pre> <p>Par d\u00e9faut l'op\u00e9rateur UNION conservera que les valeurs unique des multiples requ\u00eates. Si ont veut conserver les doublons, on doit ajouter ALL.</p> <pre><code>SELECT colonne1, colonne2 FROM table1\nUNION ALL\nSELECT colonne1, colonne2 FROM table2;\n</code></pre> <p>Le nom des colonnes du r\u00e9sultat sera le nom des colonnes d\u00e9fini dans la premi\u00e8re requ\u00eate.</p>"},{"location":"notes_de_cours/mySQL/join/#outer-join","title":"OUTER JOIN","text":"<p>Une jointure OUTER JOIN retournera tous les enregistrements des deux tables. On ne peux pas utiliser la commande OUTER JOIN en MySQL mais on peut arriver au m\u00eame r\u00e9sultat en faisant une premi\u00e8re requ\u00eate avec un LEFT JOIN unis \u00e0 une deuxi\u00e8me requ\u00eate avec un RIGHT JOIN</p> <p>Exemple </p> <pre><code>SELECT j.nom, j.prenom, g.nom AS guilde\nFROM joueur j \n    LEFT JOIN guilde g ON g.id = j.guilde_id\n\nUNION\n\nSELECT j.nom, j.prenom, g.nom AS guilde\nFROM joueur j \n    RIGHT JOIN guilde g ON g.id = j.guilde_id;\n</code></pre> <p>R\u00e9sultat</p> Nom prenom guilde Fr\u00e9chette Mathieu SqlIsGod Ouellet Alexandre SqlIsGod Tousignant Simon Error404 Taleb Fr\u00e9d\u00e9ric NULL NULL NULL IsNobodyHere"},{"location":"notes_de_cours/mySQL/stored_proc/","title":"Proc\u00e9dure stock\u00e9e","text":"<p>Une proc\u00e9dure stock\u00e9e nous permet d'enregistrer sur le serveur MySQL une s\u00e9rie d'instructions qu'on pourra r\u00e9utiliser \u00e0 notre guise. \u00c0 la diff\u00e9rence de la fonction, la proc\u00e9dure stock\u00e9e peut retourner un jeu de r\u00e9sultat.</p>"},{"location":"notes_de_cours/mySQL/stored_proc/#creation-dune-procedure","title":"Cr\u00e9ation d'une proc\u00e9dure","text":"<p>La premi\u00e8re chose \u00e0 faire quand on cr\u00e9e une proc\u00e9dure est de changer le Delimiter pour ne pas que l'intruction de cr\u00e9ation se termine au premier point-virgule (;) rencontr\u00e9. La commande est <code>DELIMITER</code> suivi du symbole \u00e0 utiliser pour indiquer une fin d'instruction. Dans l'exemple suivant le symbole est $$. \u00c0 la fin des instructions ont doit remettre le delimiter au point-virgule.</p> <pre><code>DELIMITER $$\n\n...\n\nDELIMITER ;\n</code></pre> <p>Ensuite pour cr\u00e9er la proc\u00e9dure la commande \u00e0 utiliser est <code>CREATE PROCEDURE</code>.</p> <pre><code>CREATE PROCEDURE [IF NOT EXISTS] nom_procedure (\n    param\u00e8tre1,\n    param\u00e8tre2,\u2026\n)\nBEGIN\n    -- Le traitement\nEND\n</code></pre> <p>param\u00e8tres</p> <ul> <li>Les param\u00e8tres sont d\u00e9finis par un nom, un type de donn\u00e9es et un indicateur IN, OUT ou INOUT.</li> <li>IN indique que le param\u00eatre est en entr\u00e9e, OUT en sortie et INOUT pour les deux. La valeur d'un param\u00eatre IN est \"pass\u00e9e\" dans la fonction et utilis\u00e9e dans celle-ci. Pour un param\u00eatre OUT on peut r\u00e9cup\u00e9rer sa valeur \u00e0 la sortie de la fonction. Ce n'est pas la m\u00eame valeur que le retour de la fonction, on peut donc s'en servir pour retourner plus d'une valeur \u00e0 la fonction. INOUT permet les deux. Par d\u00e9faut et si on ne l'indique pas le param\u00eatre sera IN.</li> <li>Chaque param\u00eatre est s\u00e9par\u00e9 par une virgule.</li> </ul> <p>Le traitement</p> <ul> <li>La proc\u00e9dure n'est pas tenu de retourner une valeur. On pourrait par exemple faire une proc\u00e9dure qui supprimerait les enregistrements d'une table selon certain crit\u00e8res.</li> <li>Par contre il est pr\u00e9f\u00e9rable de toujours retourner une valeur, comme un indicateur de succ\u00e8s pour l'exemple pr\u00e9c\u00e9dent. </li> <li>On peut utiliser des HANDLERs dans une proc\u00e9dure pour controller le traitement.</li> </ul>"},{"location":"notes_de_cours/mySQL/stored_proc/#utilisation-de-variables","title":"Utilisation de variables","text":"<p>On peut d\u00e9clarer des variables de la fa\u00e7on suivante : </p> <pre><code>DECLARE nom_variable type_de_donnee [DEFAULT valeur_default]\n</code></pre> <p>La section DEFAULT est optionnel et sert \u00e0 assigner une valeur par d\u00e9faut \u00e0 la variable.</p> <pre><code>DECLARE prenom VARCHAR(50) DEFAULT 'Mathieu';\n</code></pre> <p>On peut ensuite assigner une valeur \u00e0 la variable avec <code>SET</code> ou un <code>SELECT ... INTO ma_variable FROM ...</code>. Si on utilise le Select le r\u00e9sultat doit \u00eatre une valeur unique.</p> <pre><code>SET prenom = \"Alexandre\";\n\nSELECT u.prenom \nINTO prenom\nFROM usager u\nWHERE u.id = 1234;\n</code></pre>"},{"location":"notes_de_cours/mySQL/stored_proc/#suppression-dune-procedure","title":"Suppression d'une procedure","text":"Syntaxe<pre><code>DROP PROCEDURE [IF EXISTS] nom_procedure;\n</code></pre>"},{"location":"notes_de_cours/mySQL/stored_proc/#ressources","title":"Ressources","text":"<ul> <li>Documentation officiel : https://dev.mysql.com/doc/refman/8.0/en/create-procedure.html</li> <li>https://www.mysqltutorial.org/mysql-stored-procedure-tutorial.aspx</li> </ul>"},{"location":"notes_de_cours/mySQL/transaction/","title":"Transactions","text":"<p>En SQL, une transaction est une s\u00e9rie d'instructions ou de requ\u00eates qui doivent \u00eatre ex\u00e9cut\u00e9 en un seul bloc. Cette s\u00e9rie d'op\u00e9rations peut \u00eatre accept\u00e9 (COMMIT) ou refus\u00e9 (ROLLBACK). C'est une pratique qui est essentiel quand on veut lancer une s\u00e9rie d'op\u00e9ration et s'assurer de l'int\u00e9grit\u00e9 de notre base de donn\u00e9es. \u00c7a nous prot\u00e8ge \u00e0 la fois des erreurs humaines (erreur dans le code, mauvaise manipulation des donn\u00e9es, etc.) et des erreurs externes (pannes de serveur durant un traitement par exemple).</p>"},{"location":"notes_de_cours/mySQL/transaction/#demarrer-une-transaction","title":"D\u00e9marrer une transaction","text":""},{"location":"notes_de_cours/mySQL/transaction/#autocommit","title":"AUTOCOMMIT","text":"<p>Par d\u00e9faut MySQL n'utilise pas les transactions et toutes les requ\u00eates sont automatiquement valid\u00e9es. On peut modifier ce comportement en changeant la valeur de la variable syst\u00e8me autocommit. Attention, la variable autocommit est une variable de session, c'est-\u00e0-dire que la modification qu'on y fait n'est valide que pour la session en cours et qu'elle reprendra sa valeur par d\u00e9faut \u00e0 la session suivante.</p> <p>Exemple</p> <pre><code>-- Modification pour que les requ\u00eates ne soit plus automatiquement \"commit\u00e9\"\nSET autocommit = 0;\n\n-- Insertion d'un enregistrement\ninsert into athlete (nom, prenom) \nvalues ('Fr\u00e9chette', 'Mathieu');\n\n-- \u00c9tant donn\u00e9 que la variable autocommit est maintenant \u00e0 false, \n-- l'insertion ne sera permanente qu'apr\u00e8s avoir valid\u00e9 la transaction\n</code></pre>"},{"location":"notes_de_cours/mySQL/transaction/#start-transaction","title":"START TRANSACTION","text":"<p>La fa\u00e7on la plus courante de d\u00e9marrer une transaction est d'utiliser la commande START TRANSACTION. Une fois la commande lanc\u00e9e, toutes les requ\u00eates suivantes seront \"en attente\" tant que la transaction ne sera pas valid\u00e9e. </p> <p>Exemple</p> <pre><code>-- Pour l'exemple, je m'assure que la valeur de la variable autocommit est bien \u00e0 TRUE.\n-- C'est la valeur par d\u00e9faut, on n'est pas oblig\u00e9 de le sp\u00e9cifi\u00e9 en temps normal.\nSET autocommit = 1;\n-- D\u00e9but de la transaction\nSTART TRANSACTION;\n\n-- Insertion d'un enregistrement\ninsert into athlete (nom, prenom) \nvalues ('Fr\u00e9chette', 'Mathieu');\n\n-- \u00c9tant donn\u00e9 qu'on a d\u00e9but\u00e9 une transaction, l'insertion ne sera permanente \n-- qu'apr\u00e8s l'avoir valid\u00e9e ou annul\u00e9e.\n</code></pre>"},{"location":"notes_de_cours/mySQL/transaction/#terminer-une-transaction","title":"Terminer une transaction","text":""},{"location":"notes_de_cours/mySQL/transaction/#commit","title":"COMMIT","text":"<p>Si toutes les requ\u00eates se sont bien ex\u00e9cut\u00e9 et qu'on veut confirmer les changements, on va utiliser la commande COMMIT. Les modifications apport\u00e9es seront maintenant permanentes et la transaction va se terminer. </p> <p>Exemple</p> <pre><code>START TRANSACTION;\n-- Op\u00e9rations \u00e0 effectuer\n...\n\n-- Valider la transaction et rendre les op\u00e9rations permanentes.\nCOMMIT;\n</code></pre>"},{"location":"notes_de_cours/mySQL/transaction/#rollback","title":"ROLLBACK","text":"<p>Pour terminer la transaction en annulant TOUTES les modifications effectu\u00e9es, on va utiliser la commande ROLLBACK. </p> <p>Exemple</p> <pre><code>START TRANSACTION;\n-- Op\u00e9rations \u00e0 effectuer\n...\n\n-- Annuler toutes les op\u00e9rations depuis le d\u00e9but de la transaction\nROLLBACK;\n</code></pre>"},{"location":"notes_de_cours/mySQL/transaction/#utiliser-des-points-de-sauvegarde","title":"Utiliser des points de sauvegarde","text":"<p>On ne peut pas d\u00e9buter une seconde transaction \"\u00e0 l'int\u00e9rieur\" d'une transaction d\u00e9j\u00e0 d\u00e9but\u00e9e, \u00e7a va causer la validation de la premi\u00e8re et lancer la seconde. Par contre on peut cr\u00e9er des points de sauvegarde qui nous permettront d'annuler uniquement les op\u00e9rations effectu\u00e9es depuis un point de sauvegarde. </p>"},{"location":"notes_de_cours/mySQL/transaction/#savepoint","title":"SAVEPOINT","text":"<p>Pour cr\u00e9er un point de sauvegarde, on va utiliser la commande SAVEPOINT.  On peut d\u00e9finir plusieurs point de sauvegarde \u00e0 l'int\u00e9rieur d'une m\u00eame transaction.</p> <pre><code>SAVEPOINT nom_du_savepoint\n</code></pre>"},{"location":"notes_de_cours/mySQL/transaction/#rollback-to-savepoint","title":"ROLLBACK TO SAVEPOINT","text":"<p>Une fois le point de sauvegarde cr\u00e9er, on peut annuler uniquement les transactions effectu\u00e9es depuis celui-ci.</p> <p>Exemple</p> <pre><code>-- D\u00e9but de la transaction\nSTART TRANSACTION;\n\n-- Insertion d'un enregistrement\ninsert into athlete (nom, prenom) \nvalues ('Fr\u00e9chette', 'Mathieu');\n\n-- Cr\u00e9ation d'un point de sauvegarde\nSAVEPOINT save_Math;\n\n-- Insertion d'un second enregistrement\ninsert into athlete (nom, prenom) \nvalues ('Fr\u00e9chette', 'Marianne');\n\n-- Annulation jusqu'au savepoint save_Math\nROLLBACK TO SAVEPOINT save_Math;\n\n-- Validation de la transaction\nCOMMIT;\n\n-- L'athl\u00e8te Mathieu Fr\u00e9chette sera ins\u00e9r\u00e9 dans la base de donn\u00e9es mais pas Marianne Fr\u00e9chette.\n</code></pre>"},{"location":"notes_de_cours/mySQL/transaction/#commandes-qui-terminent-automatiquement-une-transaction","title":"Commandes qui terminent automatiquement une transaction","text":"<p>Attention, certaines commandes SQL vont cl\u00f4turer automatiquement une transaction et aussi valider toutes les op\u00e9rations, comme si on aurait utilis\u00e9 la commande COMMIT. Voici une liste de ces commandes</p> <ul> <li>Toutes les commandes qui apportent une modification \u00e0 la structure de la base de donn\u00e9es vont valider une transaction<ul> <li>La cr\u00e9ation ou suppression d'une base de donn\u00e9es</li> <li>Toutes les modifications apport\u00e9es aux tables, cr\u00e9ation, modification, etc...</li> <li>La cr\u00e9ation ou suppression d'un index.</li> <li>La cr\u00e9ation de proc\u00e9dures stock\u00e9es, de fonctions ou de vues.</li> </ul> </li> <li>La cr\u00e9ation, suppression ou modification d'un utilisateur.</li> <li>Le d\u00e9but d'une nouvelle transaction sans avoir termin\u00e9 la premi\u00e8re.</li> <li>Changer la valeur de la variable autocommit \u00e0 TRUE.</li> <li>La cr\u00e9ation ou suppression d'un LOCK sur une table.</li> </ul>"},{"location":"notes_de_cours/mySQL/transaction/#sources","title":"Sources","text":"<ul> <li>https://dev.mysql.com/doc/refman/8.0/en/sql-transactional-statements.html</li> <li>https://www.javatpoint.com/mysql-transaction</li> <li>https://www.mysqltutorial.org/mysql-transaction.aspx</li> </ul>"},{"location":"notes_de_cours/mySQL/trigger/","title":"Les triggers","text":"<p>Un trigger (ou d\u00e9clencheur) est une sorte de proc\u00e9dure stock\u00e9e, une s\u00e9rie d'instruction enregistr\u00e9e, qui est reli\u00e9 \u00e0 une table de la base de donn\u00e9es. Les instructions seront ex\u00e9cut\u00e9 automatiquement lors d'une insertion, d'une mise \u00e0 jour ou d'une suppression dans la table \u00e0 laquelle le trigger est attach\u00e9 et \u00e7a pour chacune des lignes affect\u00e9es par la requ\u00eate.  On doit aussi sp\u00e9cifier \u00e0 quel moment il sera d\u00e9clench\u00e9, avant l'instruction SQL ou apr\u00e8s. On peut donc d\u00e9finir jusqu'\u00e0 6 triggers par tables : avant ou apr\u00e8s une insertion, avant ou apr\u00e8s une mise \u00e0 jour, avant ou apr\u00e8s une suppression.</p> <p>On peut depuis un trigger modifier et ins\u00e9rer des donn\u00e9es dans n'importe quel table de la base de donn\u00e9es \u00e0 l'exception des tables utilis\u00e9es dans la requ\u00eate qui l'a d\u00e9clench\u00e9. Si on veut travailler sur la table \u00e0 laquelle le trigger est attach\u00e9, on n'a acc\u00e8s qu'\u00e0 la ligne qu'on est en train de traiter.</p>"},{"location":"notes_de_cours/mySQL/trigger/#pourquoi-utiliser-des-triggers","title":"Pourquoi utiliser des triggers ?","text":"<ul> <li>S'assurer de la validit\u00e9 des donn\u00e9es avant leur insertion ou leur modification.</li> <li>Pour pouvoir utiliser des traitements plus complexe lors d'op\u00e9ration qui affectent plusieurs tables. Par exemple si on veut supprimer des donn\u00e9es qui sont reli\u00e9es \u00e0 d'autres tables par des cl\u00e9s \u00e9trang\u00e8res et que les options offerte ne nous suffise pas.</li> <li>Pour garder une trace des op\u00e9rations effectu\u00e9es dans la base de donn\u00e9es.</li> <li>Mettre \u00e0 jour des informations qu'on utilise r\u00e9guli\u00e8rement pour pouvoir les retrouver facilement, comme par exemple le solde actif d'un compte client.</li> </ul>"},{"location":"notes_de_cours/mySQL/trigger/#syntaxe","title":"Syntaxe","text":"<p>On utilise la commande CREATE TRIGGER pour la cr\u00e9ation d'un trigger. Le nom du trigger doit \u00eatre unique dans la base de donn\u00e9es. Il est d'usage de nommer le trigger avec le nom de la table associ\u00e9e, du moment de son d\u00e9clenchement et de l'op\u00e9ration effectu\u00e9e, ex je veux cr\u00e9er un trigger sur la table usager qui se d\u00e9clenchera avant un insertion, je vais le nommer usager_before_insert. </p> <pre><code>CREATE TRIGGER nomTrigger \n    momentDuDeclenchement operationSQL ON nomTable\n    FOR EACH ROW\n    corpsDuTrigger;\n</code></pre> <ul> <li>Le moment du d\u00e9clenchement est BEFORE ou AFTER</li> <li>L'op\u00e9ration SQL est soit INSERT, UPDATE ou DELETE</li> <li>Si le corps du trigger contient plus d'une requ\u00eate et/ou op\u00e9ration, on doit les englober par un BEGIN END.</li> </ul>"},{"location":"notes_de_cours/mySQL/trigger/#new-et-old","title":"NEW et OLD","text":"<p>On peut utiliser les mots cl\u00e9s dans le corps du trigger pour acc\u00e9der aux donn\u00e9es avant ou apr\u00e8s leur modification. </p> <ul> <li>OLD repr\u00e9sente les donn\u00e9es avant qu'elles ne soient modifi\u00e9 par le trigger. Ces donn\u00e9es ne peuvent pas \u00eatre modifi\u00e9es. Old est disponible pour les UPDATE et DELETE</li> <li>NEW repr\u00e9sente les donn\u00e9es apr\u00e8s qu'elles aient \u00e9t\u00e9 modifi\u00e9. C'est donn\u00e9es peuvent \u00eatre lu et modifi\u00e9s. New est disponible pour les INSERT et UPDATE.</li> </ul> Requ\u00eate OLD NEW INSERT - OUI UPDATE OUI OUI DELETE OUI -"},{"location":"notes_de_cours/mySQL/trigger/#erreur-dans-un-trigger","title":"Erreur dans un trigger","text":"<p>Si un trigger ex\u00e9cut\u00e9 avant (BEFORE) une requ\u00eate cause une erreur, la requ\u00eate ne sera pas ex\u00e9cut\u00e9e. Les triggers ex\u00e9cut\u00e9s apr\u00e8s (AFTER) une requ\u00eate qui g\u00e9n\u00e8re une erreur feront \u00e9chouer celle-ci. Il est donc important de bien concevoir les triggers et d'inclure une gestion des erreurs dans notre traitement.</p>"},{"location":"notes_de_cours/mySQL/trigger/#supprimer-un-trigger","title":"Supprimer un trigger","text":"<p>Pour supprimer un trigger, on utilise la commande DROP TRIGGER suivie du nom du trigger. Si on supprimer une table, tous les triggers qui lui sont associ\u00e9e seront aussi supprim\u00e9s.</p> <pre><code>DROP TRIGGER before_insert_usager;\n</code></pre>"},{"location":"notes_de_cours/mySQL/trigger/#gestion-derreurs-dans-un-trigger","title":"Gestion d'erreurs dans un trigger","text":"<p>MySQL g\u00e8re les erreurs dans les triggers de la fa\u00e7on suivante : </p> <ul> <li>Si un trigger de type BEFORE \u00e9choue, l'op\u00e9ration sur la ligne correspondante ne sera pas effectu\u00e9e.</li> <li>Un trigger BEFORE est activ\u00e9 par l'essaie d'ins\u00e9rer ou de modifier la ligne, m\u00eame s'il y a \u00e9chec de l'op\u00e9ration.</li> <li>Un trigger AFTER est ex\u00e9cut\u00e9 seulement apr\u00e8s qu'un trigger BEFORE et l'op\u00e9ration sur la ligne ont r\u00e9ussi.</li> <li>Une erreur dans un trigger BEFORE et AFTER cause l'\u00e9chec de toute l'op\u00e9ration.</li> </ul> <p>On peut aussi g\u00e9rer les erreurs, les exceptions et m\u00eame les contraintes \u00e0 l'aide de HANDLER ou de la commande SIGNAL. Voir les notes sur la gestions des erreurs</p> <p>Voici un court exemple de gestion avec SIGNAL. On a une table compte avec un champ solde qui ne peut \u00eatre initialis\u00e9 \u00e0 une valeur inf\u00e9rieur \u00e0 0.</p> Exemple gestion d'exceptions<pre><code>DELIMITER $$\n\nCREATE TRIGGER compte_before_insert\n    BEFORE INSERT\n    ON compte FOR EACH ROW\n    BEGIN\n\n        IF NEW.solde &lt; 0 THEN \n            SIGNAL SQLSTATE '45000' \n            SET MESSAGE_TEXT = 'Le solde du nouveau compte ne peut \u00eatre n\u00e9gatif';\n        END IF;\n\n    END $$\n\nDELIMITER ;\n</code></pre>"},{"location":"notes_de_cours/mySQL/trigger/#restrictions","title":"Restrictions","text":"<ul> <li>On en peut pas utiliser de transaction dans un trigger, START TRANSACTION, COMMIT ou ROLLBACK</li> <li>On peut utiliser une proc\u00e9dure stock\u00e9e mais avec les restrictions suivantes : <ul> <li>La proc\u00e9dure ne peut pas retourner d'informations, \u00e0 part en utilisant un param\u00e8tre OUT ou IN/OUT. </li> <li>La proc\u00e9dure ne doit pas utiliser de transaction.</li> </ul> </li> <li>On ne peut pas modifier les donn\u00e9es d'une table qui est utilis\u00e9e dans la requ\u00eate qui d\u00e9clenche le trigger. \u00c7a compte pour toutes les tables de la requ\u00eate et non seulement la table associ\u00e9e au trigger.</li> <li>Une suppression ou modification de donn\u00e9es d\u00e9clench\u00e9e par une cl\u00e9 \u00e9trang\u00e8re ne provoquera pas l'ex\u00e9cution du trigger associ\u00e9 \u00e0 cette table.</li> </ul> <p>Exemple de triggers</p> <p>J'ai une table joueur, un table guilde et une table joueur_guilde_log. Dans la table joueur il y a un champ guilde_id qui fait r\u00e9f\u00e9rence \u00e0 la cl\u00e9 primaire de la table guilde. Quand on modifie la guilde d'un joueur, je voudrais sauvegarder les informations dans une autre table (le id du joueur, l'id de son acienne guile, l'id de la nouvelle et la date de la modification). Je vais cr\u00e9er un trigger AFTER sur la table joueur. Je vais aussi valider que la colonne guilde_id a \u00e9t\u00e9 modifi\u00e9 avant d'ajouter les informations dans la table joueur_guilde_log. </p> <pre><code>DELIMITER $$\n\nCREATE TRIGGER joueur_after_update\n    AFTER UPDATE\n    ON joueur FOR EACH ROW\n    BEGIN\n\n        IF OLD.guilde_id &lt;&gt; NEW.guilde_id THEN \n            INSERT INTO joueur_guild_log (joueur_id, \n                                          old_guild_id, \n                                          new_guild_id, \n                                          mod_date)\n            VALUES (old.id, \n                    old.guilde_id, \n                    new.guilde_id, \n                    NOW());\n        END IF;\n\n    END $$\n\nDELIMITER ;\n</code></pre>"},{"location":"notes_de_cours/mySQL/trigger/#documentation","title":"Documentation","text":"<ul> <li>https://www.mysqltutorial.org/mysql-triggers/</li> <li>https://www.javatpoint.com/mysql-trigger</li> <li>https://dev.mysql.com/doc/refman/8.0/en/trigger-syntax.html</li> </ul>"},{"location":"notes_de_cours/mySQL/view/","title":"VIEW","text":"<p>En SQL, on peut enregistrer une requ\u00eate qu'on utilise r\u00e9guli\u00e8rement et la r\u00e9utiliser facilement dans d'autres requ\u00eates. Pour ce faire on cr\u00e9e ce qu'on appelle une VIEW.</p>"},{"location":"notes_de_cours/mySQL/view/#avantages-de-creer-une-view","title":"Avantages de cr\u00e9er une VIEW","text":"<ul> <li>Simplification des requ\u00eates</li> <li>S\u00e9curiser des donn\u00e9es sensibles</li> <li>Faciliter la maintenance</li> </ul> <p>Il faut se rappeler qu'une view n'est pas une fa\u00e7on d'optimiser nos requ\u00eates. Quand une view est utilis\u00e9 dans une requ\u00eate, la requ\u00eate de la view est ex\u00e9cut\u00e9 en premier lieu et ensuite la requ\u00eate principale. On pourrait voir \u00e7a comme une sous-requ\u00eate qui est plus simple \u00e0 utiliser pour le programmeur.</p>"},{"location":"notes_de_cours/mySQL/view/#creer-une-view","title":"Cr\u00e9er une VIEW","text":"<p>Pour cr\u00e9er une view, on utilise la d\u00e9claration CREATE VIEW</p> <pre><code>CREATE [OR REPLACE] VIEW [nom_bd.]nom_view [(liste_colonne)]\nAS\nrequ\u00eate_select;\n</code></pre> <ul> <li>Le nom de la view doit \u00eatre unique dans la base de donn\u00e9es, aucune autre view ni table ne doit avoir le m\u00eame nom.</li> <li>Si on ajoute l'option OR REPLACE et que la view existe d\u00e9j\u00e0, la nouvelle view va remplacer l'ancienne, sinon \u00e7a n'aura aucun effet.</li> <li>On peut d\u00e9finir optionnellement les noms de colonnes de la view, sinon les noms de colonnes seront celle de la requ\u00eate select.</li> <li>Pour terminer, on ajoute une requ\u00eate select. La requ\u00eate peut interroger des tables et d'autres views.  </li> </ul> <p>Exemple</p> <pre><code>CREATE OR REPLACE VIEW etudiant_informatique (nom_complet, da)\nAS \n    SELECT CONCAT(e.nom, ', ', e.prenom),\n           e.da\n    FROM etudiant e\n        INNER JOIN etudiant_concentration ec ON ec.etudiant_id = e.id\n            INNER JOIN concentration c ON c.id = ec.concentration\n    WHERE c.description = \"Technique informatique\";\n</code></pre> <p>Ensuite pour se servir de la view, on n'a qu'\u00e0 utiliser la view comme une table : </p> <pre><code>SELECT * \nFROM etudiant_informatique\nORDER BY da;\n</code></pre>"},{"location":"notes_de_cours/mySQL/view/#modifier-une-view","title":"Modifier une VIEW","text":"<p>Pour modifier une view, on peut utiliser la d\u00e9claration CREATE OR REPLACE VIEW ou bien ALTER VIEW. Les deux m\u00e9thodes sont similaire dans leur r\u00e9sultat. On a d\u00e9j\u00e0 vu la syntaxe du CREATE OR REPLACE VIEW. Voici un exemple pour le ALTER VIEW : </p> <pre><code>ALTER VIEW nom_view [(liste_colonne)]\nAS requ\u00eate_select;;\n</code></pre> <p>On ne peut pas modifier le nom de la view par ces m\u00e9thodes, pour se faire, on doit utiliser la d\u00e9claration RENAME TABLE</p>"},{"location":"notes_de_cours/mySQL/view/#renommer-une-view","title":"Renommer une VIEW","text":"<pre><code>RENAME TABLE nom_view_original \nTO nouveau_nom_view;\n</code></pre>"},{"location":"notes_de_cours/mySQL/view/#supprimer-une-view","title":"Supprimer une VIEW","text":"<pre><code>DROP VIEW [IF EXISTS] nom_view;\n</code></pre>"},{"location":"notes_de_cours/mySQL/view/#source","title":"Source","text":"<ul> <li>https://dev.mysql.com/doc/refman/8.0/en/create-view.html</li> <li>https://www.mysqltutorial.org/mysql-views-tutorial.aspx</li> </ul>"},{"location":"notes_de_cours/python/installation/","title":"Installation de Python","text":"<p>T\u00e9l\u00e9chardez la derni\u00e8re version de Python disponible pour votre syst\u00e8me \u00e0 cette adresse https://www.python.org/downloads/.</p> <p>Ex\u00e9cutez le fichier t\u00e9l\u00e9charg\u00e9 et au premier \u00e9cran de l'installateur assurez-vous de bien cocher l'option \"Add python.exe to PATH\" dans le bas.</p> <p></p> <p>Ouvrez ensuite un terminal et entrez la commande suivante pour v\u00e9rifier que Python est bien install\u00e9 : </p> <pre><code>py --version\n</code></pre> <p>Vous pouvez aussi voir la liste de toutes les versions install\u00e9es ainsi que leur r\u00e9pertoire d'installation avec la commande :</p> <pre><code>py -0p\n</code></pre> <p>Dans cet exemple j'ai deux version d'install\u00e9e et on voit que la 3.12 est la version active.</p> <p></p>"},{"location":"notes_de_cours/python/installation/#executer-votre-premier-programme-python","title":"Ex\u00e9cuter votre premier programme Python","text":"<p>Pour lancer un programme Python il suffit de faire la commande py suivie du nom du fichier dans un terminal. Si vous codez avec vsCode je vous conseille d'installer les extensions suivantes : </p> <ul> <li>Python par Microsoft : https://marketplace.visualstudio.com/items?itemName=ms-python.python</li> <li>Pylance par Microsoft : https://marketplace.visualstudio.com/items?itemName=ms-python.vscode-pylance</li> </ul> <p>Cr\u00e9er un fichier nomm\u00e9 hello.py et copiez-y le code suivant : </p> hello.py<pre><code>print(\"Hello\")\n</code></pre> <p>Tentez de l'ex\u00e9cuter depuis la console et ensuite depuis vsCode en cliquant sur l'icone Play en haut \u00e0 droite de la fen\u00eatre du fichier.</p>"},{"location":"notes_de_cours/python/installation/#supprimer-python","title":"Supprimer Python","text":"<p>On peut supprimer une version de Python facilement en passant par la suppression des programmes Windows, elle va \u00eatre dans la liste des programmes install\u00e9s. Parcontre vous devriez aussi aller v\u00e9rifier ensuite dans les variables d'environnement car Python y ajoute des r\u00e9f\u00e9rences qui ne sont pas toujours supprim\u00e9es.</p>"},{"location":"notes_de_cours/python/libpyqt/","title":"pyQT5","text":"<p>C'est une librairie qui va nous servir \u00e0 cr\u00e9er des interfaces graphiques pour nos programmes python</p>"},{"location":"notes_de_cours/python/libpyqt/#installation","title":"Installation","text":"<p>En ligne de commande </p> <pre><code>pip install PyQt5\n</code></pre>"},{"location":"notes_de_cours/python/libpyqt/#documentation","title":"Documentation","text":""},{"location":"notes_de_cours/python/libpyqt/#tutoriel","title":"Tutoriel","text":"<ul> <li>https://www.pythonguis.com/courses/start/</li> <li>https://www.tutorialspoint.com/pyqt5/index.html</li> <li>https://build-system.fman.io/pyqt5-tutorial</li> </ul>"},{"location":"notes_de_cours/python/libpyqt/#disposition-de-notre-application","title":"Disposition de notre application","text":"<ul> <li>https://www.pythonguis.com/tutorials/pyqt-layouts/</li> <li>Le gridLayout plus en d\u00e9tail : https://www.pythontutorial.net/pyqt/pyqt-qgridlayout/</li> </ul>"},{"location":"notes_de_cours/python/libpyqt/#les-widgets","title":"Les Widgets","text":"<ul> <li>https://www.tutorialspoint.com/pyqt/pyqt_basic_widgets.htm</li> <li>https://www.pythonguis.com/tutorials/pyqt-basic-widgets/</li> </ul>"},{"location":"notes_de_cours/python/mysql_connector/","title":"MySQL Connector pour python","text":"<p>Pour nous permettre de communiquer avec notre base de donn\u00e9es MySQL depuis nos programmes Python on va utiliser la librairie MySQL Connector.</p>"},{"location":"notes_de_cours/python/mysql_connector/#installation","title":"Installation","text":"<p>En ligne de commande </p> <pre><code>pip install mysql-connector-python\n</code></pre>"},{"location":"notes_de_cours/python/mysql_connector/#utilisation","title":"Utilisation","text":"<p>Premi\u00e8rement on doit importer la librairie MySQL Connector. Ensuite on cr\u00e9e une connexion vers la base de donn\u00e9es dans laquelle on veut travailler. On va aussi d\u00e9clarer un curseur qui va s'occuper d'ex\u00e9cuter les requ\u00eates. Finalement on doit refermer le curseur et la connexion \u00e0 la base de donn\u00e9es. </p> <p>Voici un petit exemple de programme Python qui ex\u00e9cute une requ\u00eate SELECT et qui affiche ensuite \u00e0 la console le r\u00e9sultat obtenue.</p> select_exemple.py<pre><code># Importation de la librairie mysql.connector\nimport mysql.connector\n\n# Cr\u00e9ation de la connexion \u00e0 la base de donn\u00e9es\ncnx = mysql.connector.connect(\n    user='root', \n    password='********',\n    host='localhost',\n    database='bd2_ex10')\n\n# Cr\u00e9ation du curseur\n# Le param\u00eatre dictionary=True permet de faire \n# r\u00e9f\u00e9rence aux champs du r\u00e9sultat par leur nom\ncursor = cnx.cursor(dictionary=True)\n\n# Stockage de la requ\u00eate dans une variable\nquery = \"SELECT nom FROM houblon h ORDER BY nom;\"\n\n# Ex\u00e9cution de la requ\u00eate\ncursor.execute(query)\n\n# Affichage des r\u00e9sultats\nfor (ligne) in cursor:\n    print(ligne[\"nom\"])\n\n# Fermeture du curseur et de la connexion\ncursor.close()\ncnx.close()\n</code></pre> <p>Le r\u00e9sultat contenu dans le curseur est un tableau de toutes les lignes du r\u00e9sultat dont chaque \u00e9l\u00e9ment est aussi un tableau qui contient chaque colonne de la ligne. Dans l'exemple plus haut chaque \u00e9l\u00e9ment du tableau est un tableau d'un item, la colonne nom.</p> <p>Note</p> <p>Quand vous ex\u00e9cutez une requ\u00eate INSERT, UPDATE ou DELETE vous devez faire un commit pour que les modifications soit sauvegard\u00e9es. Utilisez la fontion commit() de votre objet connexion.</p> <p>Voici un autre exemple qui supprime un \u00e9l\u00e9ment d'une table. Dans cet exemple on voit comment passer des param\u00e8tres \u00e0 la requ\u00eate et faire une gestion d'erreurs avec un try ... catch.</p> delete_exemple.py<pre><code>import mysql.connector\n\nhoulon_id = 1;\n\nhoublonDelete = False\nrequete = \"DELETE FROM houblon WHERE id = %(houblon_id)s\"\nparametres = {'houblon_id' : houlon_id}\n\ntry:\n    connexion = mysql.connector.connect(\n      user='root', \n      password='r00t_bd2',\n      host='localhost',\n      database='bd2_ex10')\n    cursor = connexion.cursor()\n\n    # Ex\u00e9cution de la requ\u00eate avec passage de param\u00e8tres\n    cursor.execute(requete, parametres)\n    # Validation de la transaction\n    connexion.commit()\n\n    houblonDelete = True\nexcept mysql.Error as erreur:\n    print(erreur)\nfinally:\n    cursor.close()\n    connexion.close()\n</code></pre>"},{"location":"notes_de_cours/python/mysql_connector/#documentation","title":"Documentation","text":"<ul> <li>Documentation officielle</li> <li>Documentation sur W3Schools</li> </ul>"},{"location":"notes_de_cours/python/qtdesigner/","title":"Qt Designer","text":"<p>Qt Designer est un \u00e9diteur graphique qui nous permet de cr\u00e9er visuellement des interfaces graphiques en pyQt. Les interfaces seront ensuite export\u00e9 en fichier python que nous pourront utiliser dans nos programme.</p>"},{"location":"notes_de_cours/python/qtdesigner/#installation","title":"Installation","text":"<p>Directement en ligne de commande</p> <pre><code>pip install pip install PyQt5Designer\n</code></pre> <p>Ou bien depuis le site officiel : https://www.qt.io/download-qt-installer, vous allez devoir vous cr\u00e9er un compte pour l'installation.</p>"},{"location":"notes_de_cours/python/qtdesigner/#lancer-qt-designer","title":"Lancer Qt Designer","text":"<p>En ligne de commande, utilisez la commande designer</p> <pre><code>designer\n</code></pre>"},{"location":"notes_de_cours/python/qtdesigner/#convertir-un-fichier-ui-en-python","title":"Convertir un fichier ui en python","text":"<p>Les interfaces que vous allez cr\u00e9er avec Qt Designer seront enregistr\u00e9es dans des fichiers avec l'extension ui. Pour les utiliser dans vos programme python on va devoir les convertir. On peut le faire directement en ligne de commande et utilisant la commande pyuic5 suivi du nom du fichier source, de l'argument -o et du nom du fichier de destination. Le fichier de destination n'est pas oblig\u00e9 d'exister au moment d'ex\u00e9cuter la commande mais il doit porter l'extension py.</p> <pre><code>pyuic5 masuperfenetre.ui -o MaSuperFenetre.py\n</code></pre>"},{"location":"notes_de_cours/python/qtdesigner/#exemple","title":"Exemple","text":"<p>Au d\u00e9marrage de l'application Qt Designer la fen\u00eatre nouveau formulaire va s'afficher. S\u00e9lectionnez Main Window dans la section templates\\forms et cliquez sur cr\u00e9er.</p> <p></p> <p>Une fen\u00eatre vide va \u00eatre cr\u00e9\u00e9 avec une barre de menu dans le haut et une barre de statut dans le bas. Enregistrez cette fen\u00eatre dans le r\u00e9pertoire de votre application. (Dans mon exemple j'ai nomm\u00e9 mon fichier exemple.ui). Vous voil\u00e0 pr\u00eat \u00e0 cr\u00e9er votre interface. On cr\u00e9er une interface o\u00f9 on pourra saisir un id et en cliquant sur un bouton de l'information va s'afficher \u00e0 l'\u00e9cran.</p> <p></p> <p>Commencez par supprimer le menu et la barre de statut. Dans l'inspecteur d'objet s\u00e9lectionnez menubar et statusbar et avec un clique droit choisissez supprimer.</p> <p></p> <p>Dans la section de gauche vous avez une liste de widgets \u00e0 utiliser. Glissez un Vertical Layout dans la fen\u00eatre principale. Cliquez ensuite sur la fen\u00eatre principale \u00e0 l'ext\u00e9rieur du widget que vous venez d'ajouter et dans la barre de menu du haut de l'\u00e9diteur cliquez sur le bouton mettre en forme verticalement. Le widget Vertical Layout devrait s'\u00e9tendre \u00e0 la totalit\u00e9 de la fen\u00eatre.</p> <p></p> <p>Ensuite dans l'ordre on va ajouter un Label, un Line Edit, un Push Button et un autre Label.</p> <p></p> <p>En s\u00e9lectionnant chaque widget, modifiez la propri\u00e9t\u00e9 objectName dans l'\u00e9diteur de propri\u00e9t\u00e9s. Je n'ai pas renomm\u00e9 le premier label, mais pour les suivants j'ai utilis\u00e9 les noms suivants : </p> <ul> <li>Line Edit = editCitoyenId</li> <li>Push Button = btnRechercher</li> <li>Label = lblResultat</li> </ul> <p></p> <p>Vous pouvez modifier le texte affich\u00e9 sur un widget avec la propri\u00e9t\u00e9 text. Vous pouvez ajuter le format du texte avec plusieurs propri\u00e9t\u00e9s, dont font et alignment.</p> <p></p> <p>Derni\u00e8re chose, on va associer une fonction \u00e0 un \u00e9v\u00e9nement, ici un clique de la souris sur le bouton. On peut le faire depuis l'interface de Qt Designer ou dans notre script python. Pour le faire depuis Qt Designer, dans le menu principal, sous \u00c9dition s\u00e9lectionnez \u00c9diter signaux/slots. Ensuite cliquez sur le bouton et sans rel\u00e2cher le bouton glisser la souris vers la fen\u00eatre principale (attention on cible la fen\u00eatre principale et non le widget layout). Vous devriez avoir une ligne rouge avec \u00e0 son bout une fl\u00e8che compos\u00e9e de barre rouge. Rel\u00e2cher maintenant le bouton de la souris et la fen\u00eatre Configurer connexion va s'afficher.</p> <p></p> <p>S\u00e9lectionnez clicked() et cliquez sur \u00c9diter. Dans la fen\u00eatre qui va appara\u00eetre cliquez sur le bouton avec une croix verte dans la section Slots. Modifier ensuite le nom de la fonction (slot1() par d\u00e9faut) pour le nom que vous allez donner \u00e0 votre fonction. Cliquez ensuite sur ok. Dans la fen\u00eatre pr\u00e9c\u00e9dente vous avez maintenant votre fonction dans la section de droite, s\u00e9lectionnez la et cliquez sur ok.</p> <p></p> <p></p> <p>Pour connecter un \u00e9v\u00e9nement depuis le script python, voir plus bas dans l'exemble du fichier app.py.</p> <p>Voila le travail pour notre interface vous pouvez sauvegarder le tout et ouvrir un terminal dans le r\u00e9pertoire o\u00f9 le fichier se trouve.  Utilisez la commande qu'on a vu plus haut pour convertir le fichier ui et fichier python.</p> <pre><code>pyuic5 exemple.ui -o demo.py\n</code></pre> <p>Si on regarde dans le fichier python qu'on a cr\u00e9\u00e9 on peut voir qu'il y a une classe Ui_MainWindow qui contient notre interface. Maintenant on va cr\u00e9er un fichier python qui va \u00eatre le script principal et o\u00f9 on va appeler cette classe et l'afficher.</p> app.py<pre><code>import sys\nfrom PyQt5.QtWidgets import QApplication, QMainWindow\n# Importer la classe Ui_MainWindow du fichier demo.py\nfrom demo import Ui_MainWindow\n\n# En param\u00eatre de la classe MainWindow on va h\u00e9riter des fonctionnalit\u00e9s\n# de QMainWindow et de notre interface Ui_MainWindow\nclass MainWindow(QMainWindow, Ui_MainWindow):\n    def __init__(self, *args, obj=None, **kwargs):\n        super(MainWindow, self).__init__(*args, **kwargs)\n        # On va cr\u00e9er la fen\u00eatre avec cette commande\n        self.setupUi(self)\n        # On a acc\u00e8s \u00e0 tous les \u00e9l\u00e9ments de notre interface\n        # Par exemple ici on branche une fonction \u00e0 l'appui sur le bouton\n        self.editCitoyenId.returnPressed.connect(self.test)\n\n    # On d\u00e9fini la fonction qu'on avait d\u00e9clar\u00e9 pour le clique sur le bouton \n    # dans qtDesigner\n    def rechercherCitoyen(self):\n        # On r\u00e9cup\u00e8re la valeur du line edit\n        citoyen_id = self.editCitoyenId.text()\n        # Ensuite on pourrait lancer une fonction qui interroge la BD\n        # Pour l'exemple on va simplement afficher la valeur dans le label \n        # lblResultat\n        self.lblResultat.setText(citoyen_id)\n        # editCitoyenId et lblResultat sont les noms qu'on a donn\u00e9 au widget\n        # dans l'\u00e9diteur Qt Designer\n\n    def test(self):\n        self.lblResultat.setText('Tu as appuy\u00e9 sur Enter')\n\napp = QApplication(sys.argv)\n\nwindow = MainWindow()\nwindow.show()\napp.exec()\n</code></pre> <p>Finalement ex\u00e9cutez le script app.py pour afficher le r\u00e9sultat.</p> <p></p>"},{"location":"notes_de_cours/python/qtdesigner/#ressources","title":"Ressources","text":"<ul> <li>https://realpython.com/qt-designer-python/</li> <li>https://www.pythonguis.com/tutorials/qt-designer-gui-layout/</li> <li>https://doc.qt.io/qt-5/qtdesigner-manual.html</li> </ul>"}]}